!function(Pt,ft){"object"==typeof exports&&typeof module<"u"?module.exports=ft():"function"==typeof define&&define.amd?define(ft):(Pt=typeof globalThis<"u"?globalThis:Pt||self).bootstrap=ft()}(this,function(){"use strict";const Pt="transitionend",ft=O=>{let y=O.getAttribute("data-bs-target");if(!y||"#"===y){let E=O.getAttribute("href");if(!E||!E.includes("#")&&!E.startsWith("."))return null;E.includes("#")&&!E.startsWith("#")&&(E=`#${E.split("#")[1]}`),y=E&&"#"!==E?E.trim():null}return y},Cr=O=>{const y=ft(O);return y&&document.querySelector(y)?y:null},ho=O=>{const y=ft(O);return y?document.querySelector(y):null},xi=O=>{O.dispatchEvent(new Event(Pt))},Lr=O=>!(!O||"object"!=typeof O)&&(void 0!==O.jquery&&(O=O[0]),void 0!==O.nodeType),ai=O=>Lr(O)?O.jquery?O[0]:O:"string"==typeof O&&O.length>0?document.querySelector(O):null,Jr=(O,y,E)=>{Object.keys(E).forEach(Z=>{const Y=E[Z],ct=y[Z],vt=ct&&Lr(ct)?"element":null==(Ot=ct)?`${Ot}`:{}.toString.call(Ot).match(/\s([a-z]+)/i)[1].toLowerCase();var Ot;if(!new RegExp(Y).test(vt))throw new TypeError(`${O.toUpperCase()}: Option "${Z}" provided type "${vt}" but expected type "${Y}".`)})},co=O=>!(!Lr(O)||0===O.getClientRects().length)&&"visible"===getComputedStyle(O).getPropertyValue("visibility"),Gi=O=>!O||O.nodeType!==Node.ELEMENT_NODE||!!O.classList.contains("disabled")||(void 0!==O.disabled?O.disabled:O.hasAttribute("disabled")&&"false"!==O.getAttribute("disabled")),Yr=O=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof O.getRootNode){const y=O.getRootNode();return y instanceof ShadowRoot?y:null}return O instanceof ShadowRoot?O:O.parentNode?Yr(O.parentNode):null},oa=()=>{},Hi=()=>{const{jQuery:O}=window;return O&&!document.body.hasAttribute("data-bs-no-jquery")?O:null},aa=[],yn=()=>"rtl"===document.documentElement.dir,Ft=O=>{var y;y=()=>{const E=Hi();if(E){const Z=O.NAME,Y=E.fn[Z];E.fn[Z]=O.jQueryInterface,E.fn[Z].Constructor=O,E.fn[Z].noConflict=()=>(E.fn[Z]=Y,O.jQueryInterface)}},"loading"===document.readyState?(aa.length||document.addEventListener("DOMContentLoaded",()=>{aa.forEach(E=>E())}),aa.push(y)):y()},ee=O=>{"function"==typeof O&&O()},Fe=(O,y,E=!0)=>{if(!E)return void ee(O);const Z=(vt=>{if(!vt)return 0;let{transitionDuration:Ot,transitionDelay:Ct}=window.getComputedStyle(vt);const Ht=Number.parseFloat(Ot),ce=Number.parseFloat(Ct);return Ht||ce?(Ot=Ot.split(",")[0],Ct=Ct.split(",")[0],1e3*(Number.parseFloat(Ot)+Number.parseFloat(Ct))):0})(y)+5;let Y=!1;const ct=({target:vt})=>{vt===y&&(Y=!0,y.removeEventListener(Pt,ct),ee(O))};y.addEventListener(Pt,ct),setTimeout(()=>{Y||xi(y)},Z)},Te=(O,y,E,Z)=>{let Y=O.indexOf(y);if(-1===Y)return O[!E&&Z?O.length-1:0];const ct=O.length;return Y+=E?1:-1,Z&&(Y=(Y+ct)%ct),O[Math.max(0,Math.min(Y,ct-1))]},Di=/[^.]*(?=\..*)\.|.*/,gn=/\..*/,c=/::\d+$/,mi={};let Mt=1;const Me={mouseenter:"mouseover",mouseleave:"mouseout"},le=/^(mouseenter|mouseleave)/i,Qi=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Zt(O,y){return y&&`${y}::${Mt++}`||O.uidEvent||Mt++}function ln(O){const y=Zt(O);return O.uidEvent=y,mi[y]=mi[y]||{},mi[y]}function tn(O,y,E=null){const Z=Object.keys(O);for(let Y=0,ct=Z.length;Y<ct;Y++){const vt=O[Z[Y]];if(vt.originalHandler===y&&vt.delegationSelector===E)return vt}return null}function Ee(O,y,E){const Z="string"==typeof y,Y=Z?E:y;let ct=je(O);return Qi.has(ct)||(ct=O),[Z,Y,ct]}function jn(O,y,E,Z,Y){if("string"!=typeof y||!O)return;if(E||(E=Z,Z=null),le.test(y)){const Ue=Ze=>function(ni){if(!ni.relatedTarget||ni.relatedTarget!==ni.delegateTarget&&!ni.delegateTarget.contains(ni.relatedTarget))return Ze.call(this,ni)};Z?Z=Ue(Z):E=Ue(E)}const[ct,vt,Ot]=Ee(y,E,Z),Ct=ln(O),Ht=Ct[Ot]||(Ct[Ot]={}),ce=tn(Ht,vt,ct?E:null);if(ce)return void(ce.oneOff=ce.oneOff&&Y);const ne=Zt(vt,y.replace(Di,"")),ii=ct?(Ue=O,Ze=E,ni=Z,function qe(ji){const ci=Ue.querySelectorAll(Ze);for(let{target:Ie}=ji;Ie&&Ie!==this;Ie=Ie.parentNode)for(let Si=ci.length;Si--;)if(ci[Si]===Ie)return ji.delegateTarget=Ie,qe.oneOff&&Ut.off(Ue,ji.type,Ze,ni),ni.apply(Ie,[ji]);return null}):function(Ue,Ze){return function ni(qe){return qe.delegateTarget=Ue,ni.oneOff&&Ut.off(Ue,qe.type,Ze),Ze.apply(Ue,[qe])}}(O,E);var Ue,Ze,ni;ii.delegationSelector=ct?E:null,ii.originalHandler=vt,ii.oneOff=Y,ii.uidEvent=ne,Ht[ne]=ii,O.addEventListener(Ot,ii,ct)}function ti(O,y,E,Z,Y){const ct=tn(y[E],Z,Y);ct&&(O.removeEventListener(E,ct,Boolean(Y)),delete y[E][ct.uidEvent])}function je(O){return O=O.replace(gn,""),Me[O]||O}const Ut={on(O,y,E,Z){jn(O,y,E,Z,!1)},one(O,y,E,Z){jn(O,y,E,Z,!0)},off(O,y,E,Z){if("string"!=typeof y||!O)return;const[Y,ct,vt]=Ee(y,E,Z),Ot=vt!==y,Ct=ln(O),Ht=y.startsWith(".");if(void 0!==ct)return Ct&&Ct[vt]?void ti(O,Ct,vt,ct,Y?E:null):void 0;Ht&&Object.keys(Ct).forEach(ne=>{!function(ii,Ue,Ze,ni){const qe=Ue[Ze]||{};Object.keys(qe).forEach(ji=>{if(ji.includes(ni)){const ci=qe[ji];ti(ii,Ue,Ze,ci.originalHandler,ci.delegationSelector)}})}(O,Ct,ne,y.slice(1))});const ce=Ct[vt]||{};Object.keys(ce).forEach(ne=>{const ii=ne.replace(c,"");if(!Ot||y.includes(ii)){const Ue=ce[ne];ti(O,Ct,vt,Ue.originalHandler,Ue.delegationSelector)}})},trigger(O,y,E){if("string"!=typeof y||!O)return null;const Z=Hi(),Y=je(y),ct=y!==Y,vt=Qi.has(Y);let Ot,Ct=!0,Ht=!0,ce=!1,ne=null;return ct&&Z&&(Ot=Z.Event(y,E),Z(O).trigger(Ot),Ct=!Ot.isPropagationStopped(),Ht=!Ot.isImmediatePropagationStopped(),ce=Ot.isDefaultPrevented()),vt?(ne=document.createEvent("HTMLEvents"),ne.initEvent(Y,Ct,!0)):ne=new CustomEvent(y,{bubbles:Ct,cancelable:!0}),void 0!==E&&Object.keys(E).forEach(ii=>{Object.defineProperty(ne,ii,{get:()=>E[ii]})}),ce&&ne.preventDefault(),Ht&&O.dispatchEvent(ne),ne.defaultPrevented&&void 0!==Ot&&Ot.preventDefault(),ne}},Pi=new Map,Ci={set(O,y,E){Pi.has(O)||Pi.set(O,new Map);const Z=Pi.get(O);Z.has(y)||0===Z.size?Z.set(y,E):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(Z.keys())[0]}.`)},get:(O,y)=>Pi.has(O)&&Pi.get(O).get(y)||null,remove(O,y){if(!Pi.has(O))return;const E=Pi.get(O);E.delete(y),0===E.size&&Pi.delete(O)}};class We{constructor(y){(y=ai(y))&&(this._element=y,Ci.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Ci.remove(this._element,this.constructor.DATA_KEY),Ut.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this).forEach(y=>{this[y]=null})}_queueCallback(y,E,Z=!0){Fe(y,E,Z)}static getInstance(y){return Ci.get(ai(y),this.DATA_KEY)}static getOrCreateInstance(y,E={}){return this.getInstance(y)||new this(y,"object"==typeof E?E:null)}static get VERSION(){return"5.1.3"}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}}const bi=(O,y="hide")=>{const Z=O.NAME;Ut.on(document,`click.dismiss${O.EVENT_KEY}`,`[data-bs-dismiss="${Z}"]`,function(Y){if(["A","AREA"].includes(this.tagName)&&Y.preventDefault(),Gi(this))return;const ct=ho(this)||this.closest(`.${Z}`);O.getOrCreateInstance(ct)[y]()})};class Ln extends We{static get NAME(){return"alert"}close(){if(Ut.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const y=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,y)}_destroyElement(){this._element.remove(),Ut.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(y){return this.each(function(){const E=Ln.getOrCreateInstance(this);if("string"==typeof y){if(void 0===E[y]||y.startsWith("_")||"constructor"===y)throw new TypeError(`No method named "${y}"`);E[y](this)}})}}bi(Ln,"close"),Ft(Ln);const Ni='[data-bs-toggle="button"]';class on extends We{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(y){return this.each(function(){const E=on.getOrCreateInstance(this);"toggle"===y&&E[y]()})}}function fr(O){return"true"===O||"false"!==O&&(O===Number(O).toString()?Number(O):""===O||"null"===O?null:O)}function zr(O){return O.replace(/[A-Z]/g,y=>`-${y.toLowerCase()}`)}Ut.on(document,"click.bs.button.data-api",Ni,O=>{O.preventDefault();const y=O.target.closest(Ni);on.getOrCreateInstance(y).toggle()}),Ft(on);const Ye={setDataAttribute(O,y,E){O.setAttribute(`data-bs-${zr(y)}`,E)},removeDataAttribute(O,y){O.removeAttribute(`data-bs-${zr(y)}`)},getDataAttributes(O){if(!O)return{};const y={};return Object.keys(O.dataset).filter(E=>E.startsWith("bs")).forEach(E=>{let Z=E.replace(/^bs/,"");Z=Z.charAt(0).toLowerCase()+Z.slice(1,Z.length),y[Z]=fr(O.dataset[E])}),y},getDataAttribute:(O,y)=>fr(O.getAttribute(`data-bs-${zr(y)}`)),offset(O){const y=O.getBoundingClientRect();return{top:y.top+window.pageYOffset,left:y.left+window.pageXOffset}},position:O=>({top:O.offsetTop,left:O.offsetLeft})},_e={find:(O,y=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(y,O)),findOne:(O,y=document.documentElement)=>Element.prototype.querySelector.call(y,O),children:(O,y)=>[].concat(...O.children).filter(E=>E.matches(y)),parents(O,y){const E=[];let Z=O.parentNode;for(;Z&&Z.nodeType===Node.ELEMENT_NODE&&3!==Z.nodeType;)Z.matches(y)&&E.push(Z),Z=Z.parentNode;return E},prev(O,y){let E=O.previousElementSibling;for(;E;){if(E.matches(y))return[E];E=E.previousElementSibling}return[]},next(O,y){let E=O.nextElementSibling;for(;E;){if(E.matches(y))return[E];E=E.nextElementSibling}return[]},focusableChildren(O){const y=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(E=>`${E}:not([tabindex^="-"])`).join(", ");return this.find(y,O).filter(E=>!Gi(E)&&co(E))}},Go="carousel",Vn={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},Wo={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},mr="next",_r="prev",Zn="left",Tn="right",Qn={ArrowLeft:Tn,ArrowRight:Zn},Vr="slid.bs.carousel",Sn="active",tr=".active.carousel-item";class zn extends We{constructor(y,E){super(y),this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(E),this._indicatorsElement=_e.findOne(".carousel-indicators",this._element),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent),this._addEventListeners()}static get Default(){return Vn}static get NAME(){return Go}next(){this._slide(mr)}nextWhenVisible(){!document.hidden&&co(this._element)&&this.next()}prev(){this._slide(_r)}pause(y){y||(this._isPaused=!0),_e.findOne(".carousel-item-next, .carousel-item-prev",this._element)&&(xi(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null}cycle(y){y||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config&&this._config.interval&&!this._isPaused&&(this._updateInterval(),this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))}to(y){this._activeElement=_e.findOne(tr,this._element);const E=this._getItemIndex(this._activeElement);if(!(y>this._items.length-1||y<0)){if(!this._isSliding)return E===y?(this.pause(),void this.cycle()):void this._slide(y>E?mr:_r,this._items[y]);Ut.one(this._element,Vr,()=>this.to(y))}}_getConfig(y){return y={...Vn,...Ye.getDataAttributes(this._element),..."object"==typeof y?y:{}},Jr(Go,y,Wo),y}_handleSwipe(){const y=Math.abs(this.touchDeltaX);if(y<=40)return;const E=y/this.touchDeltaX;this.touchDeltaX=0,E&&this._slide(E>0?Tn:Zn)}_addEventListeners(){this._config.keyboard&&Ut.on(this._element,"keydown.bs.carousel",y=>this._keydown(y)),"hover"===this._config.pause&&(Ut.on(this._element,"mouseenter.bs.carousel",y=>this.pause(y)),Ut.on(this._element,"mouseleave.bs.carousel",y=>this.cycle(y))),this._config.touch&&this._touchSupported&&this._addTouchEventListeners()}_addTouchEventListeners(){const y=ct=>this._pointerEvent&&("pen"===ct.pointerType||"touch"===ct.pointerType),E=ct=>{y(ct)?this.touchStartX=ct.clientX:this._pointerEvent||(this.touchStartX=ct.touches[0].clientX)},Z=ct=>{this.touchDeltaX=ct.touches&&ct.touches.length>1?0:ct.touches[0].clientX-this.touchStartX},Y=ct=>{y(ct)&&(this.touchDeltaX=ct.clientX-this.touchStartX),this._handleSwipe(),"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(vt=>this.cycle(vt),500+this._config.interval))};_e.find(".carousel-item img",this._element).forEach(ct=>{Ut.on(ct,"dragstart.bs.carousel",vt=>vt.preventDefault())}),this._pointerEvent?(Ut.on(this._element,"pointerdown.bs.carousel",ct=>E(ct)),Ut.on(this._element,"pointerup.bs.carousel",ct=>Y(ct)),this._element.classList.add("pointer-event")):(Ut.on(this._element,"touchstart.bs.carousel",ct=>E(ct)),Ut.on(this._element,"touchmove.bs.carousel",ct=>Z(ct)),Ut.on(this._element,"touchend.bs.carousel",ct=>Y(ct)))}_keydown(y){if(/input|textarea/i.test(y.target.tagName))return;const E=Qn[y.key];E&&(y.preventDefault(),this._slide(E))}_getItemIndex(y){return this._items=y&&y.parentNode?_e.find(".carousel-item",y.parentNode):[],this._items.indexOf(y)}_getItemByOrder(y,E){return Te(this._items,E,y===mr,this._config.wrap)}_triggerSlideEvent(y,E){const Z=this._getItemIndex(y),Y=this._getItemIndex(_e.findOne(tr,this._element));return Ut.trigger(this._element,"slide.bs.carousel",{relatedTarget:y,direction:E,from:Y,to:Z})}_setActiveIndicatorElement(y){if(this._indicatorsElement){const E=_e.findOne(".active",this._indicatorsElement);E.classList.remove(Sn),E.removeAttribute("aria-current");const Z=_e.find("[data-bs-target]",this._indicatorsElement);for(let Y=0;Y<Z.length;Y++)if(Number.parseInt(Z[Y].getAttribute("data-bs-slide-to"),10)===this._getItemIndex(y)){Z[Y].classList.add(Sn),Z[Y].setAttribute("aria-current","true");break}}}_updateInterval(){const y=this._activeElement||_e.findOne(tr,this._element);if(!y)return;const E=Number.parseInt(y.getAttribute("data-bs-interval"),10);E?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=E):this._config.interval=this._config.defaultInterval||this._config.interval}_slide(y,E){const Z=this._directionToOrder(y),Y=_e.findOne(tr,this._element),ct=this._getItemIndex(Y),vt=E||this._getItemByOrder(Z,Y),Ot=this._getItemIndex(vt),Ct=Boolean(this._interval),Ht=Z===mr,ce=Ht?"carousel-item-start":"carousel-item-end",ne=Ht?"carousel-item-next":"carousel-item-prev",ii=this._orderToDirection(Z);if(vt&&vt.classList.contains(Sn))return void(this._isSliding=!1);if(this._isSliding||this._triggerSlideEvent(vt,ii).defaultPrevented||!Y||!vt)return;this._isSliding=!0,Ct&&this.pause(),this._setActiveIndicatorElement(vt),this._activeElement=vt;const Ue=()=>{Ut.trigger(this._element,Vr,{relatedTarget:vt,direction:ii,from:ct,to:Ot})};this._element.classList.contains("slide")?(vt.classList.add(ne),Y.classList.add(ce),vt.classList.add(ce),this._queueCallback(()=>{vt.classList.remove(ce,ne),vt.classList.add(Sn),Y.classList.remove(Sn,ne,ce),this._isSliding=!1,setTimeout(Ue,0)},Y,!0)):(Y.classList.remove(Sn),vt.classList.add(Sn),this._isSliding=!1,Ue()),Ct&&this.cycle()}_directionToOrder(y){return[Tn,Zn].includes(y)?yn()?y===Zn?_r:mr:y===Zn?mr:_r:y}_orderToDirection(y){return[mr,_r].includes(y)?yn()?y===_r?Zn:Tn:y===_r?Tn:Zn:y}static carouselInterface(y,E){const Z=zn.getOrCreateInstance(y,E);let{_config:Y}=Z;"object"==typeof E&&(Y={...Y,...E});const ct="string"==typeof E?E:Y.slide;if("number"==typeof E)Z.to(E);else if("string"==typeof ct){if(void 0===Z[ct])throw new TypeError(`No method named "${ct}"`);Z[ct]()}else Y.interval&&Y.ride&&(Z.pause(),Z.cycle())}static jQueryInterface(y){return this.each(function(){zn.carouselInterface(this,y)})}static dataApiClickHandler(y){const E=ho(this);if(!E||!E.classList.contains("carousel"))return;const Z={...Ye.getDataAttributes(E),...Ye.getDataAttributes(this)},Y=this.getAttribute("data-bs-slide-to");Y&&(Z.interval=!1),zn.carouselInterface(E,Z),Y&&zn.getInstance(E).to(Y),y.preventDefault()}}Ut.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",zn.dataApiClickHandler),Ut.on(window,"load.bs.carousel.data-api",()=>{const O=_e.find('[data-bs-ride="carousel"]');for(let y=0,E=O.length;y<E;y++)zn.carouselInterface(O[y],zn.getInstance(O[y]))}),Ft(zn);const kn="collapse",Zr={toggle:!0,parent:null},_i={toggle:"boolean",parent:"(null|element)"},or="show",Bi="collapse",vn="collapsing",Ve="collapsed",po=":scope .collapse .collapse",xn='[data-bs-toggle="collapse"]';class un extends We{constructor(y,E){super(y),this._isTransitioning=!1,this._config=this._getConfig(E),this._triggerArray=[];const Z=_e.find(xn);for(let Y=0,ct=Z.length;Y<ct;Y++){const vt=Z[Y],Ot=Cr(vt),Ct=_e.find(Ot).filter(Ht=>Ht===this._element);null!==Ot&&Ct.length&&(this._selector=Ot,this._triggerArray.push(vt))}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Zr}static get NAME(){return kn}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let y,E=[];if(this._config.parent){const vt=_e.find(po,this._config.parent);E=_e.find(".collapse.show, .collapse.collapsing",this._config.parent).filter(Ot=>!vt.includes(Ot))}const Z=_e.findOne(this._selector);if(E.length){const vt=E.find(Ot=>Z!==Ot);if(y=vt?un.getInstance(vt):null,y&&y._isTransitioning)return}if(Ut.trigger(this._element,"show.bs.collapse").defaultPrevented)return;E.forEach(vt=>{Z!==vt&&un.getOrCreateInstance(vt,{toggle:!1}).hide(),y||Ci.set(vt,"bs.collapse",null)});const Y=this._getDimension();this._element.classList.remove(Bi),this._element.classList.add(vn),this._element.style[Y]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const ct=`scroll${Y[0].toUpperCase()+Y.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(vn),this._element.classList.add(Bi,or),this._element.style[Y]="",Ut.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[Y]=`${this._element[ct]}px`}hide(){if(this._isTransitioning||!this._isShown()||Ut.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const y=this._getDimension();this._element.style[y]=`${this._element.getBoundingClientRect()[y]}px`,this._element.classList.add(vn),this._element.classList.remove(Bi,or);const E=this._triggerArray.length;for(let Z=0;Z<E;Z++){const Y=this._triggerArray[Z],ct=ho(Y);ct&&!this._isShown(ct)&&this._addAriaAndCollapsedClass([Y],!1)}this._isTransitioning=!0,this._element.style[y]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(vn),this._element.classList.add(Bi),Ut.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}_isShown(y=this._element){return y.classList.contains(or)}_getConfig(y){return(y={...Zr,...Ye.getDataAttributes(this._element),...y}).toggle=Boolean(y.toggle),y.parent=ai(y.parent),Jr(kn,y,_i),y}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const y=_e.find(po,this._config.parent);_e.find(xn,this._config.parent).filter(E=>!y.includes(E)).forEach(E=>{const Z=ho(E);Z&&this._addAriaAndCollapsedClass([E],this._isShown(Z))})}_addAriaAndCollapsedClass(y,E){y.length&&y.forEach(Z=>{E?Z.classList.remove(Ve):Z.classList.add(Ve),Z.setAttribute("aria-expanded",E)})}static jQueryInterface(y){return this.each(function(){const E={};"string"==typeof y&&/show|hide/.test(y)&&(E.toggle=!1);const Z=un.getOrCreateInstance(this,E);if("string"==typeof y){if(void 0===Z[y])throw new TypeError(`No method named "${y}"`);Z[y]()}})}}Ut.on(document,"click.bs.collapse.data-api",xn,function(O){("A"===O.target.tagName||O.delegateTarget&&"A"===O.delegateTarget.tagName)&&O.preventDefault();const y=Cr(this);_e.find(y).forEach(E=>{un.getOrCreateInstance(E,{toggle:!1}).toggle()})}),Ft(un);var En="top",Zi="bottom",di="right",wi="left",Qr="auto",to=[En,Zi,di,wi],x="start",S="end",D="clippingParents",W="viewport",it="popper",pt="reference",At=to.reduce(function(O,y){return O.concat([y+"-"+x,y+"-"+S])},[]),Qt=[].concat(to,[Qr]).reduce(function(O,y){return O.concat([y,y+"-"+x,y+"-"+S])},[]),he="beforeRead",ui="afterRead",bn="beforeMain",qn="afterMain",Gn="beforeWrite",ar="afterWrite",eo=[he,"read",ui,bn,"main",qn,Gn,"write",ar];function er(O){return O?(O.nodeName||"").toLowerCase():null}function sr(O){if(null==O)return window;if("[object Window]"!==O.toString()){var y=O.ownerDocument;return y&&y.defaultView||window}return O}function ko(O){return O instanceof sr(O).Element||O instanceof Element}function lr(O){return O instanceof sr(O).HTMLElement||O instanceof HTMLElement}function Yi(O){return typeof ShadowRoot<"u"&&(O instanceof sr(O).ShadowRoot||O instanceof ShadowRoot)}const z={name:"applyStyles",enabled:!0,phase:"write",fn:function(O){var y=O.state;Object.keys(y.elements).forEach(function(E){var Z=y.styles[E]||{},Y=y.attributes[E]||{},ct=y.elements[E];lr(ct)&&er(ct)&&(Object.assign(ct.style,Z),Object.keys(Y).forEach(function(vt){var Ot=Y[vt];!1===Ot?ct.removeAttribute(vt):ct.setAttribute(vt,!0===Ot?"":Ot)}))})},effect:function(O){var y=O.state,E={popper:{position:y.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(y.elements.popper.style,E.popper),y.styles=E,y.elements.arrow&&Object.assign(y.elements.arrow.style,E.arrow),function(){Object.keys(y.elements).forEach(function(Z){var Y=y.elements[Z],ct=y.attributes[Z]||{},vt=Object.keys(y.styles.hasOwnProperty(Z)?y.styles[Z]:E[Z]).reduce(function(Ot,Ct){return Ot[Ct]="",Ot},{});lr(Y)&&er(Y)&&(Object.assign(Y.style,vt),Object.keys(ct).forEach(function(Ot){Y.removeAttribute(Ot)}))})}},requires:["computeStyles"]};function B(O){return O.split("-")[0]}function F(O,y){var E=O.getBoundingClientRect();return{width:E.width/1,height:E.height/1,top:E.top/1,right:E.right/1,bottom:E.bottom/1,left:E.left/1,x:E.left/1,y:E.top/1}}function H(O){var y=F(O),E=O.offsetWidth,Z=O.offsetHeight;return Math.abs(y.width-E)<=1&&(E=y.width),Math.abs(y.height-Z)<=1&&(Z=y.height),{x:O.offsetLeft,y:O.offsetTop,width:E,height:Z}}function J(O,y){var E=y.getRootNode&&y.getRootNode();if(O.contains(y))return!0;if(E&&Yi(E)){var Z=y;do{if(Z&&O.isSameNode(Z))return!0;Z=Z.parentNode||Z.host}while(Z)}return!1}function ot(O){return sr(O).getComputedStyle(O)}function ut(O){return["table","td","th"].indexOf(er(O))>=0}function N(O){return((ko(O)?O.ownerDocument:O.document)||window.document).documentElement}function et(O){return"html"===er(O)?O:O.assignedSlot||O.parentNode||(Yi(O)?O.host:null)||N(O)}function mt(O){return lr(O)&&"fixed"!==ot(O).position?O.offsetParent:null}function Dt(O){for(var y=sr(O),E=mt(O);E&&ut(E)&&"static"===ot(E).position;)E=mt(E);return E&&("html"===er(E)||"body"===er(E)&&"static"===ot(E).position)?y:E||function(Z){var Y=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&lr(Z)&&"fixed"===ot(Z).position)return null;for(var ct=et(Z);lr(ct)&&["html","body"].indexOf(er(ct))<0;){var vt=ot(ct);if("none"!==vt.transform||"none"!==vt.perspective||"paint"===vt.contain||-1!==["transform","perspective"].indexOf(vt.willChange)||Y&&"filter"===vt.willChange||Y&&vt.filter&&"none"!==vt.filter)return ct;ct=ct.parentNode}return null}(O)||y}function Nt(O){return["top","bottom"].indexOf(O)>=0?"x":"y"}var bt=Math.max,Bt=Math.min,jt=Math.round;function Gt(O,y,E){return bt(O,Bt(y,E))}function St(O){return Object.assign({},{top:0,right:0,bottom:0,left:0},O)}function ie(O,y){return y.reduce(function(E,Z){return E[Z]=O,E},{})}const Kt={name:"arrow",enabled:!0,phase:"main",fn:function(O){var y,li,$i,E=O.state,Z=O.name,Y=O.options,ct=E.elements.arrow,vt=E.modifiersData.popperOffsets,Ot=B(E.placement),Ct=Nt(Ot),Ht=[wi,di].indexOf(Ot)>=0?"height":"width";if(ct&&vt){var ce=($i=E,St("number"!=typeof(li="function"==typeof(li=Y.padding)?li(Object.assign({},$i.rects,{placement:$i.placement})):li)?li:ie(li,to))),ne=H(ct),ii="y"===Ct?En:wi,Ue="y"===Ct?Zi:di,Ze=E.rects.reference[Ht]+E.rects.reference[Ct]-vt[Ct]-E.rects.popper[Ht],ni=vt[Ct]-E.rects.reference[Ct],qe=Dt(ct),ji=qe?"y"===Ct?qe.clientHeight||0:qe.clientWidth||0:0,zi=ji/2-ne[Ht]/2+(Ze/2-ni/2),De=Gt(ce[ii],zi,ji-ne[Ht]-ce[Ue]);E.modifiersData[Z]=((y={})[Ct]=De,y.centerOffset=De-zi,y)}},effect:function(O){var y=O.state,E=O.options.element,Z=void 0===E?"[data-popper-arrow]":E;null!=Z&&("string"!=typeof Z||(Z=y.elements.popper.querySelector(Z)))&&J(y.elements.popper,Z)&&(y.elements.arrow=Z)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Jt(O){return O.split("-")[1]}var re={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Vt(O){var y,Xn,pn,Pn,E=O.popper,Z=O.popperRect,Y=O.placement,ct=O.variation,vt=O.offsets,Ot=O.position,Ct=O.gpuAcceleration,Ht=O.adaptive,ce=O.roundOffsets,ne=!0===ce?(pn=(Xn=vt).y,Pn=window.devicePixelRatio||1,{x:jt(jt(Xn.x*Pn)/Pn)||0,y:jt(jt(pn*Pn)/Pn)||0}):"function"==typeof ce?ce(vt):vt,ii=ne.x,Ue=void 0===ii?0:ii,Ze=ne.y,ni=void 0===Ze?0:Ze,qe=vt.hasOwnProperty("x"),ji=vt.hasOwnProperty("y"),ci=wi,Ie=En,Si=window;if(Ht){var zi=Dt(E),De="clientHeight",qt="clientWidth";zi===sr(E)&&"static"!==ot(zi=N(E)).position&&"absolute"===Ot&&(De="scrollHeight",qt="scrollWidth"),Y!==En&&(Y!==wi&&Y!==di||ct!==S)||(Ie=Zi,ni-=zi[De]-Z.height,ni*=Ct?1:-1),Y!==wi&&(Y!==En&&Y!==Zi||ct!==S)||(ci=di,Ue-=zi[qt]-Z.width,Ue*=Ct?1:-1)}var li,$i=Object.assign({position:Ot},Ht&&re);return Object.assign({},$i,Ct?((li={})[Ie]=ji?"0":"",li[ci]=qe?"0":"",li.transform=(Si.devicePixelRatio||1)<=1?"translate("+Ue+"px, "+ni+"px)":"translate3d("+Ue+"px, "+ni+"px, 0)",li):((y={})[Ie]=ji?ni+"px":"",y[ci]=qe?Ue+"px":"",y.transform="",y))}const Ke={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(O){var y=O.state,E=O.options,Z=E.gpuAcceleration,Y=void 0===Z||Z,ct=E.adaptive,vt=void 0===ct||ct,Ot=E.roundOffsets,Ct=void 0===Ot||Ot,Ht={placement:B(y.placement),variation:Jt(y.placement),popper:y.elements.popper,popperRect:y.rects.popper,gpuAcceleration:Y};null!=y.modifiersData.popperOffsets&&(y.styles.popper=Object.assign({},y.styles.popper,Vt(Object.assign({},Ht,{offsets:y.modifiersData.popperOffsets,position:y.options.strategy,adaptive:vt,roundOffsets:Ct})))),null!=y.modifiersData.arrow&&(y.styles.arrow=Object.assign({},y.styles.arrow,Vt(Object.assign({},Ht,{offsets:y.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:Ct})))),y.attributes.popper=Object.assign({},y.attributes.popper,{"data-popper-placement":y.placement})},data:{}};var fi={passive:!0};const Ae={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(O){var y=O.state,E=O.instance,Z=O.options,Y=Z.scroll,ct=void 0===Y||Y,vt=Z.resize,Ot=void 0===vt||vt,Ct=sr(y.elements.popper),Ht=[].concat(y.scrollParents.reference,y.scrollParents.popper);return ct&&Ht.forEach(function(ce){ce.addEventListener("scroll",E.update,fi)}),Ot&&Ct.addEventListener("resize",E.update,fi),function(){ct&&Ht.forEach(function(ce){ce.removeEventListener("scroll",E.update,fi)}),Ot&&Ct.removeEventListener("resize",E.update,fi)}},data:{}};var hi={left:"right",right:"left",bottom:"top",top:"bottom"};function Ne(O){return O.replace(/left|right|bottom|top/g,function(y){return hi[y]})}var Ti={start:"end",end:"start"};function ei(O){return O.replace(/start|end/g,function(y){return Ti[y]})}function Xi(O){var y=sr(O);return{scrollLeft:y.pageXOffset,scrollTop:y.pageYOffset}}function yi(O){return F(N(O)).left+Xi(O).scrollLeft}function He(O){var y=ot(O);return/auto|scroll|overlay|hidden/.test(y.overflow+y.overflowY+y.overflowX)}function si(O){return["html","body","#document"].indexOf(er(O))>=0?O.ownerDocument.body:lr(O)&&He(O)?O:si(et(O))}function Mn(O,y){var E;void 0===y&&(y=[]);var Z=si(O),Y=Z===(null==(E=O.ownerDocument)?void 0:E.body),ct=sr(Z),vt=Y?[ct].concat(ct.visualViewport||[],He(Z)?Z:[]):Z,Ot=y.concat(vt);return Y?Ot:Ot.concat(Mn(et(vt)))}function Ho(O){return Object.assign({},O,{left:O.x,top:O.y,right:O.x+O.width,bottom:O.y+O.height})}function Dn(O,y){return y===W?Ho((Z=sr(E=O),vt=(Y=N(E)).clientWidth,Ot=Y.clientHeight,Ct=0,Ht=0,(ct=Z.visualViewport)&&(vt=ct.width,Ot=ct.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(Ct=ct.offsetLeft,Ht=ct.offsetTop)),{width:vt,height:Ot,x:Ct+yi(E),y:Ht})):lr(y)?function(E){var Z=F(E);return Z.top=Z.top+E.clientTop,Z.left=Z.left+E.clientLeft,Z.bottom=Z.top+E.clientHeight,Z.right=Z.left+E.clientWidth,Z.width=E.clientWidth,Z.height=E.clientHeight,Z.x=Z.left,Z.y=Z.top,Z}(y):Ho(function(E){var Z,Y=N(E),ct=Xi(E),vt=null==(Z=E.ownerDocument)?void 0:Z.body,Ot=bt(Y.scrollWidth,Y.clientWidth,vt?vt.scrollWidth:0,vt?vt.clientWidth:0),Ct=bt(Y.scrollHeight,Y.clientHeight,vt?vt.scrollHeight:0,vt?vt.clientHeight:0),Ht=-ct.scrollLeft+yi(E),ce=-ct.scrollTop;return"rtl"===ot(vt||Y).direction&&(Ht+=bt(Y.clientWidth,vt?vt.clientWidth:0)-Ot),{width:Ot,height:Ct,x:Ht,y:ce}}(N(O)));var E,Z,Y,ct,vt,Ot,Ct,Ht}function Oe(O){var y,E=O.reference,Z=O.element,Y=O.placement,ct=Y?B(Y):null,vt=Y?Jt(Y):null,Ot=E.x+E.width/2-Z.width/2,Ct=E.y+E.height/2-Z.height/2;switch(ct){case En:y={x:Ot,y:E.y-Z.height};break;case Zi:y={x:Ot,y:E.y+E.height};break;case di:y={x:E.x+E.width,y:Ct};break;case wi:y={x:E.x-Z.width,y:Ct};break;default:y={x:E.x,y:E.y}}var Ht=ct?Nt(ct):null;if(null!=Ht){var ce="y"===Ht?"height":"width";switch(vt){case x:y[Ht]=y[Ht]-(E[ce]/2-Z[ce]/2);break;case S:y[Ht]=y[Ht]+(E[ce]/2-Z[ce]/2)}}return y}function ir(O,y){void 0===y&&(y={});var cn,pn,Pn,Ui,nr,Br,$t,ea,Tr,Z=y.placement,Y=void 0===Z?O.placement:Z,ct=y.boundary,vt=void 0===ct?D:ct,Ot=y.rootBoundary,Ct=void 0===Ot?W:Ot,Ht=y.elementContext,ce=void 0===Ht?it:Ht,ne=y.altBoundary,ii=void 0!==ne&&ne,Ue=y.padding,Ze=void 0===Ue?0:Ue,ni=St("number"!=typeof Ze?Ze:ie(Ze,to)),ji=O.rects.popper,ci=O.elements[ii?ce===it?pt:it:ce],Ie=(cn=ko(ci)?ci:ci.contextElement||N(O.elements.popper),Pn=Ct,$t="clippingParents"===(pn=vt)?(nr=Mn(et(Ui=cn)),ko(Br=["absolute","fixed"].indexOf(ot(Ui).position)>=0&&lr(Ui)?Dt(Ui):Ui)?nr.filter(function(Sr){return ko(Sr)&&J(Sr,Br)&&"body"!==er(Sr)}):[]):[].concat(pn),Tr=(ea=[].concat($t,[Pn])).reduce(function(Ui,nr){var Br=Dn(cn,nr);return Ui.top=bt(Br.top,Ui.top),Ui.right=Bt(Br.right,Ui.right),Ui.bottom=Bt(Br.bottom,Ui.bottom),Ui.left=bt(Br.left,Ui.left),Ui},Dn(cn,ea[0])),Tr.width=Tr.right-Tr.left,Tr.height=Tr.bottom-Tr.top,Tr.x=Tr.left,Tr.y=Tr.top,Tr),Si=F(O.elements.reference),zi=Oe({reference:Si,element:ji,strategy:"absolute",placement:Y}),De=Ho(Object.assign({},ji,zi)),qt=ce===it?De:Si,li={top:Ie.top-qt.top+ni.top,bottom:qt.bottom-Ie.bottom+ni.bottom,left:Ie.left-qt.left+ni.left,right:qt.right-Ie.right+ni.right},$i=O.modifiersData.offset;if(ce===it&&$i){var Xn=$i[Y];Object.keys(li).forEach(function(cn){var pn=[di,Zi].indexOf(cn)>=0?1:-1,Pn=[En,Zi].indexOf(cn)>=0?"y":"x";li[cn]+=Xn[Pn]*pn})}return li}const nn={name:"flip",enabled:!0,phase:"main",fn:function(O){var y=O.state,E=O.options,Z=O.name;if(!y.modifiersData[Z]._skip){for(var Y=E.mainAxis,ct=void 0===Y||Y,vt=E.altAxis,Ot=void 0===vt||vt,Ct=E.fallbackPlacements,Ht=E.padding,ce=E.boundary,ne=E.rootBoundary,ii=E.altBoundary,Ue=E.flipVariations,Ze=void 0===Ue||Ue,ni=E.allowedAutoPlacements,qe=y.options.placement,ji=B(qe),ci=Ct||(ji!==qe&&Ze?function(Sr){if(B(Sr)===Qr)return[];var dn=Ne(Sr);return[ei(Sr),dn,ei(dn)]}(qe):[Ne(qe)]),Ie=[qe].concat(ci).reduce(function(Sr,dn){return Sr.concat(B(dn)===Qr?function en(O,y){void 0===y&&(y={});var Y=y.boundary,ct=y.rootBoundary,vt=y.padding,Ot=y.flipVariations,Ct=y.allowedAutoPlacements,Ht=void 0===Ct?Qt:Ct,ce=Jt(y.placement),ne=ce?Ot?At:At.filter(function(Ze){return Jt(Ze)===ce}):to,ii=ne.filter(function(Ze){return Ht.indexOf(Ze)>=0});0===ii.length&&(ii=ne);var Ue=ii.reduce(function(Ze,ni){return Ze[ni]=ir(O,{placement:ni,boundary:Y,rootBoundary:ct,padding:vt})[B(ni)],Ze},{});return Object.keys(Ue).sort(function(Ze,ni){return Ue[Ze]-Ue[ni]})}(y,{placement:dn,boundary:ce,rootBoundary:ne,padding:Ht,flipVariations:Ze,allowedAutoPlacements:ni}):dn)},[]),Si=y.rects.reference,zi=y.rects.popper,De=new Map,qt=!0,li=Ie[0],$i=0;$i<Ie.length;$i++){var Xn=Ie[$i],cn=B(Xn),pn=Jt(Xn)===x,Pn=[En,Zi].indexOf(cn)>=0,$t=Pn?"width":"height",ea=ir(y,{placement:Xn,boundary:ce,rootBoundary:ne,altBoundary:ii,padding:Ht}),Fo=Pn?pn?di:wi:pn?Zi:En;Si[$t]>zi[$t]&&(Fo=Ne(Fo));var Tr=Ne(Fo),Ui=[];if(ct&&Ui.push(ea[cn]<=0),Ot&&Ui.push(ea[Fo]<=0,ea[Tr]<=0),Ui.every(function(Sr){return Sr})){li=Xn,qt=!1;break}De.set(Xn,Ui)}if(qt)for(var nr=function(Sr){var dn=Ie.find(function(Uo){var hs=De.get(Uo);if(hs)return hs.slice(0,Sr).every(function(_a){return _a})});if(dn)return li=dn,"break"},Br=Ze?3:1;Br>0&&"break"!==nr(Br);Br--);y.placement!==li&&(y.modifiersData[Z]._skip=!0,y.placement=li,y.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function sa(O,y,E){return void 0===E&&(E={x:0,y:0}),{top:O.top-y.height-E.y,right:O.right-y.width+E.x,bottom:O.bottom-y.height+E.y,left:O.left-y.width-E.x}}function Bn(O){return[En,di,Zi,wi].some(function(y){return O[y]>=0})}const wn={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(O){var y=O.state,E=O.name,Z=y.rects.reference,Y=y.rects.popper,ct=y.modifiersData.preventOverflow,vt=ir(y,{elementContext:"reference"}),Ot=ir(y,{altBoundary:!0}),Ct=sa(vt,Z),Ht=sa(Ot,Y,ct),ce=Bn(Ct),ne=Bn(Ht);y.modifiersData[E]={referenceClippingOffsets:Ct,popperEscapeOffsets:Ht,isReferenceHidden:ce,hasPopperEscaped:ne},y.attributes.popper=Object.assign({},y.attributes.popper,{"data-popper-reference-hidden":ce,"data-popper-escaped":ne})}},Wn={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(O){var y=O.state,Z=O.name,Y=O.options.offset,ct=void 0===Y?[0,0]:Y,vt=Qt.reduce(function(ce,ne){return ce[ne]=(Ue=y.rects,Ze=ct,ni=B(ii=ne),qe=[wi,En].indexOf(ni)>=0?-1:1,ci=(ci=(ji="function"==typeof Ze?Ze(Object.assign({},Ue,{placement:ii})):Ze)[0])||0,Ie=((Ie=ji[1])||0)*qe,[wi,di].indexOf(ni)>=0?{x:Ie,y:ci}:{x:ci,y:Ie}),ce;var ii,Ue,Ze,ni,qe,ji,ci,Ie},{}),Ot=vt[y.placement],Ht=Ot.y;null!=y.modifiersData.popperOffsets&&(y.modifiersData.popperOffsets.x+=Ot.x,y.modifiersData.popperOffsets.y+=Ht),y.modifiersData[Z]=vt}},Fi={name:"popperOffsets",enabled:!0,phase:"read",fn:function(O){var y=O.state;y.modifiersData[O.name]=Oe({reference:y.rects.reference,element:y.rects.popper,strategy:"absolute",placement:y.placement})},data:{}},yr={name:"preventOverflow",enabled:!0,phase:"main",fn:function(O){var y=O.state,E=O.options,Z=O.name,Y=E.mainAxis,ct=void 0===Y||Y,vt=E.altAxis,Ot=void 0!==vt&&vt,ii=E.tether,Ue=void 0===ii||ii,Ze=E.tetherOffset,ni=void 0===Ze?0:Ze,qe=ir(y,{boundary:E.boundary,rootBoundary:E.rootBoundary,padding:E.padding,altBoundary:E.altBoundary}),ji=B(y.placement),ci=Jt(y.placement),Ie=!ci,Si=Nt(ji),zi="x"===Si?"y":"x",De=y.modifiersData.popperOffsets,qt=y.rects.reference,li=y.rects.popper,$i="function"==typeof ni?ni(Object.assign({},y.rects,{placement:y.placement})):ni,Xn={x:0,y:0};if(De){if(ct||Ot){var cn="y"===Si?En:wi,pn="y"===Si?Zi:di,Pn="y"===Si?"height":"width",$t=De[Si],ea=De[Si]+qe[cn],Fo=De[Si]-qe[pn],Tr=Ue?-li[Pn]/2:0,Ui=ci===x?qt[Pn]:li[Pn],nr=ci===x?-li[Pn]:-qt[Pn],Br=y.elements.arrow,Sr=Ue&&Br?H(Br):{width:0,height:0},dn=y.modifiersData["arrow#persistent"]?y.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Uo=dn[cn],hs=dn[pn],_a=Gt(0,qt[Pn],Sr[Pn]),il=Ie?qt[Pn]/2-Tr-_a-Uo-$i:Ui-_a-Uo-$i,nl=Ie?-qt[Pn]/2+Tr+_a+hs+$i:nr+_a+hs+$i,No=y.elements.arrow&&Dt(y.elements.arrow),ri=y.modifiersData.offset?y.modifiersData.offset[y.placement][Si]:0,ia=De[Si]+il-ri-(No?"y"===Si?No.clientTop||0:No.clientLeft||0:0),jo=De[Si]+nl-ri;if(ct){var hr=Gt(Ue?Bt(ea,ia):ea,$t,Ue?bt(Fo,jo):Fo);De[Si]=hr,Xn[Si]=hr-$t}if(Ot){var go=De[zi],Or=go+qe["x"===Si?En:wi],cs=go-qe["x"===Si?Zi:di],ye=Gt(Ue?Bt(Or,ia):Or,go,Ue?bt(cs,jo):cs);De[zi]=ye,Xn[zi]=ye-go}}y.modifiersData[Z]=Xn}},requiresIfExists:["offset"]};function an(O,y,E){void 0===E&&(E=!1);var Z=lr(y);lr(y)&&y.getBoundingClientRect();var Y,ct,vt=N(y),Ot=F(O),Ct={scrollLeft:0,scrollTop:0},Ht={x:0,y:0};return(Z||!Z&&!E)&&(("body"!==er(y)||He(vt))&&(Ct=(Y=y)!==sr(Y)&&lr(Y)?{scrollLeft:(ct=Y).scrollLeft,scrollTop:ct.scrollTop}:Xi(Y)),lr(y)?((Ht=F(y)).x+=y.clientLeft,Ht.y+=y.clientTop):vt&&(Ht.x=yi(vt))),{x:Ot.left+Ct.scrollLeft-Ht.x,y:Ot.top+Ct.scrollTop-Ht.y,width:Ot.width,height:Ot.height}}function Mo(O){var y=new Map,E=new Set,Z=[];function Y(ct){E.add(ct.name),[].concat(ct.requires||[],ct.requiresIfExists||[]).forEach(function(vt){if(!E.has(vt)){var Ot=y.get(vt);Ot&&Y(Ot)}}),Z.push(ct)}return O.forEach(function(ct){y.set(ct.name,ct)}),O.forEach(function(ct){E.has(ct.name)||Y(ct)}),Z}var qr={placement:"bottom",modifiers:[],strategy:"absolute"};function Vs(){for(var O=arguments.length,y=new Array(O),E=0;E<O;E++)y[E]=arguments[E];return!y.some(function(Z){return!(Z&&"function"==typeof Z.getBoundingClientRect)})}function io(O){void 0===O&&(O={});var E=O.defaultModifiers,Z=void 0===E?[]:E,Y=O.defaultOptions,ct=void 0===Y?qr:Y;return function(vt,Ot,Ct){void 0===Ct&&(Ct=ct);var Ht,ce,ne={placement:"bottom",orderedModifiers:[],options:Object.assign({},qr,ct),modifiersData:{},elements:{reference:vt,popper:Ot},attributes:{},styles:{}},ii=[],Ue=!1,Ze={state:ne,setOptions:function(qe){var ji="function"==typeof qe?qe(ne.options):qe;ni(),ne.options=Object.assign({},ct,ne.options,ji),ne.scrollParents={reference:ko(vt)?Mn(vt):vt.contextElement?Mn(vt.contextElement):[],popper:Mn(Ot)};var ci,Ie,zi,De,Si=(ci=[].concat(Z,ne.options.modifiers),Ie=ci.reduce(function(zi,De){var qt=zi[De.name];return zi[De.name]=qt?Object.assign({},qt,De,{options:Object.assign({},qt.options,De.options),data:Object.assign({},qt.data,De.data)}):De,zi},{}),zi=Object.keys(Ie).map(function(zi){return Ie[zi]}),De=Mo(zi),eo.reduce(function(qt,li){return qt.concat(De.filter(function($i){return $i.phase===li}))},[]));return ne.orderedModifiers=Si.filter(function(zi){return zi.enabled}),ne.orderedModifiers.forEach(function(zi){var qt=zi.options,$i=zi.effect;if("function"==typeof $i){var Xn=$i({state:ne,name:zi.name,instance:Ze,options:void 0===qt?{}:qt});ii.push(Xn||function(){})}}),Ze.update()},forceUpdate:function(){if(!Ue){var qe=ne.elements,ji=qe.reference,ci=qe.popper;if(Vs(ji,ci)){ne.rects={reference:an(ji,Dt(ci),"fixed"===ne.options.strategy),popper:H(ci)},ne.reset=!1,ne.placement=ne.options.placement,ne.orderedModifiers.forEach(function($i){return ne.modifiersData[$i.name]=Object.assign({},$i.data)});for(var Ie=0;Ie<ne.orderedModifiers.length;Ie++)if(!0!==ne.reset){var Si=ne.orderedModifiers[Ie],zi=Si.fn,De=Si.options;"function"==typeof zi&&(ne=zi({state:ne,options:void 0===De?{}:De,name:Si.name,instance:Ze})||ne)}else ne.reset=!1,Ie=-1}}},update:(Ht=function(){return new Promise(function(qe){Ze.forceUpdate(),qe(ne)})},function(){return ce||(ce=new Promise(function(qe){Promise.resolve().then(function(){ce=void 0,qe(Ht())})})),ce}),destroy:function(){ni(),Ue=!0}};if(!Vs(vt,Ot))return Ze;function ni(){ii.forEach(function(qe){return qe()}),ii=[]}return Ze.setOptions(Ct).then(function(qe){!Ue&&Ct.onFirstUpdate&&Ct.onFirstUpdate(qe)}),Ze}}var On=io(),mo=io({defaultModifiers:[Ae,Fi,Ke,z]}),Rn=io({defaultModifiers:[Ae,Fi,Ke,z,Wn,nn,yr,Kt,wn]});const So=Object.freeze({__proto__:null,popperGenerator:io,detectOverflow:ir,createPopperBase:On,createPopper:Rn,createPopperLite:mo,top:En,bottom:Zi,right:di,left:wi,auto:Qr,basePlacements:to,start:x,end:S,clippingParents:D,viewport:W,popper:it,reference:pt,variationPlacements:At,placements:Qt,beforeRead:he,read:"read",afterRead:ui,beforeMain:bn,main:"main",afterMain:qn,beforeWrite:Gn,write:"write",afterWrite:ar,modifierPhases:eo,applyStyles:z,arrow:Kt,computeStyles:Ke,eventListeners:Ae,flip:nn,hide:wn,offset:Wn,popperOffsets:Fi,preventOverflow:yr}),Ss="dropdown",is="Escape",Aa="ArrowUp",Gr="ArrowDown",Zs=new RegExp("ArrowUp|ArrowDown|Escape"),Na="click.bs.dropdown.data-api",ns="keydown.bs.dropdown.data-api",no="show",gr='[data-bs-toggle="dropdown"]',la=".dropdown-menu",qs=yn()?"top-end":"top-start",ja=yn()?"top-start":"top-end",ro=yn()?"bottom-end":"bottom-start",Do=yn()?"bottom-start":"bottom-end",Wr=yn()?"left-start":"right-start",ua=yn()?"right-start":"left-start",Xo={offset:[0,2],boundary:"clippingParents",reference:"toggle",display:"dynamic",popperConfig:null,autoClose:!0},Ko={offset:"(array|string|function)",boundary:"(string|element)",reference:"(string|element|object)",display:"string",popperConfig:"(null|object|function)",autoClose:"(boolean|string)"};class Hn extends We{constructor(y,E){super(y),this._popper=null,this._config=this._getConfig(E),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar()}static get Default(){return Xo}static get DefaultType(){return Ko}static get NAME(){return Ss}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Gi(this._element)||this._isShown(this._menu))return;const y={relatedTarget:this._element};if(Ut.trigger(this._element,"show.bs.dropdown",y).defaultPrevented)return;const E=Hn.getParentFromElement(this._element);this._inNavbar?Ye.setDataAttribute(this._menu,"popper","none"):this._createPopper(E),"ontouchstart"in document.documentElement&&!E.closest(".navbar-nav")&&[].concat(...document.body.children).forEach(Z=>Ut.on(Z,"mouseover",oa)),this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(no),this._element.classList.add(no),Ut.trigger(this._element,"shown.bs.dropdown",y)}hide(){!Gi(this._element)&&this._isShown(this._menu)&&this._completeHide({relatedTarget:this._element})}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(y){Ut.trigger(this._element,"hide.bs.dropdown",y).defaultPrevented||("ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(E=>Ut.off(E,"mouseover",oa)),this._popper&&this._popper.destroy(),this._menu.classList.remove(no),this._element.classList.remove(no),this._element.setAttribute("aria-expanded","false"),Ye.removeDataAttribute(this._menu,"popper"),Ut.trigger(this._element,"hidden.bs.dropdown",y))}_getConfig(y){if(y={...this.constructor.Default,...Ye.getDataAttributes(this._element),...y},Jr(Ss,y,this.constructor.DefaultType),"object"==typeof y.reference&&!Lr(y.reference)&&"function"!=typeof y.reference.getBoundingClientRect)throw new TypeError(`${Ss.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return y}_createPopper(y){if(void 0===So)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let E=this._element;"parent"===this._config.reference?E=y:Lr(this._config.reference)?E=ai(this._config.reference):"object"==typeof this._config.reference&&(E=this._config.reference);const Z=this._getPopperConfig(),Y=Z.modifiers.find(ct=>"applyStyles"===ct.name&&!1===ct.enabled);this._popper=Rn(E,this._menu,Z),Y&&Ye.setDataAttribute(this._menu,"popper","static")}_isShown(y=this._element){return y.classList.contains(no)}_getMenuElement(){return _e.next(this._element,la)[0]}_getPlacement(){const y=this._element.parentNode;if(y.classList.contains("dropend"))return Wr;if(y.classList.contains("dropstart"))return ua;const E="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return y.classList.contains("dropup")?E?ja:qs:E?Do:ro}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:y}=this._config;return"string"==typeof y?y.split(",").map(E=>Number.parseInt(E,10)):"function"==typeof y?E=>y(E,this._element):y}_getPopperConfig(){const y={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return"static"===this._config.display&&(y.modifiers=[{name:"applyStyles",enabled:!1}]),{...y,..."function"==typeof this._config.popperConfig?this._config.popperConfig(y):this._config.popperConfig}}_selectMenuItem({key:y,target:E}){const Z=_e.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(co);Z.length&&Te(Z,E,y===Gr,!Z.includes(E)).focus()}static jQueryInterface(y){return this.each(function(){const E=Hn.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===E[y])throw new TypeError(`No method named "${y}"`);E[y]()}})}static clearMenus(y){if(y&&(2===y.button||"keyup"===y.type&&"Tab"!==y.key))return;const E=_e.find(gr);for(let Z=0,Y=E.length;Z<Y;Z++){const ct=Hn.getInstance(E[Z]);if(!ct||!1===ct._config.autoClose||!ct._isShown())continue;const vt={relatedTarget:ct._element};if(y){const Ot=y.composedPath(),Ct=Ot.includes(ct._menu);if(Ot.includes(ct._element)||"inside"===ct._config.autoClose&&!Ct||"outside"===ct._config.autoClose&&Ct||ct._menu.contains(y.target)&&("keyup"===y.type&&"Tab"===y.key||/input|select|option|textarea|form/i.test(y.target.tagName)))continue;"click"===y.type&&(vt.clickEvent=y)}ct._completeHide(vt)}}static getParentFromElement(y){return ho(y)||y.parentNode}static dataApiKeydownHandler(y){if(/input|textarea/i.test(y.target.tagName)?"Space"===y.key||y.key!==is&&(y.key!==Gr&&y.key!==Aa||y.target.closest(la)):!Zs.test(y.key))return;const E=this.classList.contains(no);if(!E&&y.key===is||(y.preventDefault(),y.stopPropagation(),Gi(this)))return;const Z=this.matches(gr)?this:_e.prev(this,gr)[0],Y=Hn.getOrCreateInstance(Z);if(y.key!==is)return y.key===Aa||y.key===Gr?(E||Y.show(),void Y._selectMenuItem(y)):void(E&&"Space"!==y.key||Hn.clearMenus());Y.hide()}}Ut.on(document,ns,gr,Hn.dataApiKeydownHandler),Ut.on(document,ns,la,Hn.dataApiKeydownHandler),Ut.on(document,Na,Hn.clearMenus),Ut.on(document,"keyup.bs.dropdown.data-api",Hn.clearMenus),Ut.on(document,Na,gr,function(O){O.preventDefault(),Hn.getOrCreateInstance(this).toggle()}),Ft(Hn);const In=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Ki=".sticky-top";class vr{constructor(){this._element=document.body}getWidth(){const y=document.documentElement.clientWidth;return Math.abs(window.innerWidth-y)}hide(){const y=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,"paddingRight",E=>E+y),this._setElementAttributes(In,"paddingRight",E=>E+y),this._setElementAttributes(Ki,"marginRight",E=>E-y)}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(y,E,Z){const Y=this.getWidth();this._applyManipulationCallback(y,ct=>{if(ct!==this._element&&window.innerWidth>ct.clientWidth+Y)return;this._saveInitialAttribute(ct,E);const vt=window.getComputedStyle(ct)[E];ct.style[E]=`${Z(Number.parseFloat(vt))}px`})}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,"paddingRight"),this._resetElementAttributes(In,"paddingRight"),this._resetElementAttributes(Ki,"marginRight")}_saveInitialAttribute(y,E){const Z=y.style[E];Z&&Ye.setDataAttribute(y,E,Z)}_resetElementAttributes(y,E){this._applyManipulationCallback(y,Z=>{const Y=Ye.getDataAttribute(Z,E);void 0===Y?Z.style.removeProperty(E):(Ye.removeDataAttribute(Z,E),Z.style[E]=Y)})}_applyManipulationCallback(y,E){Lr(y)?E(y):_e.find(y,this._element).forEach(E)}isOverflowing(){return this.getWidth()>0}}const Es={className:"modal-backdrop",isVisible:!0,isAnimated:!1,rootElement:"body",clickCallback:null},el={className:"string",isVisible:"boolean",isAnimated:"boolean",rootElement:"(element|string)",clickCallback:"(function|null)"},Va="mousedown.bs.backdrop";class rs{constructor(y){this._config=this._getConfig(y),this._isAppended=!1,this._element=null}show(y){this._config.isVisible?(this._append(),this._config.isAnimated&&this._getElement(),this._getElement().classList.add("show"),this._emulateAnimation(()=>{ee(y)})):ee(y)}hide(y){this._config.isVisible?(this._getElement().classList.remove("show"),this._emulateAnimation(()=>{this.dispose(),ee(y)})):ee(y)}_getElement(){if(!this._element){const y=document.createElement("div");y.className=this._config.className,this._config.isAnimated&&y.classList.add("fade"),this._element=y}return this._element}_getConfig(y){return(y={...Es,..."object"==typeof y?y:{}}).rootElement=ai(y.rootElement),Jr("backdrop",y,el),y}_append(){this._isAppended||(this._config.rootElement.append(this._getElement()),Ut.on(this._getElement(),Va,()=>{ee(this._config.clickCallback)}),this._isAppended=!0)}dispose(){this._isAppended&&(Ut.off(this._element,Va),this._element.remove(),this._isAppended=!1)}_emulateAnimation(y){Fe(y,this._getElement(),this._config.isAnimated)}}const Za={trapElement:null,autofocus:!0},qa={trapElement:"element",autofocus:"boolean"},Ps=".bs.focustrap",As="backward";class Cs{constructor(y){this._config=this._getConfig(y),this._isActive=!1,this._lastTabNavDirection=null}activate(){const{trapElement:y,autofocus:E}=this._config;this._isActive||(E&&y.focus(),Ut.off(document,Ps),Ut.on(document,"focusin.bs.focustrap",Z=>this._handleFocusin(Z)),Ut.on(document,"keydown.tab.bs.focustrap",Z=>this._handleKeydown(Z)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Ut.off(document,Ps))}_handleFocusin(y){const{target:E}=y,{trapElement:Z}=this._config;if(E===document||E===Z||Z.contains(E))return;const Y=_e.focusableChildren(Z);0===Y.length?Z.focus():this._lastTabNavDirection===As?Y[Y.length-1].focus():Y[0].focus()}_handleKeydown(y){"Tab"===y.key&&(this._lastTabNavDirection=y.shiftKey?As:"forward")}_getConfig(y){return y={...Za,..."object"==typeof y?y:{}},Jr("focustrap",y,qa),y}}const ha={backdrop:!0,keyboard:!0,focus:!0},hn={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean"},Jo="hidden.bs.modal",oo="show.bs.modal",Bo="resize.bs.modal",Eo="click.dismiss.bs.modal",kr="keydown.dismiss.bs.modal",_o="mousedown.dismiss.bs.modal",Oo="modal-open",Mr="modal-static";class wr extends We{constructor(y,E){super(y),this._config=this._getConfig(E),this._dialog=_e.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollBar=new vr}static get Default(){return ha}static get NAME(){return"modal"}toggle(y){return this._isShown?this.hide():this.show(y)}show(y){this._isShown||this._isTransitioning||Ut.trigger(this._element,oo,{relatedTarget:y}).defaultPrevented||(this._isShown=!0,this._isAnimated()&&(this._isTransitioning=!0),this._scrollBar.hide(),document.body.classList.add(Oo),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),Ut.on(this._dialog,_o,()=>{Ut.one(this._element,"mouseup.dismiss.bs.modal",E=>{E.target===this._element&&(this._ignoreBackdropClick=!0)})}),this._showBackdrop(()=>this._showElement(y)))}hide(){if(!this._isShown||this._isTransitioning||Ut.trigger(this._element,"hide.bs.modal").defaultPrevented)return;this._isShown=!1;const y=this._isAnimated();y&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),this._focustrap.deactivate(),this._element.classList.remove("show"),Ut.off(this._element,Eo),Ut.off(this._dialog,_o),this._queueCallback(()=>this._hideModal(),this._element,y)}dispose(){[window,this._dialog].forEach(y=>Ut.off(y,".bs.modal")),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new rs({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Cs({trapElement:this._element})}_getConfig(y){return y={...ha,...Ye.getDataAttributes(this._element),..."object"==typeof y?y:{}},Jr("modal",y,hn),y}_showElement(y){const E=this._isAnimated(),Z=_e.findOne(".modal-body",this._dialog);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0,Z&&(Z.scrollTop=0),this._element.classList.add("show"),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Ut.trigger(this._element,"shown.bs.modal",{relatedTarget:y})},this._dialog,E)}_setEscapeEvent(){this._isShown?Ut.on(this._element,kr,y=>{this._config.keyboard&&"Escape"===y.key?(y.preventDefault(),this.hide()):this._config.keyboard||"Escape"!==y.key||this._triggerBackdropTransition()}):Ut.off(this._element,kr)}_setResizeEvent(){this._isShown?Ut.on(window,Bo,()=>this._adjustDialog()):Ut.off(window,Bo)}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Oo),this._resetAdjustments(),this._scrollBar.reset(),Ut.trigger(this._element,Jo)})}_showBackdrop(y){Ut.on(this._element,Eo,E=>{this._ignoreBackdropClick?this._ignoreBackdropClick=!1:E.target===E.currentTarget&&(!0===this._config.backdrop?this.hide():"static"===this._config.backdrop&&this._triggerBackdropTransition())}),this._backdrop.show(y)}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(Ut.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const{classList:y,scrollHeight:E,style:Z}=this._element,Y=E>document.documentElement.clientHeight;!Y&&"hidden"===Z.overflowY||y.contains(Mr)||(Y||(Z.overflowY="hidden"),y.add(Mr),this._queueCallback(()=>{y.remove(Mr),Y||this._queueCallback(()=>{Z.overflowY=""},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const y=this._element.scrollHeight>document.documentElement.clientHeight,E=this._scrollBar.getWidth(),Z=E>0;(!Z&&y&&!yn()||Z&&!y&&yn())&&(this._element.style.paddingLeft=`${E}px`),(Z&&!y&&!yn()||!Z&&y&&yn())&&(this._element.style.paddingRight=`${E}px`)}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(y,E){return this.each(function(){const Z=wr.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===Z[y])throw new TypeError(`No method named "${y}"`);Z[y](E)}})}}Ut.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(O){const y=ho(this);["A","AREA"].includes(this.tagName)&&O.preventDefault(),Ut.one(y,oo,Z=>{Z.defaultPrevented||Ut.one(y,Jo,()=>{co(this)&&this.focus()})});const E=_e.findOne(".modal.show");E&&wr.getInstance(E).hide(),wr.getOrCreateInstance(y).toggle(this)}),bi(wr),Ft(wr);const Ga="offcanvas",Li={backdrop:!0,keyboard:!0,scroll:!1},Ls={backdrop:"boolean",keyboard:"boolean",scroll:"boolean"},Wa=".offcanvas.show",La="hidden.bs.offcanvas";class Hr extends We{constructor(y,E){super(y),this._config=this._getConfig(E),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get NAME(){return Ga}static get Default(){return Li}toggle(y){return this._isShown?this.hide():this.show(y)}show(y){this._isShown||Ut.trigger(this._element,"show.bs.offcanvas",{relatedTarget:y}).defaultPrevented||(this._isShown=!0,this._element.style.visibility="visible",this._backdrop.show(),this._config.scroll||(new vr).hide(),this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add("show"),this._queueCallback(()=>{this._config.scroll||this._focustrap.activate(),Ut.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:y})},this._element,!0))}hide(){this._isShown&&(Ut.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.remove("show"),this._backdrop.hide(),this._queueCallback(()=>{this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._element.style.visibility="hidden",this._config.scroll||(new vr).reset(),Ut.trigger(this._element,La)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_getConfig(y){return y={...Li,...Ye.getDataAttributes(this._element),..."object"==typeof y?y:{}},Jr(Ga,y,Ls),y}_initializeBackDrop(){return new rs({className:"offcanvas-backdrop",isVisible:this._config.backdrop,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:()=>this.hide()})}_initializeFocusTrap(){return new Cs({trapElement:this._element})}_addEventListeners(){Ut.on(this._element,"keydown.dismiss.bs.offcanvas",y=>{this._config.keyboard&&"Escape"===y.key&&this.hide()})}static jQueryInterface(y){return this.each(function(){const E=Hr.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===E[y]||y.startsWith("_")||"constructor"===y)throw new TypeError(`No method named "${y}"`);E[y](this)}})}}Ut.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(O){const y=ho(this);if(["A","AREA"].includes(this.tagName)&&O.preventDefault(),Gi(this))return;Ut.one(y,La,()=>{co(this)&&this.focus()});const E=_e.findOne(Wa);E&&E!==y&&Hr.getInstance(E).hide(),Hr.getOrCreateInstance(y).toggle(this)}),Ut.on(window,"load.bs.offcanvas.data-api",()=>_e.find(Wa).forEach(O=>Hr.getOrCreateInstance(O).show())),bi(Hr),Ft(Hr);const Ha=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Yo=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,$o=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,wa=(O,y)=>{const E=O.nodeName.toLowerCase();if(y.includes(E))return!Ha.has(E)||Boolean(Yo.test(O.nodeValue)||$o.test(O.nodeValue));const Z=y.filter(Y=>Y instanceof RegExp);for(let Y=0,ct=Z.length;Y<ct;Y++)if(Z[Y].test(E))return!0;return!1};function za(O,y,E){if(!O.length)return O;if(E&&"function"==typeof E)return E(O);const Z=(new window.DOMParser).parseFromString(O,"text/html"),Y=[].concat(...Z.body.querySelectorAll("*"));for(let ct=0,vt=Y.length;ct<vt;ct++){const Ot=Y[ct],Ct=Ot.nodeName.toLowerCase();if(!Object.keys(y).includes(Ct)){Ot.remove();continue}const Ht=[].concat(...Ot.attributes),ce=[].concat(y["*"]||[],y[Ct]||[]);Ht.forEach(ne=>{wa(ne,ce)||Ot.removeAttribute(ne.nodeName)})}return Z.body.innerHTML}const os="tooltip",as=new Set(["sanitize","allowList","sanitizeFn"]),Dr={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(array|string|function)",container:"(string|element|boolean)",fallbackPlacements:"array",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",allowList:"object",popperConfig:"(null|object|function)"},Ta={AUTO:"auto",TOP:"top",RIGHT:yn()?"left":"right",BOTTOM:"bottom",LEFT:yn()?"right":"left"},yo={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:[0,0],container:!1,fallbackPlacements:["top","right","bottom","left"],boundary:"clippingParents",customClass:"",sanitize:!0,sanitizeFn:null,allowList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},pa={HIDE:"hide.bs.tooltip",HIDDEN:"hidden.bs.tooltip",SHOW:"show.bs.tooltip",SHOWN:"shown.bs.tooltip",INSERTED:"inserted.bs.tooltip",CLICK:"click.bs.tooltip",FOCUSIN:"focusin.bs.tooltip",FOCUSOUT:"focusout.bs.tooltip",MOUSEENTER:"mouseenter.bs.tooltip",MOUSELEAVE:"mouseleave.bs.tooltip"},Qo="fade",Xr="show",Ai="show",Io=".tooltip-inner",ss="hide.bs.modal",fa="hover";class ao extends We{constructor(y,E){if(void 0===So)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(y),this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this._config=this._getConfig(E),this.tip=null,this._setListeners()}static get Default(){return yo}static get NAME(){return os}static get Event(){return pa}static get DefaultType(){return Dr}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(y){if(this._isEnabled)if(y){const E=this._initializeOnDelegatedTarget(y);E._activeTrigger.click=!E._activeTrigger.click,E._isWithActiveTrigger()?E._enter(null,E):E._leave(null,E)}else{if(this.getTipElement().classList.contains(Xr))return void this._leave(null,this);this._enter(null,this)}}dispose(){clearTimeout(this._timeout),Ut.off(this._element.closest(".modal"),ss,this._hideModalHandler),this.tip&&this.tip.remove(),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this.isWithContent()||!this._isEnabled)return;const y=Ut.trigger(this._element,this.constructor.Event.SHOW),E=Yr(this._element),Z=null===E?this._element.ownerDocument.documentElement.contains(this._element):E.contains(this._element);if(y.defaultPrevented||!Z)return;"tooltip"===this.constructor.NAME&&this.tip&&this.getTitle()!==this.tip.querySelector(Io).innerHTML&&(this._disposePopper(),this.tip.remove(),this.tip=null);const Y=this.getTipElement(),ct=(ne=>{do{ne+=Math.floor(1e6*Math.random())}while(document.getElementById(ne));return ne})(this.constructor.NAME);Y.setAttribute("id",ct),this._element.setAttribute("aria-describedby",ct),this._config.animation&&Y.classList.add(Qo);const vt="function"==typeof this._config.placement?this._config.placement.call(this,Y,this._element):this._config.placement,Ot=this._getAttachment(vt);this._addAttachmentClass(Ot);const{container:Ct}=this._config;Ci.set(Y,this.constructor.DATA_KEY,this),this._element.ownerDocument.documentElement.contains(this.tip)||(Ct.append(Y),Ut.trigger(this._element,this.constructor.Event.INSERTED)),this._popper?this._popper.update():this._popper=Rn(this._element,Y,this._getPopperConfig(Ot)),Y.classList.add(Xr);const Ht=this._resolvePossibleFunction(this._config.customClass);Ht&&Y.classList.add(...Ht.split(" ")),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(ne=>{Ut.on(ne,"mouseover",oa)});const ce=this.tip.classList.contains(Qo);this._queueCallback(()=>{const ne=this._hoverState;this._hoverState=null,Ut.trigger(this._element,this.constructor.Event.SHOWN),"out"===ne&&this._leave(null,this)},this.tip,ce)}hide(){if(!this._popper)return;const y=this.getTipElement();if(Ut.trigger(this._element,this.constructor.Event.HIDE).defaultPrevented)return;y.classList.remove(Xr),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(Z=>Ut.off(Z,"mouseover",oa)),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1;const E=this.tip.classList.contains(Qo);this._queueCallback(()=>{this._isWithActiveTrigger()||(this._hoverState!==Ai&&y.remove(),this._cleanTipClass(),this._element.removeAttribute("aria-describedby"),Ut.trigger(this._element,this.constructor.Event.HIDDEN),this._disposePopper())},this.tip,E),this._hoverState=""}update(){null!==this._popper&&this._popper.update()}isWithContent(){return Boolean(this.getTitle())}getTipElement(){if(this.tip)return this.tip;const y=document.createElement("div");y.innerHTML=this._config.template;const E=y.children[0];return this.setContent(E),E.classList.remove(Qo,Xr),this.tip=E,this.tip}setContent(y){this._sanitizeAndSetContent(y,this.getTitle(),Io)}_sanitizeAndSetContent(y,E,Z){const Y=_e.findOne(Z,y);E||!Y?this.setElementContent(Y,E):Y.remove()}setElementContent(y,E){if(null!==y)return Lr(E)?(E=ai(E),void(this._config.html?E.parentNode!==y&&(y.innerHTML="",y.append(E)):y.textContent=E.textContent)):void(this._config.html?(this._config.sanitize&&(E=za(E,this._config.allowList,this._config.sanitizeFn)),y.innerHTML=E):y.textContent=E)}getTitle(){const y=this._element.getAttribute("data-bs-original-title")||this._config.title;return this._resolvePossibleFunction(y)}updateAttachment(y){return"right"===y?"end":"left"===y?"start":y}_initializeOnDelegatedTarget(y,E){return E||this.constructor.getOrCreateInstance(y.delegateTarget,this._getDelegateConfig())}_getOffset(){const{offset:y}=this._config;return"string"==typeof y?y.split(",").map(E=>Number.parseInt(E,10)):"function"==typeof y?E=>y(E,this._element):y}_resolvePossibleFunction(y){return"function"==typeof y?y.call(this._element):y}_getPopperConfig(y){const E={placement:y,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"onChange",enabled:!0,phase:"afterWrite",fn:Z=>this._handlePopperPlacementChange(Z)}],onFirstUpdate:Z=>{Z.options.placement!==Z.placement&&this._handlePopperPlacementChange(Z)}};return{...E,..."function"==typeof this._config.popperConfig?this._config.popperConfig(E):this._config.popperConfig}}_addAttachmentClass(y){this.getTipElement().classList.add(`${this._getBasicClassPrefix()}-${this.updateAttachment(y)}`)}_getAttachment(y){return Ta[y.toUpperCase()]}_setListeners(){this._config.trigger.split(" ").forEach(y=>{if("click"===y)Ut.on(this._element,this.constructor.Event.CLICK,this._config.selector,E=>this.toggle(E));else if("manual"!==y){const Z=y===fa?this.constructor.Event.MOUSELEAVE:this.constructor.Event.FOCUSOUT;Ut.on(this._element,y===fa?this.constructor.Event.MOUSEENTER:this.constructor.Event.FOCUSIN,this._config.selector,Y=>this._enter(Y)),Ut.on(this._element,Z,this._config.selector,Y=>this._leave(Y))}}),this._hideModalHandler=()=>{this._element&&this.hide()},Ut.on(this._element.closest(".modal"),ss,this._hideModalHandler),this._config.selector?this._config={...this._config,trigger:"manual",selector:""}:this._fixTitle()}_fixTitle(){const y=this._element.getAttribute("title"),E=typeof this._element.getAttribute("data-bs-original-title");(y||"string"!==E)&&(this._element.setAttribute("data-bs-original-title",y||""),!y||this._element.getAttribute("aria-label")||this._element.textContent||this._element.setAttribute("aria-label",y),this._element.setAttribute("title",""))}_enter(y,E){E=this._initializeOnDelegatedTarget(y,E),y&&(E._activeTrigger["focusin"===y.type?"focus":fa]=!0),E.getTipElement().classList.contains(Xr)||E._hoverState===Ai?E._hoverState=Ai:(clearTimeout(E._timeout),E._hoverState=Ai,E._config.delay&&E._config.delay.show?E._timeout=setTimeout(()=>{E._hoverState===Ai&&E.show()},E._config.delay.show):E.show())}_leave(y,E){E=this._initializeOnDelegatedTarget(y,E),y&&(E._activeTrigger["focusout"===y.type?"focus":fa]=E._element.contains(y.relatedTarget)),E._isWithActiveTrigger()||(clearTimeout(E._timeout),E._hoverState="out",E._config.delay&&E._config.delay.hide?E._timeout=setTimeout(()=>{"out"===E._hoverState&&E.hide()},E._config.delay.hide):E.hide())}_isWithActiveTrigger(){for(const y in this._activeTrigger)if(this._activeTrigger[y])return!0;return!1}_getConfig(y){const E=Ye.getDataAttributes(this._element);return Object.keys(E).forEach(Z=>{as.has(Z)&&delete E[Z]}),(y={...this.constructor.Default,...E,..."object"==typeof y&&y?y:{}}).container=!1===y.container?document.body:ai(y.container),"number"==typeof y.delay&&(y.delay={show:y.delay,hide:y.delay}),"number"==typeof y.title&&(y.title=y.title.toString()),"number"==typeof y.content&&(y.content=y.content.toString()),Jr(os,y,this.constructor.DefaultType),y.sanitize&&(y.template=za(y.template,y.allowList,y.sanitizeFn)),y}_getDelegateConfig(){const y={};for(const E in this._config)this.constructor.Default[E]!==this._config[E]&&(y[E]=this._config[E]);return y}_cleanTipClass(){const y=this.getTipElement(),E=new RegExp(`(^|\\s)${this._getBasicClassPrefix()}\\S+`,"g"),Z=y.getAttribute("class").match(E);null!==Z&&Z.length>0&&Z.map(Y=>Y.trim()).forEach(Y=>y.classList.remove(Y))}_getBasicClassPrefix(){return"bs-tooltip"}_handlePopperPlacementChange(y){const{state:E}=y;E&&(this.tip=E.elements.popper,this._cleanTipClass(),this._addAttachmentClass(this._getAttachment(E.placement)))}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null)}static jQueryInterface(y){return this.each(function(){const E=ao.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===E[y])throw new TypeError(`No method named "${y}"`);E[y]()}})}}Ft(ao);const Ro={...ao.Default,placement:"right",offset:[0,8],trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'},ka={...ao.DefaultType,content:"(string|element|function)"},Xa={HIDE:"hide.bs.popover",HIDDEN:"hidden.bs.popover",SHOW:"show.bs.popover",SHOWN:"shown.bs.popover",INSERTED:"inserted.bs.popover",CLICK:"click.bs.popover",FOCUSIN:"focusin.bs.popover",FOCUSOUT:"focusout.bs.popover",MOUSEENTER:"mouseenter.bs.popover",MOUSELEAVE:"mouseleave.bs.popover"};class ta extends ao{static get Default(){return Ro}static get NAME(){return"popover"}static get Event(){return Xa}static get DefaultType(){return ka}isWithContent(){return this.getTitle()||this._getContent()}setContent(y){this._sanitizeAndSetContent(y,this.getTitle(),".popover-header"),this._sanitizeAndSetContent(y,this._getContent(),".popover-body")}_getContent(){return this._resolvePossibleFunction(this._config.content)}_getBasicClassPrefix(){return"bs-popover"}static jQueryInterface(y){return this.each(function(){const E=ta.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===E[y])throw new TypeError(`No method named "${y}"`);E[y]()}})}}Ft(ta);const ma="scrollspy",ls={offset:10,method:"auto",target:""},Ea={offset:"number",method:"string",target:"(string|element)"},ur="active",Ka=".nav-link, .list-group-item, .dropdown-item",us="position";class Ma extends We{constructor(y,E){super(y),this._scrollElement="BODY"===this._element.tagName?window:this._element,this._config=this._getConfig(E),this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,Ut.on(this._scrollElement,"scroll.bs.scrollspy",()=>this._process()),this.refresh(),this._process()}static get Default(){return ls}static get NAME(){return ma}refresh(){const E="auto"===this._config.method?this._scrollElement===this._scrollElement.window?"offset":us:this._config.method,Z=E===us?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),_e.find(Ka,this._config.target).map(Y=>{const ct=Cr(Y),vt=ct?_e.findOne(ct):null;if(vt){const Ot=vt.getBoundingClientRect();if(Ot.width||Ot.height)return[Ye[E](vt).top+Z,ct]}return null}).filter(Y=>Y).sort((Y,ct)=>Y[0]-ct[0]).forEach(Y=>{this._offsets.push(Y[0]),this._targets.push(Y[1])})}dispose(){Ut.off(this._scrollElement,".bs.scrollspy"),super.dispose()}_getConfig(y){return(y={...ls,...Ye.getDataAttributes(this._element),..."object"==typeof y&&y?y:{}}).target=ai(y.target)||document.documentElement,Jr(ma,y,Ea),y}_getScrollTop(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop}_getScrollHeight(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}_getOffsetHeight(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height}_process(){const y=this._getScrollTop()+this._config.offset,E=this._getScrollHeight(),Z=this._config.offset+E-this._getOffsetHeight();if(this._scrollHeight!==E&&this.refresh(),y>=Z){const Y=this._targets[this._targets.length-1];this._activeTarget!==Y&&this._activate(Y)}else{if(this._activeTarget&&y<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(let Y=this._offsets.length;Y--;)this._activeTarget!==this._targets[Y]&&y>=this._offsets[Y]&&(void 0===this._offsets[Y+1]||y<this._offsets[Y+1])&&this._activate(this._targets[Y])}}_activate(y){this._activeTarget=y,this._clear();const E=Ka.split(",").map(Y=>`${Y}[data-bs-target="${y}"],${Y}[href="${y}"]`),Z=_e.findOne(E.join(","),this._config.target);Z.classList.add(ur),Z.classList.contains("dropdown-item")?_e.findOne(".dropdown-toggle",Z.closest(".dropdown")).classList.add(ur):_e.parents(Z,".nav, .list-group").forEach(Y=>{_e.prev(Y,".nav-link, .list-group-item").forEach(ct=>ct.classList.add(ur)),_e.prev(Y,".nav-item").forEach(ct=>{_e.children(ct,".nav-link").forEach(vt=>vt.classList.add(ur))})}),Ut.trigger(this._scrollElement,"activate.bs.scrollspy",{relatedTarget:y})}_clear(){_e.find(Ka,this._config.target).filter(y=>y.classList.contains(ur)).forEach(y=>y.classList.remove(ur))}static jQueryInterface(y){return this.each(function(){const E=Ma.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===E[y])throw new TypeError(`No method named "${y}"`);E[y]()}})}}Ut.on(window,"load.bs.scrollspy.data-api",()=>{_e.find('[data-bs-spy="scroll"]').forEach(O=>new Ma(O))}),Ft(Ma);const r="active",h="fade",m="show",b=".active",C=":scope > li > .active";class G extends We{static get NAME(){return"tab"}show(){if(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&this._element.classList.contains(r))return;let y;const E=ho(this._element),Z=this._element.closest(".nav, .list-group");Z&&(y=_e.find("UL"===Z.nodeName||"OL"===Z.nodeName?C:b,Z),y=y[y.length-1]);const Y=y?Ut.trigger(y,"hide.bs.tab",{relatedTarget:this._element}):null;if(Ut.trigger(this._element,"show.bs.tab",{relatedTarget:y}).defaultPrevented||null!==Y&&Y.defaultPrevented)return;this._activate(this._element,Z);const ct=()=>{Ut.trigger(y,"hidden.bs.tab",{relatedTarget:this._element}),Ut.trigger(this._element,"shown.bs.tab",{relatedTarget:y})};E?this._activate(E,E.parentNode,ct):ct()}_activate(y,E,Z){const Y=(!E||"UL"!==E.nodeName&&"OL"!==E.nodeName?_e.children(E,b):_e.find(C,E))[0],ct=Z&&Y&&Y.classList.contains(h),vt=()=>this._transitionComplete(y,Y,Z);Y&&ct?(Y.classList.remove(m),this._queueCallback(vt,y,!0)):vt()}_transitionComplete(y,E,Z){if(E){E.classList.remove(r);const ct=_e.findOne(":scope > .dropdown-menu .active",E.parentNode);ct&&ct.classList.remove(r),"tab"===E.getAttribute("role")&&E.setAttribute("aria-selected",!1)}y.classList.add(r),"tab"===y.getAttribute("role")&&y.setAttribute("aria-selected",!0),y.classList.contains(h)&&y.classList.add(m);let Y=y.parentNode;if(Y&&"LI"===Y.nodeName&&(Y=Y.parentNode),Y&&Y.classList.contains("dropdown-menu")){const ct=y.closest(".dropdown");ct&&_e.find(".dropdown-toggle",ct).forEach(vt=>vt.classList.add(r)),y.setAttribute("aria-expanded",!0)}Z&&Z()}static jQueryInterface(y){return this.each(function(){const E=G.getOrCreateInstance(this);if("string"==typeof y){if(void 0===E[y])throw new TypeError(`No method named "${y}"`);E[y]()}})}}Ut.on(document,"click.bs.tab.data-api",'[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',function(O){["A","AREA"].includes(this.tagName)&&O.preventDefault(),Gi(this)||G.getOrCreateInstance(this).show()}),Ft(G);const kt="show",Lt="showing",oe={animation:"boolean",autohide:"boolean",delay:"number"},de={animation:!0,autohide:!0,delay:5e3};class Qe extends We{constructor(y,E){super(y),this._config=this._getConfig(E),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get DefaultType(){return oe}static get Default(){return de}static get NAME(){return"toast"}show(){Ut.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),this._element.classList.add(kt),this._element.classList.add(Lt),this._queueCallback(()=>{this._element.classList.remove(Lt),Ut.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this._element.classList.contains(kt)&&(Ut.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(Lt),this._queueCallback(()=>{this._element.classList.add("hide"),this._element.classList.remove(Lt),this._element.classList.remove(kt),Ut.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this._element.classList.contains(kt)&&this._element.classList.remove(kt),super.dispose()}_getConfig(y){return y={...de,...Ye.getDataAttributes(this._element),..."object"==typeof y&&y?y:{}},Jr("toast",y,this.constructor.DefaultType),y}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(y,E){switch(y.type){case"mouseover":case"mouseout":this._hasMouseInteraction=E;break;case"focusin":case"focusout":this._hasKeyboardInteraction=E}if(E)return void this._clearTimeout();const Z=y.relatedTarget;this._element===Z||this._element.contains(Z)||this._maybeScheduleHide()}_setListeners(){Ut.on(this._element,"mouseover.bs.toast",y=>this._onInteraction(y,!0)),Ut.on(this._element,"mouseout.bs.toast",y=>this._onInteraction(y,!1)),Ut.on(this._element,"focusin.bs.toast",y=>this._onInteraction(y,!0)),Ut.on(this._element,"focusout.bs.toast",y=>this._onInteraction(y,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(y){return this.each(function(){const E=Qe.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===E[y])throw new TypeError(`No method named "${y}"`);E[y](this)}})}}return bi(Qe),Ft(Qe),{Alert:Ln,Button:on,Carousel:zn,Collapse:un,Dropdown:Hn,Modal:wr,Offcanvas:Hr,Popover:ta,ScrollSpy:Ma,Tab:G,Toast:Qe,Tooltip:ao}}),function(Pt,ft){"object"==typeof exports&&typeof module<"u"?ft(exports):"function"==typeof define&&define.amd?define(["exports"],ft):ft(Pt.L={})}(this,function(Pt){"use strict";function ft(r){for(var h,m,b=1,C=arguments.length;b<C;b++)for(h in m=arguments[b])r[h]=m[h];return r}var Cr=Object.create||function(r){return ho.prototype=r,new ho};function ho(){}function xi(r,h){var m=Array.prototype.slice;if(r.bind)return r.bind.apply(r,m.call(arguments,1));var b=m.call(arguments,2);return function(){return r.apply(h,b.length?b.concat(m.call(arguments)):arguments)}}var Lr=0;function ai(r){return r._leaflet_id=r._leaflet_id||++Lr,r._leaflet_id}function Jr(r,h,m){var b,C,G=function(){b=!1,C&&(rt.apply(m,C),C=!1)},rt=function(){b?C=arguments:(r.apply(m,arguments),setTimeout(G,h),b=!0)};return rt}function co(r,h,m){var b=h[1],C=h[0],G=b-C;return r===b&&m?r:((r-C)%G+G)%G+C}function Gi(){return!1}function Yr(r,h){var m=Math.pow(10,void 0===h?6:h);return Math.round(r*m)/m}function oa(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function $r(r){return oa(r).split(/\s+/)}function Hi(r,h){for(var m in Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?Cr(r.options):{}),h)r.options[m]=h[m];return r.options}function aa(r,h,m){var b=[];for(var C in r)b.push(encodeURIComponent(m?C.toUpperCase():C)+"="+encodeURIComponent(r[C]));return(h&&-1!==h.indexOf("?")?"&":"?")+b.join("&")}var yn=/\{ *([\w_-]+) *\}/g;function Ft(r,h){return r.replace(yn,function(m,b){var C=h[b];if(void 0===C)throw new Error("No value provided for variable "+m);return"function"==typeof C&&(C=C(h)),C})}var ee=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};function Fe(r,h){for(var m=0;m<r.length;m++)if(r[m]===h)return m;return-1}var Te="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Di(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var gn=0;function c(r){var h=+new Date,m=Math.max(0,16-(h-gn));return gn=h+m,window.setTimeout(r,m)}var mi=window.requestAnimationFrame||Di("RequestAnimationFrame")||c,Mt=window.cancelAnimationFrame||Di("CancelAnimationFrame")||Di("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function Me(r,h,m){if(!m||mi!==c)return mi.call(window,xi(r,h));r.call(h)}function le(r){r&&Mt.call(window,r)}var Qi={extend:ft,create:Cr,bind:xi,lastId:Lr,stamp:ai,throttle:Jr,wrapNum:co,falseFn:Gi,formatNum:Yr,trim:oa,splitWords:$r,setOptions:Hi,getParamString:aa,template:Ft,isArray:ee,indexOf:Fe,emptyImageUrl:Te,requestFn:mi,cancelFn:Mt,requestAnimFrame:Me,cancelAnimFrame:le};function Zt(){}Zt.extend=function(r){function h(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()}var m=h.__super__=this.prototype,b=Cr(m);for(var C in(b.constructor=h).prototype=b,this)Object.prototype.hasOwnProperty.call(this,C)&&"prototype"!==C&&"__super__"!==C&&(h[C]=this[C]);return r.statics&&(ft(h,r.statics),delete r.statics),r.includes&&(function(G){if(!(typeof L>"u")&&L&&L.Mixin){G=ee(G)?G:[G];for(var rt=0;rt<G.length;rt++)G[rt]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(r.includes),ft.apply(null,[b].concat(r.includes)),delete r.includes),b.options&&(r.options=ft(Cr(b.options),r.options)),ft(b,r),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){m.callInitHooks&&m.callInitHooks.call(this),this._initHooksCalled=!0;for(var G=0,rt=b._initHooks.length;G<rt;G++)b._initHooks[G].call(this)}},h},Zt.include=function(r){return ft(this.prototype,r),this},Zt.mergeOptions=function(r){return ft(this.prototype.options,r),this},Zt.addInitHook=function(r){var h=Array.prototype.slice.call(arguments,1),m="function"==typeof r?r:function(){this[r].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(m),this};var ln={on:function(r,h,m){if("object"==typeof r)for(var b in r)this._on(b,r[b],h);else for(var C=0,G=(r=$r(r)).length;C<G;C++)this._on(r[C],h,m);return this},off:function(r,h,m){if(r)if("object"==typeof r)for(var b in r)this._off(b,r[b],h);else for(var C=0,G=(r=$r(r)).length;C<G;C++)this._off(r[C],h,m);else delete this._events;return this},_on:function(r,h,m){this._events=this._events||{};var b=this._events[r];b||(this._events[r]=b=[]),m===this&&(m=void 0);for(var C={fn:h,ctx:m},G=b,rt=0,gt=G.length;rt<gt;rt++)if(G[rt].fn===h&&G[rt].ctx===m)return;G.push(C)},_off:function(r,h,m){var b,C,G;if(this._events&&(b=this._events[r]))if(h){if(m===this&&(m=void 0),b)for(C=0,G=b.length;C<G;C++){var rt=b[C];if(rt.ctx===m&&rt.fn===h)return rt.fn=Gi,this._firingCount&&(this._events[r]=b=b.slice()),void b.splice(C,1)}}else{for(C=0,G=b.length;C<G;C++)b[C].fn=Gi;delete this._events[r]}},fire:function(r,h,m){if(!this.listens(r,m))return this;var b=ft({},h,{type:r,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var C=this._events[r];if(C){this._firingCount=this._firingCount+1||1;for(var G=0,rt=C.length;G<rt;G++){var gt=C[G];gt.fn.call(gt.ctx||this,b)}this._firingCount--}}return m&&this._propagateEvent(b),this},listens:function(r,h){var m=this._events&&this._events[r];if(m&&m.length)return!0;if(h)for(var b in this._eventParents)if(this._eventParents[b].listens(r,h))return!0;return!1},once:function(r,h,m){if("object"==typeof r){for(var b in r)this.once(b,r[b],h);return this}var C=xi(function(){this.off(r,h,m).off(r,C,m)},this);return this.on(r,h,m).on(r,C,m)},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[ai(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[ai(r)],this},_propagateEvent:function(r){for(var h in this._eventParents)this._eventParents[h].fire(r.type,ft({layer:r.target,propagatedFrom:r.target},r),!0)}};ln.addEventListener=ln.on,ln.removeEventListener=ln.clearAllEventListeners=ln.off,ln.addOneTimeEventListener=ln.once,ln.fireEvent=ln.fire,ln.hasEventListeners=ln.listens;var tn=Zt.extend(ln);function Ee(r,h,m){this.x=m?Math.round(r):r,this.y=m?Math.round(h):h}var jn=Math.trunc||function(r){return 0<r?Math.floor(r):Math.ceil(r)};function ti(r,h,m){return r instanceof Ee?r:ee(r)?new Ee(r[0],r[1]):null==r?r:"object"==typeof r&&"x"in r&&"y"in r?new Ee(r.x,r.y):new Ee(r,h,m)}function je(r,h){if(r)for(var m=h?[r,h]:r,b=0,C=m.length;b<C;b++)this.extend(m[b])}function Ut(r,h){return!r||r instanceof je?r:new je(r,h)}function Pi(r,h){if(r)for(var m=h?[r,h]:r,b=0,C=m.length;b<C;b++)this.extend(m[b])}function Ci(r,h){return r instanceof Pi?r:new Pi(r,h)}function We(r,h,m){if(isNaN(r)||isNaN(h))throw new Error("Invalid LatLng object: ("+r+", "+h+")");this.lat=+r,this.lng=+h,void 0!==m&&(this.alt=+m)}function bi(r,h,m){return r instanceof We?r:ee(r)&&"object"!=typeof r[0]?3===r.length?new We(r[0],r[1],r[2]):2===r.length?new We(r[0],r[1]):null:null==r?r:"object"==typeof r&&"lat"in r?new We(r.lat,"lng"in r?r.lng:r.lon,r.alt):void 0===h?null:new We(r,h,m)}Ee.prototype={clone:function(){return new Ee(this.x,this.y)},add:function(r){return this.clone()._add(ti(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(ti(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new Ee(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new Ee(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=jn(this.x),this.y=jn(this.y),this},distanceTo:function(r){var h=(r=ti(r)).x-this.x,m=r.y-this.y;return Math.sqrt(h*h+m*m)},equals:function(r){return(r=ti(r)).x===this.x&&r.y===this.y},contains:function(r){return r=ti(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+Yr(this.x)+", "+Yr(this.y)+")"}},je.prototype={extend:function(r){return r=ti(r),this.min||this.max?(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(r.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(r.y,this.max.y)):(this.min=r.clone(),this.max=r.clone()),this},getCenter:function(r){return new Ee((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return new Ee(this.min.x,this.max.y)},getTopRight:function(){return new Ee(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var h,m;return(r=("number"==typeof r[0]||r instanceof Ee?ti:Ut)(r))instanceof je?(h=r.min,m=r.max):h=m=r,h.x>=this.min.x&&m.x<=this.max.x&&h.y>=this.min.y&&m.y<=this.max.y},intersects:function(r){r=Ut(r);var h=this.min,m=this.max,b=r.min,C=r.max;return C.x>=h.x&&b.x<=m.x&&C.y>=h.y&&b.y<=m.y},overlaps:function(r){r=Ut(r);var h=this.min,m=this.max,b=r.min,C=r.max;return C.x>h.x&&b.x<m.x&&C.y>h.y&&b.y<m.y},isValid:function(){return!(!this.min||!this.max)}},Pi.prototype={extend:function(r){var h,m,b=this._southWest,C=this._northEast;if(r instanceof We)m=h=r;else{if(!(r instanceof Pi))return r?this.extend(bi(r)||Ci(r)):this;if(m=r._northEast,!(h=r._southWest)||!m)return this}return b||C?(b.lat=Math.min(h.lat,b.lat),b.lng=Math.min(h.lng,b.lng),C.lat=Math.max(m.lat,C.lat),C.lng=Math.max(m.lng,C.lng)):(this._southWest=new We(h.lat,h.lng),this._northEast=new We(m.lat,m.lng)),this},pad:function(r){var h=this._southWest,m=this._northEast,b=Math.abs(h.lat-m.lat)*r,C=Math.abs(h.lng-m.lng)*r;return new Pi(new We(h.lat-b,h.lng-C),new We(m.lat+b,m.lng+C))},getCenter:function(){return new We((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new We(this.getNorth(),this.getWest())},getSouthEast:function(){return new We(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){r=("number"==typeof r[0]||r instanceof We||"lat"in r?bi:Ci)(r);var h,m,b=this._southWest,C=this._northEast;return r instanceof Pi?(h=r.getSouthWest(),m=r.getNorthEast()):h=m=r,h.lat>=b.lat&&m.lat<=C.lat&&h.lng>=b.lng&&m.lng<=C.lng},intersects:function(r){r=Ci(r);var h=this._southWest,m=this._northEast,b=r.getSouthWest(),C=r.getNorthEast();return C.lat>=h.lat&&b.lat<=m.lat&&C.lng>=h.lng&&b.lng<=m.lng},overlaps:function(r){r=Ci(r);var h=this._southWest,m=this._northEast,b=r.getSouthWest(),C=r.getNorthEast();return C.lat>h.lat&&b.lat<m.lat&&C.lng>h.lng&&b.lng<m.lng},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,h){return!!r&&(r=Ci(r),this._southWest.equals(r.getSouthWest(),h)&&this._northEast.equals(r.getNorthEast(),h))},isValid:function(){return!(!this._southWest||!this._northEast)}};var Ln,Ni={latLngToPoint:function(r,h){var m=this.projection.project(r),b=this.scale(h);return this.transformation._transform(m,b)},pointToLatLng:function(r,h){var m=this.scale(h),b=this.transformation.untransform(r,m);return this.projection.unproject(b)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var h=this.projection.bounds,m=this.scale(r);return new je(this.transformation.transform(h.min,m),this.transformation.transform(h.max,m))},infinite:!(We.prototype={equals:function(r,h){return!!r&&(r=bi(r),Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng))<=(void 0===h?1e-9:h))},toString:function(r){return"LatLng("+Yr(this.lat,r)+", "+Yr(this.lng,r)+")"},distanceTo:function(r){return on.distance(this,bi(r))},wrap:function(){return on.wrapLatLng(this)},toBounds:function(r){var h=180*r/40075017,m=h/Math.cos(Math.PI/180*this.lat);return Ci([this.lat-h,this.lng-m],[this.lat+h,this.lng+m])},clone:function(){return new We(this.lat,this.lng,this.alt)}}),wrapLatLng:function(r){var h=this.wrapLng?co(r.lng,this.wrapLng,!0):r.lng;return new We(this.wrapLat?co(r.lat,this.wrapLat,!0):r.lat,h,r.alt)},wrapLatLngBounds:function(r){var h=r.getCenter(),m=this.wrapLatLng(h),b=h.lat-m.lat,C=h.lng-m.lng;if(0==b&&0==C)return r;var G=r.getSouthWest(),rt=r.getNorthEast();return new Pi(new We(G.lat-b,G.lng-C),new We(rt.lat-b,rt.lng-C))}},on=ft({},Ni,{wrapLng:[-180,180],R:6371e3,distance:function(r,h){var m=Math.PI/180,b=r.lat*m,C=h.lat*m,G=Math.sin((h.lat-r.lat)*m/2),rt=Math.sin((h.lng-r.lng)*m/2),gt=G*G+Math.cos(b)*Math.cos(C)*rt*rt,kt=2*Math.atan2(Math.sqrt(gt),Math.sqrt(1-gt));return this.R*kt}}),zr={R:6378137,MAX_LATITUDE:85.0511287798,project:function(r){var h=Math.PI/180,m=this.MAX_LATITUDE,b=Math.max(Math.min(m,r.lat),-m),C=Math.sin(b*h);return new Ee(this.R*r.lng*h,this.R*Math.log((1+C)/(1-C))/2)},unproject:function(r){var h=180/Math.PI;return new We((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*h,r.x*h/this.R)},bounds:new je([-(Ln=6378137*Math.PI),-Ln],[Ln,Ln])};function Ye(r,h,m,b){if(ee(r))return this._a=r[0],this._b=r[1],this._c=r[2],void(this._d=r[3]);this._a=r,this._b=h,this._c=m,this._d=b}function _e(r,h,m,b){return new Ye(r,h,m,b)}Ye.prototype={transform:function(r,h){return this._transform(r.clone(),h)},_transform:function(r,h){return r.x=(h=h||1)*(this._a*r.x+this._b),r.y=h*(this._c*r.y+this._d),r},untransform:function(r,h){return new Ee((r.x/(h=h||1)-this._b)/this._a,(r.y/h-this._d)/this._c)}};var Go,Vn=ft({},on,{code:"EPSG:3857",projection:zr,transformation:_e(Go=.5/(Math.PI*zr.R),.5,-Go,.5)}),Wo=ft({},Vn,{code:"EPSG:900913"});function mr(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function _r(r,h){for(var m,b,C,G,rt="",gt=0,kt=r.length;gt<kt;gt++){for(m=0,b=(C=r[gt]).length;m<b;m++)rt+=(m?"L":"M")+(G=C[m]).x+" "+G.y;rt+=h?he?"z":"x":""}return rt||"M0 0"}var Zn=document.documentElement.style,Tn="ActiveXObject"in window,Qn=Tn&&!document.addEventListener,Vr="msLaunchUri"in navigator&&!("documentMode"in document),Sn=ui("webkit"),tr=ui("android"),zn=ui("android 2")||ui("android 3"),kn=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Zr=tr&&ui("Google")&&kn<537&&!("AudioNode"in window),_i=!!window.opera,or=!Vr&&ui("chrome"),Bi=ui("gecko")&&!Sn&&!_i&&!Tn,vn=!or&&ui("safari"),Ve=ui("phantom"),po="OTransition"in Zn,xn=0===navigator.platform.indexOf("Win"),un=Tn&&"transition"in Zn,En="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!zn,Zi="MozPerspective"in Zn,di=!window.L_DISABLE_3D&&(un||En||Zi)&&!po&&!Ve,wi=typeof orientation<"u"||ui("mobile"),Qr=wi&&Sn,to=wi&&En,x=!window.PointerEvent&&window.MSPointerEvent,S=!(!window.PointerEvent&&!x),D=!window.L_NO_TOUCH&&(S||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),W=wi&&_i,it=wi&&Bi,pt=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),At=function(){var r=!1;try{var h=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",Gi,h),window.removeEventListener("testPassiveEventSupport",Gi,h)}catch{}return r}(),Qt=!!document.createElement("canvas").getContext,he=!(!document.createElementNS||!mr("svg").createSVGRect),Pe=!he&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var h=r.firstChild;return h.style.behavior="url(#default#VML)",h&&"object"==typeof h.adj}catch{return!1}}();function ui(r){return 0<=navigator.userAgent.toLowerCase().indexOf(r)}var bn={ie:Tn,ielt9:Qn,edge:Vr,webkit:Sn,android:tr,android23:zn,androidStock:Zr,opera:_i,chrome:or,gecko:Bi,safari:vn,phantom:Ve,opera12:po,win:xn,ie3d:un,webkit3d:En,gecko3d:Zi,any3d:di,mobile:wi,mobileWebkit:Qr,mobileWebkit3d:to,msPointer:x,pointer:S,touch:D,mobileOpera:W,mobileGecko:it,retina:pt,passiveEvents:At,canvas:Qt,svg:he,vml:Pe},Ri=x?"MSPointerDown":"pointerdown",qn=x?"MSPointerMove":"pointermove",Gn=x?"MSPointerUp":"pointerup",fo=x?"MSPointerCancel":"pointercancel",ar={},eo=!1;function sr(r){ar[r.pointerId]=r}function ko(r){ar[r.pointerId]&&(ar[r.pointerId]=r)}function lr(r){delete ar[r.pointerId]}function Yi(r,h){for(var m in r.touches=[],ar)r.touches.push(ar[m]);r.changedTouches=[r],h(r)}var H,J,ot,ut,N,et,z=x?"MSPointerDown":S?"pointerdown":"touchstart",B=x?"MSPointerUp":S?"pointerup":"touchend",F="_leaflet_",mt=hi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Dt=hi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Nt="webkitTransition"===Dt||"OTransition"===Dt?Dt+"End":"transitionend";function bt(r){return"string"==typeof r?document.getElementById(r):r}function Bt(r,h){var m,b=r.style[h]||r.currentStyle&&r.currentStyle[h];return b&&"auto"!==b||!document.defaultView||(b=(m=document.defaultView.getComputedStyle(r,null))?m[h]:null),"auto"===b?null:b}function jt(r,h,m){var b=document.createElement(r);return b.className=h||"",m&&m.appendChild(b),b}function Gt(r){var h=r.parentNode;h&&h.removeChild(r)}function St(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function ie(r){var h=r.parentNode;h&&h.lastChild!==r&&h.appendChild(r)}function Kt(r){var h=r.parentNode;h&&h.firstChild!==r&&h.insertBefore(r,h.firstChild)}function Jt(r,h){if(void 0!==r.classList)return r.classList.contains(h);var m=fi(r);return 0<m.length&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(m)}function re(r,h){var m;if(void 0!==r.classList)for(var b=$r(h),C=0,G=b.length;C<G;C++)r.classList.add(b[C]);else Jt(r,h)||Ke(r,((m=fi(r))?m+" ":"")+h)}function Vt(r,h){void 0!==r.classList?r.classList.remove(h):Ke(r,oa((" "+fi(r)+" ").replace(" "+h+" "," ")))}function Ke(r,h){void 0===r.className.baseVal?r.className=h:r.className.baseVal=h}function fi(r){return r.correspondingElement&&(r=r.correspondingElement),void 0===r.className.baseVal?r.className:r.className.baseVal}function Ae(r,h){"opacity"in r.style?r.style.opacity=h:"filter"in r.style&&function(m,b){var C=!1,G="DXImageTransform.Microsoft.Alpha";try{C=m.filters.item(G)}catch{if(1===b)return}b=Math.round(100*b),C?(C.Enabled=100!==b,C.Opacity=b):m.style.filter+=" progid:"+G+"(opacity="+b+")"}(r,h)}function hi(r){for(var h=document.documentElement.style,m=0;m<r.length;m++)if(r[m]in h)return r[m];return!1}function Ne(r,h,m){var b=h||new Ee(0,0);r.style[mt]=(un?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(m?" scale("+m+")":"")}function Ti(r,h){r._leaflet_pos=h,di?Ne(r,h):(r.style.left=h.x+"px",r.style.top=h.y+"px")}function ei(r){return r._leaflet_pos||new Ee(0,0)}function Xi(){Oe(window,"dragstart",an)}function yi(){en(window,"dragstart",an)}function He(r){for(;-1===r.tabIndex;)r=r.parentNode;r.style&&(si(),et=(N=r).style.outline,r.style.outline="none",Oe(window,"keydown",si))}function si(){N&&(N.style.outline=et,et=N=void 0,en(window,"keydown",si))}function Mn(r){for(;!((r=r.parentNode).offsetWidth&&r.offsetHeight||r===document.body););return r}function Ho(r){var h=r.getBoundingClientRect();return{x:h.width/r.offsetWidth||1,y:h.height/r.offsetHeight||1,boundingClientRect:h}}ut="onselectstart"in document?(ot=function(){Oe(window,"selectstart",an)},function(){en(window,"selectstart",an)}):(J=hi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),ot=function(){var r;J&&(r=document.documentElement.style,H=r[J],r[J]="none")},function(){J&&(document.documentElement.style[J]=H,H=void 0)});var Dn={TRANSFORM:mt,TRANSITION:Dt,TRANSITION_END:Nt,get:bt,getStyle:Bt,create:jt,remove:Gt,empty:St,toFront:ie,toBack:Kt,hasClass:Jt,addClass:re,removeClass:Vt,setClass:Ke,getClass:fi,setOpacity:Ae,testProp:hi,setTransform:Ne,setPosition:Ti,getPosition:ei,disableTextSelection:ot,enableTextSelection:ut,disableImageDrag:Xi,enableImageDrag:yi,preventOutline:He,restoreOutline:si,getSizedParentNode:Mn,getScale:Ho};function Oe(r,h,m,b){if("object"==typeof h)for(var C in h)Bn(r,C,h[C],m);else for(var G=0,rt=(h=$r(h)).length;G<rt;G++)Bn(r,h[G],m,b);return this}var ir="_leaflet_events";function en(r,h,m,b){if("object"==typeof h)for(var C in h)wn(r,C,h[C],m);else if(h)for(var G=0,rt=(h=$r(h)).length;G<rt;G++)wn(r,h[G],m,b);else{for(var gt in r[ir])wn(r,gt,r[ir][gt]);delete r[ir]}return this}function nn(){return S&&!Vr&&!vn}var sa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Bn(r,h,m,b){var C=h+ai(m)+(b?"_"+ai(b):"");if(r[ir]&&r[ir][C])return this;var G,rt,gt,kt,Lt,oe,de=function(E){return m.call(b||r,E||window.event)},Qe=de;function O(E){if(S){if(!E.isPrimary||"mouse"===E.pointerType)return}else if(1<E.touches.length)return;var Z=Date.now(),Y=Z-(kt||Z);Lt=E.touches?E.touches[0]:E,oe=0<Y&&Y<=250,kt=Z}function y(E){if(oe&&!Lt.cancelBubble){if(S){if("mouse"===E.pointerType)return;var Z,Y,ct={};for(Y in Lt)ct[Y]=(Z=Lt[Y])&&Z.bind?Z.bind(Lt):Z;Lt=ct}Lt.type="dblclick",Lt.button=0,rt(Lt),kt=null}}S&&0===h.indexOf("touch")?function er(r,h,m,b){function C(y){Yi(y,rt)}var G,rt,gt,kt,Lt,oe,de,Qe;function O(y){y.pointerType===(y.MSPOINTER_TYPE_MOUSE||"mouse")&&0===y.buttons||Yi(y,kt)}"touchstart"===h?(Lt=r,oe=m,de=b,Qe=xi(function(y){y.MSPOINTER_TYPE_TOUCH&&y.pointerType===y.MSPOINTER_TYPE_TOUCH&&an(y),Yi(y,oe)}),Lt["_leaflet_touchstart"+de]=Qe,Lt.addEventListener(Ri,Qe,!1),eo||(document.addEventListener(Ri,sr,!0),document.addEventListener(qn,ko,!0),document.addEventListener(Gn,lr,!0),document.addEventListener(fo,lr,!0),eo=!0)):"touchmove"===h?(kt=m,(gt=r)["_leaflet_touchmove"+b]=O,gt.addEventListener(qn,O,!1)):"touchend"===h&&(rt=m,(G=r)["_leaflet_touchend"+b]=C,G.addEventListener(Gn,C,!1),G.addEventListener(fo,C,!1))}(r,h,de,C):D&&"dblclick"===h&&!nn()?(rt=de,oe=!1,(G=r)[F+z+(gt=C)]=O,G[F+B+gt]=y,G[F+"dblclick"+gt]=rt,G.addEventListener(z,O,!!At&&{passive:!1}),G.addEventListener(B,y,!!At&&{passive:!1}),G.addEventListener("dblclick",rt,!1)):"addEventListener"in r?"touchstart"===h||"touchmove"===h||"wheel"===h||"mousewheel"===h?r.addEventListener(sa[h]||h,de,!!At&&{passive:!1}):"mouseenter"===h||"mouseleave"===h?r.addEventListener(sa[h],de=function(E){E=E||window.event,So(r,E)&&Qe(E)},!1):r.addEventListener(h,Qe,!1):"attachEvent"in r&&r.attachEvent("on"+h,de),r[ir]=r[ir]||{},r[ir][C]=de}function wn(r,h,m,b){var C,G,rt,gt,kt,Lt,oe,de,Qe=h+ai(m)+(b?"_"+ai(b):""),O=r[ir]&&r[ir][Qe];if(!O)return this;S&&0===h.indexOf("touch")?(de=(Lt=r)["_leaflet_"+(oe=h)+Qe],"touchstart"===oe?Lt.removeEventListener(Ri,de,!1):"touchmove"===oe?Lt.removeEventListener(qn,de,!1):"touchend"===oe&&(Lt.removeEventListener(Gn,de,!1),Lt.removeEventListener(fo,de,!1))):D&&"dblclick"===h&&!nn()?(rt=(C=r)[F+z+(G=Qe)],gt=C[F+B+G],kt=C[F+"dblclick"+G],C.removeEventListener(z,rt,!!At&&{passive:!1}),C.removeEventListener(B,gt,!!At&&{passive:!1}),C.removeEventListener("dblclick",kt,!1)):"removeEventListener"in r?r.removeEventListener(sa[h]||h,O,!1):"detachEvent"in r&&r.detachEvent("on"+h,O),r[ir][Qe]=null}function Wn(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,Rn(r),this}function Fi(r){return Bn(r,"wheel",Wn),this}function yr(r){return Oe(r,"mousedown touchstart dblclick",Wn),Bn(r,"click",mo),this}function an(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function Mo(r){return an(r),Wn(r),this}function qr(r,h){if(!h)return new Ee(r.clientX,r.clientY);var m=Ho(h),b=m.boundingClientRect;return new Ee((r.clientX-b.left)/m.x-h.clientLeft,(r.clientY-b.top)/m.y-h.clientTop)}var Vs=xn&&or?2*window.devicePixelRatio:Bi?window.devicePixelRatio:1;function io(r){return Vr?r.wheelDeltaY/2:r.deltaY&&0===r.deltaMode?-r.deltaY/Vs:r.deltaY&&1===r.deltaMode?20*-r.deltaY:r.deltaY&&2===r.deltaMode?60*-r.deltaY:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?20*-r.detail:r.detail?r.detail/-32765*60:0}var On={};function mo(r){On[r.type]=!0}function Rn(r){var h=On[r.type];return On[r.type]=!1,h}function So(r,h){var m=h.relatedTarget;if(!m)return!0;try{for(;m&&m!==r;)m=m.parentNode}catch{return!1}return m!==r}var Ss={on:Oe,off:en,stopPropagation:Wn,disableScrollPropagation:Fi,disableClickPropagation:yr,preventDefault:an,stop:Mo,getMousePosition:qr,getWheelDelta:io,fakeStop:mo,skipped:Rn,isExternalTarget:So,addListener:Oe,removeListener:en},is=tn.extend({run:function(r,h,m,b){this.stop(),this._el=r,this._inProgress=!0,this._duration=m||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=ei(r),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Me(this._animate,this),this._step()},_step:function(r){var h=new Date-this._startTime,m=1e3*this._duration;h<m?this._runFrame(this._easeOut(h/m),r):(this._runFrame(1),this._complete())},_runFrame:function(r,h){var m=this._startPos.add(this._offset.multiplyBy(r));h&&m._round(),Ti(this._el,m),this.fire("step")},_complete:function(){le(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),gi=tn.extend({options:{crs:Vn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,h){h=Hi(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=xi(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),void 0!==h.zoom&&(this._zoom=this._limitZoom(h.zoom)),h.center&&void 0!==h.zoom&&this.setView(bi(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Dt&&di&&!W&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Oe(this._proxy,Nt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,h,m){return h=void 0===h?this._zoom:this._limitZoom(h),r=this._limitCenter(bi(r),h,this.options.maxBounds),m=m||{},this._stop(),this._loaded&&!m.reset&&!0!==m&&(void 0!==m.animate&&(m.zoom=ft({animate:m.animate},m.zoom),m.pan=ft({animate:m.animate,duration:m.duration},m.pan)),this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,h,m.zoom):this._tryAnimatedPan(r,m.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(r,h),this)},setZoom:function(r,h){return this._loaded?this.setView(this.getCenter(),r,{zoom:h}):(this._zoom=r,this)},zoomIn:function(r,h){return this.setZoom(this._zoom+(r=r||(di?this.options.zoomDelta:1)),h)},zoomOut:function(r,h){return this.setZoom(this._zoom-(r=r||(di?this.options.zoomDelta:1)),h)},setZoomAround:function(r,h,m){var b=this.getZoomScale(h),C=this.getSize().divideBy(2),G=(r instanceof Ee?r:this.latLngToContainerPoint(r)).subtract(C).multiplyBy(1-1/b),rt=this.containerPointToLatLng(C.add(G));return this.setView(rt,h,{zoom:m})},_getBoundsCenterZoom:function(r,h){h=h||{},r=r.getBounds?r.getBounds():Ci(r);var m=ti(h.paddingTopLeft||h.padding||[0,0]),b=ti(h.paddingBottomRight||h.padding||[0,0]),C=this.getBoundsZoom(r,!1,m.add(b));if((C="number"==typeof h.maxZoom?Math.min(h.maxZoom,C):C)===1/0)return{center:r.getCenter(),zoom:C};var G=b.subtract(m).divideBy(2),rt=this.project(r.getSouthWest(),C),gt=this.project(r.getNorthEast(),C);return{center:this.unproject(rt.add(gt).divideBy(2).add(G),C),zoom:C}},fitBounds:function(r,h){if(!(r=Ci(r)).isValid())throw new Error("Bounds are not valid.");var m=this._getBoundsCenterZoom(r,h);return this.setView(m.center,m.zoom,h)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,h){return this.setView(r,this._zoom,{pan:h})},panBy:function(r,h){return h=h||{},(r=ti(r).round()).x||r.y?(!0===h.animate||this.getSize().contains(r)?(this._panAnim||(this._panAnim=new is,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),!1!==h.animate?(re(this._mapPane,"leaflet-pan-anim"),m=this._getMapPanePos().subtract(r).round(),this._panAnim.run(this._mapPane,m,h.duration||.25,h.easeLinearity)):(this._rawPanBy(r),this.fire("move").fire("moveend"))):this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this):this.fire("moveend");var m},flyTo:function(r,h,m){if(!1===(m=m||{}).animate||!di)return this.setView(r,h,m);this._stop();var b=this.project(this.getCenter()),C=this.project(r),G=this.getSize(),rt=this._zoom;r=bi(r),h=void 0===h?rt:h;var gt=Math.max(G.x,G.y),kt=gt*this.getZoomScale(rt,h),Lt=C.distanceTo(b)||1,oe=1.42,de=oe*oe;function Qe(Ot){var Ct=(kt*kt-gt*gt+(Ot?-1:1)*de*de*Lt*Lt)/(2*(Ot?kt:gt)*de*Lt),Ht=Math.sqrt(Ct*Ct+1)-Ct;return Ht<1e-9?-18:Math.log(Ht)}function O(Ot){return(Math.exp(Ot)-Math.exp(-Ot))/2}function y(Ot){return(Math.exp(Ot)+Math.exp(-Ot))/2}var E=Qe(0),Y=Date.now(),ct=(Qe(1)-E)/oe,vt=m.duration?1e3*m.duration:1e3*ct*.8;return this._moveStart(!0,m.noMoveStart),function Ot(){var Ht,ce=(Date.now()-Y)/vt,ne=(1-Math.pow(1-ce,1.5))*ct;ce<=1?(this._flyToFrame=Me(Ot,this),this._move(this.unproject(b.add(C.subtract(b).multiplyBy(function Z(Ot){return gt*(y(E)*(O(Ct=E+oe*Ot)/y(Ct))-O(E))/de;var Ct}(ne)/Lt)),rt),this.getScaleZoom(gt/(Ht=ne,gt*(y(E)/y(E+oe*Ht))),rt),{flyTo:!0})):this._move(r,h)._moveEnd(!0)}.call(this),this},flyToBounds:function(r,h){var m=this._getBoundsCenterZoom(r,h);return this.flyTo(m.center,m.zoom,h)},setMaxBounds:function(r){return(r=Ci(r)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(r){var h=this.options.minZoom;return this.options.minZoom=r,this._loaded&&h!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var h=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&h!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,h){this._enforcingBounds=!0;var m=this.getCenter(),b=this._limitCenter(m,this._zoom,Ci(r));return m.equals(b)||this.panTo(b,h),this._enforcingBounds=!1,this},panInside:function(r,h){var m,b,C=ti((h=h||{}).paddingTopLeft||h.padding||[0,0]),G=ti(h.paddingBottomRight||h.padding||[0,0]),rt=this.getCenter(),gt=this.project(rt),kt=this.project(r),Lt=this.getPixelBounds(),oe=Lt.getSize().divideBy(2),de=Ut([Lt.min.add(C),Lt.max.subtract(G)]);return de.contains(kt)||(this._enforcingBounds=!0,m=gt.subtract(kt),b=ti(kt.x+m.x,kt.y+m.y),(kt.x<de.min.x||kt.x>de.max.x)&&(b.x=gt.x-m.x,0<m.x?b.x+=oe.x-C.x:b.x-=oe.x-G.x),(kt.y<de.min.y||kt.y>de.max.y)&&(b.y=gt.y-m.y,0<m.y?b.y+=oe.y-C.y:b.y-=oe.y-G.y),this.panTo(this.unproject(b),h),this._enforcingBounds=!1),this},invalidateSize:function(r){if(!this._loaded)return this;r=ft({animate:!1,pan:!0},!0===r?{animate:!0}:r);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var m=this.getSize(),b=h.divideBy(2).round(),C=m.divideBy(2).round(),G=b.subtract(C);return G.x||G.y?(r.animate&&r.pan?this.panBy(G):(r.pan&&this._rawPanBy(G),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(xi(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:m})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=ft({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=xi(this._handleGeolocationResponse,this),m=xi(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,m,r):navigator.geolocation.getCurrentPosition(h,m,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){var h=r.code,m=r.message||(1===h?"permission denied":2===h?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+m+"."})},_handleGeolocationResponse:function(r){var h,m=new We(r.coords.latitude,r.coords.longitude),b=m.toBounds(2*r.coords.accuracy),C=this._locateOptions;C.setView&&(h=this.getBoundsZoom(b),this.setView(m,C.maxZoom?Math.min(h,C.maxZoom):h));var G={latlng:m,bounds:b,timestamp:r.timestamp};for(var rt in r.coords)"number"==typeof r.coords[rt]&&(G[rt]=r.coords[rt]);this.fire("locationfound",G)},addHandler:function(r,h){if(!h)return this;var m=this[r]=new h(this);return this._handlers.push(m),this.options[r]&&m.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}var r;for(r in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),Gt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(le(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[r].remove();for(r in this._panes)Gt(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,h){var m=jt("div","leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),h||this._mapPane);return r&&(this._panes[r]=m),m},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds();return new Pi(this.unproject(r.getBottomLeft()),this.unproject(r.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,h,m){r=Ci(r),m=ti(m||[0,0]);var O=this.getZoom()||0,b=this.getMinZoom(),C=this.getMaxZoom(),G=r.getNorthWest(),rt=r.getSouthEast(),gt=this.getSize().subtract(m),kt=Ut(this.project(rt,O),this.project(G,O)).getSize(),Lt=di?this.options.zoomSnap:1,oe=gt.x/kt.x,de=gt.y/kt.y,Qe=h?Math.max(oe,de):Math.min(oe,de);return O=this.getScaleZoom(Qe,O),Lt&&(O=Math.round(O/(Lt/100))*(Lt/100),O=h?Math.ceil(O/Lt)*Lt:Math.floor(O/Lt)*Lt),Math.max(b,Math.min(C,O))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new Ee(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,h){var m=this._getTopLeftPoint(r,h);return new je(m,m.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(void 0===r?this.getZoom():r)},getPane:function(r){return"string"==typeof r?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,h){var m=this.options.crs;return h=void 0===h?this._zoom:h,m.scale(r)/m.scale(h)},getScaleZoom:function(r,h){var m=this.options.crs,b=m.zoom(r*m.scale(h=void 0===h?this._zoom:h));return isNaN(b)?1/0:b},project:function(r,h){return h=void 0===h?this._zoom:h,this.options.crs.latLngToPoint(bi(r),h)},unproject:function(r,h){return h=void 0===h?this._zoom:h,this.options.crs.pointToLatLng(ti(r),h)},layerPointToLatLng:function(r){var h=ti(r).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(r){return this.project(bi(r))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(bi(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(Ci(r))},distance:function(r,h){return this.options.crs.distance(bi(r),bi(h))},containerPointToLayerPoint:function(r){return ti(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return ti(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var h=this.containerPointToLayerPoint(ti(r));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(bi(r)))},mouseEventToContainerPoint:function(r){return qr(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var h=this._container=bt(r);if(!h)throw new Error("Map container not found.");if(h._leaflet_id)throw new Error("Map container is already initialized.");Oe(h,"scroll",this._onScroll,this),this._containerId=ai(h)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&di,re(r,"leaflet-container"+(D?" leaflet-touch":"")+(pt?" leaflet-retina":"")+(Qn?" leaflet-oldie":"")+(vn?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=Bt(r,"position");"absolute"!==h&&"relative"!==h&&"fixed"!==h&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ti(this._mapPane,new Ee(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(re(r.markerPane,"leaflet-zoom-hide"),re(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,h){Ti(this._mapPane,new Ee(0,0));var m=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var b=this._zoom!==h;this._moveStart(b,!1)._move(r,h)._moveEnd(b),this.fire("viewreset"),m&&this.fire("load")},_moveStart:function(r,h){return r&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(r,h,m){void 0===h&&(h=this._zoom);var b=this._zoom!==h;return this._zoom=h,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),(b||m&&m.pinch)&&this.fire("zoom",m),this.fire("move",m)},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return le(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){Ti(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={};var h=r?en:Oe;h((this._targets[ai(this._container)]=this)._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),di&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){le(this._resizeRequest),this._resizeRequest=Me(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,h){for(var m,b=[],C="mouseout"===h||"mouseover"===h,G=r.target||r.srcElement,rt=!1;G;){if((m=this._targets[ai(G)])&&("click"===h||"preclick"===h)&&!r._simulated&&this._draggableMoved(m)){rt=!0;break}if(m&&m.listens(h,!0)&&(C&&!So(G,r)||(b.push(m),C))||G===this._container)break;G=G.parentNode}return b.length||rt||C||!So(G,r)||(b=[this]),b},_handleDOMEvent:function(r){var h;this._loaded&&!Rn(r)&&("mousedown"!==(h=r.type)&&"keypress"!==h&&"keyup"!==h&&"keydown"!==h||He(r.target||r.srcElement),this._fireDOMEvent(r,h))},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,h,m){var b;if("click"===r.type&&((b=ft({},r)).type="preclick",this._fireDOMEvent(b,b.type,m)),!r._stopped&&(m=(m||[]).concat(this._findEventTargets(r,h))).length){var C=m[0];"contextmenu"===h&&C.listens(h,!0)&&an(r);var G,rt={originalEvent:r};"keypress"!==r.type&&"keydown"!==r.type&&"keyup"!==r.type&&(rt.containerPoint=(G=C.getLatLng&&(!C._radius||C._radius<=10))?this.latLngToContainerPoint(C.getLatLng()):this.mouseEventToContainerPoint(r),rt.layerPoint=this.containerPointToLayerPoint(rt.containerPoint),rt.latlng=G?C.getLatLng():this.layerPointToLatLng(rt.layerPoint));for(var gt=0;gt<m.length;gt++)if(m[gt].fire(h,rt,!0),rt.originalEvent._stopped||!1===m[gt].options.bubblingMouseEvents&&-1!==Fe(this._mouseEvents,h))return}},_draggableMoved:function(r){return(r=r.dragging&&r.dragging.enabled()?r:this).dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,h=this._handlers.length;r<h;r++)this._handlers[r].disable()},whenReady:function(r,h){return this._loaded?r.call(h||this,{target:this}):this.on("load",r,h),this},_getMapPanePos:function(){return ei(this._mapPane)||new Ee(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,h){return(r&&void 0!==h?this._getNewPixelOrigin(r,h):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,h){var m=this.getSize()._divideBy(2);return this.project(r,h)._subtract(m)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,h,m){var b=this._getNewPixelOrigin(m,h);return this.project(r,h)._subtract(b)},_latLngBoundsToNewLayerBounds:function(r,h,m){var b=this._getNewPixelOrigin(m,h);return Ut([this.project(r.getSouthWest(),h)._subtract(b),this.project(r.getNorthWest(),h)._subtract(b),this.project(r.getSouthEast(),h)._subtract(b),this.project(r.getNorthEast(),h)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,h,m){if(!m)return r;var b=this.project(r,h),C=this.getSize().divideBy(2),G=new je(b.subtract(C),b.add(C)),rt=this._getBoundsOffset(G,m,h);return rt.round().equals([0,0])?r:this.unproject(b.add(rt),h)},_limitOffset:function(r,h){if(!h)return r;var m=this.getPixelBounds(),b=new je(m.min.add(r),m.max.add(r));return r.add(this._getBoundsOffset(b,h))},_getBoundsOffset:function(r,h,m){var b=Ut(this.project(h.getNorthEast(),m),this.project(h.getSouthWest(),m)),C=b.min.subtract(r.min),G=b.max.subtract(r.max);return new Ee(this._rebound(C.x,-G.x),this._rebound(C.y,-G.y))},_rebound:function(r,h){return 0<r+h?Math.round(r-h)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(h))},_limitZoom:function(r){var h=this.getMinZoom(),m=this.getMaxZoom(),b=di?this.options.zoomSnap:1;return b&&(r=Math.round(r/b)*b),Math.max(h,Math.min(m,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Vt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,h){var m=this._getCenterOffset(r)._trunc();return!(!0!==(h&&h.animate)&&!this.getSize().contains(m)||(this.panBy(m,h),0))},_createAnimProxy:function(){var r=this._proxy=jt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(h){var m=mt,b=this._proxy.style[m];Ne(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),b===this._proxy.style[m]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Gt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),h=this.getZoom();Ne(this._proxy,this.project(r,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(r){this._animatingZoom&&0<=r.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,h,m){if(this._animatingZoom)return!0;if(m=m||{},!this._zoomAnimated||!1===m.animate||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(h),C=this._getCenterOffset(r)._divideBy(1-1/b);return!(!0!==m.animate&&!this.getSize().contains(C)||(Me(function(){this._moveStart(!0,!1)._animateZoom(r,h,!0)},this),0))},_animateZoom:function(r,h,m,b){this._mapPane&&(m&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=h,re(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:h,noUpdate:b}),setTimeout(xi(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Vt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),Me(function(){this._moveEnd(!0)},this))}});function Aa(r){return new Gr(r)}var Gr=Zt.extend({options:{position:"topright"},initialize:function(r){Hi(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var h=this._map;return h&&h.removeControl(this),this.options.position=r,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var h=this._container=this.onAdd(r),m=this.getPosition(),b=r._controlCorners[m];return re(h,"leaflet-control"),-1!==m.indexOf("bottom")?b.insertBefore(h,b.firstChild):b.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map&&(Gt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null),this},_refocusOnMap:function(r){this._map&&r&&0<r.screenX&&0<r.screenY&&this._map.getContainer().focus()}});gi.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},h="leaflet-",m=this._controlContainer=jt("div",h+"control-container",this._container);function b(C,G){r[C+G]=jt("div",h+C+" "+h+G,m)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)Gt(this._controlCorners[r]);Gt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Zs=Gr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,h,m,b){return m<b?-1:b<m?1:0}},initialize:function(r,h,m){for(var b in Hi(this,m),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,r)this._addLayer(r[b],b);for(b in h)this._addLayer(h[b],b,!0)},onAdd:function(r){this._initLayout(),this._update(),(this._map=r).on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return Gr.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,h){return this._addLayer(r,h),this._map?this._update():this},addOverlay:function(r,h){return this._addLayer(r,h,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var h=this._getLayer(ai(r));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){re(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(re(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):Vt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Vt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",h=this._container=jt("div",r),m=this.options.collapsed;h.setAttribute("aria-haspopup",!0),yr(h),Fi(h);var b=this._section=jt("section",r+"-list");m&&(this._map.on("click",this.collapse,this),tr||Oe(h,{mouseenter:this.expand,mouseleave:this.collapse},this));var C=this._layersLink=jt("a",r+"-toggle",h);C.href="#",C.title="Layers",D?(Oe(C,"click",Mo),Oe(C,"click",this.expand,this)):Oe(C,"focus",this.expand,this),m||this.expand(),this._baseLayersList=jt("div",r+"-base",b),this._separator=jt("div",r+"-separator",b),this._overlaysList=jt("div",r+"-overlays",b),h.appendChild(b)},_getLayer:function(r){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&ai(this._layers[h].layer)===r)return this._layers[h]},_addLayer:function(r,h,m){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:h,overlay:m}),this.options.sortLayers&&this._layers.sort(xi(function(b,C){return this.options.sortFunction(b.layer,C.layer,b.name,C.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;St(this._baseLayersList),St(this._overlaysList),this._layerControlInputs=[];for(var r,h,m,b=0,C=0;C<this._layers.length;C++)this._addItem(m=this._layers[C]),h=h||m.overlay,r=r||!m.overlay,b+=m.overlay?0:1;return this.options.hideSingleBase&&(this._baseLayersList.style.display=(r=r&&1<b)?"":"none"),this._separator.style.display=h&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var h=this._getLayer(ai(r.target)),m=h.overlay?"add"===r.type?"overlayadd":"overlayremove":"add"===r.type?"baselayerchange":null;m&&this._map.fire(m,h)},_createRadioElement:function(r,h){var m='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(h?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=m,b.firstChild},_addItem:function(r){var h,m=document.createElement("label"),b=this._map.hasLayer(r.layer);r.overlay?((h=document.createElement("input")).type="checkbox",h.className="leaflet-control-layers-selector",h.defaultChecked=b):h=this._createRadioElement("leaflet-base-layers_"+ai(this),b),this._layerControlInputs.push(h),h.layerId=ai(r.layer),Oe(h,"click",this._onInputClick,this);var C=document.createElement("span");C.innerHTML=" "+r.name;var G=document.createElement("div");return m.appendChild(G),G.appendChild(h),G.appendChild(C),(r.overlay?this._overlaysList:this._baseLayersList).appendChild(m),this._checkDisabledLayers(),m},_onInputClick:function(){var r,h,m=this._layerControlInputs,b=[],C=[];this._handlingClick=!0;for(var G=m.length-1;0<=G;G--)h=this._getLayer((r=m[G]).layerId).layer,r.checked?b.push(h):r.checked||C.push(h);for(G=0;G<C.length;G++)this._map.hasLayer(C[G])&&this._map.removeLayer(C[G]);for(G=0;G<b.length;G++)this._map.hasLayer(b[G])||this._map.addLayer(b[G]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var r,h,m=this._layerControlInputs,b=this._map.getZoom(),C=m.length-1;0<=C;C--)h=this._getLayer((r=m[C]).layerId).layer,r.disabled=void 0!==h.options.minZoom&&b<h.options.minZoom||void 0!==h.options.maxZoom&&b>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Na=Gr.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(r){var h="leaflet-control-zoom",m=jt("div",h+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,h+"-in",m,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,h+"-out",m,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),m},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,h,m,b,C){var G=jt("a",m,b);return G.innerHTML=r,G.href="#",G.title=h,G.setAttribute("role","button"),G.setAttribute("aria-label",h),yr(G),Oe(G,"click",Mo),Oe(G,"click",C,this),Oe(G,"click",this._refocusOnMap,this),G},_updateDisabled:function(){var r=this._map,h="leaflet-disabled";Vt(this._zoomInButton,h),Vt(this._zoomOutButton,h),!this._disabled&&r._zoom!==r.getMinZoom()||re(this._zoomOutButton,h),!this._disabled&&r._zoom!==r.getMaxZoom()||re(this._zoomInButton,h)}});gi.mergeOptions({zoomControl:!0}),gi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Na,this.addControl(this.zoomControl))});var ns=Gr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var h="leaflet-control-scale",m=jt("div",h),b=this.options;return this._addScales(b,h+"-line",m),r.on(b.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),m},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,h,m){r.metric&&(this._mScale=jt("div",h,m)),r.imperial&&(this._iScale=jt("div",h,m))},_update:function(){var r=this._map,h=r.getSize().y/2,m=r.distance(r.containerPointToLatLng([0,h]),r.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(m)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var h=this._getRoundNum(r);this._updateScale(this._mScale,h<1e3?h+" m":h/1e3+" km",h/r)},_updateImperial:function(r){var h,m,b,C=3.2808399*r;5280<C?(m=this._getRoundNum(h=C/5280),this._updateScale(this._iScale,m+" mi",m/h)):(b=this._getRoundNum(C),this._updateScale(this._iScale,b+" ft",b/C))},_updateScale:function(r,h,m){r.style.width=Math.round(this.options.maxWidth*m)+"px",r.innerHTML=h},_getRoundNum:function(r){var h=Math.pow(10,(Math.floor(r)+"").length-1),m=r/h;return h*(10<=m?10:5<=m?5:3<=m?3:2<=m?2:1)}}),no=Gr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(r){Hi(this,r),this._attributions={}},onAdd:function(r){for(var h in(r.attributionControl=this)._container=jt("div","leaflet-control-attribution"),yr(this._container),r._layers)r._layers[h].getAttribution&&this.addAttribution(r._layers[h].getAttribution());return this._update(),this._container},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r&&(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update()),this},removeAttribution:function(r){return r&&this._attributions[r]&&(this._attributions[r]--,this._update()),this},_update:function(){if(this._map){var r=[];for(var h in this._attributions)this._attributions[h]&&r.push(h);var m=[];this.options.prefix&&m.push(this.options.prefix),r.length&&m.push(r.join(", ")),this._container.innerHTML=m.join(" | ")}}});gi.mergeOptions({attributionControl:!0}),gi.addInitHook(function(){this.options.attributionControl&&(new no).addTo(this)}),Gr.Layers=Zs,Gr.Zoom=Na,Gr.Scale=ns,Gr.Attribution=no,Aa.layers=function(r,h,m){return new Zs(r,h,m)},Aa.zoom=function(r){return new Na(r)},Aa.scale=function(r){return new ns(r)},Aa.attribution=function(r){return new no(r)};var gr=Zt.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled&&(this._enabled=!1,this.removeHooks()),this},enabled:function(){return!!this._enabled}});gr.addTo=function(r,h){return r.addHandler(h,this),this};var la,qs={Events:ln},ja=D?"touchstart mousedown":"mousedown",ro={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Do={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Wr=tn.extend({options:{clickTolerance:3},initialize:function(r,h,m,b){Hi(this,b),this._element=r,this._dragStartTarget=h||r,this._preventOutline=m},enable:function(){this._enabled||(Oe(this._dragStartTarget,ja,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Wr._dragging===this&&this.finishDrag(),en(this._dragStartTarget,ja,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){var h,m;!r._simulated&&this._enabled&&(this._moved=!1,Jt(this._element,"leaflet-zoom-anim")||Wr._dragging||r.shiftKey||1!==r.which&&1!==r.button&&!r.touches||((Wr._dragging=this)._preventOutline&&He(this._element),Xi(),ot(),this._moving||(this.fire("down"),h=r.touches?r.touches[0]:r,m=Mn(this._element),this._startPoint=new Ee(h.clientX,h.clientY),this._parentScale=Ho(m),Oe(document,Do[r.type],this._onMove,this),Oe(document,ro[r.type],this._onUp,this))))},_onMove:function(r){var h,m;!r._simulated&&this._enabled&&(r.touches&&1<r.touches.length?this._moved=!0:((m=new Ee((h=r.touches&&1===r.touches.length?r.touches[0]:r).clientX,h.clientY)._subtract(this._startPoint)).x||m.y)&&(Math.abs(m.x)+Math.abs(m.y)<this.options.clickTolerance||(m.x/=this._parentScale.x,m.y/=this._parentScale.y,an(r),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=ei(this._element).subtract(m),re(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),re(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(m),this._moving=!0,le(this._animRequest),this._lastEvent=r,this._animRequest=Me(this._updatePosition,this,!0))))},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),Ti(this._element,this._newPos),this.fire("drag",r)},_onUp:function(r){!r._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var r in Vt(document.body,"leaflet-dragging"),this._lastTarget&&(Vt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Do)en(document,Do[r],this._onMove,this),en(document,ro[r],this._onUp,this);yi(),ut(),this._moved&&this._moving&&(le(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Wr._dragging=!1}});function ua(r,h){if(!h||!r.length)return r.slice();var m=h*h;return function(b,C){var G=b.length,rt=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(G);rt[0]=rt[G-1]=1,function Lt(oe,de,Qe,O,y){var E,Z,Y,ct=0;for(Z=O+1;Z<=y-1;Z++)ct<(Y=Ki(oe[Z],oe[O],oe[y],!0))&&(E=Z,ct=Y);Qe<ct&&(de[E]=1,Lt(oe,de,Qe,O,E),Lt(oe,de,Qe,E,y))}(b,rt,C,0,G-1);var gt,kt=[];for(gt=0;gt<G;gt++)rt[gt]&&kt.push(b[gt]);return kt}(r=function(b,C){for(var G=[b[0]],rt=1,gt=0,kt=b.length;rt<kt;rt++)void 0,void 0,(de=(oe=b[gt]).x-(Lt=b[rt]).x)*de+(Qe=oe.y-Lt.y)*Qe>C&&(G.push(b[rt]),gt=rt);var Lt,oe,de,Qe;return gt<kt-1&&G.push(b[kt-1]),G}(r,m),m)}function Xo(r,h,m){return Math.sqrt(Ki(r,h,m,!0))}function Ko(r,h,m,b,C){var G,rt,gt,kt=b?la:In(r,m),Lt=In(h,m);for(la=Lt;;){if(!(kt|Lt))return[r,h];if(kt&Lt)return!1;gt=In(rt=Hn(r,h,G=kt||Lt,m,C),m),G===kt?(r=rt,kt=gt):(h=rt,Lt=gt)}}function Hn(r,h,m,b,C){var G,rt,gt=h.x-r.x,kt=h.y-r.y,Lt=b.min,oe=b.max;return 8&m?(G=r.x+gt*(oe.y-r.y)/kt,rt=oe.y):4&m?(G=r.x+gt*(Lt.y-r.y)/kt,rt=Lt.y):2&m?(G=oe.x,rt=r.y+kt*(oe.x-r.x)/gt):1&m&&(G=Lt.x,rt=r.y+kt*(Lt.x-r.x)/gt),new Ee(G,rt,C)}function In(r,h){var m=0;return r.x<h.min.x?m|=1:r.x>h.max.x&&(m|=2),r.y<h.min.y?m|=4:r.y>h.max.y&&(m|=8),m}function Ki(r,h,m,b){var C,G=h.x,rt=h.y,gt=m.x-G,kt=m.y-rt,Lt=gt*gt+kt*kt;return 0<Lt&&(1<(C=((r.x-G)*gt+(r.y-rt)*kt)/Lt)?(G=m.x,rt=m.y):0<C&&(G+=gt*C,rt+=kt*C)),gt=r.x-G,kt=r.y-rt,b?gt*gt+kt*kt:new Ee(G,rt)}function vr(r){return!ee(r[0])||"object"!=typeof r[0][0]&&void 0!==r[0][0]}function Es(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),vr(r)}var el={simplify:ua,pointToSegmentDistance:Xo,closestPointOnSegment:function(r,h,m){return Ki(r,h,m)},clipSegment:Ko,_getEdgeIntersection:Hn,_getBitCode:In,_sqClosestPointOnSegment:Ki,isFlat:vr,_flat:Es};function Is(r,h,m){for(var b,C,G,rt,gt,kt,Lt,oe=[1,4,2,8],de=0,Qe=r.length;de<Qe;de++)r[de]._code=In(r[de],h);for(G=0;G<4;G++){for(kt=oe[G],b=[],de=0,C=(Qe=r.length)-1;de<Qe;C=de++)gt=r[C],(rt=r[de])._code&kt?gt._code&kt||((Lt=Hn(gt,rt,kt,h,m))._code=In(Lt,h),b.push(Lt)):(gt._code&kt&&((Lt=Hn(gt,rt,kt,h,m))._code=In(Lt,h),b.push(Lt)),b.push(rt));r=b}return r}var Va,rs={clipPolygon:Is},Za={project:function(r){return new Ee(r.lng,r.lat)},unproject:function(r){return new We(r.y,r.x)},bounds:new je([-180,-90],[180,90])},qa={R:6378137,R_MINOR:6356752.314245179,bounds:new je([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(r){var h=Math.PI/180,m=this.R,gt=r.lat*h,b=this.R_MINOR/m,C=Math.sqrt(1-b*b),G=C*Math.sin(gt),rt=Math.tan(Math.PI/4-gt/2)/Math.pow((1-G)/(1+G),C/2);return gt=-m*Math.log(Math.max(rt,1e-10)),new Ee(r.lng*h*m,gt)},unproject:function(r){for(var h,m=180/Math.PI,b=this.R,C=this.R_MINOR/b,G=Math.sqrt(1-C*C),rt=Math.exp(-r.y/b),gt=Math.PI/2-2*Math.atan(rt),kt=0,Lt=.1;kt<15&&1e-7<Math.abs(Lt);kt++)h=G*Math.sin(gt),h=Math.pow((1-h)/(1+h),G/2),gt+=Lt=Math.PI/2-2*Math.atan(rt*h)-gt;return new We(gt*m,r.x*m/b)}},Ps={LonLat:Za,Mercator:qa,SphericalMercator:zr},As=ft({},on,{code:"EPSG:3395",projection:qa,transformation:_e(Va=.5/(Math.PI*qa.R),.5,-Va,.5)}),Cs=ft({},on,{code:"EPSG:4326",projection:Za,transformation:_e(1/180,1,-1/180,.5)}),Ca=ft({},Ni,{projection:Za,transformation:_e(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,h){var m=h.lng-r.lng,b=h.lat-r.lat;return Math.sqrt(m*m+b*b)},infinite:!0});Ni.Earth=on,Ni.EPSG3395=As,Ni.EPSG3857=Vn,Ni.EPSG900913=Wo,Ni.EPSG4326=Cs,Ni.Simple=Ca;var xr=tn.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[ai(r)]=this},removeInteractiveTarget:function(r){return delete this._map._targets[ai(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var h,m=r.target;m.hasLayer(this)&&(this._map=m,this._zoomAnimated=m._zoomAnimated,this.getEvents&&(h=this.getEvents(),m.on(h,this),this.once("remove",function(){m.off(h,this)},this)),this.onAdd(m),this.getAttribution&&m.attributionControl&&m.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),m.fire("layeradd",{layer:this}))}});gi.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var h=ai(r);return this._layers[h]||((this._layers[h]=r)._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r)),this},removeLayer:function(r){var h=ai(r);return this._layers[h]&&(this._loaded&&r.onRemove(this),r.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(r.getAttribution()),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null),this},hasLayer:function(r){return!!r&&ai(r)in this._layers},eachLayer:function(r,h){for(var m in this._layers)r.call(h,this._layers[m]);return this},_addLayers:function(r){for(var h=0,m=(r=r?ee(r)?r:[r]:[]).length;h<m;h++)this.addLayer(r[h])},_addZoomLimit:function(r){!isNaN(r.options.maxZoom)&&isNaN(r.options.minZoom)||(this._zoomBoundLayers[ai(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var h=ai(r);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,h=-1/0,m=this._getZoomSpan();for(var b in this._zoomBoundLayers){var C=this._zoomBoundLayers[b].options;r=void 0===C.minZoom?r:Math.min(r,C.minZoom),h=void 0===C.maxZoom?h:Math.max(h,C.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=r===1/0?void 0:r,m!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ha=xr.extend({initialize:function(r,h){var m,b;if(Hi(this,h),this._layers={},r)for(m=0,b=r.length;m<b;m++)this.addLayer(r[m])},addLayer:function(r){var h=this.getLayerId(r);return this._layers[h]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var h=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(r){return!!r&&("number"==typeof r?r:this.getLayerId(r))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var h,m,b=Array.prototype.slice.call(arguments,1);for(h in this._layers)(m=this._layers[h])[r]&&m[r].apply(m,b);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,h){for(var m in this._layers)r.call(h,this._layers[m]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:ai}),hn=ha.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),ha.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),ha.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new Pi;for(var h in this._layers){var m=this._layers[h];r.extend(m.getBounds?m.getBounds():m.getLatLng())}return r}}),Jo=Zt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(r){Hi(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,h){var m=this._getIconUrl(r);if(!m){if("icon"===r)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(m,h&&"IMG"===h.tagName?h:null);return this._setIconStyles(b,r),b},_setIconStyles:function(r,h){var m=this.options,b=m[h+"Size"];"number"==typeof b&&(b=[b,b]);var C=ti(b),G=ti("shadow"===h&&m.shadowAnchor||m.iconAnchor||C&&C.divideBy(2,!0));r.className="leaflet-marker-"+h+" "+(m.className||""),G&&(r.style.marginLeft=-G.x+"px",r.style.marginTop=-G.y+"px"),C&&(r.style.width=C.x+"px",r.style.height=C.y+"px")},_createImg:function(r,h){return(h=h||document.createElement("img")).src=r,h},_getIconUrl:function(r){return pt&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}}),oo=Jo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return oo.imagePath||(oo.imagePath=this._detectIconPath()),(this.options.imagePath||oo.imagePath)+Jo.prototype._getIconUrl.call(this,r)},_detectIconPath:function(){var r=jt("div","leaflet-default-icon-path",document.body),h=Bt(r,"background-image")||Bt(r,"backgroundImage");return document.body.removeChild(r),null===h||0!==h.indexOf("url")?"":h.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Bo=gr.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new Wr(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),re(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Vt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var h,m=this._marker,b=m._map,C=this._marker.options.autoPanSpeed,G=this._marker.options.autoPanPadding,rt=ei(m._icon),gt=b.getPixelBounds(),kt=b.getPixelOrigin(),Lt=Ut(gt.min._subtract(kt).add(G),gt.max._subtract(kt).subtract(G));Lt.contains(rt)||(h=ti((Math.max(Lt.max.x,rt.x)-Lt.max.x)/(gt.max.x-Lt.max.x)-(Math.min(Lt.min.x,rt.x)-Lt.min.x)/(gt.min.x-Lt.min.x),(Math.max(Lt.max.y,rt.y)-Lt.max.y)/(gt.max.y-Lt.max.y)-(Math.min(Lt.min.y,rt.y)-Lt.min.y)/(gt.min.y-Lt.min.y)).multiplyBy(C),b.panBy(h,{animate:!1}),this._draggable._newPos._add(h),this._draggable._startPos._add(h),Ti(m._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=Me(this._adjustPan.bind(this,r)))},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(le(this._panRequest),this._panRequest=Me(this._adjustPan.bind(this,r)))},_onDrag:function(r){var h=this._marker,m=h._shadow,b=ei(h._icon),C=h._map.layerPointToLatLng(b);m&&Ti(m,b),h._latlng=C,r.latlng=C,r.oldLatLng=this._oldLatLng,h.fire("move",r).fire("drag",r)},_onDragEnd:function(r){le(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),Eo=xr.extend({options:{icon:new oo,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,h){Hi(this,h),this._latlng=bi(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var h=this._latlng;return this._latlng=bi(r),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){var r;return this._icon&&this._map&&(r=this._map.latLngToLayerPoint(this._latlng).round(),this._setPos(r)),this},_initIcon:function(){var r=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),m=r.icon.createIcon(this._icon),b=!1;m!==this._icon&&(this._icon&&this._removeIcon(),b=!0,r.title&&(m.title=r.title),"IMG"===m.tagName&&(m.alt=r.alt||"")),re(m,h),r.keyboard&&(m.tabIndex="0"),this._icon=m,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var C=r.icon.createShadow(this._shadow),G=!1;C!==this._shadow&&(this._removeShadow(),G=!0),C&&(re(C,h),C.alt=""),this._shadow=C,r.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),C&&G&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),Gt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Gt(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&Ti(this._icon,r),this._shadow&&Ti(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var h=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(h)},_initInteraction:function(){var r;this.options.interactive&&(re(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Bo&&(r=this.options.draggable,this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Bo(this),r&&this.dragging.enable()))},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&Ae(this._icon,r),this._shadow&&Ae(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),kr=xr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return Hi(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),_o=kr.extend({options:{fill:!0,radius:10},initialize:function(r,h){Hi(this,h),this._latlng=bi(r),this._radius=this.options.radius},setLatLng:function(r){var h=this._latlng;return this._latlng=bi(r),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var h=r&&r.radius||this._radius;return kr.prototype.setStyle.call(this,r),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,h=this._radiusY||r,m=this._clickTolerance(),b=[r+m,h+m];this._pxBounds=new je(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Oo=_o.extend({initialize:function(r,h,m){if("number"==typeof h&&(h=ft({},m,{radius:h})),Hi(this,h),this._latlng=bi(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new Pi(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:kr.prototype.setStyle,_project:function(){var r,h,m,b,C,G,rt,gt,kt=this._latlng.lng,Lt=this._latlng.lat,oe=this._map,de=oe.options.crs;de.distance===on.distance?(r=Math.PI/180,m=oe.project([Lt+(h=this._mRadius/on.R/r),kt]),b=oe.project([Lt-h,kt]),C=m.add(b).divideBy(2),G=oe.unproject(C).lat,rt=Math.acos((Math.cos(h*r)-Math.sin(Lt*r)*Math.sin(G*r))/(Math.cos(Lt*r)*Math.cos(G*r)))/r,!isNaN(rt)&&0!==rt||(rt=h/Math.cos(Math.PI/180*Lt)),this._point=C.subtract(oe.getPixelOrigin()),this._radius=isNaN(rt)?0:C.x-oe.project([G,kt-rt]).x,this._radiusY=C.y-m.y):(gt=de.unproject(de.project(this._latlng).subtract([this._mRadius,0])),this._point=oe.latLngToLayerPoint(this._latlng),this._radius=this._point.x-oe.latLngToLayerPoint(gt).x),this._updateBounds()}}),br=kr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,h){Hi(this,h),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var h,m,b=1/0,C=null,G=Ki,rt=0,gt=this._parts.length;rt<gt;rt++)for(var kt=this._parts[rt],Lt=1,oe=kt.length;Lt<oe;Lt++){var de=G(r,h=kt[Lt-1],m=kt[Lt],!0);de<b&&(b=de,C=G(r,h,m))}return C&&(C.distance=Math.sqrt(b)),C},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var r,h,m,b,C,G,rt,gt=this._rings[0],kt=gt.length;if(!kt)return null;for(h=r=0;r<kt-1;r++)h+=gt[r].distanceTo(gt[r+1])/2;if(0===h)return this._map.layerPointToLatLng(gt[0]);for(b=r=0;r<kt-1;r++)if(h<(b+=m=(C=gt[r]).distanceTo(G=gt[r+1])))return this._map.layerPointToLatLng([G.x-(rt=(b-h)/m)*(G.x-C.x),G.y-rt*(G.y-C.y)])},getBounds:function(){return this._bounds},addLatLng:function(r,h){return h=h||this._defaultShape(),r=bi(r),h.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new Pi,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return vr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var h=[],m=vr(r),b=0,C=r.length;b<C;b++)m?(h[b]=bi(r[b]),this._bounds.extend(h[b])):h[b]=this._convertLatLngs(r[b]);return h},_project:function(){var r=new je;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),h=new Ee(r,r);this._pxBounds=new je([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)])},_projectLatlngs:function(r,h,m){var b,C,rt=r.length;if(r[0]instanceof We){for(C=[],b=0;b<rt;b++)C[b]=this._map.latLngToLayerPoint(r[b]),m.extend(C[b]);h.push(C)}else for(b=0;b<rt;b++)this._projectLatlngs(r[b],h,m)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(r))if(this.options.noClip)this._parts=this._rings;else for(var h,m,b,C,G=this._parts,rt=0,gt=0,kt=this._rings.length;rt<kt;rt++)for(h=0,m=(C=this._rings[rt]).length;h<m-1;h++)(b=Ko(C[h],C[h+1],r,h,!0))&&(G[gt]=G[gt]||[],G[gt].push(b[0]),b[1]===C[h+1]&&h!==m-2||(G[gt].push(b[1]),gt++))},_simplifyPoints:function(){for(var r=this._parts,h=this.options.smoothFactor,m=0,b=r.length;m<b;m++)r[m]=ua(r[m],h)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,h){var m,b,C,G,rt,gt,kt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(m=0,G=this._parts.length;m<G;m++)for(b=0,C=(rt=(gt=this._parts[m]).length)-1;b<rt;C=b++)if((h||0!==b)&&Xo(r,gt[C],gt[b])<=kt)return!0;return!1}});br._flat=Es;var Mr=br.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var r,h,m,b,C,G,rt,gt,Lt=this._rings[0],oe=Lt.length;if(!oe)return null;for(r=G=rt=gt=0,h=oe-1;r<oe;h=r++)rt+=((m=Lt[r]).x+(b=Lt[h]).x)*(C=m.y*b.x-b.y*m.x),gt+=(m.y+b.y)*C,G+=3*C;return this._map.layerPointToLatLng(0===G?Lt[0]:[rt/G,gt/G])},_convertLatLngs:function(r){var h=br.prototype._convertLatLngs.call(this,r),m=h.length;return 2<=m&&h[0]instanceof We&&h[0].equals(h[m-1])&&h.pop(),h},_setLatLngs:function(r){br.prototype._setLatLngs.call(this,r),vr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return vr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var m=this._renderer._bounds,r=this.options.weight,h=new Ee(r,r);if(m=new je(m.min.subtract(h),m.max.add(h)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(m))if(this.options.noClip)this._parts=this._rings;else for(var b,C=0,G=this._rings.length;C<G;C++)(b=Is(this._rings[C],m,!0)).length&&this._parts.push(b)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var h,m,b,C,G,rt,gt,kt,Lt=!1;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(C=0,gt=this._parts.length;C<gt;C++)for(G=0,rt=(kt=(h=this._parts[C]).length)-1;G<kt;rt=G++)(m=h[G]).y>r.y!=(b=h[rt]).y>r.y&&r.x<(b.x-m.x)*(r.y-m.y)/(b.y-m.y)+m.x&&(Lt=!Lt);return Lt||br.prototype._containsPoint.call(this,r,!0)}}),wr=hn.extend({initialize:function(r,h){Hi(this,h),this._layers={},r&&this.addData(r)},addData:function(r){var h,m,b,C=ee(r)?r:r.features;if(C){for(h=0,m=C.length;h<m;h++)((b=C[h]).geometries||b.geometry||b.features||b.coordinates)&&this.addData(b);return this}var G=this.options;if(G.filter&&!G.filter(r))return this;var rt=Ga(r,G);return rt?(rt.feature=Ha(r),rt.defaultOptions=rt.options,this.resetStyle(rt),G.onEachFeature&&G.onEachFeature(r,rt),this.addLayer(rt)):this},resetStyle:function(r){return void 0===r?this.eachLayer(this.resetStyle,this):(r.options=ft({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(h){this._setLayerStyle(h,r)},this)},_setLayerStyle:function(r,h){r.setStyle&&("function"==typeof h&&(h=h(r.feature)),r.setStyle(h))}});function Ga(r,h){var m,b,C,G,rt="Feature"===r.type?r.geometry:r,gt=rt?rt.coordinates:null,kt=[],Lt=h&&h.pointToLayer,oe=h&&h.coordsToLatLng||Ls;if(!gt&&!rt)return null;switch(rt.type){case"Point":return Li(Lt,r,m=oe(gt),h);case"MultiPoint":for(C=0,G=gt.length;C<G;C++)m=oe(gt[C]),kt.push(Li(Lt,r,m,h));return new hn(kt);case"LineString":case"MultiLineString":return b=ca(gt,"LineString"===rt.type?0:1,oe),new br(b,h);case"Polygon":case"MultiPolygon":return b=ca(gt,"Polygon"===rt.type?1:2,oe),new Mr(b,h);case"GeometryCollection":for(C=0,G=rt.geometries.length;C<G;C++){var de=Ga({geometry:rt.geometries[C],type:"Feature",properties:r.properties},h);de&&kt.push(de)}return new hn(kt);default:throw new Error("Invalid GeoJSON object.")}}function Li(r,h,m,b){return r?r(h,m):new Eo(m,b&&b.markersInheritOptions&&b)}function Ls(r){return new We(r[1],r[0],r[2])}function ca(r,h,m){for(var b,C=[],G=0,rt=r.length;G<rt;G++)b=h?ca(r[G],h-1,m):(m||Ls)(r[G]),C.push(b);return C}function Wa(r,h){return h="number"==typeof h?h:6,void 0!==r.alt?[Yr(r.lng,h),Yr(r.lat,h),Yr(r.alt,h)]:[Yr(r.lng,h),Yr(r.lat,h)]}function La(r,h,m,b){for(var C=[],G=0,rt=r.length;G<rt;G++)C.push(h?La(r[G],h-1,m,b):Wa(r[G],b));return!h&&m&&C.push(C[0]),C}function Hr(r,h){return r.feature?ft({},r.feature,{geometry:h}):Ha(h)}function Ha(r){return"Feature"===r.type||"FeatureCollection"===r.type?r:{type:"Feature",properties:{},geometry:r}}var Yo={toGeoJSON:function(r){return Hr(this,{type:"Point",coordinates:Wa(this.getLatLng(),r)})}};function $o(r,h){return new wr(r,h)}Eo.include(Yo),Oo.include(Yo),_o.include(Yo),br.include({toGeoJSON:function(r){var h=!vr(this._latlngs);return Hr(this,{type:(h?"Multi":"")+"LineString",coordinates:La(this._latlngs,h?1:0,!1,r)})}}),Mr.include({toGeoJSON:function(r){var h=!vr(this._latlngs),m=h&&!vr(this._latlngs[0]),b=La(this._latlngs,m?2:h?1:0,!0,r);return h||(b=[b]),Hr(this,{type:(m?"Multi":"")+"Polygon",coordinates:b})}}),ha.include({toMultiPoint:function(r){var h=[];return this.eachLayer(function(m){h.push(m.toGeoJSON(r).geometry.coordinates)}),Hr(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(r){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===h)return this.toMultiPoint(r);var m="GeometryCollection"===h,b=[];return this.eachLayer(function(C){var G,rt;C.toGeoJSON&&(G=C.toGeoJSON(r),m?b.push(G.geometry):"FeatureCollection"===(rt=Ha(G)).type?b.push.apply(b,rt.features):b.push(rt))}),m?Hr(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});var wa=$o,za=xr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,h,m){this._url=r,this._bounds=Ci(h),Hi(this,m)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(re(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Gt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&ie(this._image),this},bringToBack:function(){return this._map&&Kt(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=Ci(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r="IMG"===this._url.tagName,h=this._image=r?this._url:jt("img");re(h,"leaflet-image-layer"),this._zoomAnimated&&re(h,"leaflet-zoom-animated"),this.options.className&&re(h,this.options.className),h.onselectstart=Gi,h.onmousemove=Gi,h.onload=xi(this.fire,this,"load"),h.onerror=xi(this._overlayOnError,this,"error"),!this.options.crossOrigin&&""!==this.options.crossOrigin||(h.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r?this._url=h.src:(h.src=this._url,h.alt=this.options.alt)},_animateZoom:function(r){var h=this._map.getZoomScale(r.zoom),m=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;Ne(this._image,m,h)},_reset:function(){var r=this._image,h=new je(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),m=h.getSize();Ti(r,h.min),r.style.width=m.x+"px",r.style.height=m.y+"px"},_updateOpacity:function(){Ae(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)}}),os=za.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var r="VIDEO"===this._url.tagName,h=this._image=r?this._url:jt("video");if(re(h,"leaflet-image-layer"),this._zoomAnimated&&re(h,"leaflet-zoom-animated"),this.options.className&&re(h,this.options.className),h.onselectstart=Gi,h.onmousemove=Gi,h.onloadeddata=xi(this.fire,this,"load"),r){for(var m=h.getElementsByTagName("source"),b=[],C=0;C<m.length;C++)b.push(m[C].src);this._url=0<m.length?b:[h.src]}else{ee(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted;for(var G=0;G<this._url.length;G++){var rt=jt("source");rt.src=this._url[G],h.appendChild(rt)}}}}),as=za.extend({_initImage:function(){var r=this._image=this._url;re(r,"leaflet-image-layer"),this._zoomAnimated&&re(r,"leaflet-zoom-animated"),this.options.className&&re(r,this.options.className),r.onselectstart=Gi,r.onmousemove=Gi}}),Dr=xr.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(r,h){Hi(this,r),this._source=h},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&Ae(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&Ae(this._container,1),this.bringToFront()},onRemove:function(r){r._fadeAnimated?(Ae(this._container,0),this._removeTimeout=setTimeout(xi(Gt,void 0,this._container),200)):Gt(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=bi(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ie(this._container),this},bringToBack:function(){return this._map&&Kt(this._container),this},_prepareOpen:function(r,h,m){if(h instanceof xr||(m=h,h=r),h instanceof hn)for(var b in r._layers){h=r._layers[b];break}if(!m)if(h.getCenter)m=h.getCenter();else{if(!h.getLatLng)throw new Error("Unable to get source layer LatLng.");m=h.getLatLng()}return this._source=h,this.update(),m},_updateContent:function(){if(this._content){var r=this._contentNode,h="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof h)r.innerHTML=h;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){var r,h,m,b,C;this._map&&(r=this._map.latLngToLayerPoint(this._latlng),h=ti(this.options.offset),m=this._getAnchor(),this._zoomAnimated?Ti(this._container,r.add(m)):h=h.add(r).add(m),b=this._containerBottom=-h.y,C=this._containerLeft=-Math.round(this._containerWidth/2)+h.x,this._container.style.bottom=b+"px",this._container.style.left=C+"px")},_getAnchor:function(){return[0,0]}}),Ta=Dr.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r.openPopup(this),this},onAdd:function(r){Dr.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof kr||this._source.on("preclick",Wn))},onRemove:function(r){Dr.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof kr||this._source.off("preclick",Wn))},getEvents:function(){var r=Dr.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this._close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var r,h="leaflet-popup",m=this._container=jt("div",h+" "+(this.options.className||"")+" leaflet-zoom-animated"),b=this._wrapper=jt("div",h+"-content-wrapper",m);this._contentNode=jt("div",h+"-content",b),yr(m),Fi(this._contentNode),Oe(m,"contextmenu",Wn),this._tipContainer=jt("div",h+"-tip-container",m),this._tip=jt("div",h+"-tip",this._tipContainer),this.options.closeButton&&((r=this._closeButton=jt("a",h+"-close-button",m)).href="#close",r.innerHTML="&#215;",Oe(r,"click",this._onCloseButtonClick,this))},_updateLayout:function(){var r=this._contentNode,h=r.style;h.width="",h.whiteSpace="nowrap";var m=r.offsetWidth;m=Math.min(m,this.options.maxWidth),m=Math.max(m,this.options.minWidth),h.width=m+1+"px",h.whiteSpace="",h.height="";var C=this.options.maxHeight,G="leaflet-popup-scrolled";C&&C<r.offsetHeight?(h.height=C+"px",re(r,G)):Vt(r,G),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var h=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),m=this._getAnchor();Ti(this._container,h.add(m))},_adjustPan:function(){var r,h,m,b,C,G,rt,gt,kt,Lt,oe,de;this.options.autoPan&&(this._map._panAnim&&this._map._panAnim.stop(),r=this._map,h=parseInt(Bt(this._container,"marginBottom"),10)||0,b=this._containerWidth,(C=new Ee(this._containerLeft,-(m=this._container.offsetHeight+h)-this._containerBottom))._add(ei(this._container)),G=r.layerPointToContainerPoint(C),rt=ti(this.options.autoPanPadding),gt=ti(this.options.autoPanPaddingTopLeft||rt),kt=ti(this.options.autoPanPaddingBottomRight||rt),Lt=r.getSize(),de=oe=0,G.x+b+kt.x>Lt.x&&(oe=G.x+b-Lt.x+kt.x),G.x-oe-gt.x<0&&(oe=G.x-gt.x),G.y+m+kt.y>Lt.y&&(de=G.y+m-Lt.y+kt.y),G.y-de-gt.y<0&&(de=G.y-gt.y),(oe||de)&&r.fire("autopanstart").panBy([oe,de]))},_onCloseButtonClick:function(r){this._close(),Mo(r)},_getAnchor:function(){return ti(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});gi.mergeOptions({closePopupOnClick:!0}),gi.include({openPopup:function(r,h,m){return r instanceof Ta||(r=new Ta(m).setContent(r)),h&&r.setLatLng(h),this.hasLayer(r)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=r,this.addLayer(r))},closePopup:function(r){return r&&r!==this._popup||(r=this._popup,this._popup=null),r&&this.removeLayer(r),this}}),xr.include({bindPopup:function(r,h){return r instanceof Ta?(Hi(r,h),(this._popup=r)._source=this):(this._popup&&!h||(this._popup=new Ta(h,this)),this._popup.setContent(r)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r,h){return this._popup&&this._map&&(h=this._popup._prepareOpen(this,r,h),this._map.openPopup(this._popup,h)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(r){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(r)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){var h=r.layer||r.target;this._popup&&this._map&&(Mo(r),h instanceof kr?this.openPopup(r.layer||r.target,r.latlng):this._map.hasLayer(this._popup)&&this._popup._source===h?this.closePopup():this.openPopup(h,r.latlng))},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){13===r.originalEvent.keyCode&&this._openPopup(r)}});var yo=Dr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(r){Dr.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(r){Dr.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var r=Dr.prototype.getEvents.call(this);return D&&!this.options.permanent&&(r.preclick=this._close),r},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=jt("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var h,m=this._map,b=this._container,C=m.latLngToContainerPoint(m.getCenter()),G=m.layerPointToContainerPoint(r),rt=this.options.direction,gt=b.offsetWidth,kt=b.offsetHeight,Lt=ti(this.options.offset),oe=this._getAnchor(),de="top"===rt?(h=gt/2,kt):"bottom"===rt?(h=gt/2,0):(h="center"===rt?gt/2:"right"===rt?0:"left"===rt?gt:G.x<C.x?(rt="right",0):(rt="left",gt+2*(Lt.x+oe.x)),kt/2);r=r.subtract(ti(h,de,!0)).add(Lt).add(oe),Vt(b,"leaflet-tooltip-right"),Vt(b,"leaflet-tooltip-left"),Vt(b,"leaflet-tooltip-top"),Vt(b,"leaflet-tooltip-bottom"),re(b,"leaflet-tooltip-"+rt),Ti(b,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&Ae(this._container,r)},_animateZoom:function(r){var h=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(h)},_getAnchor:function(){return ti(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});gi.include({openTooltip:function(r,h,m){return r instanceof yo||(r=new yo(m).setContent(r)),h&&r.setLatLng(h),this.hasLayer(r)?this:this.addLayer(r)},closeTooltip:function(r){return r&&this.removeLayer(r),this}}),xr.include({bindTooltip:function(r,h){return r instanceof yo?(Hi(r,h),(this._tooltip=r)._source=this):(this._tooltip&&!h||(this._tooltip=new yo(h,this)),this._tooltip.setContent(r)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){var h,m;!r&&this._tooltipHandlersAdded||(h=r?"off":"on",m={remove:this.closeTooltip,move:this._moveTooltip},this._tooltip.options.permanent?m.add=this._openTooltip:(m.mouseover=this._openTooltip,m.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(m.mousemove=this._moveTooltip),D&&(m.click=this._openTooltip)),this[h](m),this._tooltipHandlersAdded=!r)},openTooltip:function(r,h){return this._tooltip&&this._map&&(h=this._tooltip._prepareOpen(this,r,h),this._map.openTooltip(this._tooltip,h),this._tooltip.options.interactive&&this._tooltip._container&&(re(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(Vt(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(r){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(r)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_openTooltip:function(r){this._tooltip&&this._map&&this.openTooltip(r.layer||r.target,this._tooltip.options.sticky?r.latlng:void 0)},_moveTooltip:function(r){var h,m,b=r.latlng;this._tooltip.options.sticky&&r.originalEvent&&(h=this._map.mouseEventToContainerPoint(r.originalEvent),m=this._map.containerPointToLayerPoint(h),b=this._map.layerPointToLatLng(m)),this._tooltip.setLatLng(b)}});var pa=Jo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var h,m=r&&"DIV"===r.tagName?r:document.createElement("div"),b=this.options;return b.html instanceof Element?(St(m),m.appendChild(b.html)):m.innerHTML=!1!==b.html?b.html:"",b.bgPos&&(h=ti(b.bgPos),m.style.backgroundPosition=-h.x+"px "+-h.y+"px"),this._setIconStyles(m,"icon"),m},createShadow:function(){return null}});Jo.Default=oo;var Qo=xr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:wi,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){Hi(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),Gt(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ie(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Kt(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Jr(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof Ee?r:new Ee(r,r)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var h,m=this.getPane().children,b=-r(-1/0,1/0),C=0,G=m.length;C<G;C++)h=m[C].style.zIndex,m[C]!==this._container&&h&&(b=r(b,+h));isFinite(b)&&(this.options.zIndex=b+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Qn){Ae(this._container,this.options.opacity);var r=+new Date,h=!1,m=!1;for(var b in this._tiles){var C,G=this._tiles[b];G.current&&G.loaded&&(C=Math.min(1,(r-G.loaded)/200),Ae(G.el,C),C<1?h=!0:(G.active?m=!0:this._onOpaqueTile(G),G.active=!0))}m&&!this._noPrune&&this._pruneTiles(),h&&(le(this._fadeFrame),this._fadeFrame=Me(this._updateOpacity,this))}},_onOpaqueTile:Gi,_initContainer:function(){this._container||(this._container=jt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,h=this.options.maxZoom;if(void 0!==r){for(var m in this._levels)m=Number(m),this._levels[m].el.children.length||m===r?(this._levels[m].el.style.zIndex=h-Math.abs(r-m),this._onUpdateLevel(m)):(Gt(this._levels[m].el),this._removeTilesAtZoom(m),this._onRemoveLevel(m),delete this._levels[m]);var b=this._levels[r],C=this._map;return b||((b=this._levels[r]={}).el=jt("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=h,b.origin=C.project(C.unproject(C.getPixelOrigin()),r).round(),b.zoom=r,this._setZoomTransform(b,C.getCenter(),C.getZoom()),this._onCreateLevel(b)),this._level=b}},_onUpdateLevel:Gi,_onRemoveLevel:Gi,_onCreateLevel:Gi,_pruneTiles:function(){if(this._map){var r,h,m,b=this._map.getZoom();if(b>this.options.maxZoom||b<this.options.minZoom)this._removeAllTiles();else{for(r in this._tiles)(m=this._tiles[r]).retain=m.current;for(r in this._tiles)(m=this._tiles[r]).current&&!m.active&&(this._retainParent((h=m.coords).x,h.y,h.z,h.z-5)||this._retainChildren(h.x,h.y,h.z,h.z+2));for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}}},_removeTilesAtZoom:function(r){for(var h in this._tiles)this._tiles[h].coords.z===r&&this._removeTile(h)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)Gt(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,h,m,b){var C=Math.floor(r/2),G=Math.floor(h/2),rt=m-1,gt=new Ee(+C,+G);gt.z=+rt;var kt=this._tileCoordsToKey(gt),Lt=this._tiles[kt];return Lt&&Lt.active?Lt.retain=!0:(Lt&&Lt.loaded&&(Lt.retain=!0),b<rt&&this._retainParent(C,G,rt,b))},_retainChildren:function(r,h,m,b){for(var C=2*r;C<2*r+2;C++)for(var G=2*h;G<2*h+2;G++){var rt=new Ee(C,G);rt.z=m+1;var gt=this._tileCoordsToKey(rt),kt=this._tiles[gt];kt&&kt.active?kt.retain=!0:(kt&&kt.loaded&&(kt.retain=!0),m+1<b&&this._retainChildren(C,G,m+1,b))}},_resetView:function(r){var h=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var h=this.options;return void 0!==h.minNativeZoom&&r<h.minNativeZoom?h.minNativeZoom:void 0!==h.maxNativeZoom&&h.maxNativeZoom<r?h.maxNativeZoom:r},_setView:function(r,h,m,b){var C=Math.round(h);C=void 0!==this.options.maxZoom&&C>this.options.maxZoom||void 0!==this.options.minZoom&&C<this.options.minZoom?void 0:this._clampZoom(C),b&&!(this.options.updateWhenZooming&&C!==this._tileZoom)||(this._tileZoom=C,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==C&&this._update(r),m||this._pruneTiles(),this._noPrune=!!m),this._setZoomTransforms(r,h)},_setZoomTransforms:function(r,h){for(var m in this._levels)this._setZoomTransform(this._levels[m],r,h)},_setZoomTransform:function(r,h,m){var b=this._map.getZoomScale(m,r.zoom),C=r.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(h,m)).round();di?Ne(r.el,C,b):Ti(r.el,C)},_resetGrid:function(){var r=this._map,h=r.options.crs,m=this._tileSize=this.getTileSize(),b=this._tileZoom,C=this._map.getPixelWorldBounds(this._tileZoom);C&&(this._globalTileRange=this._pxBoundsToTileRange(C)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,h.wrapLng[0]],b).x/m.x),Math.ceil(r.project([0,h.wrapLng[1]],b).x/m.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([h.wrapLat[0],0],b).y/m.x),Math.ceil(r.project([h.wrapLat[1],0],b).y/m.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(r){var h=this._map,m=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),b=h.getZoomScale(m,this._tileZoom),C=h.project(r,this._tileZoom).floor(),G=h.getSize().divideBy(2*b);return new je(C.subtract(G),C.add(G))},_update:function(r){var h=this._map;if(h){var m=this._clampZoom(h.getZoom());if(void 0===r&&(r=h.getCenter()),void 0!==this._tileZoom){var b=this._getTiledPixelBounds(r),C=this._pxBoundsToTileRange(b),G=C.getCenter(),rt=[],gt=this.options.keepBuffer,kt=new je(C.getBottomLeft().subtract([gt,-gt]),C.getTopRight().add([gt,-gt]));if(!(isFinite(C.min.x)&&isFinite(C.min.y)&&isFinite(C.max.x)&&isFinite(C.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Lt in this._tiles){var oe=this._tiles[Lt].coords;oe.z===this._tileZoom&&kt.contains(new Ee(oe.x,oe.y))||(this._tiles[Lt].current=!1)}if(1<Math.abs(m-this._tileZoom))this._setView(r,m);else{for(var de=C.min.y;de<=C.max.y;de++)for(var Qe=C.min.x;Qe<=C.max.x;Qe++){var O,y=new Ee(Qe,de);y.z=this._tileZoom,this._isValidTile(y)&&((O=this._tiles[this._tileCoordsToKey(y)])?O.current=!0:rt.push(y))}if(rt.sort(function(Z,Y){return Z.distanceTo(G)-Y.distanceTo(G)}),0!==rt.length){this._loading||(this._loading=!0,this.fire("loading"));var E=document.createDocumentFragment();for(Qe=0;Qe<rt.length;Qe++)this._addTile(rt[Qe],E);this._level.el.appendChild(E)}}}}},_isValidTile:function(r){var h=this._map.options.crs;if(!h.infinite){var m=this._globalTileRange;if(!h.wrapLng&&(r.x<m.min.x||r.x>m.max.x)||!h.wrapLat&&(r.y<m.min.y||r.y>m.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(r);return Ci(this.options.bounds).overlaps(b)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var h=this._map,m=this.getTileSize(),b=r.scaleBy(m),C=b.add(m);return[h.unproject(b,r.z),h.unproject(C,r.z)]},_tileCoordsToBounds:function(r){var h=this._tileCoordsToNwSe(r),m=new Pi(h[0],h[1]);return this.options.noWrap||(m=this._map.wrapLatLngBounds(m)),m},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var h=r.split(":"),m=new Ee(+h[0],+h[1]);return m.z=+h[2],m},_removeTile:function(r){var h=this._tiles[r];h&&(Gt(h.el),delete this._tiles[r],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){re(r,"leaflet-tile");var h=this.getTileSize();r.style.width=h.x+"px",r.style.height=h.y+"px",r.onselectstart=Gi,r.onmousemove=Gi,Qn&&this.options.opacity<1&&Ae(r,this.options.opacity),tr&&!zn&&(r.style.WebkitBackfaceVisibility="hidden")},_addTile:function(r,h){var m=this._getTilePos(r),b=this._tileCoordsToKey(r),C=this.createTile(this._wrapCoords(r),xi(this._tileReady,this,r));this._initTile(C),this.createTile.length<2&&Me(xi(this._tileReady,this,r,null,C)),Ti(C,m),this._tiles[b]={el:C,coords:r,current:!0},h.appendChild(C),this.fire("tileloadstart",{tile:C,coords:r})},_tileReady:function(r,h,m){h&&this.fire("tileerror",{error:h,tile:m,coords:r});var b=this._tileCoordsToKey(r);(m=this._tiles[b])&&(m.loaded=+new Date,this._map._fadeAnimated?(Ae(m.el,0),le(this._fadeFrame),this._fadeFrame=Me(this._updateOpacity,this)):(m.active=!0,this._pruneTiles()),h||(re(m.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:m.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Qn||!this._map._fadeAnimated?Me(this._pruneTiles,this):setTimeout(xi(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var h=new Ee(this._wrapX?co(r.x,this._wrapX):r.x,this._wrapY?co(r.y,this._wrapY):r.y);return h.z=r.z,h},_pxBoundsToTileRange:function(r){var h=this.getTileSize();return new je(r.min.unscaleBy(h).floor(),r.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}}),Xr=Qo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(r,h){this._url=r,(h=Hi(this,h)).detectRetina&&pt&&0<h.maxZoom&&(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom++):(h.zoomOffset++,h.maxZoom--),h.minZoom=Math.max(0,h.minZoom)),"string"==typeof h.subdomains&&(h.subdomains=h.subdomains.split("")),tr||this.on("tileunload",this._onTileRemove)},setUrl:function(r,h){return this._url===r&&void 0===h&&(h=!0),this._url=r,h||this.redraw(),this},createTile:function(r,h){var m=document.createElement("img");return Oe(m,"load",xi(this._tileOnLoad,this,h,m)),Oe(m,"error",xi(this._tileOnError,this,h,m)),!this.options.crossOrigin&&""!==this.options.crossOrigin||(m.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),m.alt="",m.setAttribute("role","presentation"),m.src=this.getTileUrl(r),m},getTileUrl:function(r){var h,m={r:pt?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};return this._map&&!this._map.options.crs.infinite&&(h=this._globalTileRange.max.y-r.y,this.options.tms&&(m.y=h),m["-y"]=h),Ft(this._url,ft(m,this.options))},_tileOnLoad:function(r,h){Qn?setTimeout(xi(r,this,null,h),0):r(null,h)},_tileOnError:function(r,h,m){var b=this.options.errorTileUrl;b&&h.getAttribute("src")!==b&&(h.src=b),r(m,h)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom;return this.options.zoomReverse&&(r=this.options.maxZoom-r),r+this.options.zoomOffset},_getSubdomain:function(r){var h=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var r,h;for(r in this._tiles)this._tiles[r].coords.z!==this._tileZoom&&((h=this._tiles[r].el).onload=Gi,h.onerror=Gi,h.complete||(h.src=Te,Gt(h),delete this._tiles[r]))},_removeTile:function(r){var h=this._tiles[r];if(h)return Zr||h.el.setAttribute("src",Te),Qo.prototype._removeTile.call(this,r)},_tileReady:function(r,h,m){if(this._map&&(!m||m.getAttribute("src")!==Te))return Qo.prototype._tileReady.call(this,r,h,m)}});function Ai(r,h){return new Xr(r,h)}var Sa=Xr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,h){this._url=r;var m=ft({},this.defaultWmsParams);for(var b in h)b in this.options||(m[b]=h[b]);var C=(h=Hi(this,h)).detectRetina&&pt?2:1,G=this.getTileSize();m.width=G.x*C,m.height=G.y*C,this.wmsParams=m},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code,Xr.prototype.onAdd.call(this,r)},getTileUrl:function(r){var h=this._tileCoordsToNwSe(r),m=this._crs,b=Ut(m.project(h[0]),m.project(h[1])),C=b.min,G=b.max,rt=(1.3<=this._wmsVersion&&this._crs===Cs?[C.y,C.x,G.y,G.x]:[C.x,C.y,G.x,G.y]).join(","),gt=Xr.prototype.getTileUrl.call(this,r);return gt+aa(this.wmsParams,gt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+rt},setParams:function(r,h){return ft(this.wmsParams,r),h||this.redraw(),this}});Xr.WMS=Sa,Ai.wms=function(r,h){return new Sa(r,h)};var Io=xr.extend({options:{padding:.1,tolerance:0},initialize:function(r){Hi(this,r),ai(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&re(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,h){var m=this._map.getZoomScale(h,this._zoom),b=ei(this._container),C=this._map.getSize().multiplyBy(.5+this.options.padding),G=this._map.project(this._center,h),rt=this._map.project(r,h).subtract(G),gt=C.multiplyBy(-m).add(b).add(C).subtract(rt);di?Ne(this._container,gt,m):Ti(this._container,gt)},_reset:function(){for(var r in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,h=this._map.getSize(),m=this._map.containerPointToLayerPoint(h.multiplyBy(-r)).round();this._bounds=new je(m,m.add(h.multiplyBy(1+2*r)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),da=Io.extend({getEvents:function(){var r=Io.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Io.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");Oe(r,"mousemove",this._onMouseMove,this),Oe(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Oe(r,"mouseout",this._handleMouseOut,this),this._ctx=r.getContext("2d")},_destroyContainer:function(){le(this._redrawRequest),delete this._ctx,Gt(this._container),en(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var r in this._redrawBounds=null,this._layers)this._layers[r]._update();this._redraw()}},_update:function(){var r,h,m,b;this._map._animatingZoom&&this._bounds||(Io.prototype._update.call(this),h=this._container,m=(r=this._bounds).getSize(),b=pt?2:1,Ti(h,r.min),h.width=b*m.x,h.height=b*m.y,h.style.width=m.x+"px",h.style.height=m.y+"px",pt&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update"))},_reset:function(){Io.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r);var h=(this._layers[ai(r)]=r)._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var h=r._order,m=h.next,b=h.prev;m?m.prev=b:this._drawLast=b,b?b.next=m:this._drawFirst=m,delete r._order,delete this._layers[ai(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if("string"==typeof r.options.dashArray){for(var h,m=r.options.dashArray.split(/[, ]+/),b=[],C=0;C<m.length;C++){if(h=Number(m[C]),isNaN(h))return;b.push(h)}r.options._dashArray=b}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||Me(this._redraw,this))},_extendRedrawBounds:function(r){var h;r._pxBounds&&(h=(r.options.weight||0)+1,this._redrawBounds=this._redrawBounds||new je,this._redrawBounds.extend(r._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(r._pxBounds.max.add([h,h])))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r,h=this._redrawBounds;h?(r=h.getSize(),this._ctx.clearRect(h.min.x,h.min.y,r.x,r.y)):(this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore())},_draw:function(){var r,h,m=this._redrawBounds;this._ctx.save(),m&&(h=m.getSize(),this._ctx.beginPath(),this._ctx.rect(m.min.x,m.min.y,h.x,h.y),this._ctx.clip()),this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)r=b.layer,(!m||r._pxBounds&&r._pxBounds.intersects(m))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,h){if(this._drawing){var m,b,C,G,rt=r._parts,gt=rt.length,kt=this._ctx;if(gt){for(kt.beginPath(),m=0;m<gt;m++){for(b=0,C=rt[m].length;b<C;b++)kt[b?"lineTo":"moveTo"]((G=rt[m][b]).x,G.y);h&&kt.closePath()}this._fillStroke(kt,r)}}},_updateCircle:function(r){var h,m,b,C;this._drawing&&!r._empty()&&(h=r._point,m=this._ctx,b=Math.max(Math.round(r._radius),1),1!=(C=(Math.max(Math.round(r._radiusY),1)||b)/b)&&(m.save(),m.scale(1,C)),m.beginPath(),m.arc(h.x,h.y/C,b,0,2*Math.PI,!1),1!=C&&m.restore(),this._fillStroke(m,r))},_fillStroke:function(r,h){var m=h.options;m.fill&&(r.globalAlpha=m.fillOpacity,r.fillStyle=m.fillColor||m.color,r.fill(m.fillRule||"evenodd")),m.stroke&&0!==m.weight&&(r.setLineDash&&r.setLineDash(h.options&&h.options._dashArray||[]),r.globalAlpha=m.opacity,r.lineWidth=m.weight,r.strokeStyle=m.color,r.lineCap=m.lineCap,r.lineJoin=m.lineJoin,r.stroke())},_onClick:function(r){for(var h,m,b=this._map.mouseEventToLayerPoint(r),C=this._drawFirst;C;C=C.next)(h=C.layer).options.interactive&&h._containsPoint(b)&&(("click"===r.type||"preclick"!==r.type)&&this._map._draggableMoved(h)||(m=h));m&&(mo(r),this._fireEvent([m],r))},_onMouseMove:function(r){var h;!this._map||this._map.dragging.moving()||this._map._animatingZoom||(h=this._map.mouseEventToLayerPoint(r),this._handleMouseHover(r,h))},_handleMouseOut:function(r){var h=this._hoveredLayer;h&&(Vt(this._container,"leaflet-interactive"),this._fireEvent([h],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,h){if(!this._mouseHoverThrottled){for(var m,b,C=this._drawFirst;C;C=C.next)(m=C.layer).options.interactive&&m._containsPoint(h)&&(b=m);b!==this._hoveredLayer&&(this._handleMouseOut(r),b&&(re(this._container,"leaflet-interactive"),this._fireEvent([b],r,"mouseover"),this._hoveredLayer=b)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],r),this._mouseHoverThrottled=!0,setTimeout(xi(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,h,m){this._map._fireDOMEvent(h,m||h.type,r)},_bringToFront:function(r){var h,m,b=r._order;b&&(m=b.prev,(h=b.next)&&((h.prev=m)?m.next=h:h&&(this._drawFirst=h),b.prev=this._drawLast,(this._drawLast.next=b).next=null,this._drawLast=b,this._requestRedraw(r)))},_bringToBack:function(r){var h,m,b=r._order;b&&(h=b.next,(m=b.prev)&&((m.next=h)?h.prev=m:m&&(this._drawLast=m),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(r)))}});function ss(r){return Qt?new da(r):null}var fa=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{return function(h){return document.createElement("<"+h+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),zs={_initContainer:function(){this._container=jt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Io.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var h=r._container=fa("shape");re(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",r._path=fa("path"),h.appendChild(r._path),this._updateStyle(r),this._layers[ai(r)]=r},_addPath:function(r){var h=r._container;this._container.appendChild(h),r.options.interactive&&r.addInteractiveTarget(h)},_removePath:function(r){var h=r._container;Gt(h),r.removeInteractiveTarget(h),delete this._layers[ai(r)]},_updateStyle:function(r){var h=r._stroke,m=r._fill,b=r.options,C=r._container;C.stroked=!!b.stroke,C.filled=!!b.fill,b.stroke?(h=h||(r._stroke=fa("stroke")),C.appendChild(h),h.weight=b.weight+"px",h.color=b.color,h.opacity=b.opacity,h.dashStyle=b.dashArray?ee(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):"",h.endcap=b.lineCap.replace("butt","flat"),h.joinstyle=b.lineJoin):h&&(C.removeChild(h),r._stroke=null),b.fill?(m=m||(r._fill=fa("fill")),C.appendChild(m),m.color=b.fillColor||b.color,m.opacity=b.fillOpacity):m&&(C.removeChild(m),r._fill=null)},_updateCircle:function(r){var h=r._point.round(),m=Math.round(r._radius),b=Math.round(r._radiusY||m);this._setPath(r,r._empty()?"M0 0":"AL "+h.x+","+h.y+" "+m+","+b+" 0,23592600")},_setPath:function(r,h){r._path.v=h},_bringToFront:function(r){ie(r._container)},_bringToBack:function(r){Kt(r._container)}},ao=Pe?fa:mr,Ro=Io.extend({getEvents:function(){var r=Io.prototype.getEvents.call(this);return r.zoomstart=this._onZoomStart,r},_initContainer:function(){this._container=ao("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ao("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Gt(this._container),en(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){var r,h,m;this._map._animatingZoom&&this._bounds||(Io.prototype._update.call(this),h=(r=this._bounds).getSize(),m=this._container,this._svgSize&&this._svgSize.equals(h)||(this._svgSize=h,m.setAttribute("width",h.x),m.setAttribute("height",h.y)),Ti(m,r.min),m.setAttribute("viewBox",[r.min.x,r.min.y,h.x,h.y].join(" ")),this.fire("update"))},_initPath:function(r){var h=r._path=ao("path");r.options.className&&re(h,r.options.className),r.options.interactive&&re(h,"leaflet-interactive"),this._updateStyle(r),this._layers[ai(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){Gt(r._path),r.removeInteractiveTarget(r._path),delete this._layers[ai(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var h=r._path,m=r.options;h&&(m.stroke?(h.setAttribute("stroke",m.color),h.setAttribute("stroke-opacity",m.opacity),h.setAttribute("stroke-width",m.weight),h.setAttribute("stroke-linecap",m.lineCap),h.setAttribute("stroke-linejoin",m.lineJoin),m.dashArray?h.setAttribute("stroke-dasharray",m.dashArray):h.removeAttribute("stroke-dasharray"),m.dashOffset?h.setAttribute("stroke-dashoffset",m.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),m.fill?(h.setAttribute("fill",m.fillColor||m.color),h.setAttribute("fill-opacity",m.fillOpacity),h.setAttribute("fill-rule",m.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(r,h){this._setPath(r,_r(r._parts,h))},_updateCircle:function(r){var h=r._point,m=Math.max(Math.round(r._radius),1),b="a"+m+","+(Math.max(Math.round(r._radiusY),1)||m)+" 0 1,0 ",C=r._empty()?"M0 0":"M"+(h.x-m)+","+h.y+b+2*m+",0 "+b+2*-m+",0 ";this._setPath(r,C)},_setPath:function(r,h){r._path.setAttribute("d",h)},_bringToFront:function(r){ie(r._path)},_bringToBack:function(r){Kt(r._path)}});function ka(r){return he||Pe?new Ro(r):null}Pe&&Ro.include(zs),gi.include({getRenderer:function(r){var h=(h=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer)||(this._renderer=this._createRenderer());return this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(r){if("overlayPane"===r||void 0===r)return!1;var h=this._paneRenderers[r];return void 0===h&&(h=this._createRenderer({pane:r}),this._paneRenderers[r]=h),h},_createRenderer:function(r){return this.options.preferCanvas&&ss(r)||ka(r)}});var Xa=Mr.extend({initialize:function(r,h){Mr.prototype.initialize.call(this,this._boundsToLatLngs(r),h)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return[(r=Ci(r)).getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});Ro.create=ao,Ro.pointsToPath=_r,wr.geometryToLayer=Ga,wr.coordsToLatLng=Ls,wr.coordsToLatLngs=ca,wr.latLngToCoords=Wa,wr.latLngsToCoords=La,wr.getFeature=Hr,wr.asFeature=Ha,gi.mergeOptions({boxZoom:!0});var ta=gr.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){Oe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){en(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Gt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||1!==r.which&&1!==r.button)return!1;this._clearDeferredResetState(),this._resetState(),ot(),Xi(),this._startPoint=this._map.mouseEventToContainerPoint(r),Oe(document,{contextmenu:Mo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=jt("div","leaflet-zoom-box",this._container),re(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var h=new je(this._point,this._startPoint),m=h.getSize();Ti(this._box,h.min),this._box.style.width=m.x+"px",this._box.style.height=m.y+"px"},_finish:function(){this._moved&&(Gt(this._box),Vt(this._container,"leaflet-crosshair")),ut(),yi(),en(document,{contextmenu:Mo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){var h;1!==r.which&&1!==r.button||(this._finish(),this._moved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(xi(this._resetState,this),0),h=new Pi(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})))},_onKeyDown:function(r){27===r.keyCode&&this._finish()}});gi.addInitHook("addHandler","boxZoom",ta),gi.mergeOptions({doubleClickZoom:!0});var ma=gr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var h=this._map,m=h.getZoom(),b=h.options.zoomDelta,C=r.originalEvent.shiftKey?m-b:m+b;"center"===h.options.doubleClickZoom?h.setZoom(C):h.setZoomAround(r.containerPoint,C)}});gi.addInitHook("addHandler","doubleClickZoom",ma),gi.mergeOptions({dragging:!0,inertia:!zn,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ls=gr.extend({addHooks:function(){var r;this._draggable||(this._draggable=new Wr((r=this._map)._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))),re(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Vt(this._map._container,"leaflet-grab"),Vt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r,h=this._map;h._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity?(r=Ci(this._map.options.maxBounds),this._offsetLimit=Ut(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))):this._offsetLimit=null,h.fire("movestart").fire("dragstart"),h.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){var h,m;this._map.options.inertia&&(h=this._lastTime=+new Date,m=this._lastPos=this._draggable._absPos||this._draggable._newPos,this._positions.push(m),this._times.push(h),this._prunePositions(h)),this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;1<this._positions.length&&50<r-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,h){return r-(r-h)*this._viscosity},_onPreDragLimit:function(){var r,h;this._viscosity&&this._offsetLimit&&((r=this._draggable._newPos.subtract(this._draggable._startPos)).x<(h=this._offsetLimit).min.x&&(r.x=this._viscousLimit(r.x,h.min.x)),r.y<h.min.y&&(r.y=this._viscousLimit(r.y,h.min.y)),r.x>h.max.x&&(r.x=this._viscousLimit(r.x,h.max.x)),r.y>h.max.y&&(r.y=this._viscousLimit(r.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(r))},_onPreDragWrap:function(){var r=this._worldWidth,h=Math.round(r/2),m=this._initialWorldOffset,b=this._draggable._newPos.x,C=(b-h+m)%r+h-m,G=(b+h+m)%r-h-m,rt=Math.abs(C+m)<Math.abs(G+m)?C:G;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=rt},_onDragEnd:function(r){var b,C,G,rt,gt,kt,Lt,oe=this._map,de=oe.options,Qe=!de.inertia||this._times.length<2;oe.fire("dragend",r),Qe?oe.fire("moveend"):(this._prunePositions(+new Date),G=(C=this._lastPos.subtract(this._positions[0]).multiplyBy((b=de.easeLinearity)/((this._lastTime-this._times[0])/1e3))).distanceTo([0,0]),rt=Math.min(de.inertiaMaxSpeed,G),gt=C.multiplyBy(rt/G),(Lt=gt.multiplyBy(-(kt=rt/(de.inertiaDeceleration*b))/2).round()).x||Lt.y?(Lt=oe._limitOffset(Lt,oe.options.maxBounds),Me(function(){oe.panBy(Lt,{duration:kt,easeLinearity:b,noMoveStart:!0,animate:!0})})):oe.fire("moveend"))}});gi.addInitHook("addHandler","dragging",ls),gi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ea=gr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),Oe(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),en(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){var r,h,m,b;this._focused||(r=document.body,h=document.documentElement,m=r.scrollTop||h.scrollTop,b=r.scrollLeft||h.scrollLeft,this._map._container.focus(),window.scrollTo(b,m))},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){for(var h=this._panKeys={},m=this.keyCodes,b=0,C=m.left.length;b<C;b++)h[m.left[b]]=[-1*r,0];for(b=0,C=m.right.length;b<C;b++)h[m.right[b]]=[r,0];for(b=0,C=m.down.length;b<C;b++)h[m.down[b]]=[0,r];for(b=0,C=m.up.length;b<C;b++)h[m.up[b]]=[0,-1*r]},_setZoomDelta:function(r){for(var h=this._zoomKeys={},m=this.keyCodes,b=0,C=m.zoomIn.length;b<C;b++)h[m.zoomIn[b]]=r;for(b=0,C=m.zoomOut.length;b<C;b++)h[m.zoomOut[b]]=-r},_addHooks:function(){Oe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){en(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var h,m=r.keyCode,b=this._map;if(m in this._panKeys)b._panAnim&&b._panAnim._inProgress||(h=this._panKeys[m],r.shiftKey&&(h=ti(h).multiplyBy(3)),b.panBy(h),b.options.maxBounds&&b.panInsideBounds(b.options.maxBounds));else if(m in this._zoomKeys)b.setZoom(b.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[m]);else{if(27!==m||!b._popup||!b._popup.options.closeOnEscapeKey)return;b.closePopup()}Mo(r)}}});gi.addInitHook("addHandler","keyboard",Ea),gi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ur=gr.extend({addHooks:function(){Oe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){en(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var h=io(r),m=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var b=Math.max(m-(new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(xi(this._performZoom,this),b),Mo(r)},_performZoom:function(){var r=this._map,h=r.getZoom(),m=this._map.options.zoomSnap||0;r._stop();var C=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,G=m?Math.ceil(C/m)*m:C,rt=r._limitZoom(h+(0<this._delta?G:-G))-h;this._delta=0,this._startTime=null,rt&&("center"===r.options.scrollWheelZoom?r.setZoom(h+rt):r.setZoomAround(this._lastMousePos,h+rt))}});gi.addInitHook("addHandler","scrollWheelZoom",ur),gi.mergeOptions({tap:!0,tapTolerance:15});var Ka=gr.extend({addHooks:function(){Oe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){en(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(r.touches){if(an(r),this._fireClick=!0,1<r.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var h=r.touches[0],m=h.target;this._startPos=this._newPos=new Ee(h.clientX,h.clientY),m.tagName&&"a"===m.tagName.toLowerCase()&&re(m,"leaflet-active"),this._holdTimeout=setTimeout(xi(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",h))},this),1e3),this._simulateEvent("mousedown",h),Oe(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(r){var h,m;clearTimeout(this._holdTimeout),en(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&r&&r.changedTouches&&((m=(h=r.changedTouches[0]).target)&&m.tagName&&"a"===m.tagName.toLowerCase()&&Vt(m,"leaflet-active"),this._simulateEvent("mouseup",h),this._isTapValid()&&this._simulateEvent("click",h))},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(r){var h=r.touches[0];this._newPos=new Ee(h.clientX,h.clientY),this._simulateEvent("mousemove",h)},_simulateEvent:function(r,h){var m=document.createEvent("MouseEvents");m._simulated=!0,h.target._simulatedClick=!0,m.initMouseEvent(r,!0,!0,window,1,h.screenX,h.screenY,h.clientX,h.clientY,!1,!1,!1,!1,0,null),h.target.dispatchEvent(m)}});!D||S&&!vn||gi.addInitHook("addHandler","tap",Ka),gi.mergeOptions({touchZoom:D&&!zn,bounceAtZoomLimits:!0});var us=gr.extend({addHooks:function(){re(this._map._container,"leaflet-touch-zoom"),Oe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Vt(this._map._container,"leaflet-touch-zoom"),en(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var h,m,b=this._map;!r.touches||2!==r.touches.length||b._animatingZoom||this._zooming||(h=b.mouseEventToContainerPoint(r.touches[0]),m=b.mouseEventToContainerPoint(r.touches[1]),this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),"center"!==b.options.touchZoom&&(this._pinchStartLatLng=b.containerPointToLatLng(h.add(m)._divideBy(2))),this._startDist=h.distanceTo(m),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),Oe(document,"touchmove",this._onTouchMove,this),Oe(document,"touchend",this._onTouchEnd,this),an(r))},_onTouchMove:function(r){if(r.touches&&2===r.touches.length&&this._zooming){var h=this._map,m=h.mouseEventToContainerPoint(r.touches[0]),b=h.mouseEventToContainerPoint(r.touches[1]),C=m.distanceTo(b)/this._startDist;if(this._zoom=h.getScaleZoom(C,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&C<1||this._zoom>h.getMaxZoom()&&1<C)&&(this._zoom=h._limitZoom(this._zoom)),"center"===h.options.touchZoom){if(this._center=this._startLatLng,1==C)return}else{var G=m._add(b)._divideBy(2)._subtract(this._centerPoint);if(1==C&&0===G.x&&0===G.y)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(G),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),le(this._animRequest);var rt=xi(h._move,h,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=Me(rt,this,!0),an(r)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,le(this._animRequest),en(document,"touchmove",this._onTouchMove,this),en(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});gi.addInitHook("addHandler","touchZoom",us),gi.BoxZoom=ta,gi.DoubleClickZoom=ma,gi.Drag=ls,gi.Keyboard=Ea,gi.ScrollWheelZoom=ur,gi.Tap=Ka,gi.TouchZoom=us,Pt.version="1.7.1",Pt.Control=Gr,Pt.control=Aa,Pt.Browser=bn,Pt.Evented=tn,Pt.Mixin=qs,Pt.Util=Qi,Pt.Class=Zt,Pt.Handler=gr,Pt.extend=ft,Pt.bind=xi,Pt.stamp=ai,Pt.setOptions=Hi,Pt.DomEvent=Ss,Pt.DomUtil=Dn,Pt.PosAnimation=is,Pt.Draggable=Wr,Pt.LineUtil=el,Pt.PolyUtil=rs,Pt.Point=Ee,Pt.point=ti,Pt.Bounds=je,Pt.bounds=Ut,Pt.Transformation=Ye,Pt.transformation=_e,Pt.Projection=Ps,Pt.LatLng=We,Pt.latLng=bi,Pt.LatLngBounds=Pi,Pt.latLngBounds=Ci,Pt.CRS=Ni,Pt.GeoJSON=wr,Pt.geoJSON=$o,Pt.geoJson=wa,Pt.Layer=xr,Pt.LayerGroup=ha,Pt.layerGroup=function(r,h){return new ha(r,h)},Pt.FeatureGroup=hn,Pt.featureGroup=function(r,h){return new hn(r,h)},Pt.ImageOverlay=za,Pt.imageOverlay=function(r,h,m){return new za(r,h,m)},Pt.VideoOverlay=os,Pt.videoOverlay=function(r,h,m){return new os(r,h,m)},Pt.SVGOverlay=as,Pt.svgOverlay=function(r,h,m){return new as(r,h,m)},Pt.DivOverlay=Dr,Pt.Popup=Ta,Pt.popup=function(r,h){return new Ta(r,h)},Pt.Tooltip=yo,Pt.tooltip=function(r,h){return new yo(r,h)},Pt.Icon=Jo,Pt.icon=function(r){return new Jo(r)},Pt.DivIcon=pa,Pt.divIcon=function(r){return new pa(r)},Pt.Marker=Eo,Pt.marker=function(r,h){return new Eo(r,h)},Pt.TileLayer=Xr,Pt.tileLayer=Ai,Pt.GridLayer=Qo,Pt.gridLayer=function(r){return new Qo(r)},Pt.SVG=Ro,Pt.svg=ka,Pt.Renderer=Io,Pt.Canvas=da,Pt.canvas=ss,Pt.Path=kr,Pt.CircleMarker=_o,Pt.circleMarker=function(r,h){return new _o(r,h)},Pt.Circle=Oo,Pt.circle=function(r,h,m){return new Oo(r,h,m)},Pt.Polyline=br,Pt.polyline=function(r,h){return new br(r,h)},Pt.Polygon=Mr,Pt.polygon=function(r,h){return new Mr(r,h)},Pt.Rectangle=Xa,Pt.rectangle=function(r,h){return new Xa(r,h)},Pt.Map=gi,Pt.map=function(r,h){return new gi(r,h)};var Ma=window.L;Pt.noConflict=function(){return window.L=Ma,this},window.L=Pt}),function(Pt,ft){"object"==typeof exports&&typeof module<"u"?ft(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],ft):ft(((Pt=typeof globalThis<"u"?globalThis:Pt||self).L=Pt.L||{},Pt.L.esri={}),Pt.L)}(this,function(Pt,ft){"use strict";var ho=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,xi=""===document.documentElement.style.pointerEvents,Lr={cors:ho,pointerEvents:xi},ai={attributionWidthOffset:55},Jr=0;function co(x){var S="";for(var D in x.f=x.f||"json",x)if(Object.prototype.hasOwnProperty.call(x,D)){var W,it=x[D],pt=Object.prototype.toString.call(it);S.length&&(S+="&"),W="[object Array]"===pt?"[object Object]"===Object.prototype.toString.call(it[0])?JSON.stringify(it):it.join(","):"[object Object]"===pt?JSON.stringify(it):"[object Date]"===pt?it.valueOf():it,S+=encodeURIComponent(D)+"="+encodeURIComponent(W)}return S}function Gi(x,S){var D=new window.XMLHttpRequest;return D.onerror=function(W){D.onreadystatechange=ft.Util.falseFn,x.call(S,{error:{code:500,message:"XMLHttpRequest error"}},null)},D.onreadystatechange=function(){var W,it;if(4===D.readyState){try{W=JSON.parse(D.responseText)}catch{W=null,it={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!it&&W.error&&(it=W.error,W=null),D.onerror=ft.Util.falseFn,x.call(S,it,W)}},D.ontimeout=function(){this.onerror()},D}function Yr(x,S,D,W){var it=Gi(D,W);return it.open("POST",x),null!=W&&void 0!==W.options&&(it.timeout=W.options.timeout),it.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),it.send(co(S)),it}function oa(x,S,D,W){var it=Gi(D,W);return it.open("GET",x+"?"+co(S),!0),null!=W&&void 0!==W.options&&(it.timeout=W.options.timeout,W.options.withCredentials&&(it.withCredentials=!0)),it.send(null),it}function $r(x,S,D,W){var it=co(S),pt=Gi(D,W),At=(x+"?"+it).length;if(At<=2e3&&Lr.cors?pt.open("GET",x+"?"+it):At>2e3&&Lr.cors&&(pt.open("POST",x),pt.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),null!=W&&void 0!==W.options&&(pt.timeout=W.options.timeout,W.options.withCredentials&&(pt.withCredentials=!0)),At<=2e3&&Lr.cors)pt.send(null);else{if(!(At>2e3&&Lr.cors))return At<=2e3&&!Lr.cors?Hi(x,S,D,W):void yn("a request to "+x+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy https://developers.arcgis.com/esri-leaflet/api-reference/request/");pt.send(it)}return pt}function Hi(x,S,D,W){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var it="c"+Jr;S.callback="window._EsriLeafletCallbacks."+it,window._EsriLeafletCallbacks[it]=function(At){if(!0!==window._EsriLeafletCallbacks[it]){var Qt,he=Object.prototype.toString.call(At);"[object Object]"!==he&&"[object Array]"!==he&&(Qt={error:{code:500,message:"Expected array or object as JSONP response"}},At=null),!Qt&&At.error&&(Qt=At,At=null),D.call(W,Qt,At),window._EsriLeafletCallbacks[it]=!0}};var pt=ft.DomUtil.create("script",null,document.body);return pt.type="text/javascript",pt.src=x+"?"+co(S),pt.id=it,pt.onerror=function(At){At&&!0!==window._EsriLeafletCallbacks[it]&&(D.call(W,{error:{code:500,message:"An unknown error occurred"}}),window._EsriLeafletCallbacks[it]=!0)},ft.DomUtil.addClass(pt,"esri-leaflet-jsonp"),Jr++,{id:it,url:pt.src,abort:function(){window._EsriLeafletCallbacks._callback[it]({code:0,message:"Request aborted."})}}}var aa=Lr.cors?oa:Hi;function yn(){console&&console.warn&&console.warn.apply(console,arguments)}aa.CORS=oa,aa.JSONP=Hi;var Ft={request:$r,get:aa,post:Yr},ee=function(x,S,D,W){var At=(W[1]-D[1])*(S[0]-x[0])-(W[0]-D[0])*(S[1]-x[1]);if(0!==At){var Qt=((W[0]-D[0])*(x[1]-D[1])-(W[1]-D[1])*(x[0]-D[0]))/At,he=((S[0]-x[0])*(x[1]-D[1])-(S[1]-x[1])*(x[0]-D[0]))/At;if(Qt>=0&&Qt<=1&&he>=0&&he<=1)return!0}return!1},Fe=function(x,S){for(var D=0;D<x.length-1;D++)for(var W=0;W<S.length-1;W++)if(ee(x[D],x[D+1],S[W],S[W+1]))return!0;return!1},Te=function(x){return function(S,D){for(var W=0;W<S.length;W++)if(S[W]!==D[W])return!1;return!0}(x[0],x[x.length-1])||x.push(x[0]),x},Di=function(x){for(var S,D=0,W=0,it=x.length,pt=x[W];W<it-1;W++)D+=((S=x[W+1])[0]-pt[0])*(S[1]+pt[1]),pt=S;return D>=0},gn=function(x){var S={};for(var D in x)x.hasOwnProperty(D)&&(S[D]=x[D]);return S},c=function(x,S){var D=Fe(x,S),W=function(it,pt){for(var At=!1,Qt=-1,he=it.length,Pe=he-1;++Qt<he;Pe=Qt)(it[Qt][1]<=pt[1]&&pt[1]<it[Pe][1]||it[Pe][1]<=pt[1]&&pt[1]<it[Qt][1])&&pt[0]<(it[Pe][0]-it[Qt][0])*(pt[1]-it[Qt][1])/(it[Pe][1]-it[Qt][1])+it[Qt][0]&&(At=!At);return At}(x,S[0]);return!(D||!W)},mi=function x(S,D){var W={};if(S.features){W.type="FeatureCollection",W.features=[];for(var it=0;it<S.features.length;it++)W.features.push(x(S.features[it],D))}if("number"==typeof S.x&&"number"==typeof S.y&&(W.type="Point",W.coordinates=[S.x,S.y],"number"==typeof S.z&&W.coordinates.push(S.z)),S.points&&(W.type="MultiPoint",W.coordinates=S.points.slice(0)),S.paths&&(1===S.paths.length?(W.type="LineString",W.coordinates=S.paths[0].slice(0)):(W.type="MultiLineString",W.coordinates=S.paths.slice(0))),S.rings&&(W=function(pt){for(var At,he,Pe=[],ui=[],bn=0;bn<pt.length;bn++){var Ri=Te(pt[bn].slice(0));if(!(Ri.length<4))if(Di(Ri)){var qn=[Ri.slice().reverse()];Pe.push(qn)}else ui.push(Ri.slice().reverse())}for(var Gn=[];ui.length;){he=ui.pop();var fo=!1;for(At=Pe.length-1;At>=0;At--)if(c(Pe[At][0],he)){Pe[At].push(he),fo=!0;break}fo||Gn.push(he)}for(;Gn.length;){he=Gn.pop();var ar=!1;for(At=Pe.length-1;At>=0;At--)if(Fe(Pe[At][0],he)){Pe[At].push(he),ar=!0;break}ar||Pe.push([he.reverse()])}return 1===Pe.length?{type:"Polygon",coordinates:Pe[0]}:{type:"MultiPolygon",coordinates:Pe}}(S.rings.slice(0))),"number"==typeof S.xmin&&"number"==typeof S.ymin&&"number"==typeof S.xmax&&"number"==typeof S.ymax&&(W.type="Polygon",W.coordinates=[[[S.xmax,S.ymax],[S.xmin,S.ymax],[S.xmin,S.ymin],[S.xmax,S.ymin],[S.xmax,S.ymax]]]),(S.geometry||S.attributes)&&(W.type="Feature",W.geometry=S.geometry?x(S.geometry):null,W.properties=S.attributes?gn(S.attributes):null,S.attributes))try{W.id=function(pt,At){for(var Qt=At?[At,"OBJECTID","FID"]:["OBJECTID","FID"],he=0;he<Qt.length;he++){var Pe=Qt[he];if(Pe in pt&&("string"==typeof pt[Pe]||"number"==typeof pt[Pe]))return pt[Pe]}throw Error("No valid id attribute found")}(S.attributes,D)}catch{}return JSON.stringify(W.geometry)===JSON.stringify({})&&(W.geometry=null),S.spatialReference&&S.spatialReference.wkid&&4326!==S.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(S.spatialReference)),W},Mt=function(x){var S=[],D=x.slice(0),W=Te(D.shift().slice(0));if(W.length>=4){Di(W)||W.reverse(),S.push(W);for(var it=0;it<D.length;it++){var pt=Te(D[it].slice(0));pt.length>=4&&(Di(pt)&&pt.reverse(),S.push(pt))}}return S},Me=function x(S,D){D=D||"OBJECTID";var W,it={wkid:4326},pt={};switch(S.type){case"Point":pt.x=S.coordinates[0],pt.y=S.coordinates[1],S.coordinates[2]&&(pt.z=S.coordinates[2]),pt.spatialReference=it;break;case"MultiPoint":pt.points=S.coordinates.slice(0),S.coordinates[0][2]&&(pt.hasZ=!0),pt.spatialReference=it;break;case"LineString":pt.paths=[S.coordinates.slice(0)],S.coordinates[0][2]&&(pt.hasZ=!0),pt.spatialReference=it;break;case"MultiLineString":pt.paths=S.coordinates.slice(0),S.coordinates[0][0][2]&&(pt.hasZ=!0),pt.spatialReference=it;break;case"Polygon":pt.rings=Mt(S.coordinates.slice(0)),S.coordinates[0][0][2]&&(pt.hasZ=!0),pt.spatialReference=it;break;case"MultiPolygon":pt.rings=function(At){for(var Qt=[],he=0;he<At.length;he++)for(var Pe=Mt(At[he]),ui=Pe.length-1;ui>=0;ui--){var bn=Pe[ui].slice(0);Qt.push(bn)}return Qt}(S.coordinates.slice(0)),S.coordinates[0][0][0][2]&&(pt.hasZ=!0),pt.spatialReference=it;break;case"Feature":S.geometry&&(pt.geometry=x(S.geometry,D)),pt.attributes=S.properties?gn(S.properties):{},S.id&&(pt.attributes[D]=S.id);break;case"FeatureCollection":for(pt=[],W=0;W<S.features.length;W++)pt.push(x(S.features[W],D));break;case"GeometryCollection":for(pt=[],W=0;W<S.geometries.length;W++)pt.push(x(S.geometries[W],D))}return pt},le='<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>';function Qi(x,S){return Me(x,S)}function Zt(x,S){return mi(x,S)}function ln(x){if("NaN"!==x.xmin&&"NaN"!==x.ymin&&"NaN"!==x.xmax&&"NaN"!==x.ymax){var S=ft.latLng(x.ymin,x.xmin),D=ft.latLng(x.ymax,x.xmax);return ft.latLngBounds(S,D)}return null}function tn(x){return{xmin:(x=ft.latLngBounds(x)).getSouthWest().lng,ymin:x.getSouthWest().lat,xmax:x.getNorthEast().lng,ymax:x.getNorthEast().lat,spatialReference:{wkid:4326}}}var Ee=/^(OBJECTID|FID|OID|ID)$/i;function jn(x){var S;if(x.objectIdFieldName)S=x.objectIdFieldName;else if(x.fields){for(var D=0;D<=x.fields.length-1;D++)if("esriFieldTypeOID"===x.fields[D].type){S=x.fields[D].name;break}if(!S)for(D=0;D<=x.fields.length-1;D++)if(x.fields[D].name.match(Ee)){S=x.fields[D].name;break}}return S}function ti(x){for(var S in x.attributes)if(S.match(Ee))return S}function je(x,S){var D,W=x.features||x.results,it=W&&W.length;D=S||jn(x);var pt={type:"FeatureCollection",features:[]};if(it)for(var At=W.length-1;At>=0;At--){var Qt=Zt(W[At],D||ti(W[At]));pt.features.push(Qt)}return pt}function Ut(x){return"/"!==(x=ft.Util.trim(x))[x.length-1]&&(x+="/"),x}function Pi(x){if(-1!==x.url.indexOf("?")){x.requestParams=x.requestParams||{};var S=x.url.substring(x.url.indexOf("?")+1);x.url=x.url.split("?")[0],x.requestParams=JSON.parse('{"'+decodeURI(S).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return x.url=Ut(x.url.split("?")[0]),x}function Ci(x){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(x)}function We(x){var S;switch(x){case"Point":S="esriGeometryPoint";break;case"MultiPoint":S="esriGeometryMultipoint";break;case"LineString":case"MultiLineString":S="esriGeometryPolyline";break;case"Polygon":case"MultiPolygon":S="esriGeometryPolygon"}return S}function bi(x){return x.getSize().x-ai.attributionWidthOffset+"px"}function Ln(x){if(x.attributionControl){if(x.attributionControl._esriAttributionLayerCount||(x.attributionControl._esriAttributionLayerCount=0),0===x.attributionControl._esriAttributionLayerCount){if(!x.attributionControl._esriAttributionAddedOnce){var S=document.createElement("style");S.type="text/css",S.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(S);var D=document.createElement("style");D.type="text/css",D.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+bi(x)+";}",document.getElementsByTagName("head")[0].appendChild(D),x.on("resize",function(W){x.attributionControl&&(x.attributionControl._container.style.maxWidth=bi(W.target))}),x.attributionControl._esriAttributionAddedOnce=!0}x.attributionControl.setPrefix(le+' | Powered by <a href="https://www.esri.com">Esri</a>'),ft.DomUtil.addClass(x.attributionControl._container,"esri-truncated-attribution:hover"),ft.DomUtil.addClass(x.attributionControl._container,"esri-truncated-attribution")}x.attributionControl._esriAttributionLayerCount=x.attributionControl._esriAttributionLayerCount+1}}function Ni(x){x.attributionControl&&(x.attributionControl._esriAttributionLayerCount&&1===x.attributionControl._esriAttributionLayerCount&&(x.attributionControl.setPrefix(le),ft.DomUtil.removeClass(x.attributionControl._container,"esri-truncated-attribution:hover"),ft.DomUtil.removeClass(x.attributionControl._container,"esri-truncated-attribution")),x.attributionControl._esriAttributionLayerCount=x.attributionControl._esriAttributionLayerCount-1)}function on(x){var S={geometry:null,geometryType:null};return x instanceof ft.LatLngBounds?(S.geometry=tn(x),S.geometryType="esriGeometryEnvelope",S):(x.getLatLng&&(x=x.getLatLng()),x instanceof ft.LatLng&&(x={type:"Point",coordinates:[x.lng,x.lat]}),x instanceof ft.GeoJSON&&(x=x.getLayers()[0].feature.geometry,S.geometry=Qi(x),S.geometryType=We(x.type)),x.toGeoJSON&&(x=x.toGeoJSON()),"Feature"===x.type&&(x=x.geometry),"Point"===x.type||"LineString"===x.type||"Polygon"===x.type||"MultiPolygon"===x.type?(S.geometry=Qi(x),S.geometryType=We(x.type),S):void yn("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}function fr(x,S){Lr.cors&&$r(x,{},ft.Util.bind(function(D,W){if(!D){S._esriAttributions=[];for(var it=0;it<W.contributors.length;it++)for(var pt=W.contributors[it],At=0;At<pt.coverageAreas.length;At++){var Qt=pt.coverageAreas[At],he=ft.latLng(Qt.bbox[0],Qt.bbox[1]),Pe=ft.latLng(Qt.bbox[2],Qt.bbox[3]);S._esriAttributions.push({attribution:pt.attribution,score:Qt.score,bounds:ft.latLngBounds(he,Pe),minZoom:Qt.zoomMin,maxZoom:Qt.zoomMax})}S._esriAttributions.sort(function(ui,bn){return bn.score-ui.score}),zr({target:S})}},this))}function zr(x){var S=x.target,D=S._esriAttributions;if(S&&S.attributionControl){var W=S.attributionControl._container.querySelector(".esri-dynamic-attribution");if(W&&D){for(var it="",pt=S.getBounds(),At=ft.latLngBounds(pt.getSouthWest().wrap(),pt.getNorthEast().wrap()),Qt=S.getZoom(),he=0;he<D.length;he++){var Pe=D[he],ui=Pe.attribution;!it.match(ui)&&Pe.bounds.intersects(At)&&Qt>=Pe.minZoom&&Qt<=Pe.maxZoom&&(it+=", "+ui)}it=it.substr(2),W.innerHTML=it,W.style.maxWidth=bi(S),S.fire("attributionupdated",{attribution:it})}}}var Ye={warn:yn,cleanUrl:Ut,getUrlParams:Pi,isArcgisOnline:Ci,geojsonTypeToArcGIS:We,responseToFeatureCollection:je,geojsonToArcGIS:Qi,arcgisToGeoJSON:Zt,boundsToExtent:tn,extentToBounds:ln,calcAttributionWidth:bi,setEsriAttribution:Ln,_setGeometry:on,_getAttributionData:fr,_updateMapAttribution:zr,_findIdAttributeFromFeature:ti,_findIdAttributeFromResponse:jn},_e=ft.Class.extend({options:{proxy:!1,useCors:ho},generateSetter:function(x,S){return ft.Util.bind(function(D){return this.params[x]=D,this},S)},initialize:function(x){if(x.request&&x.options?(this._service=x,ft.Util.setOptions(this,x.options)):(ft.Util.setOptions(this,x),this.options.url=Ut(x.url)),this.params=ft.Util.extend({},this.params||{}),this.setters)for(var S in this.setters)this[S]=this.generateSetter(this.setters[S],this)},token:function(x){return this._service?this._service.authenticate(x):this.params.token=x,this},apikey:function(x){return this.token(x)},format:function(x){return this.params.returnUnformattedValues=!x,this},request:function(x,S){return this.options.requestParams&&ft.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,x,S):this._request("request",this.path,this.params,x,S)},_request:function(x,S,D,W,it){var pt=this.options.proxy?this.options.proxy+"?"+this.options.url+S:this.options.url+S;return"get"!==x&&"request"!==x||this.options.useCors?Ft[x](pt,D,W,it):Ft.get.JSONP(pt,D,W,it)}}),Go=_e.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(x,S){return x=ft.latLng(x),this.params.geometry=[x.lng,x.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=S,this.params.inSR=4326,this},where:function(x){return this.params.where=x,this},between:function(x,S){return this.params.time=[x.valueOf(),S.valueOf()],this},simplify:function(x,S){var D=Math.abs(x.getBounds().getWest()-x.getBounds().getEast());return this.params.maxAllowableOffset=D/x.getSize().y*S,this},orderBy:function(x,S){return S=S||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[x,S].join(" "),this},run:function(x,S){return this._cleanParams(),this.options.isModern||Ci(this.options.url)&&void 0===this.options.isModern?(this.params.f="geojson",this.request(function(D,W){this._trapSQLerrors(D),x.call(S,D,W,W)},this)):this.request(function(D,W){this._trapSQLerrors(D),x.call(S,D,W&&je(W),W)},this)},count:function(x,S){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(D,W){x.call(this,D,W&&W.count,W)},S)},ids:function(x,S){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(D,W){x.call(this,D,W&&W.objectIds,W)},S)},bounds:function(x,S){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(D,W){W&&W.extent&&ln(W.extent)?x.call(S,D,ln(W.extent),W):x.call(S,D={message:"Invalid Bounds"},null,W)},S)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(x){var S=ft.point(x);return this.params.pixelSize=[S.x,S.y],this},layer:function(x){return this.path=x+"/query",this},_trapSQLerrors:function(x){x&&"400"===x.code&&yn("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(x){this.params.inSR=4326;var S=on(x);this.params.geometry=S.geometry,this.params.geometryType=S.geometryType}});function Vn(x){return new Go(x)}var Wo=_e.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(x,S){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[x,S].join(":"),this},simplify:function(x,S){var D=Math.abs(x.getBounds().getWest()-x.getBounds().getEast());return this.params.maxAllowableOffset=D/x.getSize().y*S,this},run:function(x,S){return this.request(function(D,W){x.call(S,D,W&&je(W),W)},S)}});function mr(x){return new Wo(x)}var _r=_e.extend({path:"identify",between:function(x,S){return this.params.time=[x.valueOf(),S.valueOf()],this}}),Zn=_r.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(x){var S=tn(x.getBounds()),D=x.getSize();return this.params.imageDisplay=[D.x,D.y,96],this.params.mapExtent=[S.xmin,S.ymin,S.xmax,S.ymax],this},at:function(x){return 2===x.length&&(x=ft.latLng(x)),this._setGeometryParams(x),this},layerDef:function(x,S){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[x,S].join(":"),this},simplify:function(x,S){var D=Math.abs(x.getBounds().getWest()-x.getBounds().getEast());return this.params.maxAllowableOffset=D/x.getSize().y*S,this},run:function(x,S){return this.request(function(D,W){if(D)x.call(S,D,void 0,W);else{var it=je(W);W.results=W.results.reverse();for(var pt=0;pt<it.features.length;pt++)it.features[pt].layerId=W.results[pt].layerId;x.call(S,void 0,it,W)}})},_setGeometryParams:function(x){var S=on(x);this.params.geometry=S.geometry,this.params.geometryType=S.geometryType}});function Tn(x){return new Zn(x)}var Qn=_r.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(x){return x=ft.latLng(x),this.params.geometry=JSON.stringify({x:x.lng,y:x.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(x,S){return this.request(function(D,W){x.call(S,D,W&&this._responseToGeoJSON(W),W)},this)},_responseToGeoJSON:function(x){var S=x.location,D=x.catalogItems,W=x.catalogItemVisibilities,it={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[S.x,S.y]},crs:{type:"EPSG",properties:{code:S.spatialReference.wkid}},properties:{OBJECTID:x.objectId,name:x.name,value:x.value},id:x.objectId}};if(x.properties&&x.properties.Values&&(it.pixel.properties.values=x.properties.Values),D&&D.features&&(it.catalogItems=je(D),W&&W.length===it.catalogItems.features.length))for(var pt=W.length-1;pt>=0;pt--)it.catalogItems.features[pt].properties.catalogItemVisibility=W[pt];return it}});function Vr(x){return new Qn(x)}var Sn=ft.Evented.extend({options:{proxy:!1,useCors:ho,timeout:0},initialize:function(x){x=x||{},this._requestQueue=[],this._authenticating=!1,ft.Util.setOptions(this,x),this.options.url=Ut(this.options.url)},get:function(x,S,D,W){return this._request("get",x,S,D,W)},post:function(x,S,D,W){return this._request("post",x,S,D,W)},request:function(x,S,D,W){return this._request("request",x,S,D,W)},metadata:function(x,S){return this._request("get","",{},x,S)},authenticate:function(x){return this._authenticating=!1,this.options.token=x,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(x){this.options.timeout=x},_request:function(x,S,D,W,it){this.fire("requeststart",{url:this.options.url+S,params:D,method:x},!0);var pt=this._createServiceCallback(x,S,D,W,it);if(this.options.token&&(D.token=this.options.token),this.options.requestParams&&ft.Util.extend(D,this.options.requestParams),!this._authenticating){var At=this.options.proxy?this.options.proxy+"?"+this.options.url+S:this.options.url+S;return"get"!==x&&"request"!==x||this.options.useCors?Ft[x](At,D,pt,it):Ft.get.JSONP(At,D,pt,it)}this._requestQueue.push([x,S,D,W,it])},_createServiceCallback:function(x,S,D,W,it){return ft.Util.bind(function(pt,At){!pt||499!==pt.code&&498!==pt.code||(this._authenticating=!0,this._requestQueue.push([x,S,D,W,it]),this.fire("authenticationrequired",{authenticate:ft.Util.bind(this.authenticate,this)},!0),pt.authenticate=ft.Util.bind(this.authenticate,this)),W.call(it,pt,At),pt?this.fire("requesterror",{url:this.options.url+S,params:D,message:pt.message,code:pt.code,method:x},!0):this.fire("requestsuccess",{url:this.options.url+S,params:D,response:At,method:x},!0),this.fire("requestend",{url:this.options.url+S,params:D,method:x},!0)},this)},_runQueue:function(){for(var x=this._requestQueue.length-1;x>=0;x--){var S=this._requestQueue[x];this[S.shift()].apply(this,S)}this._requestQueue=[]}}),tr=Sn.extend({identify:function(){return Tn(this)},find:function(){return mr(this)},query:function(){return Vn(this)}});function zn(x){return new tr(x)}var kn=Sn.extend({query:function(){return Vn(this)},identify:function(){return Vr(this)}});function Zr(x){return new kn(x)}var _i=Sn.extend({options:{idAttribute:"OBJECTID"},query:function(){return Vn(this)},addFeature:function(x,S,D){this.addFeatures(x,S,D)},addFeatures:function(x,S,D){for(var W=x.features?x.features:[x],it=W.length-1;it>=0;it--)delete W[it].id;return x=Qi(x),this.post("addFeatures",{features:x=W.length>1?x:[x]},function(pt,At){S&&S.call(D,pt||At.addResults[0].error,At&&At.addResults?At.addResults.length>1?At.addResults:At.addResults[0]:void 0)},D)},updateFeature:function(x,S,D){this.updateFeatures(x,S,D)},updateFeatures:function(x,S,D){var W=x.features?x.features:[x];return x=Qi(x,this.options.idAttribute),this.post("updateFeatures",{features:x=W.length>1?x:[x]},function(it,pt){S&&S.call(D,it||pt.updateResults[0].error,pt&&pt.updateResults?pt.updateResults.length>1?pt.updateResults:pt.updateResults[0]:void 0)},D)},deleteFeature:function(x,S,D){this.deleteFeatures(x,S,D)},deleteFeatures:function(x,S,D){return this.post("deleteFeatures",{objectIds:x},function(W,it){S&&S.call(D,W||it.deleteResults[0].error,it&&it.deleteResults?it.deleteResults.length>1?it.deleteResults:it.deleteResults[0]:void 0)},D)}});function or(x){return new _i(x)}var Bi="https:"!==window.location.protocol?"http:":"https:",vn=ft.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:Bi+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:Bi+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:xi?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:xi?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:xi?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:xi?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:xi?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:xi?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:xi?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:Bi+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:Bi+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:Bi+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:Bi+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(x,S){var D;if("object"==typeof x&&x.urlTemplate&&x.options)D=x;else{if("string"!=typeof x||!vn.TILES[x])throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');D=vn.TILES[x]}var W=ft.Util.extend(D.options,S);ft.Util.setOptions(this,W),this.options.ignoreDeprecationWarning||console.warn("WARNING: L.esri.BasemapLayer uses data services that are in mature support and are not being updated. Please use L.esri.Vector.vectorBasemapLayer instead. More info: https://esriurl.com/esri-leaflet-basemap"),this.options.token&&-1===D.urlTemplate.indexOf("token=")&&(D.urlTemplate+="?token="+this.options.token),this.options.proxy&&(D.urlTemplate=this.options.proxy+"?"+D.urlTemplate),ft.TileLayer.prototype.initialize.call(this,D.urlTemplate,W)},onAdd:function(x){Ln(x),"esri-labels"===this.options.pane&&this._initPane(),this.options.attributionUrl&&fr((this.options.proxy?this.options.proxy+"?":"")+this.options.attributionUrl,x),x.on("moveend",zr),ft.TileLayer.prototype.onAdd.call(this,x)},onRemove:function(x){Ni(x),x.off("moveend",zr),ft.TileLayer.prototype.onRemove.call(this,x)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var x=this._map.createPane(this.options.pane);x.style.pointerEvents="none",x.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var x='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return x}}),Ve=ft.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(x){x=Pi(x=ft.Util.setOptions(this,x)),this.tileUrl=(x.proxy?x.proxy+"?":"")+x.url+"tile/{z}/{y}/{x}"+(x.requestParams&&Object.keys(x.requestParams).length>0?ft.Util.getParamString(x.requestParams):""),-1!==x.url.indexOf("{s}")&&x.subdomains&&(x.url=x.url.replace("{s}",x.subdomains[0])),this.service=zn(x),this.service.addEventParent(this),new RegExp(/tiles.arcgis(online)?\.com/g).test(x.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),x.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),ft.TileLayer.prototype.initialize.call(this,this.tileUrl,x)},getTileUrl:function(x){var S=this._getZoomForUrl();return ft.Util.template(this.tileUrl,ft.Util.extend({s:this._getSubdomain(x),x:x.x,y:x.y,z:this._lodMap&&this._lodMap[S]?this._lodMap[S]:S},this.options))},createTile:function(x,S){var D=document.createElement("img");return ft.DomEvent.on(D,"load",ft.Util.bind(this._tileOnLoad,this,S,D)),ft.DomEvent.on(D,"error",ft.Util.bind(this._tileOnError,this,S,D)),this.options.crossOrigin&&(D.crossOrigin=""),D.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?D.src=this.getTileUrl(x):this.once("lodmap",function(){D.src=this.getTileUrl(x)},this),D},onAdd:function(x){Ln(x),this._lodMap||this.metadata(function(S,D){if(!S&&D.spatialReference){var W=D.spatialReference.latestWkid||D.spatialReference.wkid;if(!this.options.attribution&&x.attributionControl&&D.copyrightText&&(this.options.attribution=D.copyrightText,x.attributionControl.addAttribution(this.getAttribution())),x.options.crs!==ft.CRS.EPSG3857||102100!==W&&3857!==W)x.options.crs&&x.options.crs.code&&x.options.crs.code.indexOf(W)>-1||yn("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet https://developers.arcgis.com/esri-leaflet/samples/non-mercator-projection/");else{this._lodMap={};for(var it=D.tileInfo.lods,pt=Ve.MercatorZoomLevels,At=0;At<it.length;At++){var Qt=it[At];for(var he in pt)if(this._withinPercentage(Qt.resolution,pt[he],this.options.zoomOffsetAllowance)){this._lodMap[he]=Qt.level;break}}this.fire("lodmap")}}},this),ft.TileLayer.prototype.onAdd.call(this,x)},onRemove:function(x){Ni(x),ft.TileLayer.prototype.onRemove.call(this,x)},metadata:function(x,S){return this.service.metadata(x,S),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(x){var S="?token="+x;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,S):this.tileUrl+S,this.options.token=x,this.service.authenticate(x),this},_withinPercentage:function(x,S,D){return Math.abs(x/S-1)<D}}),po=ft.ImageOverlay.extend({onAdd:function(x){this._topLeft=x.getPixelBounds().min,ft.ImageOverlay.prototype.onAdd.call(this,x)},_reset:function(){this._map.options.crs===ft.CRS.EPSG3857?ft.ImageOverlay.prototype._reset.call(this):ft.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),xn=ft.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:ho,attribution:null,interactive:!1,alt:""},onAdd:function(x){Ln(x),this.options.zIndex&&(this.options.position=null),this._update=ft.Util.throttle(this._update,this.options.updateInterval,this),x.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?x.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(S,D){!S&&!this.options.attribution&&x.attributionControl&&D.copyrightText&&(this.options.attribution=D.copyrightText,x.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(x){Ni(x),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(x,S){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=ft.popup(S),this._popupFunction=x,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(x){return this.options.zIndex=x,this._currentImage&&this._currentImage.setZIndex(x),this},_setAutoZIndex:function(x){if(this._currentImage){for(var S,D=this._currentImage.getPane().children,W=-x(-1/0,1/0),it=0,pt=D.length;it<pt;it++)S=D[it].style.zIndex,D[it]!==this._currentImage._image&&S&&(W=x(W,+S));isFinite(W)&&(this.options.zIndex=W+x(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(x){return this.options.opacity=x,this._currentImage&&this._currentImage.setOpacity(x),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(x,S){return this.options.from=x,this.options.to=S,this._update(),this},metadata:function(x,S){return this.service.metadata(x,S),this},authenticate:function(x){return this.service.authenticate(x),this},redraw:function(){this._update()},_renderImage:function(x,S,D){if(this._map){if(D&&(x="data:"+D+";base64,"+x),!x)return;var W=new po(x,S,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),it=function(){this._map.removeLayer(W),this.fire("error"),W.off("load",pt,this)},pt=function(At){if(W.off("error",it,this),this._map){var Qt=At.target,he=this._currentImage;Qt._bounds.equals(S)&&Qt._bounds.equals(this._map.getBounds())?(this._currentImage=Qt,"front"===this.options.position?this.bringToFront():"back"===this.options.position&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),he&&this._map&&this._map.removeLayer(he),he&&he._map&&he._map.removeLayer(he)):this._map.removeLayer(Qt)}this.fire("load",{bounds:S})};W.once("error",it,this),W.once("load",pt,this)}},_update:function(){if(this._map){var x=this._map.getZoom(),S=this._map.getBounds();if(!(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress))if(x>this.options.maxZoom||x<this.options.minZoom)this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);else{var D=this._buildExportParams();ft.Util.extend(D,this.options.requestParams),D?(this._requestExport(D,S),this.fire("loading",{bounds:S})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(x,S,D,W){if(x=ft.latLng(x),this._shouldRenderPopup&&this._lastClick.equals(x)){var it=this._popupFunction(S,D,W);it&&this._popup.setLatLng(x).setContent(it).openOn(this._map)}},_resetPopupState:function(x){this._shouldRenderPopup=!1,this._lastClick=x.latlng},_calculateBbox:function(){var x=this._map.getPixelBounds(),S=this._map.unproject(x.getBottomLeft()),D=this._map.unproject(x.getTopRight()),W=this._map.options.crs.project(D),it=this._map.options.crs.project(S),pt=ft.bounds(W,it);return[pt.getBottomLeft().x,pt.getBottomLeft().y,pt.getTopRight().x,pt.getTopRight().y].join(",")},_calculateImageSize:function(){var x=this._map.getPixelBounds(),S=this._map.getSize(),D=this._map.unproject(x.getBottomLeft()),W=this._map.unproject(x.getTopRight()),it=this._map.latLngToLayerPoint(W).y,pt=this._map.latLngToLayerPoint(D).y;return(it>0||pt<S.y)&&(S.y=pt-it),S.x+","+S.y}}),un=xn.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(x){x=Pi(x),this.service=Zr(x),this.service.addEventParent(this),ft.Util.setOptions(this,x)},setPixelType:function(x){return this.options.pixelType=x,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(x){return this.options.bandIds=ft.Util.isArray(x)?x.join(","):x.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(x,S){return this.options.noData=ft.Util.isArray(x)?x.join(","):x.toString(),S&&(this.options.noDataInterpretation=S),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(x){this.options.renderingRule=x,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(x){this.options.mosaicRule=x,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(x){var S=ft.Util.bind(function(W,it,pt){W||setTimeout(ft.Util.bind(function(){this._renderPopup(x.latlng,W,it,pt)},this),300)},this),D=this.identify().at(x.latlng);this.options.mosaicRule&&D.setMosaicRule(this.options.mosaicRule),D.run(S),this._shouldRenderPopup=!0,this._lastClick=x.latlng},_buildExportParams:function(){var x=parseInt(this._map.options.crs.code.split(":")[1],10),S={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:x,imageSR:x};return this.options.from&&this.options.to&&(S.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(S.pixelType=this.options.pixelType),this.options.interpolation&&(S.interpolation=this.options.interpolation),this.options.compressionQuality&&(S.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(S.bandIds=this.options.bandIds),(0===this.options.noData||this.options.noData)&&(S.noData=this.options.noData),this.options.noDataInterpretation&&(S.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(S.token=this.service.options.token),this.options.renderingRule&&(S.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(S.mosaicRule=JSON.stringify(this.options.mosaicRule)),S},_requestExport:function(x,S){if("json"===this.options.f)this.service.request("exportImage",x,function(W,it){W||(this.options.token&&(it.href+="?token="+this.options.token),this.options.proxy&&(it.href=this.options.proxy+"?"+it.href),this._renderImage(it.href,S))},this);else{x.f="image";var D=this.options.url+"exportImage"+ft.Util.getParamString(x);this.options.proxy&&(D=this.options.proxy+"?"+D),this._renderImage(D,S)}}}),En=xn.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(x){x=Pi(x),this.service=zn(x),this.service.addEventParent(this),ft.Util.setOptions(this,x)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(x){return this.options.dynamicLayers=x,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(x){return this.options.layers=x,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(x){return this.options.layerDefs=x,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(x){return this.options.timeOptions=x,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(x){var S,D=ft.Util.bind(function(it,pt,At){it||setTimeout(ft.Util.bind(function(){this._renderPopup(x.latlng,it,pt,At)},this),300)},this);if((S=this.options.popup?this.options.popup.on(this._map).at(x.latlng):this.identify().on(this._map).at(x.latlng)).params.maxAllowableOffset||S.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||S.layers(this.options.layers?"visible:"+this.options.layers.join(","):"visible"),this.options.layerDefs&&"string"!=typeof this.options.layerDefs&&!S.params.layerDefs)for(var W in this.options.layerDefs)Object.prototype.hasOwnProperty.call(this.options.layerDefs,W)&&S.layerDef(W,this.options.layerDefs[W]);S.run(D),this._shouldRenderPopup=!0,this._lastClick=x.latlng},_buildExportParams:function(){var x=parseInt(this._map.options.crs.code.split(":")[1],10),S={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:x,imageSR:x};if(this.options.dynamicLayers&&(S.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(0===this.options.layers.length)return;S.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(S.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(S.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(S.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(S.token=this.service.options.token),this.options.proxy&&(S.proxy=this.options.proxy),this.options.disableCache&&(S._ts=Date.now()),S},_requestExport:function(x,S){if("json"===this.options.f)this.service.request("export",x,function(W,it){W||(this.options.token&&it.href&&(it.href+="?token="+this.options.token),this.options.proxy&&it.href&&(it.href=this.options.proxy+"?"+it.href),it.href?this._renderImage(it.href,S):this._renderImage(it.imageData,S,it.contentType))},this);else{x.f="image";var D=this.options.url+"export"+ft.Util.getParamString(x);this.options.proxy&&(D=this.options.proxy+"?"+D),this._renderImage(D,S)}}}),Zi=ft.Layer.extend({options:{cellSize:512,updateWhenIdle:ft.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize:function(x){ft.Util.setOptions(this,x)},onAdd:function(x){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove:function(x){this._removeAllCells(),this._cellZoom=void 0},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents:function(){var x={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=ft.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),x.move=this._onMove),x},createCell:function(){return document.createElement("div")},removeCell:function(){},reuseCell:function(){},cellLeave:function(){},cellEnter:function(){},getCellSize:function(){var x=this.options.cellSize;return x instanceof ft.Point?x:new ft.Point(x,x)},_pruneCells:function(){if(this._map){var x,S;for(x in this._cells)(S=this._cells[x]).retain=S.current;for(x in this._cells)if((S=this._cells[x]).current&&!S.active){var D=S.coords;this._retainParent(D.x,D.y,D.z,D.z-5)||this._retainChildren(D.x,D.y,D.z,D.z+2)}for(x in this._cells)this._cells[x].retain||this._removeCell(x)}},_removeAllCells:function(){for(var x in this._cells)this._removeCell(x)},_invalidateAll:function(){this._removeAllCells(),this._cellZoom=void 0},_retainParent:function(x,S,D,W){var it=Math.floor(x/2),pt=Math.floor(S/2),At=D-1,Qt=new ft.Point(+it,+pt);Qt.z=+At;var he=this._cellCoordsToKey(Qt),Pe=this._cells[he];return Pe&&Pe.active?(Pe.retain=!0,!0):(Pe&&Pe.loaded&&(Pe.retain=!0),At>W&&this._retainParent(it,pt,At,W))},_retainChildren:function(x,S,D,W){for(var it=2*x;it<2*x+2;it++)for(var pt=2*S;pt<2*S+2;pt++){var At=new ft.Point(it,pt);At.z=D+1;var Qt=this._cellCoordsToKey(At),he=this._cells[Qt];he&&he.active?he.retain=!0:(he&&he.loaded&&(he.retain=!0),D+1<W&&this._retainChildren(it,pt,D+1,W))}},_resetView:function(x){var S=x&&(x.pinch||x.flyTo);S||this._setView(this._map.getCenter(),this._map.getZoom(),S,S)},_setView:function(x,S,D,W){var it=Math.round(S);W||(this._cellZoom=it,this._abortLoading&&this._abortLoading(),this._resetGrid(),void 0!==it&&this._update(x),D||this._pruneCells(),this._noPrune=!!D)},_resetGrid:function(){var x=this._map,S=x.options.crs,D=this._cellSize=this.getCellSize(),W=this._cellZoom,it=this._map.getPixelWorldBounds(this._cellZoom);it&&(this._globalCellRange=this._pxBoundsToCellRange(it)),this._wrapX=S.wrapLng&&!this.options.noWrap&&[Math.floor(x.project([0,S.wrapLng[0]],W).x/D.x),Math.ceil(x.project([0,S.wrapLng[1]],W).x/D.y)],this._wrapY=S.wrapLat&&!this.options.noWrap&&[Math.floor(x.project([S.wrapLat[0],0],W).y/D.x),Math.ceil(x.project([S.wrapLat[1],0],W).y/D.y)]},_onMoveEnd:function(x){x&&(x.pinch||x.flyTo)||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds:function(x){var S=this._map,D=S._animatingZoom?Math.max(S._animateToZoom,S.getZoom()):S.getZoom(),W=S.getZoomScale(D,this._cellZoom),it=S.project(x,this._cellZoom).floor(),pt=S.getSize().divideBy(2*W);return new ft.Bounds(it.subtract(pt),it.add(pt))},_update:function(x){var S=this._map;if(S){var D=Math.round(S.getZoom());void 0===x&&(x=S.getCenter());var W=this._getCelldPixelBounds(x),it=this._pxBoundsToCellRange(W),pt=it.getCenter(),At=[],Qt=this.options.keepBuffer,he=new ft.Bounds(it.getBottomLeft().subtract([Qt,-Qt]),it.getTopRight().add([Qt,-Qt]));if(!(isFinite(it.min.x)&&isFinite(it.min.y)&&isFinite(it.max.x)&&isFinite(it.max.y)))throw new Error("Attempted to load an infinite number of cells");for(var Pe in this._cells){var ui=this._cells[Pe].coords;ui.z===this._cellZoom&&he.contains(new ft.Point(ui.x,ui.y))||(this._cells[Pe].current=!1)}if(Math.abs(D-this._cellZoom)>1)this._setView(x,D);else{for(var bn=it.min.y;bn<=it.max.y;bn++)for(var Ri=it.min.x;Ri<=it.max.x;Ri++){var qn=new ft.Point(Ri,bn);if(qn.z=this._cellZoom,this._isValidCell(qn)){var Gn=this._cells[this._cellCoordsToKey(qn)];Gn?Gn.current=!0:At.push(qn)}}if(At.sort(function(eo,er){return eo.distanceTo(pt)-er.distanceTo(pt)}),0!==At.length)for(this._loading||(this._loading=!0),Ri=0;Ri<At.length;Ri++){var fo=this._cellCoordsToKey(At[Ri]),ar=this._keyToCellCoords(fo);this._activeCells[ar]?this._reuseCell(At[Ri]):this._createCell(At[Ri])}}}},_isValidCell:function(x){var S=this._map.options.crs;if(!S.infinite){var D=this._globalCellRange;if(!S.wrapLng&&(x.x<D.min.x||x.x>D.max.x)||!S.wrapLat&&(x.y<D.min.y||x.y>D.max.y))return!1}if(!this.options.bounds)return!0;var W=this._cellCoordsToBounds(x);return ft.toLatLngBounds(this.options.bounds).overlaps(W)},_keyToBounds:function(x){return this._cellCoordsToBounds(this._keyToCellCoords(x))},_cellCoordsToNwSe:function(x){var S=this._map,D=this.getCellSize(),W=x.scaleBy(D),it=W.add(D);return[S.unproject(W,x.z),S.unproject(it,x.z)]},_cellCoordsToBounds:function(x){var S=this._cellCoordsToNwSe(x),D=new ft.LatLngBounds(S[0],S[1]);return this.options.noWrap||(D=this._map.wrapLatLngBounds(D)),D},_cellCoordsToKey:function(x){return x.x+":"+x.y+":"+x.z},_keyToCellCoords:function(x){var S=x.split(":"),D=new ft.Point(+S[0],+S[1]);return D.z=+S[2],D},_removeCell:function(x){var S=this._cells[x];if(S){var D=this._keyToCellCoords(x),W=this._wrapCoords(D),it=this._cellCoordsToBounds(this._wrapCoords(D));S.current=!1,delete this._cells[x],this._activeCells[x]=S,this.cellLeave(it,W,x),this.fire("cellleave",{key:x,coords:W,bounds:it})}},_reuseCell:function(x){var S=this._cellCoordsToKey(x);this._cells[S]=this._activeCells[S],this._cells[S].current=!0;var D=this._wrapCoords(x),W=this._cellCoordsToBounds(this._wrapCoords(x));this.cellEnter(W,D,S),this.fire("cellenter",{key:S,coords:D,bounds:W})},_createCell:function(x){var S=this._cellCoordsToKey(x),D=this._wrapCoords(x),W=this._cellCoordsToBounds(this._wrapCoords(x));this.createCell(W,D,S),this.fire("cellcreate",{key:S,coords:D,bounds:W}),this._cells[S]={coords:x,current:!0},ft.Util.requestAnimFrame(this._pruneCells,this)},_cellReady:function(x,S,D){var W=this._cellCoordsToKey(x);(D=this._cells[W])&&(D.loaded=+new Date,D.active=!0)},_getCellPos:function(x){return x.scaleBy(this.getCellSize())},_wrapCoords:function(x){var S=new ft.Point(this._wrapX?ft.Util.wrapNum(x.x,this._wrapX):x.x,this._wrapY?ft.Util.wrapNum(x.y,this._wrapY):x.y);return S.z=x.z,S},_pxBoundsToCellRange:function(x){var S=this.getCellSize();return new ft.Bounds(x.min.unscaleBy(S).floor(),x.max.unscaleBy(S).ceil().subtract([1,1]))}});function di(x){this.values=[].concat(x||[])}di.prototype.query=function(x){var S=this.getIndex(x);return this.values[S]},di.prototype.getIndex=function(x){this.dirty&&this.sort();for(var S,D,W=0,it=this.values.length-1;W<=it;)if(S=(W+it)/2|0,+(D=this.values[Math.round(S)]).value<+x)W=S+1;else{if(!(+D.value>+x))return S;it=S-1}return Math.abs(~it)},di.prototype.between=function(x,S){var D=this.getIndex(x),W=this.getIndex(S);if(0===D&&0===W)return[];for(;this.values[D-1]&&this.values[D-1].value===x;)D--;for(;this.values[W+1]&&this.values[W+1].value===S;)W++;return this.values[W]&&this.values[W].value===S&&this.values[W+1]&&W++,this.values.slice(D,W)},di.prototype.insert=function(x){return this.values.splice(this.getIndex(x.value),0,x),this},di.prototype.bulkAdd=function(x,S){return this.values=this.values.concat([].concat(x||[])),S?this.sort():this.dirty=!0,this},di.prototype.sort=function(){return this.values.sort(function(x,S){return+S.value-+x.value}).reverse(),this.dirty=!1,this};var wi=Zi.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize:function(x){if(Zi.prototype.initialize.call(this,x),x=Pi(x),x=ft.Util.setOptions(this,x),this.service=or(x),this.service.addEventParent(this),"*"!==this.options.fields[0]){for(var S=!1,D=0;D<this.options.fields.length;D++)this.options.fields[D].match(/^(OBJECTID|FID|OID|ID)$/i)&&(S=!0);!1===S&&yn("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new di,this._endTimeIndex=new di):this.options.timeField&&(this._timeIndex=new di),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(x){return Ln(x),this.service.metadata(function(S,D){if(!S){var W=D.supportedQueryFormats,it=!1;(!1===this.service.options.isModern||this.options.fetchAllFeatures)&&(it=!0),!it&&W&&-1!==W.indexOf("geoJSON")&&(this.service.options.isModern=!0),D.objectIdField&&(this.service.options.idAttribute=D.objectIdField),!this.options.attribution&&x.attributionControl&&D.copyrightText&&(this.options.attribution=D.copyrightText,x.attributionControl.addAttribution(this.getAttribution()))}},this),x.on("zoomend",this._handleZoomChange,this),Zi.prototype.onAdd.call(this,x)},onRemove:function(x){return Ni(x),x.off("zoomend",this._handleZoomChange,this),Zi.prototype.onRemove.call(this,x)},getAttribution:function(){return this.options.attribution},createCell:function(x,S){this._visibleZoom()&&this._requestFeatures(x,S)},_requestFeatures:function(x,S,D,W){this._activeRequests++,W=W||0;var it=this.options.where;return 1===this._activeRequests&&this.fire("loading",{bounds:x},!0),this._buildQuery(x,W).run(function(pt,At,Qt){Qt&&Qt.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===it&&(!pt&&At&&At.features.length&&ft.Util.requestAnimFrame(ft.Util.bind(function(){this._addFeatures(At.features,S),this._postProcessFeatures(x)},this)),pt||!At||At.features.length||this._postProcessFeatures(x),pt&&this._postProcessFeatures(x),D&&D.call(this,pt,At),Qt&&(Qt.exceededTransferLimit||Qt.properties&&Qt.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(x,S,D,W+At.features.length))},this)},_postProcessFeatures:function(x){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:x})},_cacheKey:function(x){return x.z+":"+x.x+":"+x.y},_addFeatures:function(x,S){if(S){var D=this._cacheKey(S);this._cache[D]=this._cache[D]||[]}for(var W=x.length-1;W>=0;W--){var it=x[W].id;-1===this._currentSnapshot.indexOf(it)&&this._currentSnapshot.push(it),void 0!==D&&-1===this._cache[D].indexOf(it)&&this._cache[D].push(it)}this.options.timeField&&this._buildTimeIndexes(x),this.createLayers(x)},_buildQuery:function(x,S){var D=this.service.query().intersects(x).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(S))&&(D=D.offset(S)),D.params.resultType="tile",this.options.requestParams&&ft.Util.extend(D.params,this.options.requestParams),this.options.simplifyFactor&&D.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&D.between(this.options.from,this.options.to),D},setWhere:function(x,S,D){this.options.where=x&&x.length?x:"1=1";for(var W=[],it=[],pt=0,At=null,Qt=ft.Util.bind(function(Ri,qn){if(Ri&&(At=Ri),qn)for(var Gn=qn.features.length-1;Gn>=0;Gn--)it.push(qn.features[Gn].id);--pt<=0&&this._visibleZoom()&&x===this.options.where&&(this._currentSnapshot=it,ft.Util.requestAnimFrame(ft.Util.bind(function(){this.removeLayers(W),this.addLayers(it),S&&S.call(D,At)},this)))},this),he=this._currentSnapshot.length-1;he>=0;he--)W.push(this._currentSnapshot[he]);for(var Pe in this._cache={},this._cells){pt++;var ui=this._keyToCellCoords(Pe),bn=this._cellCoordsToBounds(ui);this._requestFeatures(bn,ui,Qt)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(x,S,D,W){var it=this.options.from,pt=this.options.to,At=0,Qt=null,he=ft.Util.bind(function(Ri){Ri&&(Qt=Ri),this._filterExistingFeatures(it,pt,x,S),At--,D&&At<=0&&D.call(W,Qt)},this);if(this.options.from=x,this.options.to=S,this._filterExistingFeatures(it,pt,x,S),"server"===this.options.timeFilterMode)for(var Pe in this._cells){At++;var ui=this._keyToCellCoords(Pe),bn=this._cellCoordsToBounds(ui);this._requestFeatures(bn,ui,he)}return this},refresh:function(){this.setWhere(this.options.where)},_filterExistingFeatures:function(x,S,D,W){var it=x&&S?this._getFeaturesInTimeRange(x,S):this._currentSnapshot,pt=this._getFeaturesInTimeRange(D,W);if(pt.indexOf)for(var At=0;At<pt.length;At++){var Qt=it.indexOf(pt[At]);Qt>=0&&it.splice(Qt,1)}ft.Util.requestAnimFrame(ft.Util.bind(function(){this.removeLayers(it),this.addLayers(pt)},this))},_getFeaturesInTimeRange:function(x,S){var D,W=[];if(this.options.timeField.start&&this.options.timeField.end){var it=this._startTimeIndex.between(x,S),pt=this._endTimeIndex.between(x,S);D=it.concat(pt)}else{if(!this._timeIndex)return yn("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];D=this._timeIndex.between(x,S)}for(var At=D.length-1;At>=0;At--)W.push(D[At].id);return W},_buildTimeIndexes:function(x){var S,D;if(this.options.timeField.start&&this.options.timeField.end){var W=[],it=[];for(S=x.length-1;S>=0;S--)W.push({id:(D=x[S]).id,value:new Date(D.properties[this.options.timeField.start])}),it.push({id:D.id,value:new Date(D.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(W),this._endTimeIndex.bulkAdd(it)}else{var pt=[];for(S=x.length-1;S>=0;S--)pt.push({id:(D=x[S]).id,value:new Date(D.properties[this.options.timeField])});this._timeIndex.bulkAdd(pt)}},_featureWithinTimeRange:function(x){if(!this.options.from||!this.options.to)return!0;var S=+this.options.from.valueOf(),D=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var W=+x.properties[this.options.timeField];return W>=S&&W<=D}if(this.options.timeField.start&&this.options.timeField.end){var it=+x.properties[this.options.timeField.start],pt=+x.properties[this.options.timeField.end];return it>=S&&it<=D||pt>=S&&pt<=D||it<=S&&pt>=D}},_visibleZoom:function(){if(!this._map)return!1;var x=this._map.getZoom();return!(x>this.options.maxZoom||x<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var x in this._cells){var D=this._cacheKey(this._cells[x].coords);this._cache[D]&&this.addLayers(this._cache[D])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(x){return this.service.authenticate(x),this},metadata:function(x,S){return this.service.metadata(x,S),this},query:function(){return this.service.query()},_getMetadata:function(x){this._metadata?x(void 0,this._metadata):this.metadata(ft.Util.bind(function(S,D){this._metadata=D,x(S,this._metadata)},this))},addFeature:function(x,S,D){this.addFeatures(x,S,D)},addFeatures:function(x,S,D){this._getMetadata(ft.Util.bind(function(W,it){if(W)S&&S.call(this,W,null);else{var pt=x.features?x.features:[x];this.service.addFeatures(x,ft.Util.bind(function(At,Qt){if(!At){for(var he=pt.length-1;he>=0;he--)pt[he].properties[it.objectIdField]=pt.length>1?Qt[he].objectId:Qt.objectId,pt[he].id=pt.length>1?Qt[he].objectId:Qt.objectId;this._addFeatures(pt)}S&&S.call(D,At,Qt)},this))}},this))},updateFeature:function(x,S,D){this.updateFeatures(x,S,D)},updateFeatures:function(x,S,D){var W=x.features?x.features:[x];this.service.updateFeatures(x,function(it,pt){if(!it){for(var At=W.length-1;At>=0;At--)this.removeLayers([W[At].id],!0);this._addFeatures(W)}S&&S.call(D,it,pt)},this)},deleteFeature:function(x,S,D){this.deleteFeatures(x,S,D)},deleteFeatures:function(x,S,D){return this.service.deleteFeatures(x,function(W,it){var pt=it.length?it:[it];if(!W&&pt.length>0)for(var At=pt.length-1;At>=0;At--)this.removeLayers([pt[At].objectId],!0);S&&S.call(D,W,it)},this)}}),Qr=wi.extend({options:{cacheLayers:!0},initialize:function(x){x.apikey&&(x.token=x.apikey),wi.prototype.initialize.call(this,x),this._originalStyle=this.options.style,this._layers={}},onRemove:function(x){for(var S in this._layers)x.removeLayer(this._layers[S]),this.fire("removefeature",{feature:this._layers[S].feature,permanent:!1},!0);return wi.prototype.onRemove.call(this,x)},createNewLayer:function(x){var S=ft.GeoJSON.geometryToLayer(x,this.options);return S&&(S.defaultOptions=S.options),S},_updateLayer:function(x,S){var D=[],W=this.options.coordsToLatLng||ft.GeoJSON.coordsToLatLng;switch(S.properties&&(x.feature.properties=S.properties),S.geometry.type){case"Point":D=ft.GeoJSON.coordsToLatLng(S.geometry.coordinates),x.setLatLng(D);break;case"LineString":D=ft.GeoJSON.coordsToLatLngs(S.geometry.coordinates,0,W),x.setLatLngs(D);break;case"MultiLineString":case"Polygon":D=ft.GeoJSON.coordsToLatLngs(S.geometry.coordinates,1,W),x.setLatLngs(D);break;case"MultiPolygon":D=ft.GeoJSON.coordsToLatLngs(S.geometry.coordinates,2,W),x.setLatLngs(D)}this.redraw(x.feature.id)},createLayers:function(x){for(var S=x.length-1;S>=0;S--){var D,W=x[S],it=this._layers[W.id];!this._visibleZoom()||!it||this._map.hasLayer(it)||this.options.timeField&&!this._featureWithinTimeRange(W)||(this._map.addLayer(it),this.fire("addfeature",{feature:it.feature},!0)),it&&(it.setLatLngs||it.setLatLng)&&this._updateLayer(it,W),it||((D=this.createNewLayer(W))?(D.feature=W,D.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(D.feature,D),this._layers[D.feature.id]=D,this.setFeatureStyle(D.feature.id,this.options.style),this.fire("createfeature",{feature:D.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(W))&&this._map.addLayer(D)):yn("invalid GeoJSON encountered"))}},addLayers:function(x){for(var S=x.length-1;S>=0;S--){var D=this._layers[x[S]];!D||this.options.timeField&&!this._featureWithinTimeRange(D.feature)||(this._map.addLayer(D),this.fire("addfeature",{feature:D.feature},!0))}},removeLayers:function(x,S){for(var D=x.length-1;D>=0;D--){var W=x[D],it=this._layers[W];it&&(this.fire("removefeature",{feature:it.feature,permanent:S},!0),this._map.removeLayer(it)),it&&S&&delete this._layers[W]}},cellEnter:function(x,S){this._visibleZoom()&&!this._zooming&&this._map&&ft.Util.requestAnimFrame(ft.Util.bind(function(){var D=this._cacheKey(S),W=this._cellCoordsToKey(S),it=this._cache[D];this._activeCells[W]&&it&&this.addLayers(it)},this))},cellLeave:function(x,S){this._zooming||ft.Util.requestAnimFrame(ft.Util.bind(function(){if(this._map){var D=this._cacheKey(S),W=this._cellCoordsToKey(S),it=this._cache[D],pt=this._map.getBounds();if(!this._activeCells[W]&&it){for(var At=!0,Qt=0;Qt<it.length;Qt++){var he=this._layers[it[Qt]];he&&he.getBounds&&pt.intersects(he.getBounds())&&(At=!1)}At&&this.removeLayers(it,!this.options.cacheLayers),!this.options.cacheLayers&&At&&(delete this._cache[D],delete this._cells[W],delete this._activeCells[W])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(x){this.resetFeatureStyle(x.feature.id)},this),this},setStyle:function(x){return this.options.style=x,this.eachFeature(function(S){this.setFeatureStyle(S.feature.id,x)},this),this},resetFeatureStyle:function(x){var S=this._layers[x],D=this._originalStyle||ft.Path.prototype.options;return S&&(ft.Util.extend(S.options,S.defaultOptions),this.setFeatureStyle(x,D)),this},setFeatureStyle:function(x,S){var D=this._layers[x];return"function"==typeof S&&(S=S(D.feature)),D.setStyle&&D.setStyle(S),this},eachActiveFeature:function(x,S){if(this._map){var D=this._map.getBounds();for(var W in this._layers)-1!==this._currentSnapshot.indexOf(this._layers[W].feature.id)&&("function"==typeof this._layers[W].getLatLng&&D.contains(this._layers[W].getLatLng())||"function"==typeof this._layers[W].getBounds&&D.intersects(this._layers[W].getBounds()))&&x.call(S,this._layers[W])}return this},eachFeature:function(x,S){for(var D in this._layers)x.call(S,this._layers[D]);return this},getFeature:function(x){return this._layers[x]},bringToBack:function(){this.eachFeature(function(x){x.bringToBack&&x.bringToBack()})},bringToFront:function(){this.eachFeature(function(x){x.bringToFront&&x.bringToFront()})},redraw:function(x){return x&&this._redraw(x),this},_redraw:function(x){var S=this._layers[x],D=S.feature;if(S&&S.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var W=this.options.pointToLayer(D,ft.latLng(D.geometry.coordinates[1],D.geometry.coordinates[0])).options.icon;S.setIcon(W)}if(S&&S.setStyle&&this.options.pointToLayer){var it=this.options.pointToLayer(D,ft.latLng(D.geometry.coordinates[1],D.geometry.coordinates[0])).options;this.setFeatureStyle(D.id,it)}S&&S.setStyle&&this.options.style&&this.resetStyle(D.id)}});Pt.BasemapLayer=vn,Pt.DynamicMapLayer=En,Pt.FeatureLayer=Qr,Pt.FeatureLayerService=_i,Pt.FeatureManager=wi,Pt.Find=Wo,Pt.Identify=_r,Pt.IdentifyFeatures=Zn,Pt.IdentifyImage=Qn,Pt.ImageMapLayer=un,Pt.ImageService=kn,Pt.MapService=tr,Pt.Query=Go,Pt.RasterLayer=xn,Pt.Service=Sn,Pt.Support=Lr,Pt.Task=_e,Pt.TiledMapLayer=Ve,Pt.Util=Ye,Pt.VERSION="3.0.8",Pt.basemapLayer=function(x,S){return new vn(x,S)},Pt.dynamicMapLayer=function(x,S){return new En(x,S)},Pt.featureLayer=function(x){return new Qr(x)},Pt.featureLayerService=or,Pt.find=mr,Pt.get=aa,Pt.identify=function(x){return new _r(x)},Pt.identifyFeatures=Tn,Pt.identifyImage=Vr,Pt.imageMapLayer=function(x,S){return new un(x,S)},Pt.imageService=Zr,Pt.mapService=zn,Pt.options=ai,Pt.post=Yr,Pt.query=Vn,Pt.request=$r,Pt.service=function(x){return x=Pi(x),new Sn(x)},Pt.task=function(x){return x=Pi(x),new _e(x)},Pt.tiledMapLayer=function(x,S){return new Ve(x,S)},Object.defineProperty(Pt,"__esModule",{value:!0})}),function(Pt,ft){"object"==typeof exports&&typeof module<"u"?ft(exports,require("leaflet"),require("esri-leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet","esri-leaflet"],ft):ft(((Pt=typeof globalThis<"u"?globalThis:Pt||self).L=Pt.L||{},Pt.L.esri=Pt.L.esri||{},Pt.L.esri.Vector={}),Pt.L,Pt.L.esri)}(this,function(Pt,ft,Cr){"use strict";function xi(Ft,ee,Fe){Cr.request(Ft,ee.token?{token:ee.token}:{},Fe)}function ai(Ft,ee,Fe){xi(Ft,ee,function(Te,Di){Te&&console.error(Te);var gn,c=Ft;"/"===Ft.charAt(Ft.length-1)&&(c=Ft.slice(0,Ft.length-1)),Jr(gn="/"===Di.defaultStyles.charAt(0)?c+Di.defaultStyles+"/root.json":c+"/"+Di.defaultStyles+"/root.json",ee,function(mi,Mt){mi&&console.error(mi),Fe(null,Mt,gn,Di,Ft)})})}function Jr(Ft,ee,Fe){Cr.request(Ft,ee.token?{token:ee.token}:{},Fe)}function co(Ft,ee){Cr.Support.cors&&Cr.request(Ft,{},function(Fe,Te){if(!Fe){ee._esriAttributions=ee._esriAttributions||[];for(var Di=0;Di<Te.contributors.length;Di++)for(var gn=Te.contributors[Di],c=0;c<gn.coverageAreas.length;c++){var mi=gn.coverageAreas[c],Mt=ft.latLng(mi.bbox[0],mi.bbox[1]),Me=ft.latLng(mi.bbox[2],mi.bbox[3]);ee._esriAttributions.push({attribution:gn.attribution,score:mi.score,bounds:ft.latLngBounds(Mt,Me),minZoom:mi.zoomMin,maxZoom:mi.zoomMax})}ee._esriAttributions.sort(function(Qi,Zt){return Zt.score-Qi.score}),Cr.Util._updateMapAttribution({target:ee})}})}const Gi=[3857,102100,102113];typeof globalThis<"u"||typeof window<"u"||typeof global<"u"&&global;var Yr={exports:{}};Yr.exports=function(){var Fe,Te,Di;function gn(c,mi){if(Fe)if(Te){var Mt="var sharedChunk = {}; ("+Fe+")(sharedChunk); ("+Te+")(sharedChunk);",Me={};Fe(Me),Di=mi(Me),typeof window<"u"&&(Di.workerUrl=window.URL.createObjectURL(new Blob([Mt],{type:"text/javascript"})))}else Te=mi;else Fe=mi}return gn(0,function(c){function mi(t,e){return t(e={exports:{}},e.exports),e.exports}var Mt=Me;function Me(t,e,i,s){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=i,this.p2y=s}Me.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Me.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Me.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Me.prototype.solveCurveX=function(t,e){var i,s,u,p,f;for(void 0===e&&(e=1e-6),u=t,f=0;f<8;f++){if(p=this.sampleCurveX(u)-t,Math.abs(p)<e)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=p/v}if((u=t)<(i=0))return i;if(u>(s=1))return s;for(;i<s;){if(p=this.sampleCurveX(u),Math.abs(p-t)<e)return u;t>p?i=u:s=u,u=.5*(s-i)+i}return u},Me.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var le=Qi;function Qi(t,e){this.x=t,this.y=e}Qi.prototype={clone:function(){return new Qi(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),s=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=s,this},_rotateAround:function(t,e){var i=Math.cos(t),s=Math.sin(t),u=e.y+s*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-s*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qi.convert=function(t){return t instanceof Qi?t:Array.isArray(t)?new Qi(t[0],t[1]):t};var Zt=typeof self<"u"?self:{},ln=Math.pow(2,53)-1;function tn(t,e,i,s){var u=new Mt(t,e,i,s);return function(p){return u.solve(p)}}var Ee=tn(.25,.1,.25,1);function jn(t,e,i){return Math.min(i,Math.max(e,t))}function ti(t,e,i){var s=i-e,u=((t-e)%s+s)%s+e;return u===e?i:u}function je(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var s=0,u=e;s<u.length;s+=1){var p=u[s];for(var f in p)t[f]=p[f]}return t}var Ut=1;function Pi(){return Ut++}function Ci(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function We(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function bi(t,e){t.forEach(function(i){e[i]&&(e[i]=e[i].bind(e))})}function Ln(t,e){return-1!==t.indexOf(e,t.length-e.length)}function Ni(t,e,i){var s={};for(var u in t)s[u]=e.call(i||this,t[u],u,t);return s}function on(t,e,i){var s={};for(var u in t)e.call(i||this,t[u],u,t)&&(s[u]=t[u]);return s}function fr(t){return Array.isArray(t)?t.map(fr):"object"==typeof t&&t?Ni(t,fr):t}var zr={};function Ye(t){zr[t]||(typeof console<"u"&&console.warn(t),zr[t]=!0)}function _e(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function Go(t){for(var e=0,i=0,s=t.length,u=s-1,p=void 0,f=void 0;i<s;u=i++)e+=((f=t[u]).x-(p=t[i]).x)*(p.y+f.y);return e}function Vn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Wo(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(s,u,p,f){var v=p||f;return e[u]=!v||v.toLowerCase(),""}),e["max-age"]){var i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}var mr=null;function _r(t){if(null==mr){var e=t.navigator?t.navigator.userAgent:null;mr=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return mr}function Zn(t){try{var e=Zt[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}var Tn,Qn,Vr,Sn,tr=Zt.performance&&Zt.performance.now?Zt.performance.now.bind(Zt.performance):Date.now.bind(Date),zn=Zt.requestAnimationFrame||Zt.mozRequestAnimationFrame||Zt.webkitRequestAnimationFrame||Zt.msRequestAnimationFrame,kn=Zt.cancelAnimationFrame||Zt.mozCancelAnimationFrame||Zt.webkitCancelAnimationFrame||Zt.msCancelAnimationFrame,Zr={now:tr,frame:function(t){var e=zn(t);return{cancel:function(){return kn(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var i=Zt.document.createElement("canvas"),s=i.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return i.width=t.width,i.height=t.height,s.drawImage(t,0,0,t.width,t.height),s.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return Tn||(Tn=Zt.document.createElement("a")),Tn.href=t,Tn.href},hardwareConcurrency:Zt.navigator&&Zt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Zt.devicePixelRatio},get prefersReducedMotion(){return!!Zt.matchMedia&&(null==Qn&&(Qn=Zt.matchMedia("(prefers-reduced-motion: reduce)")),Qn.matches)}},_i={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},or={supported:!1,testSupport:function(t){!Bi&&Sn&&(vn?Ve(t):Vr=t)}},Bi=!1,vn=!1;function Ve(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Sn),t.isContextLost())return;or.supported=!0}catch{}t.deleteTexture(e),Bi=!0}Zt.document&&((Sn=Zt.document.createElement("img")).onload=function(){Vr&&Ve(Vr),Vr=null,vn=!0},Sn.onerror=function(){Bi=!0,Vr=null},Sn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var po="01",xn=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function un(t){return 0===t.indexOf("mapbox:")}xn.prototype._createSkuToken=function(){var t=function(){for(var e="",i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",po,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},xn.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},xn.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},xn.prototype.normalizeStyleURL=function(t,e){if(!un(t))return t;var i=wi(t);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},xn.prototype.normalizeGlyphsURL=function(t,e){if(!un(t))return t;var i=wi(t);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},xn.prototype.normalizeSourceURL=function(t,e){if(!un(t))return t;var i=wi(t);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||e)},xn.prototype.normalizeSpriteURL=function(t,e,i,s){var u=wi(t);return un(t)?(u.path="/styles/v1"+u.path+"/sprite"+e+i,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=""+e+i,Qr(u))},xn.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!un(t))return t;var i=wi(t);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Zr.devicePixelRatio>=2||512===e?"@2x":"")+(or.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var s=this._customAccessToken||function(u){for(var p=0,f=u;p<f.length;p+=1){var v=f[p].match(/^access_token=(.*)$/);if(v)return v[1]}return null}(i.params)||_i.ACCESS_TOKEN;return _i.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,s)},xn.prototype.canonicalizeTileURL=function(t,e){var i=wi(t);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return t;var s="mapbox://tiles/";s+=i.path.replace("/v4/","");var u=i.params;return e&&(u=u.filter(function(p){return!p.match(/^access_token=/)})),u.length&&(s+="?"+u.join("&")),s},xn.prototype.canonicalizeTileset=function(t,e){for(var i=!!e&&un(e),s=[],u=0,p=t.tiles||[];u<p.length;u+=1){var f=p[u];Zi(f)?s.push(this.canonicalizeTileURL(f,i)):s.push(f)}return s},xn.prototype._makeAPIURL=function(t,e){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=wi(_i.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,"http"===t.protocol){var u=t.params.indexOf("secure");u>=0&&t.params.splice(u,1)}if("/"!==s.path&&(t.path=""+s.path+t.path),!_i.REQUIRE_ACCESS_TOKEN)return Qr(t);if(!(e=e||_i.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return t.params=t.params.filter(function(p){return-1===p.indexOf("access_token")}),t.params.push("access_token="+e),Qr(t)};var En=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Zi(t){return En.test(t)}var di=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function wi(t){var e=t.match(di);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Qr(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function to(t){if(!t)return null;var e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(Zt.atob(e[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var x=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};x.prototype.getStorageKey=function(t){var e,i=to(_i.ACCESS_TOKEN);return e=i&&i.u?Zt.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(s,u){return String.fromCharCode(Number("0x"+u))})):_i.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},x.prototype.fetchEventData=function(){var t=Zn("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{var s=Zt.localStorage.getItem(e);s&&(this.eventData=JSON.parse(s));var u=Zt.localStorage.getItem(i);u&&(this.anonId=u)}catch{Ye("Unable to read from LocalStorage")}},x.prototype.saveEventData=function(){var t=Zn("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{Zt.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&Zt.localStorage.setItem(e,JSON.stringify(this.eventData))}catch{Ye("Unable to write to LocalStorage")}},x.prototype.processRequests=function(t){},x.prototype.postEvent=function(t,e,i,s){var u=this;if(_i.EVENTS_URL){var p=wi(_i.EVENTS_URL);p.params.push("access_token="+(s||_i.ACCESS_TOKEN||""));var f={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.1",skuId:po,userId:this.anonId},v=e?je(f,e):f,T={url:Qr(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=Yi(T,function(I){u.pendingRequest=null,i(I),u.saveEventData(),u.processRequests(s)})}},x.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var S,D,W=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(i,s,u,p){this.skuToken=u,(_i.EVENTS_URL&&p||_i.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(f){return un(f)||Zi(f)}))&&this.queueRequest({id:s,timestamp:Date.now()},p)},e.prototype.processRequests=function(i){var s=this;if(!this.pendingRequest&&0!==this.queue.length){var u=this.queue.shift(),p=u.id,f=u.timestamp;p&&this.success[p]||(this.anonId||this.fetchEventData(),We(this.anonId)||(this.anonId=Ci()),this.postEvent(f,{skuToken:this.skuToken},function(v){v||p&&(s.success[p]=!0)},i))}},e}(x),it=new(function(t){function e(i){t.call(this,"appUserTurnstile"),this._customAccessToken=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(i,s){_i.EVENTS_URL&&_i.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(u){return un(u)||Zi(u)})&&this.queueRequest(Date.now(),s)},e.prototype.processRequests=function(i){var s=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var u=to(_i.ACCESS_TOKEN),p=u?u.u:_i.ACCESS_TOKEN,f=p!==this.eventData.tokenU;We(this.anonId)||(this.anonId=Ci(),f=!0);var v=this.queue.shift();if(this.eventData.lastSuccess){var T=new Date(this.eventData.lastSuccess),I=new Date(v),A=(v-this.eventData.lastSuccess)/864e5;f=f||A>=1||A<-1||T.getDate()!==I.getDate()}else f=!0;if(!f)return this.processRequests();this.postEvent(v,{"enabled.telemetry":!1},function(k){k||(s.eventData.lastSuccess=v,s.eventData.tokenU=p)},i)}},e}(x)),pt=it.postTurnstileEvent.bind(it),At=new W,Qt=At.postMapLoadEvent.bind(At),he=500,Pe=50;function ui(){Zt.caches&&!S&&(S=Zt.caches.open("mapbox-tiles"))}function bn(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var Ri,qn=1/0;function Gn(){return null==Ri&&(Ri=Zt.OffscreenCanvas&&new Zt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof Zt.createImageBitmap),Ri}var fo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(fo);var ar,eo,er=function(t){function e(i,s,u){401===s&&Zi(u)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,i),this.status=s,this.url=u,this.name=this.constructor.name,this.message=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),sr=Vn()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===Zt.location.protocol?Zt.parent:Zt).location.href},ko=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(sr())&&!/^\w+:/.test(i))){if(Zt.fetch&&Zt.Request&&Zt.AbortController&&Zt.Request.prototype.hasOwnProperty("signal"))return function(s,u){var p,f=new Zt.AbortController,v=new Zt.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:sr(),signal:f.signal}),T=!1,I=!1,A=(p=v.url).indexOf("sku=")>0&&Zi(p);"json"===s.type&&v.headers.set("Accept","application/json");var k=function(U,K,$){if(!I){if(U&&"SecurityError"!==U.message&&Ye(U),K&&$)return R(K);var lt=Date.now();Zt.fetch(v).then(function(nt){if(nt.ok){var dt=A?nt.clone():null;return R(nt,dt,lt)}return u(new er(nt.statusText,nt.status,s.url))}).catch(function(nt){20!==nt.code&&u(new Error(nt.message))})}},R=function(U,K,$){("arrayBuffer"===s.type?U.arrayBuffer():"json"===s.type?U.json():U.text()).then(function(lt){I||(K&&$&&function(nt,dt,yt){if(ui(),S){var xt={status:dt.status,statusText:dt.statusText,headers:new Zt.Headers};dt.headers.forEach(function(zt,Wt){return xt.headers.set(Wt,zt)});var Tt=Wo(dt.headers.get("Cache-Control")||"");Tt["no-store"]||(Tt["max-age"]&&xt.headers.set("Expires",new Date(yt+1e3*Tt["max-age"]).toUTCString()),new Date(xt.headers.get("Expires")).getTime()-yt<42e4||function(zt,Wt){if(void 0===D)try{new Response(new ReadableStream),D=!0}catch{D=!1}D?Wt(zt.body):zt.blob().then(Wt)}(dt,function(zt){var Wt=new Zt.Response(zt,xt);ui(),S&&S.then(function(te){return te.put(bn(nt.url),Wt)}).catch(function(te){return Ye(te.message)})}))}}(v,K,$),T=!0,u(null,lt,U.headers.get("Cache-Control"),U.headers.get("Expires")))}).catch(function(lt){I||u(new Error(lt.message))})};return A?function(U,K){if(ui(),!S)return K(null);var $=bn(U.url);S.then(function(lt){lt.match($).then(function(nt){var dt=function(yt){if(!yt)return!1;var xt=new Date(yt.headers.get("Expires")||0),Tt=Wo(yt.headers.get("Cache-Control")||"");return xt>Date.now()&&!Tt["no-cache"]}(nt);lt.delete($),dt&&lt.put($,nt.clone()),K(null,nt,dt)}).catch(K)}).catch(K)}(v,k):k(null,null),{cancel:function(){I=!0,T||f.abort()}}}(t,e);if(Vn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(s,u){var p=new Zt.XMLHttpRequest;for(var f in p.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(p.responseType="arraybuffer"),s.headers)p.setRequestHeader(f,s.headers[f]);return"json"===s.type&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials="include"===s.credentials,p.onerror=function(){u(new Error(p.statusText))},p.onload=function(){if((p.status>=200&&p.status<300||0===p.status)&&null!==p.response){var v=p.response;if("json"===s.type)try{v=JSON.parse(p.response)}catch(T){return u(T)}u(null,v,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else u(new er(p.statusText,p.status,s.url))},p.send(s.body),{cancel:function(){return p.abort()}}}(t,e)},lr=function(t,e){return ko(je(t,{type:"arrayBuffer"}),e)},Yi=function(t,e){return ko(je(t,{method:"POST"}),e)},z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ar=[],eo=0;var B=function(t,e){if(or.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),eo>=_i.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return ar.push(i),i}eo++;var s=!1,u=function(){if(!s)for(s=!0,eo--;ar.length&&eo<_i.MAX_PARALLEL_IMAGE_REQUESTS;){var f=ar.shift();f.cancelled||(f.cancel=B(f.requestParameters,f.callback).cancel)}},p=lr(t,function(f,v,T,I){var k,R;u(),f?e(f):v&&(Gn()?(k=e,R=new Zt.Blob([new Uint8Array(v)],{type:"image/png"}),Zt.createImageBitmap(R).then(function(U){k(null,U)}).catch(function(U){k(new Error("Could not load image because of "+U.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(A,k,R,U){var K=new Zt.Image,$=Zt.URL;K.onload=function(){k(null,K),$.revokeObjectURL(K.src),K.onload=null,Zt.requestAnimationFrame(function(){K.src=z})},K.onerror=function(){return k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var lt=new Zt.Blob([new Uint8Array(A)],{type:"image/png"});K.cacheControl=R,K.expires=U,K.src=A.byteLength?$.createObjectURL(lt):z}(v,e,T,I))});return{cancel:function(){p.cancel(),u()}}};function F(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function H(t,e,i){if(i&&i[t]){var s=i[t].indexOf(e);-1!==s&&i[t].splice(s,1)}}var J=function(t,e){void 0===e&&(e={}),je(this,e),this.type=t},ot=function(t){function e(i,s){void 0===s&&(s={}),t.call(this,"error",je({error:i},s))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(J),ut=function(){};ut.prototype.on=function(t,e){return this._listeners=this._listeners||{},F(t,e,this._listeners),this},ut.prototype.off=function(t,e){return H(t,e,this._listeners),H(t,e,this._oneTimeListeners),this},ut.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},F(t,e,this._oneTimeListeners),this},ut.prototype.fire=function(t,e){"string"==typeof t&&(t=new J(t,e||{}));var i=t.type;if(this.listens(i)){t.target=this;for(var s=0,u=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];s<u.length;s+=1)u[s].call(this,t);for(var p=0,f=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];p<f.length;p+=1){var v=f[p];H(i,v,this._oneTimeListeners),v.call(this,t)}var T=this._eventedParent;T&&(je(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),T.fire(t))}else t instanceof ot&&console.error(t.error);return this},ut.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},ut.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var N={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},et=function(t,e,i,s){this.message=(t?t+": ":"")+i,s&&(this.identifier=s),null!=e&&e.__line__&&(this.line=e.__line__)};function mt(t){var e=t.value;return e?[new et(t.key,e,"constants have been deprecated as of v8")]:[]}function Dt(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var s=0,u=e;s<u.length;s+=1){var p=u[s];for(var f in p)t[f]=p[f]}return t}function Nt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function bt(t){if(Array.isArray(t))return t.map(bt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var i in t)e[i]=bt(t[i]);return e}return Nt(t)}var Bt=function(t){function e(i,s){t.call(this,s),this.message=s,this.key=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),jt=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var i=0,s=e;i<s.length;i+=1){var u=s[i];this.bindings[u[0]]=u[1]}};jt.prototype.concat=function(t){return new jt(this,t)},jt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},jt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Gt={kind:"null"},St={kind:"number"},ie={kind:"string"},Kt={kind:"boolean"},Jt={kind:"color"},re={kind:"object"},Vt={kind:"value"},Ke={kind:"collator"},fi={kind:"formatted"},Ae={kind:"resolvedImage"};function hi(t,e){return{kind:"array",itemType:t,N:e}}function Ne(t){if("array"===t.kind){var e=Ne(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var Ti=[Gt,St,ie,Kt,Jt,fi,re,hi(Vt),Ae];function ei(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!ei(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var i=0,s=Ti;i<s.length;i+=1)if(!ei(s[i],e))return null}return"Expected "+Ne(t)+" but found "+Ne(e)+" instead."}function Xi(t,e){return e.some(function(i){return i.kind===t.kind})}function yi(t,e){return e.some(function(i){return"null"===i?null===t:"array"===i?Array.isArray(t):"object"===i?t&&!Array.isArray(t)&&"object"==typeof t:i===typeof t})}var He=mi(function(t,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(v){return(v=Math.round(v))<0?0:v>255?255:v}function u(v){return s("%"===v[v.length-1]?parseFloat(v)/100*255:parseInt(v))}function p(v){return(T="%"===v[v.length-1]?parseFloat(v)/100:parseFloat(v))<0?0:T>1?1:T;var T}function f(v,T,I){return I<0?I+=1:I>1&&(I-=1),6*I<1?v+(T-v)*I*6:2*I<1?T:3*I<2?v+(T-v)*(2/3-I)*6:v}try{e.parseCSSColor=function(v){var T,I=v.replace(/ /g,"").toLowerCase();if(I in i)return i[I].slice();if("#"===I[0])return 4===I.length?(T=parseInt(I.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:7===I.length&&(T=parseInt(I.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var A=I.indexOf("("),k=I.indexOf(")");if(-1!==A&&k+1===I.length){var R=I.substr(0,A),U=I.substr(A+1,k-(A+1)).split(","),K=1;switch(R){case"rgba":if(4!==U.length)return null;K=p(U.pop());case"rgb":return 3!==U.length?null:[u(U[0]),u(U[1]),u(U[2]),K];case"hsla":if(4!==U.length)return null;K=p(U.pop());case"hsl":if(3!==U.length)return null;var $=(parseFloat(U[0])%360+360)%360/360,lt=p(U[1]),nt=p(U[2]),dt=nt<=.5?nt*(lt+1):nt+lt-nt*lt,yt=2*nt-dt;return[s(255*f(yt,dt,$+1/3)),s(255*f(yt,dt,$)),s(255*f(yt,dt,$-1/3)),K];default:return null}}return null}}catch{}}).parseCSSColor,si=function(t,e,i,s){void 0===s&&(s=1),this.r=t,this.g=e,this.b=i,this.a=s};si.parse=function(t){if(t){if(t instanceof si)return t;if("string"==typeof t){var e=He(t);if(e)return new si(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},si.prototype.toString=function(){var t=this.toArray(),e=t[1],i=t[2],s=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(i)+","+s+")"},si.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},si.black=new si(0,0,0,1),si.white=new si(1,1,1,1),si.transparent=new si(0,0,0,0),si.red=new si(1,0,0,1);var Mn=function(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Mn.prototype.compare=function(t,e){return this.collator.compare(t,e)},Mn.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ho=function(t,e,i,s,u){this.text=t,this.image=e,this.scale=i,this.fontStack=s,this.textColor=u},Dn=function(t){this.sections=t};Dn.fromString=function(t){return new Dn([new Ho(t,null,null,null,null)])},Dn.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},Dn.factory=function(t){return t instanceof Dn?t:Dn.fromString(t)},Dn.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},Dn.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var s=i[e];if(s.image)t.push(["image",s.image.name]);else{t.push(s.text);var u={};s.fontStack&&(u["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(u["font-scale"]=s.scale),s.textColor&&(u["text-color"]=["rgba"].concat(s.textColor.toArray())),t.push(u)}}return t};var Oe=function(t){this.name=t.name,this.available=t.available};function ir(t,e,i,s){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:"Invalid rgba value ["+[t,e,i,s].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof s?[t,e,i,s]:[t,e,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function en(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof si||t instanceof Mn||t instanceof Dn||t instanceof Oe)return!0;if(Array.isArray(t)){for(var e=0,i=t;e<i.length;e+=1)if(!en(i[e]))return!1;return!0}if("object"==typeof t){for(var s in t)if(!en(t[s]))return!1;return!0}return!1}function nn(t){if(null===t)return Gt;if("string"==typeof t)return ie;if("boolean"==typeof t)return Kt;if("number"==typeof t)return St;if(t instanceof si)return Jt;if(t instanceof Mn)return Ke;if(t instanceof Dn)return fi;if(t instanceof Oe)return Ae;if(Array.isArray(t)){for(var e,i=t.length,s=0,u=t;s<u.length;s+=1){var p=nn(u[s]);if(e){if(e===p)continue;e=Vt;break}e=p}return hi(e||Vt,i)}return re}function sa(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof si||t instanceof Dn||t instanceof Oe?t.toString():JSON.stringify(t)}Oe.prototype.toString=function(){return this.name},Oe.fromString=function(t){return t?new Oe({name:t,available:!1}):null},Oe.prototype.serialize=function(){return["image",this.name]};var Bn=function(t,e){this.type=t,this.value=e};Bn.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!en(t[1]))return e.error("invalid value");var i=t[1],s=nn(i),u=e.expectedType;return"array"!==s.kind||0!==s.N||!u||"array"!==u.kind||"number"==typeof u.N&&0!==u.N||(s=u),new Bn(s,i)},Bn.prototype.evaluate=function(){return this.value},Bn.prototype.eachChild=function(){},Bn.prototype.outputDefined=function(){return!0},Bn.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof si?["rgba"].concat(this.value.toArray()):this.value instanceof Dn?this.value.serialize():this.value};var wn=function(t){this.name="ExpressionEvaluationError",this.message=t};wn.prototype.toJSON=function(){return this.message};var Wn={string:ie,number:St,boolean:Kt,object:re},Fi=function(t,e){this.type=t,this.args=e};Fi.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i,s=1,u=t[0];if("array"===u){var p,f;if(t.length>2){var v=t[1];if("string"!=typeof v||!(v in Wn)||"object"===v)return e.error('The item type argument of "array" must be one of string, number, boolean',1);p=Wn[v],s++}else p=Vt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);f=t[2],s++}i=hi(p,f)}else i=Wn[u];for(var T=[];s<t.length;s++){var I=e.parse(t[s],s,Vt);if(!I)return null;T.push(I)}return new Fi(i,T)},Fi.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var i=this.args[e].evaluate(t);if(!ei(this.type,nn(i)))return i;if(e===this.args.length-1)throw new wn("Expected value to be of type "+Ne(this.type)+", but found "+Ne(nn(i))+" instead.")}return null},Fi.prototype.eachChild=function(t){this.args.forEach(t)},Fi.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Fi.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var i=t.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){e.push(i.kind);var s=t.N;("number"==typeof s||this.args.length>1)&&e.push(s)}}return e.concat(this.args.map(function(u){return u.serialize()}))};var yr=function(t){this.type=fi,this.sections=t};yr.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return e.error("First argument must be an image or text section.");for(var s=[],u=!1,p=1;p<=t.length-1;++p){var f=t[p];if(u&&"object"==typeof f&&!Array.isArray(f)){u=!1;var v=null;if(f["font-scale"]&&!(v=e.parse(f["font-scale"],1,St)))return null;var T=null;if(f["text-font"]&&!(T=e.parse(f["text-font"],1,hi(ie))))return null;var I=null;if(f["text-color"]&&!(I=e.parse(f["text-color"],1,Jt)))return null;var A=s[s.length-1];A.scale=v,A.font=T,A.textColor=I}else{var k=e.parse(t[p],1,Vt);if(!k)return null;var R=k.type.kind;if("string"!==R&&"value"!==R&&"null"!==R&&"resolvedImage"!==R)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");u=!0,s.push({content:k,scale:null,font:null,textColor:null})}}return new yr(s)},yr.prototype.evaluate=function(t){return new Dn(this.sections.map(function(e){var i=e.content.evaluate(t);return nn(i)===Ae?new Ho("",i,null,null,null):new Ho(sa(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))},yr.prototype.eachChild=function(t){for(var e=0,i=this.sections;e<i.length;e+=1){var s=i[e];t(s.content),s.scale&&t(s.scale),s.font&&t(s.font),s.textColor&&t(s.textColor)}},yr.prototype.outputDefined=function(){return!1},yr.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var s=i[e];t.push(s.content.serialize());var u={};s.scale&&(u["font-scale"]=s.scale.serialize()),s.font&&(u["text-font"]=s.font.serialize()),s.textColor&&(u["text-color"]=s.textColor.serialize()),t.push(u)}return t};var an=function(t){this.type=Ae,this.input=t};an.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var i=e.parse(t[1],1,ie);return i?new an(i):e.error("No image name provided.")},an.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=Oe.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i},an.prototype.eachChild=function(t){t(this.input)},an.prototype.outputDefined=function(){return!1},an.prototype.serialize=function(){return["image",this.input.serialize()]};var Mo={"to-boolean":Kt,"to-color":Jt,"to-number":St,"to-string":ie},qr=function(t,e){this.type=t,this.args=e};qr.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[0];if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return e.error("Expected one argument.");for(var s=Mo[i],u=[],p=1;p<t.length;p++){var f=e.parse(t[p],p,Vt);if(!f)return null;u.push(f)}return new qr(s,u)},qr.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,i,s=0,u=this.args;s<u.length;s+=1){if(i=null,(e=u[s].evaluate(t))instanceof si)return e;if("string"==typeof e){var p=t.parseColor(e);if(p)return p}else if(Array.isArray(e)&&!(i=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":ir(e[0],e[1],e[2],e[3])))return new si(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new wn(i||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var f=null,v=0,T=this.args;v<T.length;v+=1){if(null===(f=T[v].evaluate(t)))return 0;var I=Number(f);if(!isNaN(I))return I}throw new wn("Could not convert "+JSON.stringify(f)+" to number.")}return"formatted"===this.type.kind?Dn.fromString(sa(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Oe.fromString(sa(this.args[0].evaluate(t))):sa(this.args[0].evaluate(t))},qr.prototype.eachChild=function(t){this.args.forEach(t)},qr.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},qr.prototype.serialize=function(){if("formatted"===this.type.kind)return new yr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new an(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var Vs=["Unknown","Point","LineString","Polygon"],io=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};io.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},io.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Vs[this.feature.type]:this.feature.type:null},io.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},io.prototype.canonicalID=function(){return this.canonical},io.prototype.properties=function(){return this.feature&&this.feature.properties||{}},io.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=si.parse(t)),e};var On=function(t,e,i,s){this.name=t,this.type=e,this._evaluate=i,this.args=s};On.prototype.evaluate=function(t){return this._evaluate(t,this.args)},On.prototype.eachChild=function(t){this.args.forEach(t)},On.prototype.outputDefined=function(){return!1},On.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},On.parse=function(t,e){var i,s=t[0],u=On.definitions[s];if(!u)return e.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0);for(var p=Array.isArray(u)?u[0]:u.type,f=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,v=f.filter(function(xe){var se=xe[0];return!Array.isArray(se)||se.length===t.length-1}),T=null,I=0,A=v;I<A.length;I+=1){var k=A[I],R=k[0],U=k[1];T=new Ko(e.registry,e.path,null,e.scope);for(var K=[],$=!1,lt=1;lt<t.length;lt++){var nt=t[lt],dt=Array.isArray(R)?R[lt-1]:R.type,yt=T.parse(nt,1+K.length,dt);if(!yt){$=!0;break}K.push(yt)}if(!$)if(Array.isArray(R)&&R.length!==K.length)T.error("Expected "+R.length+" arguments, but found "+K.length+" instead.");else{for(var xt=0;xt<K.length;xt++){var Tt=Array.isArray(R)?R[xt]:R.type,zt=K[xt];T.concat(xt+1).checkSubtype(Tt,zt.type)}if(0===T.errors.length)return new On(s,p,U,K)}}if(1===v.length)(i=e.errors).push.apply(i,T.errors);else{for(var Wt=(v.length?v:f).map(function(xe){var se;return se=xe[0],Array.isArray(se)?"("+se.map(Ne).join(", ")+")":"("+Ne(se.type)+"...)"}).join(" | "),te=[],ge=1;ge<t.length;ge++){var ae=e.parse(t[ge],1+te.length);if(!ae)return null;te.push(Ne(ae.type))}e.error("Expected arguments of type "+Wt+", but found ("+te.join(", ")+") instead.")}return null},On.register=function(t,e){for(var i in On.definitions=e,e)t[i]=On};var mo=function(t,e,i){this.type=Ke,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e};function Rn(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function So(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Ss(t,e){var i=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(i*u*8192),Math.round(s*u*8192)]}function is(t,e,i){return e[1]>t[1]!=i[1]>t[1]&&t[0]<(i[0]-e[0])*(t[1]-e[1])/(i[1]-e[1])+e[0]}function gi(t,e){for(var i,s,u,p,f,v,T,I=!1,A=0,k=e.length;A<k;A++)for(var R=e[A],U=0,K=R.length;U<K-1;U++){if((p=(i=t)[0]-(s=R[U])[0])*(T=i[1]-(u=R[U+1])[1])-(v=i[0]-u[0])*(f=i[1]-s[1])==0&&p*v<=0&&f*T<=0)return!1;is(t,R[U],R[U+1])&&(I=!I)}return I}function Aa(t,e){for(var i=0;i<e.length;i++)if(gi(t,e[i]))return!0;return!1}function Gr(t,e,i,s){var u=s[0]-i[0],p=s[1]-i[1],f=(t[0]-i[0])*p-u*(t[1]-i[1]),v=(e[0]-i[0])*p-u*(e[1]-i[1]);return f>0&&v<0||f<0&&v>0}function Zs(t,e,i){for(var s=0,u=i;s<u.length;s+=1)for(var p=u[s],f=0;f<p.length-1;++f)if((k=[(A=p[f+1])[0]-(I=p[f])[0],A[1]-I[1]])[0]*(R=[(T=e)[0]-(v=t)[0],T[1]-v[1]])[1]-k[1]*R[0]!=0&&Gr(v,T,I,A)&&Gr(I,A,v,T))return!0;var v,T,I,A,k,R;return!1}function Na(t,e){for(var i=0;i<t.length;++i)if(!gi(t[i],e))return!1;for(var s=0;s<t.length-1;++s)if(Zs(t[s],t[s+1],e))return!1;return!0}function ns(t,e){for(var i=0;i<e.length;i++)if(Na(t,e[i]))return!0;return!1}function no(t,e,i){for(var s=[],u=0;u<t.length;u++){for(var p=[],f=0;f<t[u].length;f++){var v=Ss(t[u][f],i);Rn(e,v),p.push(v)}s.push(p)}return s}function gr(t,e,i){for(var s=[],u=0;u<t.length;u++){var p=no(t[u],e,i);s.push(p)}return s}function la(t,e,i,s){if(t[0]<i[0]||t[0]>i[2]){var u=.5*s,p=t[0]-i[0]>u?-s:i[0]-t[0]>u?s:0;0===p&&(p=t[0]-i[2]>u?-s:i[2]-t[0]>u?s:0),t[0]+=p}Rn(e,t)}function qs(t,e,i,s){for(var u=8192*Math.pow(2,s.z),p=[8192*s.x,8192*s.y],f=[],v=0,T=t;v<T.length;v+=1)for(var I=0,A=T[v];I<A.length;I+=1){var k=A[I],R=[k.x+p[0],k.y+p[1]];la(R,e,i,u),f.push(R)}return f}function ja(t,e,i,s){for(var u,p=8192*Math.pow(2,s.z),f=[8192*s.x,8192*s.y],v=[],T=0,I=t;T<I.length;T+=1){for(var A=[],k=0,R=I[T];k<R.length;k+=1){var U=R[k],K=[U.x+f[0],U.y+f[1]];Rn(e,K),A.push(K)}v.push(A)}if(e[2]-e[0]<=p/2){(u=e)[0]=u[1]=1/0,u[2]=u[3]=-1/0;for(var $=0,lt=v;$<lt.length;$+=1)for(var nt=0,dt=lt[$];nt<dt.length;nt+=1)la(dt[nt],e,i,p)}return v}mo.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");var s=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,Kt);if(!s)return null;var u=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,Kt);if(!u)return null;var p=null;return i.locale&&!(p=e.parse(i.locale,1,ie))?null:new mo(s,u,p)},mo.prototype.evaluate=function(t){return new Mn(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},mo.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},mo.prototype.outputDefined=function(){return!1},mo.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var ro=function(t,e){this.type=Kt,this.geojson=t,this.geometries=e};function Do(t){if(t instanceof On&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof ro)return!1;var e=!0;return t.eachChild(function(i){e&&!Do(i)&&(e=!1)}),e}function Wr(t){if(t instanceof On&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild(function(i){e&&!Wr(i)&&(e=!1)}),e}function ua(t,e){if(t instanceof On&&e.indexOf(t.name)>=0)return!1;var i=!0;return t.eachChild(function(s){i&&!ua(s,e)&&(i=!1)}),i}ro.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(en(t[1])){var i=t[1];if("FeatureCollection"===i.type)for(var s=0;s<i.features.length;++s){var u=i.features[s].geometry.type;if("Polygon"===u||"MultiPolygon"===u)return new ro(i,i.features[s].geometry)}else if("Feature"===i.type){var p=i.geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new ro(i,i.geometry)}else if("Polygon"===i.type||"MultiPolygon"===i.type)return new ro(i,i)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ro.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(e,i){var s=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],p=e.canonicalID();if("Polygon"===i.type){var f=no(i.coordinates,u,p),v=qs(e.geometry(),s,u,p);if(!So(s,u))return!1;for(var T=0,I=v;T<I.length;T+=1)if(!gi(I[T],f))return!1}if("MultiPolygon"===i.type){var A=gr(i.coordinates,u,p),k=qs(e.geometry(),s,u,p);if(!So(s,u))return!1;for(var R=0,U=k;R<U.length;R+=1)if(!Aa(U[R],A))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(e,i){var s=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],p=e.canonicalID();if("Polygon"===i.type){var f=no(i.coordinates,u,p),v=ja(e.geometry(),s,u,p);if(!So(s,u))return!1;for(var T=0,I=v;T<I.length;T+=1)if(!Na(I[T],f))return!1}if("MultiPolygon"===i.type){var A=gr(i.coordinates,u,p),k=ja(e.geometry(),s,u,p);if(!So(s,u))return!1;for(var R=0,U=k;R<U.length;R+=1)if(!ns(U[R],A))return!1}return!0}(t,this.geometries)}return!1},ro.prototype.eachChild=function(){},ro.prototype.outputDefined=function(){return!0},ro.prototype.serialize=function(){return["within",this.geojson]};var Xo=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Xo.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var i=t[1];return e.scope.has(i)?new Xo(i,e.scope.get(i)):e.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Xo.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Xo.prototype.eachChild=function(){},Xo.prototype.outputDefined=function(){return!1},Xo.prototype.serialize=function(){return["var",this.name]};var Ko=function(t,e,i,s,u){void 0===e&&(e=[]),void 0===s&&(s=new jt),void 0===u&&(u=[]),this.registry=t,this.path=e,this.key=e.map(function(p){return"["+p+"]"}).join(""),this.scope=s,this.errors=u,this.expectedType=i};function Hn(t,e){for(var i,s=t.length-1,u=0,p=s,f=0;u<=p;)if((i=t[f=Math.floor((u+p)/2)])<=e){if(f===s||e<t[f+1])return f;u=f+1}else{if(!(i>e))throw new wn("Input is not a number.");p=f-1}return 0}Ko.prototype.parse=function(t,e,i,s,u){return void 0===u&&(u={}),e?this.concat(e,i,s)._parse(t,u):this._parse(t,u)},Ko.prototype._parse=function(t,e){function i(I,A,k){return"assert"===k?new Fi(A,[I]):"coerce"===k?new qr(A,[I]):I}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var s=t[0];if("string"!=typeof s)return this.error("Expression name must be a string, but found "+typeof s+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var u=this.registry[s];if(u){var p=u.parse(t,this);if(!p)return null;if(this.expectedType){var f=this.expectedType,v=p.type;if("string"!==f.kind&&"number"!==f.kind&&"boolean"!==f.kind&&"object"!==f.kind&&"array"!==f.kind||"value"!==v.kind)if("color"!==f.kind&&"formatted"!==f.kind&&"resolvedImage"!==f.kind||"value"!==v.kind&&"string"!==v.kind){if(this.checkSubtype(f,v))return null}else p=i(p,f,e.typeAnnotation||"coerce");else p=i(p,f,e.typeAnnotation||"assert")}if(!(p instanceof Bn)&&"resolvedImage"!==p.type.kind&&function I(A){if(A instanceof Xo)return I(A.boundExpression);if(A instanceof On&&"error"===A.name||A instanceof mo||A instanceof ro)return!1;var k=A instanceof qr||A instanceof Fi,R=!0;return A.eachChild(function(U){R=k?R&&I(U):R&&U instanceof Bn}),!!R&&Do(A)&&ua(A,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(p)){var T=new io;try{p=new Bn(p.type,p.evaluate(T))}catch(I){return this.error(I.message),null}}return p}return this.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},Ko.prototype.concat=function(t,e,i){var s="number"==typeof t?this.path.concat(t):this.path,u=i?this.scope.concat(i):this.scope;return new Ko(this.registry,s,e||null,u,this.errors)},Ko.prototype.error=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var s=""+this.key+e.map(function(u){return"["+u+"]"}).join("");this.errors.push(new Bt(s,t))},Ko.prototype.checkSubtype=function(t,e){var i=ei(t,e);return i&&this.error(i),i};var In=function(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var s=0,u=i;s<u.length;s+=1){var p=u[s],f=p[1];this.labels.push(p[0]),this.outputs.push(f)}};function Ki(t,e,i){return t*(1-i)+e*i}In.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var i=e.parse(t[1],1,St);if(!i)return null;var s=[],u=null;e.expectedType&&"value"!==e.expectedType.kind&&(u=e.expectedType);for(var p=1;p<t.length;p+=2){var f=1===p?-1/0:t[p],v=t[p+1],T=p,I=p+1;if("number"!=typeof f)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(s.length&&s[s.length-1][0]>=f)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);var A=e.parse(v,I,u);if(!A)return null;u=u||A.type,s.push([f,A])}return new In(u,i,s)},In.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);var s=this.input.evaluate(t);if(s<=e[0])return i[0].evaluate(t);var u=e.length;return s>=e[u-1]?i[u-1].evaluate(t):i[Hn(e,s)].evaluate(t)},In.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},In.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},In.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var vr=Object.freeze({__proto__:null,number:Ki,color:function(t,e,i){return new si(Ki(t.r,e.r,i),Ki(t.g,e.g,i),Ki(t.b,e.b,i),Ki(t.a,e.a,i))},array:function(t,e,i){return t.map(function(s,u){return Ki(s,e[u],i)})}}),Es=6/29*3*(6/29),el=Math.PI/180,Is=180/Math.PI;function Va(t){return t>.008856451679035631?Math.pow(t,1/3):t/Es+4/29}function rs(t){return t>6/29?t*t*t:Es*(t-4/29)}function Za(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function qa(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ps(t){var e=qa(t.r),i=qa(t.g),s=qa(t.b),u=Va((.4124564*e+.3575761*i+.1804375*s)/.95047),p=Va((.2126729*e+.7151522*i+.072175*s)/1);return{l:116*p-16,a:500*(u-p),b:200*(p-Va((.0193339*e+.119192*i+.9503041*s)/1.08883)),alpha:t.a}}function As(t){var e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*rs(e),i=.95047*rs(i),s=1.08883*rs(s),new si(Za(3.2404542*i-1.5371385*e-.4985314*s),Za(-.969266*i+1.8760108*e+.041556*s),Za(.0556434*i-.2040259*e+1.0572252*s),t.alpha)}function Cs(t,e,i){var s=e-t;return t+i*(s>180||s<-180?s-360*Math.round(s/360):s)}var Ca={forward:Ps,reverse:As,interpolate:function(t,e,i){return{l:Ki(t.l,e.l,i),a:Ki(t.a,e.a,i),b:Ki(t.b,e.b,i),alpha:Ki(t.alpha,e.alpha,i)}}},xr={forward:function(t){var e=Ps(t),i=e.l,s=e.a,u=e.b,p=Math.atan2(u,s)*Is;return{h:p<0?p+360:p,c:Math.sqrt(s*s+u*u),l:i,alpha:t.a}},reverse:function(t){var e=t.h*el,i=t.c;return As({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:Cs(t.h,e.h,i),c:Ki(t.c,e.c,i),l:Ki(t.l,e.l,i),alpha:Ki(t.alpha,e.alpha,i)}}},ha=Object.freeze({__proto__:null,lab:Ca,hcl:xr}),hn=function(t,e,i,s,u){this.type=t,this.operator=e,this.interpolation=i,this.input=s,this.labels=[],this.outputs=[];for(var p=0,f=u;p<f.length;p+=1){var v=f[p],T=v[1];this.labels.push(v[0]),this.outputs.push(T)}};function Jo(t,e,i,s){var u=s-i,p=t-i;return 0===u?0:1===e?p/u:(Math.pow(e,p)-1)/(Math.pow(e,u)-1)}hn.interpolationFactor=function(t,e,i,s){var u=0;if("exponential"===t.name)u=Jo(e,t.base,i,s);else if("linear"===t.name)u=Jo(e,1,i,s);else if("cubic-bezier"===t.name){var p=t.controlPoints;u=new Mt(p[0],p[1],p[2],p[3]).solve(Jo(e,1,i,s))}return u},hn.parse=function(t,e){var i=t[0],s=t[1],u=t[2],p=t.slice(3);if(!Array.isArray(s)||0===s.length)return e.error("Expected an interpolation type expression.",1);if("linear"===s[0])s={name:"linear"};else if("exponential"===s[0]){var f=s[1];if("number"!=typeof f)return e.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:f}}else{if("cubic-bezier"!==s[0])return e.error("Unknown interpolation type "+String(s[0]),1,0);var v=s.slice(1);if(4!==v.length||v.some(function(lt){return"number"!=typeof lt||lt<0||lt>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:v}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(u=e.parse(u,2,St)))return null;var T=[],I=null;"interpolate-hcl"===i||"interpolate-lab"===i?I=Jt:e.expectedType&&"value"!==e.expectedType.kind&&(I=e.expectedType);for(var A=0;A<p.length;A+=2){var k=p[A],R=p[A+1],U=A+3,K=A+4;if("number"!=typeof k)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(T.length&&T[T.length-1][0]>=k)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);var $=e.parse(R,K,I);if(!$)return null;I=I||$.type,T.push([k,$])}return"number"===I.kind||"color"===I.kind||"array"===I.kind&&"number"===I.itemType.kind&&"number"==typeof I.N?new hn(I,i,s,u,T):e.error("Type "+Ne(I)+" is not interpolatable.")},hn.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);var s=this.input.evaluate(t);if(s<=e[0])return i[0].evaluate(t);var u=e.length;if(s>=e[u-1])return i[u-1].evaluate(t);var p=Hn(e,s),f=hn.interpolationFactor(this.interpolation,s,e[p],e[p+1]),v=i[p].evaluate(t),T=i[p+1].evaluate(t);return"interpolate"===this.operator?vr[this.type.kind.toLowerCase()](v,T,f):"interpolate-hcl"===this.operator?xr.reverse(xr.interpolate(xr.forward(v),xr.forward(T),f)):Ca.reverse(Ca.interpolate(Ca.forward(v),Ca.forward(T),f))},hn.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},hn.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},hn.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],i=0;i<this.labels.length;i++)e.push(this.labels[i],this.outputs[i].serialize());return e};var oo=function(t,e){this.type=t,this.args=e};oo.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var i=null,s=e.expectedType;s&&"value"!==s.kind&&(i=s);for(var u=[],p=0,f=t.slice(1);p<f.length;p+=1){var v=e.parse(f[p],1+u.length,i,void 0,{typeAnnotation:"omit"});if(!v)return null;i=i||v.type,u.push(v)}var T=s&&u.some(function(I){return ei(s,I.type)});return new oo(T?Vt:i,u)},oo.prototype.evaluate=function(t){for(var e,i=null,s=0,u=0,p=this.args;u<p.length&&(s++,(i=p[u].evaluate(t))&&i instanceof Oe&&!i.available&&(e||(e=i.name),i=null,s===this.args.length&&(i=e)),null===i);u+=1);return i},oo.prototype.eachChild=function(t){this.args.forEach(t)},oo.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},oo.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Bo=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Bo.prototype.evaluate=function(t){return this.result.evaluate(t)},Bo.prototype.eachChild=function(t){for(var e=0,i=this.bindings;e<i.length;e+=1)t(i[e][1]);t(this.result)},Bo.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var i=[],s=1;s<t.length-1;s+=2){var u=t[s];if("string"!=typeof u)return e.error("Expected string, but found "+typeof u+" instead.",s);if(/[^a-zA-Z0-9_]/.test(u))return e.error("Variable names must contain only alphanumeric characters or '_'.",s);var p=e.parse(t[s+1],s+1);if(!p)return null;i.push([u,p])}var f=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return f?new Bo(i,f):null},Bo.prototype.outputDefined=function(){return this.result.outputDefined()},Bo.prototype.serialize=function(){for(var t=["let"],e=0,i=this.bindings;e<i.length;e+=1){var s=i[e];t.push(s[0],s[1].serialize())}return t.push(this.result.serialize()),t};var Eo=function(t,e,i){this.type=t,this.index=e,this.input=i};Eo.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,St),s=e.parse(t[2],2,hi(e.expectedType||Vt));return i&&s?new Eo(s.type.itemType,i,s):null},Eo.prototype.evaluate=function(t){var e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new wn("Array index out of bounds: "+e+" < 0.");if(e>=i.length)throw new wn("Array index out of bounds: "+e+" > "+(i.length-1)+".");if(e!==Math.floor(e))throw new wn("Array index must be an integer, but found "+e+" instead.");return i[e]},Eo.prototype.eachChild=function(t){t(this.index),t(this.input)},Eo.prototype.outputDefined=function(){return!1},Eo.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var kr=function(t,e){this.type=Kt,this.needle=t,this.haystack=e};kr.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Vt),s=e.parse(t[2],2,Vt);return i&&s?Xi(i.type,[Kt,ie,St,Gt,Vt])?new kr(i,s):e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ne(i.type)+" instead"):null},kr.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!yi(e,["boolean","string","number","null"]))throw new wn("Expected first argument to be of type boolean, string, number or null, but found "+Ne(nn(e))+" instead.");if(!yi(i,["string","array"]))throw new wn("Expected second argument to be of type array or string, but found "+Ne(nn(i))+" instead.");return i.indexOf(e)>=0},kr.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},kr.prototype.outputDefined=function(){return!0},kr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var _o=function(t,e,i){this.type=St,this.needle=t,this.haystack=e,this.fromIndex=i};_o.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Vt),s=e.parse(t[2],2,Vt);if(!i||!s)return null;if(!Xi(i.type,[Kt,ie,St,Gt,Vt]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ne(i.type)+" instead");if(4===t.length){var u=e.parse(t[3],3,St);return u?new _o(i,s,u):null}return new _o(i,s)},_o.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!yi(e,["boolean","string","number","null"]))throw new wn("Expected first argument to be of type boolean, string, number or null, but found "+Ne(nn(e))+" instead.");if(!yi(i,["string","array"]))throw new wn("Expected second argument to be of type array or string, but found "+Ne(nn(i))+" instead.");if(this.fromIndex){var s=this.fromIndex.evaluate(t);return i.indexOf(e,s)}return i.indexOf(e)},_o.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},_o.prototype.outputDefined=function(){return!1},_o.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Oo=function(t,e,i,s,u,p){this.inputType=t,this.type=e,this.input=i,this.cases=s,this.outputs=u,this.otherwise=p};Oo.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var i,s;e.expectedType&&"value"!==e.expectedType.kind&&(s=e.expectedType);for(var u={},p=[],f=2;f<t.length-1;f+=2){var v=t[f],T=t[f+1];Array.isArray(v)||(v=[v]);var I=e.concat(f);if(0===v.length)return I.error("Expected at least one branch label.");for(var A=0,k=v;A<k.length;A+=1){var R=k[A];if("number"!=typeof R&&"string"!=typeof R)return I.error("Branch labels must be numbers or strings.");if("number"==typeof R&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return I.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof R&&Math.floor(R)!==R)return I.error("Numeric branch labels must be integer values.");if(i){if(I.checkSubtype(i,nn(R)))return null}else i=nn(R);if(void 0!==u[String(R)])return I.error("Branch labels must be unique.");u[String(R)]=p.length}var U=e.parse(T,f,s);if(!U)return null;s=s||U.type,p.push(U)}var K=e.parse(t[1],1,Vt);if(!K)return null;var $=e.parse(t[t.length-1],t.length-1,s);return $?"value"!==K.type.kind&&e.concat(1).checkSubtype(i,K.type)?null:new Oo(i,s,K,u,p,$):null},Oo.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(nn(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Oo.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Oo.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},Oo.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],i=[],s={},u=0,p=Object.keys(this.cases).sort();u<p.length;u+=1){var f=p[u];void 0===(k=s[this.cases[f]])?(s[this.cases[f]]=i.length,i.push([this.cases[f],[f]])):i[k][1].push(f)}for(var v=function(U){return"number"===t.inputType.kind?Number(U):U},T=0,I=i;T<I.length;T+=1){var A=I[T],k=A[0],R=A[1];e.push(1===R.length?v(R[0]):R.map(v)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var br=function(t,e,i){this.type=t,this.branches=e,this.otherwise=i};br.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var s=[],u=1;u<t.length-1;u+=2){var p=e.parse(t[u],u,Kt);if(!p)return null;var f=e.parse(t[u+1],u+1,i);if(!f)return null;s.push([p,f]),i=i||f.type}var v=e.parse(t[t.length-1],t.length-1,i);return v?new br(i,s,v):null},br.prototype.evaluate=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var s=i[e],u=s[1];if(s[0].evaluate(t))return u.evaluate(t)}return this.otherwise.evaluate(t)},br.prototype.eachChild=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var s=i[e],u=s[1];t(s[0]),t(u)}t(this.otherwise)},br.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},br.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Mr=function(t,e,i,s){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=s};function wr(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Ga(t,e,i,s){return 0===s.compare(e,i)}function Li(t,e,i){var s="=="!==t&&"!="!==t;return function(){function u(p,f,v){this.type=Kt,this.lhs=p,this.rhs=f,this.collator=v,this.hasUntypedArgument="value"===p.type.kind||"value"===f.type.kind}return u.parse=function(p,f){if(3!==p.length&&4!==p.length)return f.error("Expected two or three arguments.");var v=p[0],T=f.parse(p[1],1,Vt);if(!T)return null;if(!wr(v,T.type))return f.concat(1).error('"'+v+"\" comparisons are not supported for type '"+Ne(T.type)+"'.");var I=f.parse(p[2],2,Vt);if(!I)return null;if(!wr(v,I.type))return f.concat(2).error('"'+v+"\" comparisons are not supported for type '"+Ne(I.type)+"'.");if(T.type.kind!==I.type.kind&&"value"!==T.type.kind&&"value"!==I.type.kind)return f.error("Cannot compare types '"+Ne(T.type)+"' and '"+Ne(I.type)+"'.");s&&("value"===T.type.kind&&"value"!==I.type.kind?T=new Fi(I.type,[T]):"value"!==T.type.kind&&"value"===I.type.kind&&(I=new Fi(T.type,[I])));var A=null;if(4===p.length){if("string"!==T.type.kind&&"string"!==I.type.kind&&"value"!==T.type.kind&&"value"!==I.type.kind)return f.error("Cannot use collator to compare non-string types.");if(!(A=f.parse(p[3],3,Ke)))return null}return new u(T,I,A)},u.prototype.evaluate=function(p){var f=this.lhs.evaluate(p),v=this.rhs.evaluate(p);if(s&&this.hasUntypedArgument){var T=nn(f),I=nn(v);if(T.kind!==I.kind||"string"!==T.kind&&"number"!==T.kind)throw new wn('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+T.kind+", "+I.kind+") instead.")}if(this.collator&&!s&&this.hasUntypedArgument){var A=nn(f),k=nn(v);if("string"!==A.kind||"string"!==k.kind)return e(p,f,v)}return this.collator?i(p,f,v,this.collator.evaluate(p)):e(p,f,v)},u.prototype.eachChild=function(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)},u.prototype.outputDefined=function(){return!0},u.prototype.serialize=function(){var p=[t];return this.eachChild(function(f){p.push(f.serialize())}),p},u}()}Mr.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Vt),s=e.parse(t[2],2,St);if(!i||!s)return null;if(!Xi(i.type,[hi(Vt),ie,Vt]))return e.error("Expected first argument to be of type array or string, but found "+Ne(i.type)+" instead");if(4===t.length){var u=e.parse(t[3],3,St);return u?new Mr(i.type,i,s,u):null}return new Mr(i.type,i,s)},Mr.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!yi(e,["string","array"]))throw new wn("Expected first argument to be of type array or string, but found "+Ne(nn(e))+" instead.");if(this.endIndex){var s=this.endIndex.evaluate(t);return e.slice(i,s)}return e.slice(i)},Mr.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Mr.prototype.outputDefined=function(){return!1},Mr.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ls=Li("==",function(t,e,i){return e===i},Ga),ca=Li("!=",function(t,e,i){return e!==i},function(t,e,i,s){return!Ga(0,e,i,s)}),Wa=Li("<",function(t,e,i){return e<i},function(t,e,i,s){return s.compare(e,i)<0}),La=Li(">",function(t,e,i){return e>i},function(t,e,i,s){return s.compare(e,i)>0}),Hr=Li("<=",function(t,e,i){return e<=i},function(t,e,i,s){return s.compare(e,i)<=0}),Ha=Li(">=",function(t,e,i){return e>=i},function(t,e,i,s){return s.compare(e,i)>=0}),Yo=function(t,e,i,s,u){this.type=ie,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=s,this.maxFractionDigits=u};Yo.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var i=e.parse(t[1],1,St);if(!i)return null;var s=t[2];if("object"!=typeof s||Array.isArray(s))return e.error("NumberFormat options argument must be an object.");var u=null;if(s.locale&&!(u=e.parse(s.locale,1,ie)))return null;var p=null;if(s.currency&&!(p=e.parse(s.currency,1,ie)))return null;var f=null;if(s["min-fraction-digits"]&&!(f=e.parse(s["min-fraction-digits"],1,St)))return null;var v=null;return s["max-fraction-digits"]&&!(v=e.parse(s["max-fraction-digits"],1,St))?null:new Yo(i,u,p,f,v)},Yo.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Yo.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Yo.prototype.outputDefined=function(){return!1},Yo.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var $o=function(t){this.type=St,this.input=t};$o.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?e.error("Expected argument of type string or array, but found "+Ne(i.type)+" instead."):new $o(i):null},$o.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e||Array.isArray(e))return e.length;throw new wn("Expected value to be of type string or array, but found "+Ne(nn(e))+" instead.")},$o.prototype.eachChild=function(t){t(this.input)},$o.prototype.outputDefined=function(){return!1},$o.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var wa={"==":Ls,"!=":ca,">":La,"<":Wa,">=":Ha,"<=":Hr,array:Fi,at:Eo,boolean:Fi,case:br,coalesce:oo,collator:mo,format:yr,image:an,in:kr,"index-of":_o,interpolate:hn,"interpolate-hcl":hn,"interpolate-lab":hn,length:$o,let:Bo,literal:Bn,match:Oo,number:Fi,"number-format":Yo,object:Fi,slice:Mr,step:In,string:Fi,"to-boolean":qr,"to-color":qr,"to-number":qr,"to-string":qr,var:Xo,within:ro};function za(t,e){var i=e[0],s=e[1],u=e[2],p=e[3];i=i.evaluate(t),s=s.evaluate(t),u=u.evaluate(t);var f=p?p.evaluate(t):1,v=ir(i,s,u,f);if(v)throw new wn(v);return new si(i/255*f,s/255*f,u/255*f,f)}function os(t,e){return t in e}function as(t,e){var i=e[t];return void 0===i?null:i}function Dr(t){return{type:t}}function Ta(t){return{result:"success",value:t}}function yo(t){return{result:"error",value:t}}function pa(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Qo(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Xr(t){return!!t.expression&&t.expression.interpolated}function Ai(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Sa(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Io(t){return t}function da(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function ss(t,e,i,s,u){return da(typeof i===u?s[i]:void 0,t.default,e.default)}function fa(t,e,i){if("number"!==Ai(i))return da(t.default,e.default);var s=t.stops.length;if(1===s||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[s-1][0])return t.stops[s-1][1];var u=Hn(t.stops.map(function(p){return p[0]}),i);return t.stops[u][1]}function zs(t,e,i){var s=void 0!==t.base?t.base:1;if("number"!==Ai(i))return da(t.default,e.default);var u=t.stops.length;if(1===u||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[u-1][0])return t.stops[u-1][1];var R,U,$,lt,p=Hn(t.stops.map(function(k){return k[0]}),i),f=(R=s,lt=i-(U=t.stops[p][0]),0==($=t.stops[p+1][0]-U)?0:1===R?lt/$:(Math.pow(R,lt)-1)/(Math.pow(R,$)-1)),v=t.stops[p][1],T=t.stops[p+1][1],I=vr[e.type]||Io;if(t.colorSpace&&"rgb"!==t.colorSpace){var A=ha[t.colorSpace];I=function(k,R){return A.reverse(A.interpolate(A.forward(k),A.forward(R),f))}}return"function"==typeof v.evaluate?{evaluate:function(){for(var k=[],R=arguments.length;R--;)k[R]=arguments[R];var U=v.evaluate.apply(void 0,k),K=T.evaluate.apply(void 0,k);if(void 0!==U&&void 0!==K)return I(U,K,f)}}:I(v,T,f)}function ao(t,e,i){return"color"===e.type?i=si.parse(i):"formatted"===e.type?i=Dn.fromString(i.toString()):"resolvedImage"===e.type?i=Oe.fromString(i.toString()):Ai(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),da(i,t.default,e.default)}On.register(wa,{error:[{kind:"error"},[ie],function(t,e){throw new wn(e[0].evaluate(t))}],typeof:[ie,[Vt],function(t,e){return Ne(nn(e[0].evaluate(t)))}],"to-rgba":[hi(St,4),[Jt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Jt,[St,St,St],za],rgba:[Jt,[St,St,St,St],za],has:{type:Kt,overloads:[[[ie],function(t,e){return os(e[0].evaluate(t),t.properties())}],[[ie,re],function(t,e){var i=e[1];return os(e[0].evaluate(t),i.evaluate(t))}]]},get:{type:Vt,overloads:[[[ie],function(t,e){return as(e[0].evaluate(t),t.properties())}],[[ie,re],function(t,e){var i=e[1];return as(e[0].evaluate(t),i.evaluate(t))}]]},"feature-state":[Vt,[ie],function(t,e){return as(e[0].evaluate(t),t.featureState||{})}],properties:[re,[],function(t){return t.properties()}],"geometry-type":[ie,[],function(t){return t.geometryType()}],id:[Vt,[],function(t){return t.id()}],zoom:[St,[],function(t){return t.globals.zoom}],"heatmap-density":[St,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[St,[],function(t){return t.globals.lineProgress||0}],accumulated:[Vt,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[St,Dr(St),function(t,e){for(var i=0,s=0,u=e;s<u.length;s+=1)i+=u[s].evaluate(t);return i}],"*":[St,Dr(St),function(t,e){for(var i=1,s=0,u=e;s<u.length;s+=1)i*=u[s].evaluate(t);return i}],"-":{type:St,overloads:[[[St,St],function(t,e){var i=e[1];return e[0].evaluate(t)-i.evaluate(t)}],[[St],function(t,e){return-e[0].evaluate(t)}]]},"/":[St,[St,St],function(t,e){var i=e[1];return e[0].evaluate(t)/i.evaluate(t)}],"%":[St,[St,St],function(t,e){var i=e[1];return e[0].evaluate(t)%i.evaluate(t)}],ln2:[St,[],function(){return Math.LN2}],pi:[St,[],function(){return Math.PI}],e:[St,[],function(){return Math.E}],"^":[St,[St,St],function(t,e){var i=e[1];return Math.pow(e[0].evaluate(t),i.evaluate(t))}],sqrt:[St,[St],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[St,[St],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[St,[St],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[St,[St],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[St,[St],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[St,[St],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[St,[St],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[St,[St],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[St,[St],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[St,[St],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[St,Dr(St),function(t,e){return Math.min.apply(Math,e.map(function(i){return i.evaluate(t)}))}],max:[St,Dr(St),function(t,e){return Math.max.apply(Math,e.map(function(i){return i.evaluate(t)}))}],abs:[St,[St],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[St,[St],function(t,e){var i=e[0].evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[St,[St],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[St,[St],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Kt,[ie,Vt],function(t,e){var i=e[0],s=e[1];return t.properties()[i.value]===s.value}],"filter-id-==":[Kt,[Vt],function(t,e){var i=e[0];return t.id()===i.value}],"filter-type-==":[Kt,[ie],function(t,e){var i=e[0];return t.geometryType()===i.value}],"filter-<":[Kt,[ie,Vt],function(t,e){var i=e[0],s=e[1],u=t.properties()[i.value],p=s.value;return typeof u==typeof p&&u<p}],"filter-id-<":[Kt,[Vt],function(t,e){var i=e[0],s=t.id(),u=i.value;return typeof s==typeof u&&s<u}],"filter->":[Kt,[ie,Vt],function(t,e){var i=e[0],s=e[1],u=t.properties()[i.value],p=s.value;return typeof u==typeof p&&u>p}],"filter-id->":[Kt,[Vt],function(t,e){var i=e[0],s=t.id(),u=i.value;return typeof s==typeof u&&s>u}],"filter-<=":[Kt,[ie,Vt],function(t,e){var i=e[0],s=e[1],u=t.properties()[i.value],p=s.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[Kt,[Vt],function(t,e){var i=e[0],s=t.id(),u=i.value;return typeof s==typeof u&&s<=u}],"filter->=":[Kt,[ie,Vt],function(t,e){var i=e[0],s=e[1],u=t.properties()[i.value],p=s.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[Kt,[Vt],function(t,e){var i=e[0],s=t.id(),u=i.value;return typeof s==typeof u&&s>=u}],"filter-has":[Kt,[Vt],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Kt,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Kt,[hi(ie)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Kt,[hi(Vt)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Kt,[ie,hi(Vt)],function(t,e){var i=e[0];return e[1].value.indexOf(t.properties()[i.value])>=0}],"filter-in-large":[Kt,[ie,hi(Vt)],function(t,e){var i=e[0],s=e[1];return function(u,p,f,v){for(;f<=v;){var T=f+v>>1;if(p[T]===u)return!0;p[T]>u?v=T-1:f=T+1}return!1}(t.properties()[i.value],s.value,0,s.value.length-1)}],all:{type:Kt,overloads:[[[Kt,Kt],function(t,e){var i=e[1];return e[0].evaluate(t)&&i.evaluate(t)}],[Dr(Kt),function(t,e){for(var i=0,s=e;i<s.length;i+=1)if(!s[i].evaluate(t))return!1;return!0}]]},any:{type:Kt,overloads:[[[Kt,Kt],function(t,e){var i=e[1];return e[0].evaluate(t)||i.evaluate(t)}],[Dr(Kt),function(t,e){for(var i=0,s=e;i<s.length;i+=1)if(s[i].evaluate(t))return!0;return!1}]]},"!":[Kt,[Kt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Kt,[ie],function(t,e){var i=t.globals&&t.globals.isSupportedScript;return!i||i(e[0].evaluate(t))}],upcase:[ie,[ie],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[ie,[ie],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[ie,Dr(Vt),function(t,e){return e.map(function(i){return sa(i.evaluate(t))}).join("")}],"resolved-locale":[ie,[Ke],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Ro=function(t,e){var i;this.expression=t,this._warningHistory={},this._evaluator=new io,this._defaultValue=e?"color"===(i=e).type&&Sa(i.default)?new si(0,0,0,0):"color"===i.type?si.parse(i.default)||null:void 0===i.default?null:i.default:null,this._enumValues=e&&"enum"===e.type?e.values:null};function ka(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in wa}function Xa(t,e){var u,p,i=new Ko(wa,[],e?(p={color:Jt,string:ie,number:St,enum:ie,boolean:Kt,formatted:fi,resolvedImage:Ae},"array"===(u=e).type?hi(p[u.value]||Vt,u.length):p[u.type]):void 0),s=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?Ta(new Ro(s,e)):yo(i.errors)}Ro.prototype.evaluateWithoutErrorHandling=function(t,e,i,s,u,p){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=s,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=p,this.expression.evaluate(this._evaluator)},Ro.prototype.evaluate=function(t,e,i,s,u,p){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=s,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=p||null;try{var f=this.expression.evaluate(this._evaluator);if(null==f||"number"==typeof f&&f!=f)return this._defaultValue;if(this._enumValues&&!(f in this._enumValues))throw new wn("Expected value to be one of "+Object.keys(this._enumValues).map(function(v){return JSON.stringify(v)}).join(", ")+", but found "+JSON.stringify(f)+" instead.");return f}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}};var ta=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Wr(e.expression)};ta.prototype.evaluateWithoutErrorHandling=function(t,e,i,s,u,p){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,s,u,p)},ta.prototype.evaluate=function(t,e,i,s,u,p){return this._styleExpression.evaluate(t,e,i,s,u,p)};var ma=function(t,e,i,s){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Wr(e.expression),this.interpolationType=s};function ls(t,e){if("error"===(t=Xa(t,e)).result)return t;var i=t.value.expression,s=Do(i);if(!s&&!pa(e))return yo([new Bt("","data expressions not supported")]);var u=ua(i,["zoom"]);if(!u&&!Qo(e))return yo([new Bt("","zoom expressions not supported")]);var p=function f(v){var T=null;if(v instanceof Bo)T=f(v.result);else if(v instanceof oo)for(var I=0,A=v.args;I<A.length&&!(T=f(A[I]));I+=1);else(v instanceof In||v instanceof hn)&&v.input instanceof On&&"zoom"===v.input.name&&(T=v);return T instanceof Bt||v.eachChild(function(k){var R=f(k);R instanceof Bt?T=R:!T&&R?T=new Bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):T&&R&&T!==R&&(T=new Bt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),T}(i);return p||u?p instanceof Bt?yo([p]):p instanceof hn&&!Xr(e)?yo([new Bt("",'"interpolate" expressions cannot be used with this property')]):Ta(p?new ma(s?"camera":"composite",t.value,p.labels,p instanceof hn?p.interpolation:void 0):new ta(s?"constant":"source",t.value)):yo([new Bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}ma.prototype.evaluateWithoutErrorHandling=function(t,e,i,s,u,p){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,s,u,p)},ma.prototype.evaluate=function(t,e,i,s,u,p){return this._styleExpression.evaluate(t,e,i,s,u,p)},ma.prototype.interpolationFactor=function(t,e,i){return this.interpolationType?hn.interpolationFactor(this.interpolationType,t,e,i):0};var Ea=function(t,e){this._parameters=t,this._specification=e,Dt(this,function i(s,u){var p,f,v,T="color"===u.type,I=s.stops&&"object"==typeof s.stops[0][0],A=I||!(I||void 0!==s.property),k=s.type||(Xr(u)?"exponential":"interval");if(T&&((s=Dt({},s)).stops&&(s.stops=s.stops.map(function(ae){return[ae[0],si.parse(ae[1])]})),s.default=si.parse(s.default?s.default:u.default)),s.colorSpace&&"rgb"!==s.colorSpace&&!ha[s.colorSpace])throw new Error("Unknown color space: "+s.colorSpace);if("exponential"===k)p=zs;else if("interval"===k)p=fa;else if("categorical"===k){p=ss,f=Object.create(null);for(var R=0,U=s.stops;R<U.length;R+=1){var K=U[R];f[K[0]]=K[1]}v=typeof s.stops[0][0]}else{if("identity"!==k)throw new Error('Unknown function type "'+k+'"');p=ao}if(I){for(var $={},lt=[],nt=0;nt<s.stops.length;nt++){var dt=s.stops[nt],yt=dt[0].zoom;void 0===$[yt]&&($[yt]={zoom:yt,type:s.type,property:s.property,default:s.default,stops:[]},lt.push(yt)),$[yt].stops.push([dt[0].value,dt[1]])}for(var xt=[],Tt=0,zt=lt;Tt<zt.length;Tt+=1){var Wt=zt[Tt];xt.push([$[Wt].zoom,i($[Wt],u)])}var te={name:"linear"};return{kind:"composite",interpolationType:te,interpolationFactor:hn.interpolationFactor.bind(void 0,te),zoomStops:xt.map(function(ae){return ae[0]}),evaluate:function(ae,xe){var se=ae.zoom;return zs({stops:xt,base:s.base},u,se).evaluate(se,xe)}}}if(A){var ge="exponential"===k?{name:"exponential",base:void 0!==s.base?s.base:1}:null;return{kind:"camera",interpolationType:ge,interpolationFactor:hn.interpolationFactor.bind(void 0,ge),zoomStops:s.stops.map(function(ae){return ae[0]}),evaluate:function(ae){return p(s,u,ae.zoom,f,v)}}}return{kind:"source",evaluate:function(ae,xe){var se=xe&&xe.properties?xe.properties[s.property]:void 0;return void 0===se?da(s.default,u.default):p(s,u,se,f,v)}}}(this._parameters,this._specification))};function ur(t){var e=t.key,i=t.value,s=t.valueSpec||{},u=t.objectElementValidators||{},p=t.style,f=t.styleSpec,v=[],T=Ai(i);if("object"!==T)return[new et(e,i,"object expected, "+T+" found")];for(var I in i){var A=I.split(".")[0],k=s[A]||s["*"],R=void 0;if(u[A])R=u[A];else if(s[A])R=Ct;else if(u["*"])R=u["*"];else{if(!s["*"]){v.push(new et(e,i[I],'unknown property "'+I+'"'));continue}R=Ct}v=v.concat(R({key:(e&&e+".")+I,value:i[I],valueSpec:k,style:p,styleSpec:f,object:i,objectKey:I},i))}for(var U in s)u[U]||s[U].required&&void 0===s[U].default&&void 0===i[U]&&v.push(new et(e,i,'missing required property "'+U+'"'));return v}function Ka(t){var e=t.value,i=t.valueSpec,s=t.style,u=t.styleSpec,p=t.key,f=t.arrayElementValidator||Ct;if("array"!==Ai(e))return[new et(p,e,"array expected, "+Ai(e)+" found")];if(i.length&&e.length!==i.length)return[new et(p,e,"array length "+i.length+" expected, length "+e.length+" found")];if(i["min-length"]&&e.length<i["min-length"])return[new et(p,e,"array length at least "+i["min-length"]+" expected, length "+e.length+" found")];var v={type:i.value,values:i.values};u.$version<7&&(v.function=i.function),"object"===Ai(i.value)&&(v=i.value);for(var T=[],I=0;I<e.length;I++)T=T.concat(f({array:e,arrayIndex:I,value:e[I],valueSpec:v,style:s,styleSpec:u,key:p+"["+I+"]"}));return T}function us(t){var e=t.key,i=t.value,s=t.valueSpec,u=Ai(i);return"number"===u&&i!=i&&(u="NaN"),"number"!==u?[new et(e,i,"number expected, "+u+" found")]:"minimum"in s&&i<s.minimum?[new et(e,i,i+" is less than the minimum value "+s.minimum)]:"maximum"in s&&i>s.maximum?[new et(e,i,i+" is greater than the maximum value "+s.maximum)]:[]}function Ma(t){var e,i,s,u=t.valueSpec,p=Nt(t.value.type),f={},v="categorical"!==p&&void 0===t.value.property,T=!v,I="array"===Ai(t.value.stops)&&"array"===Ai(t.value.stops[0])&&"object"===Ai(t.value.stops[0][0]),A=ur({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(U){if("identity"===p)return[new et(U.key,U.value,'identity function may not have a "stops" property')];var K=[],$=U.value;return K=K.concat(Ka({key:U.key,value:$,valueSpec:U.valueSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:k})),"array"===Ai($)&&0===$.length&&K.push(new et(U.key,$,"array must have at least one stop")),K},default:function(U){return Ct({key:U.key,value:U.value,valueSpec:u,style:U.style,styleSpec:U.styleSpec})}}});return"identity"===p&&v&&A.push(new et(t.key,t.value,'missing required property "property"')),"identity"===p||t.value.stops||A.push(new et(t.key,t.value,'missing required property "stops"')),"exponential"===p&&t.valueSpec.expression&&!Xr(t.valueSpec)&&A.push(new et(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(T&&!pa(t.valueSpec)?A.push(new et(t.key,t.value,"property functions not supported")):v&&!Qo(t.valueSpec)&&A.push(new et(t.key,t.value,"zoom functions not supported"))),"categorical"!==p&&!I||void 0!==t.value.property||A.push(new et(t.key,t.value,'"property" property is required')),A;function k(U){var K=[],$=U.value,lt=U.key;if("array"!==Ai($))return[new et(lt,$,"array expected, "+Ai($)+" found")];if(2!==$.length)return[new et(lt,$,"array length 2 expected, length "+$.length+" found")];if(I){if("object"!==Ai($[0]))return[new et(lt,$,"object expected, "+Ai($[0])+" found")];if(void 0===$[0].zoom)return[new et(lt,$,"object stop key must have zoom")];if(void 0===$[0].value)return[new et(lt,$,"object stop key must have value")];if(s&&s>Nt($[0].zoom))return[new et(lt,$[0].zoom,"stop zoom values must appear in ascending order")];Nt($[0].zoom)!==s&&(s=Nt($[0].zoom),i=void 0,f={}),K=K.concat(ur({key:lt+"[0]",value:$[0],valueSpec:{zoom:{}},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:us,value:R}}))}else K=K.concat(R({key:lt+"[0]",value:$[0],valueSpec:{},style:U.style,styleSpec:U.styleSpec},$));return ka(bt($[1]))?K.concat([new et(lt+"[1]",$[1],"expressions are not allowed in function stops.")]):K.concat(Ct({key:lt+"[1]",value:$[1],valueSpec:u,style:U.style,styleSpec:U.styleSpec}))}function R(U,K){var $=Ai(U.value),lt=Nt(U.value),nt=null!==U.value?U.value:K;if(e){if($!==e)return[new et(U.key,nt,$+" stop domain type must match previous stop domain type "+e)]}else e=$;if("number"!==$&&"string"!==$&&"boolean"!==$)return[new et(U.key,nt,"stop domain value must be a number, string, or boolean")];if("number"!==$&&"categorical"!==p){var dt="number expected, "+$+" found";return pa(u)&&void 0===p&&(dt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new et(U.key,nt,dt)]}return"categorical"!==p||"number"!==$||isFinite(lt)&&Math.floor(lt)===lt?"categorical"!==p&&"number"===$&&void 0!==i&&lt<i?[new et(U.key,nt,"stop domain values must appear in ascending order")]:(i=lt,"categorical"===p&&lt in f?[new et(U.key,nt,"stop domain values must be unique")]:(f[lt]=!0,[])):[new et(U.key,nt,"integer expected, found "+lt)]}}function r(t){var e=("property"===t.expressionContext?ls:Xa)(bt(t.value),t.valueSpec);if("error"===e.result)return e.value.map(function(s){return new et(""+t.key+s.key,t.value,s.message)});var i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new et(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Wr(i))return[new et(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Wr(i))return[new et(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!ua(i,["zoom","feature-state"]))return[new et(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Do(i))return[new et(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function h(t){var e=t.key,i=t.value,s=t.valueSpec,u=[];return Array.isArray(s.values)?-1===s.values.indexOf(Nt(i))&&u.push(new et(e,i,"expected one of ["+s.values.join(", ")+"], "+JSON.stringify(i)+" found")):-1===Object.keys(s.values).indexOf(Nt(i))&&u.push(new et(e,i,"expected one of ["+Object.keys(s.values).join(", ")+"], "+JSON.stringify(i)+" found")),u}function m(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,i=t.slice(1);e<i.length;e+=1){var s=i[e];if(!m(s)&&"boolean"!=typeof s)return!1}return!0;default:return!0}}Ea.deserialize=function(t){return new Ea(t._parameters,t._specification)},Ea.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var b={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function C(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};m(t)||(t=rt(t));var e=Xa(t,b);if("error"===e.result)throw new Error(e.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,s,u){return e.value.evaluate(i,s,{},u)},needGeometry:function i(s){if(!Array.isArray(s))return!1;if("within"===s[0])return!0;for(var u=1;u<s.length;u++)if(i(s[u]))return!0;return!1}(t)}}function G(t,e){return t<e?-1:t>e?1:0}function rt(t){if(!t)return!0;var e,i=t[0];return t.length<=1?"any"!==i:"=="===i?gt(t[1],t[2],"=="):"!="===i?oe(gt(t[1],t[2],"==")):"<"===i||">"===i||"<="===i||">="===i?gt(t[1],t[2],i):"any"===i?(e=t.slice(1),["any"].concat(e.map(rt))):"all"===i?["all"].concat(t.slice(1).map(rt)):"none"===i?["all"].concat(t.slice(1).map(rt).map(oe)):"in"===i?kt(t[1],t.slice(2)):"!in"===i?oe(kt(t[1],t.slice(2))):"has"===i?Lt(t[1]):"!has"===i?oe(Lt(t[1])):"within"!==i||t}function gt(t,e,i){switch(t){case"$type":return["filter-type-"+i,e];case"$id":return["filter-id-"+i,e];default:return["filter-"+i,t,e]}}function kt(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(i){return typeof i!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(G)]]:["filter-in-small",t,["literal",e]]}}function Lt(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function oe(t){return["!",t]}function de(t){return m(bt(t.value))?r(Dt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(i){var s=i.value,u=i.key;if("array"!==Ai(s))return[new et(u,s,"array expected, "+Ai(s)+" found")];var p,f=i.styleSpec,v=[];if(s.length<1)return[new et(u,s,"filter array must have at least 1 element")];switch(v=v.concat(h({key:u+"[0]",value:s[0],valueSpec:f.filter_operator,style:i.style,styleSpec:i.styleSpec})),Nt(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===Nt(s[1])&&v.push(new et(u,s,'"$type" cannot be use with operator "'+s[0]+'"'));case"==":case"!=":3!==s.length&&v.push(new et(u,s,'filter array for operator "'+s[0]+'" must have 3 elements'));case"in":case"!in":s.length>=2&&"string"!==(p=Ai(s[1]))&&v.push(new et(u+"[1]",s[1],"string expected, "+p+" found"));for(var T=2;T<s.length;T++)p=Ai(s[T]),"$type"===Nt(s[1])?v=v.concat(h({key:u+"["+T+"]",value:s[T],valueSpec:f.geometry_type,style:i.style,styleSpec:i.styleSpec})):"string"!==p&&"number"!==p&&"boolean"!==p&&v.push(new et(u+"["+T+"]",s[T],"string, number, or boolean expected, "+p+" found"));break;case"any":case"all":case"none":for(var I=1;I<s.length;I++)v=v.concat(e({key:u+"["+I+"]",value:s[I],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":p=Ai(s[1]),2!==s.length?v.push(new et(u,s,'filter array for "'+s[0]+'" operator must have 2 elements')):"string"!==p&&v.push(new et(u+"[1]",s[1],"string expected, "+p+" found"));break;case"within":p=Ai(s[1]),2!==s.length?v.push(new et(u,s,'filter array for "'+s[0]+'" operator must have 2 elements')):"object"!==p&&v.push(new et(u+"[1]",s[1],"object expected, "+p+" found"))}return v}(t)}function Qe(t,e){var i=t.key,s=t.style,u=t.styleSpec,p=t.value,f=t.objectKey,v=u[e+"_"+t.layerType];if(!v)return[];var T=f.match(/^(.*)-transition$/);if("paint"===e&&T&&v[T[1]]&&v[T[1]].transition)return Ct({key:i,value:p,valueSpec:u.transition,style:s,styleSpec:u});var I,A=t.valueSpec||v[f];if(!A)return[new et(i,p,'unknown property "'+f+'"')];if("string"===Ai(p)&&pa(A)&&!A.tokens&&(I=/^{([^}]+)}$/.exec(p)))return[new et(i,p,'"'+f+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(I[1])+" }`.")];var k=[];return"symbol"===t.layerType&&("text-field"===f&&s&&!s.glyphs&&k.push(new et(i,p,'use of "text-field" requires a style "glyphs" property')),"text-font"===f&&Sa(bt(p))&&"identity"===Nt(p.type)&&k.push(new et(i,p,'"text-font" does not support identity functions'))),k.concat(Ct({key:t.key,value:p,valueSpec:A,style:s,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:f}))}function O(t){return Qe(t,"paint")}function y(t){return Qe(t,"layout")}function E(t){var e=[],i=t.value,s=t.key,u=t.style,p=t.styleSpec;i.type||i.ref||e.push(new et(s,i,'either "type" or "ref" is required'));var f,v=Nt(i.type),T=Nt(i.ref);if(i.id)for(var I=Nt(i.id),A=0;A<t.arrayIndex;A++){var k=u.layers[A];Nt(k.id)===I&&e.push(new et(s,i.id,'duplicate layer id "'+i.id+'", previously used at line '+k.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(K){K in i&&e.push(new et(s,i[K],'"'+K+'" is prohibited for ref layers'))}),u.layers.forEach(function(K){Nt(K.id)===T&&(f=K)}),f?f.ref?e.push(new et(s,i.ref,"ref cannot reference another ref layer")):v=Nt(f.type):e.push(new et(s,i.ref,'ref layer "'+T+'" not found'));else if("background"!==v)if(i.source){var R=u.sources&&u.sources[i.source],U=R&&Nt(R.type);R?"vector"===U&&"raster"===v?e.push(new et(s,i.source,'layer "'+i.id+'" requires a raster source')):"raster"===U&&"raster"!==v?e.push(new et(s,i.source,'layer "'+i.id+'" requires a vector source')):"vector"!==U||i["source-layer"]?"raster-dem"===U&&"hillshade"!==v?e.push(new et(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==v||!i.paint||!i.paint["line-gradient"]||"geojson"===U&&R.lineMetrics||e.push(new et(s,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new et(s,i,'layer "'+i.id+'" must specify a "source-layer"')):e.push(new et(s,i.source,'source "'+i.source+'" not found'))}else e.push(new et(s,i,'missing required property "source"'));return e=e.concat(ur({key:s,value:i,valueSpec:p.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ct({key:s+".type",value:i.type,valueSpec:p.layer.type,style:t.style,styleSpec:t.styleSpec,object:i,objectKey:"type"})},filter:de,layout:function(K){return ur({layer:i,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,objectElementValidators:{"*":function($){return y(Dt({layerType:v},$))}}})},paint:function(K){return ur({layer:i,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,objectElementValidators:{"*":function($){return O(Dt({layerType:v},$))}}})}}}))}function Z(t){var e=t.value,i=t.key,s=Ai(e);return"string"!==s?[new et(i,e,"string expected, "+s+" found")]:[]}var Y={promoteId:function(t){var e=t.key,i=t.value;if("string"===Ai(i))return Z({key:e,value:i});var s=[];for(var u in i)s.push.apply(s,Z({key:e+"."+u,value:i[u]}));return s}};function ct(t){var e=t.value,i=t.key,s=t.styleSpec,u=t.style;if(!e.type)return[new et(i,e,'"type" is required')];var p,f=Nt(e.type);switch(f){case"vector":case"raster":case"raster-dem":return ur({key:i,value:e,valueSpec:s["source_"+f.replace("-","_")],style:t.style,styleSpec:s,objectElementValidators:Y});case"geojson":if(p=ur({key:i,value:e,valueSpec:s.source_geojson,style:u,styleSpec:s,objectElementValidators:Y}),e.cluster)for(var v in e.clusterProperties){var T=e.clusterProperties[v],I=T[0],A="string"==typeof I?[I,["accumulated"],["get",v]]:I;p.push.apply(p,r({key:i+"."+v+".map",value:T[1],expressionContext:"cluster-map"})),p.push.apply(p,r({key:i+"."+v+".reduce",value:A,expressionContext:"cluster-reduce"}))}return p;case"video":return ur({key:i,value:e,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return ur({key:i,value:e,valueSpec:s.source_image,style:u,styleSpec:s});case"canvas":return[new et(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return h({key:i+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:u,styleSpec:s})}}function vt(t){var e=t.value,i=t.styleSpec,s=i.light,u=t.style,p=[],f=Ai(e);if(void 0===e)return p;if("object"!==f)return p.concat([new et("light",e,"object expected, "+f+" found")]);for(var v in e){var T=v.match(/^(.*)-transition$/);p=p.concat(T&&s[T[1]]&&s[T[1]].transition?Ct({key:v,value:e[v],valueSpec:i.transition,style:u,styleSpec:i}):s[v]?Ct({key:v,value:e[v],valueSpec:s[v],style:u,styleSpec:i}):[new et(v,e[v],'unknown property "'+v+'"')])}return p}var Ot={"*":function(){return[]},array:Ka,boolean:function(t){var e=t.value,i=t.key,s=Ai(e);return"boolean"!==s?[new et(i,e,"boolean expected, "+s+" found")]:[]},number:us,color:function(t){var e=t.key,i=t.value,s=Ai(i);return"string"!==s?[new et(e,i,"color expected, "+s+" found")]:null===He(i)?[new et(e,i,'color expected, "'+i+'" found')]:[]},constants:mt,enum:h,filter:de,function:Ma,layer:E,object:ur,source:ct,light:vt,string:Z,formatted:function(t){return 0===Z(t).length?[]:r(t)},resolvedImage:function(t){return 0===Z(t).length?[]:r(t)}};function Ct(t){var e=t.value,i=t.valueSpec,s=t.styleSpec;return i.expression&&Sa(Nt(e))?Ma(t):i.expression&&ka(bt(e))?r(t):i.type&&Ot[i.type]?Ot[i.type](t):ur(Dt({},t,{valueSpec:i.type?s[i.type]:i}))}function Ht(t){var e=t.value,i=t.key,s=Z(t);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new et(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new et(i,e,'"glyphs" url must include a "{range}" token'))),s}function ce(t,e){void 0===e&&(e=N);var i=[];return i=i.concat(Ct({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Ht,"*":function(){return[]}}})),t.constants&&(i=i.concat(mt({key:"constants",value:t.constants,style:t,styleSpec:e}))),ne(i)}function ne(t){return[].concat(t).sort(function(e,i){return e.line-i.line})}function ii(t){return function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];return ne(t.apply(this,e))}}ce.source=ii(ct),ce.light=ii(vt),ce.layer=ii(E),ce.filter=ii(de),ce.paintProperty=ii(O),ce.layoutProperty=ii(y);var Ue=ce,Ze=Ue.light,ni=Ue.paintProperty,qe=Ue.layoutProperty;function ji(t,e){var i=!1;if(e&&e.length)for(var s=0,u=e;s<u.length;s+=1)t.fire(new ot(new Error(u[s].message))),i=!0;return i}var ci=Ie;function Ie(t,e,i){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var u=new Int32Array(this.arrayBuffer);t=u[0],this.d=(e=u[1])+2*(i=u[2]);for(var p=0;p<this.d*this.d;p++){var f=u[3+p],v=u[3+p+1];s.push(f===v?null:u.subarray(f,v))}var T=u[3+s.length+1];this.keys=u.subarray(u[3+s.length],T),this.bboxes=u.subarray(T),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var I=0;I<this.d*this.d;I++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var A=i/e*t;this.min=-A,this.max=t+A}Ie.prototype.insert=function(t,e,i,s,u){this._forEachCell(e,i,s,u,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(u)},Ie.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ie.prototype._insertCell=function(t,e,i,s,u,p){this.cells[u].push(p)},Ie.prototype.query=function(t,e,i,s,u){var p=this.min,f=this.max;if(t<=p&&e<=p&&f<=i&&f<=s&&!u)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(t,e,i,s,this._queryCell,v,{},u),v},Ie.prototype._queryCell=function(t,e,i,s,u,p,f,v){var T=this.cells[u];if(null!==T)for(var I=this.keys,A=this.bboxes,k=0;k<T.length;k++){var R=T[k];if(void 0===f[R]){var U=4*R;(v?v(A[U+0],A[U+1],A[U+2],A[U+3]):t<=A[U+2]&&e<=A[U+3]&&i>=A[U+0]&&s>=A[U+1])?(f[R]=!0,p.push(I[R])):f[R]=!1}}},Ie.prototype._forEachCell=function(t,e,i,s,u,p,f,v){for(var T=this._convertToCellCoord(t),I=this._convertToCellCoord(e),A=this._convertToCellCoord(i),k=this._convertToCellCoord(s),R=T;R<=A;R++)for(var U=I;U<=k;U++){var K=this.d*U+R;if((!v||v(this._convertFromCellCoord(R),this._convertFromCellCoord(U),this._convertFromCellCoord(R+1),this._convertFromCellCoord(U+1)))&&u.call(this,t,e,i,s,K,p,f,v))return}},Ie.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Ie.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Ie.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,i=0,s=0;s<this.cells.length;s++)i+=this.cells[s].length;var u=new Int32Array(e+i+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var p=e,f=0;f<t.length;f++){var v=t[f];u[3+f]=p,u.set(v,p),p+=v.length}return u[3+t.length]=p,u.set(this.keys,p),u[3+t.length+1]=p+=this.keys.length,u.set(this.bboxes,p),p+=this.bboxes.length,u.buffer};var Si=Zt.ImageData,zi=Zt.ImageBitmap,De={};function qt(t,e,i){void 0===i&&(i={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),De[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}for(var li in qt("Object",Object),ci.serialize=function(t,e){var i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}},ci.deserialize=function(t){return new ci(t.buffer)},qt("Grid",ci),qt("Color",si),qt("Error",Error),qt("ResolvedImage",Oe),qt("StylePropertyFunction",Ea),qt("StyleExpression",Ro,{omit:["_evaluator"]}),qt("ZoomDependentExpression",ma),qt("ZoomConstantExpression",ta),qt("CompoundExpression",On,{omit:["_evaluate"]}),wa)wa[li]._classRegistryKey||qt("Expression_"+li,wa[li]);function $i(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Xn(t){return zi&&t instanceof zi}function cn(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if($i(t)||Xn(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var i=t;return e&&e.push(i.buffer),i}if(t instanceof Si)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var s=[],u=0,p=t;u<p.length;u+=1)s.push(cn(p[u],e));return s}if("object"==typeof t){var f=t.constructor,v=f._classRegistryKey;if(!v)throw new Error("can't serialize object of unregistered class");var T=f.serialize?f.serialize(t,e):{};if(!f.serialize){for(var I in t)if(t.hasOwnProperty(I)&&!(De[v].omit.indexOf(I)>=0)){var A=t[I];T[I]=De[v].shallow.indexOf(I)>=0?A:cn(A,e)}t instanceof Error&&(T.message=t.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==v&&(T.$name=v),T}throw new Error("can't serialize object of type "+typeof t)}function pn(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||$i(t)||Xn(t)||ArrayBuffer.isView(t)||t instanceof Si)return t;if(Array.isArray(t))return t.map(pn);if("object"==typeof t){var e=t.$name||"Object",i=De[e].klass;if(!i)throw new Error("can't deserialize unregistered class "+e);if(i.deserialize)return i.deserialize(t);for(var s=Object.create(i.prototype),u=0,p=Object.keys(t);u<p.length;u+=1){var f=p[u];if("$name"!==f){var v=t[f];s[f]=De[e].shallow.indexOf(f)>=0?v:pn(v)}}return s}throw new Error("can't deserialize object of type "+typeof t)}var Pn=function(){this.first=!0};Pn.prototype.update=function(t,e){var i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))};var $t={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function ea(t){for(var e=0,i=t;e<i.length;e+=1)if(Fo(i[e].charCodeAt(0)))return!0;return!1}function Fo(t){return!(746!==t&&747!==t&&(t<4352||!($t["Bopomofo Extended"](t)||$t.Bopomofo(t)||$t["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||$t["CJK Compatibility Ideographs"](t)||$t["CJK Compatibility"](t)||$t["CJK Radicals Supplement"](t)||$t["CJK Strokes"](t)||!(!$t["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||$t["CJK Unified Ideographs Extension A"](t)||$t["CJK Unified Ideographs"](t)||$t["Enclosed CJK Letters and Months"](t)||$t["Hangul Compatibility Jamo"](t)||$t["Hangul Jamo Extended-A"](t)||$t["Hangul Jamo Extended-B"](t)||$t["Hangul Jamo"](t)||$t["Hangul Syllables"](t)||$t.Hiragana(t)||$t["Ideographic Description Characters"](t)||$t.Kanbun(t)||$t["Kangxi Radicals"](t)||$t["Katakana Phonetic Extensions"](t)||$t.Katakana(t)&&12540!==t||!(!$t["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!$t["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||$t["Unified Canadian Aboriginal Syllabics"](t)||$t["Unified Canadian Aboriginal Syllabics Extended"](t)||$t["Vertical Forms"](t)||$t["Yijing Hexagram Symbols"](t)||$t["Yi Syllables"](t)||$t["Yi Radicals"](t))))}function Tr(t){return!(Fo(t)||(e=t,$t["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||$t["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||$t["Letterlike Symbols"](e)||$t["Number Forms"](e)||$t["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||$t["Control Pictures"](e)&&9251!==e||$t["Optical Character Recognition"](e)||$t["Enclosed Alphanumerics"](e)||$t["Geometric Shapes"](e)||$t["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||$t["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||$t["CJK Symbols and Punctuation"](e)||$t.Katakana(e)||$t["Private Use Area"](e)||$t["CJK Compatibility Forms"](e)||$t["Small Form Variants"](e)||$t["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e}function Ui(t){return t>=1424&&t<=2303||$t["Arabic Presentation Forms-A"](t)||$t["Arabic Presentation Forms-B"](t)}function nr(t,e){return!(!e&&Ui(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||$t.Khmer(t))}function Br(t){for(var e=0,i=t;e<i.length;e+=1)if(Ui(i[e].charCodeAt(0)))return!0;return!1}var Sr=null,dn="unavailable",Uo=null,hs=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(dn="error"),Sr&&Sr(t)};function _a(){il.fire(new J("pluginStateChange",{pluginStatus:dn,pluginURL:Uo}))}var il=new ut,nl=function(){return dn},No=function(){if("deferred"!==dn||!Uo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");dn="loading",_a(),Uo&&lr({url:Uo},function(t){t?hs(t):(dn="loaded",_a())})},Po={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===dn||null!=Po.applyArabicShaping},isLoading:function(){return"loading"===dn},setState:function(t){dn=t.pluginStatus,Uo=t.pluginURL},isParsed:function(){return null!=Po.applyArabicShaping&&null!=Po.processBidirectionalText&&null!=Po.processStyledBidirectionalText},getPluginURL:function(){return Uo}},ri=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Pn,this.transition={})};ri.prototype.isSupportedScript=function(t){return function(e,i){for(var s=0,u=e;s<u.length;s+=1)if(!nr(u[s].charCodeAt(0),i))return!1;return!0}(t,Po.isLoaded())},ri.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ri.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}};var ia=function(t,e){this.property=t,this.value=e,this.expression=function(i,s){if(Sa(i))return new Ea(i,s);if(ka(i)){var u=ls(i,s);if("error"===u.result)throw new Error(u.value.map(function(f){return f.key+": "+f.message}).join(", "));return u.value}var p=i;return"string"==typeof i&&"color"===s.type&&(p=si.parse(i)),{kind:"constant",evaluate:function(){return p}}}(void 0===e?t.specification.default:e,t.specification)};ia.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ia.prototype.possiblyEvaluate=function(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)};var jo=function(t){this.property=t,this.value=new ia(t,void 0)};jo.prototype.transitioned=function(t,e){return new Ja(this.property,this.value,e,je({},t.transition,this.transition),t.now)},jo.prototype.untransitioned=function(){return new Ja(this.property,this.value,null,{},0)};var hr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};hr.prototype.getValue=function(t){return fr(this._values[t].value.value)},hr.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new jo(this._values[t].property)),this._values[t].value=new ia(this._values[t].property,null===e?void 0:fr(e))},hr.prototype.getTransition=function(t){return fr(this._values[t].transition)},hr.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new jo(this._values[t].property)),this._values[t].transition=fr(e)||void 0},hr.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var s=i[e],u=this.getValue(s);void 0!==u&&(t[s]=u);var p=this.getTransition(s);void 0!==p&&(t[s+"-transition"]=p)}return t},hr.prototype.transitioned=function(t,e){for(var i=new Da(this._properties),s=0,u=Object.keys(this._values);s<u.length;s+=1){var p=u[s];i._values[p]=this._values[p].transitioned(t,e._values[p])}return i},hr.prototype.untransitioned=function(){for(var t=new Da(this._properties),e=0,i=Object.keys(this._values);e<i.length;e+=1){var s=i[e];t._values[s]=this._values[s].untransitioned()}return t};var Ja=function(t,e,i,s,u){this.property=t,this.value=e,this.begin=u+s.delay||0,this.end=this.begin+s.duration||0,t.specification.transition&&(s.delay||s.duration)&&(this.prior=i)};Ja.prototype.possiblyEvaluate=function(t,e,i){var s=t.now||0,u=this.value.possiblyEvaluate(t,e,i),p=this.prior;if(p){if(s>this.end)return this.prior=null,u;if(this.value.isDataDriven())return this.prior=null,u;if(s<this.begin)return p.possiblyEvaluate(t,e,i);var f=(s-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(t,e,i),u,function(v){if(v<=0)return 0;if(v>=1)return 1;var T=v*v,I=T*v;return 4*(v<.5?I:3*(v-T)+I-.75)}(f))}return u};var Da=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Da.prototype.possiblyEvaluate=function(t,e,i){for(var s=new cs(this._properties),u=0,p=Object.keys(this._values);u<p.length;u+=1){var f=p[u];s._values[f]=this._values[f].possiblyEvaluate(t,e,i)}return s},Da.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var go=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};go.prototype.getValue=function(t){return fr(this._values[t].value)},go.prototype.setValue=function(t,e){this._values[t]=new ia(this._values[t].property,null===e?void 0:fr(e))},go.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var s=i[e],u=this.getValue(s);void 0!==u&&(t[s]=u)}return t},go.prototype.possiblyEvaluate=function(t,e,i){for(var s=new cs(this._properties),u=0,p=Object.keys(this._values);u<p.length;u+=1){var f=p[u];s._values[f]=this._values[f].possiblyEvaluate(t,e,i)}return s};var Or=function(t,e,i){this.property=t,this.value=e,this.parameters=i};Or.prototype.isConstant=function(){return"constant"===this.value.kind},Or.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},Or.prototype.evaluate=function(t,e,i,s){return this.property.evaluate(this.value,this.parameters,t,e,i,s)};var cs=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};cs.prototype.get=function(t){return this._values[t]};var ye=function(t){this.specification=t};ye.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},ye.prototype.interpolate=function(t,e,i){var s=vr[this.specification.type];return s?s(t,e,i):t};var fe=function(t,e){this.specification=t,this.overrides=e};fe.prototype.possiblyEvaluate=function(t,e,i,s){return new Or(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},i,s)}:t.expression,e)},fe.prototype.interpolate=function(t,e,i){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Or(this,{kind:"constant",value:void 0},t.parameters);var s=vr[this.specification.type];return s?new Or(this,{kind:"constant",value:s(t.value.value,e.value.value,i)},t.parameters):t},fe.prototype.evaluate=function(t,e,i,s,u,p){return"constant"===t.kind?t.value:t.evaluate(e,i,s,u,p)};var yl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(i,s,u,p){if(void 0===i.value)return new Or(this,{kind:"constant",value:void 0},s);if("constant"===i.expression.kind){var f=i.expression.evaluate(s,null,{},u,p),v="resolvedImage"===i.property.specification.type&&"string"!=typeof f?f.name:f,T=this._calculate(v,v,v,s);return new Or(this,{kind:"constant",value:T},s)}if("camera"===i.expression.kind){var I=this._calculate(i.expression.evaluate({zoom:s.zoom-1}),i.expression.evaluate({zoom:s.zoom}),i.expression.evaluate({zoom:s.zoom+1}),s);return new Or(this,{kind:"constant",value:I},s)}return new Or(this,i.expression,s)},e.prototype.evaluate=function(i,s,u,p,f,v){if("source"===i.kind){var T=i.evaluate(s,u,p,f,v);return this._calculate(T,T,T,s)}return"composite"===i.kind?this._calculate(i.evaluate({zoom:Math.floor(s.zoom)-1},u,p),i.evaluate({zoom:Math.floor(s.zoom)},u,p),i.evaluate({zoom:Math.floor(s.zoom)+1},u,p),s):i.value},e.prototype._calculate=function(i,s,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:i,to:s}:{from:u,to:s}},e.prototype.interpolate=function(i){return i},e}(fe),vo=function(t){this.specification=t};vo.prototype.possiblyEvaluate=function(t,e,i,s){if(void 0!==t.value){if("constant"===t.expression.kind){var u=t.expression.evaluate(e,null,{},i,s);return this._calculate(u,u,u,e)}return this._calculate(t.expression.evaluate(new ri(Math.floor(e.zoom-1),e)),t.expression.evaluate(new ri(Math.floor(e.zoom),e)),t.expression.evaluate(new ri(Math.floor(e.zoom+1),e)),e)}},vo.prototype._calculate=function(t,e,i,s){return s.zoom>s.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}},vo.prototype.interpolate=function(t){return t};var Ia=function(t){this.specification=t};Ia.prototype.possiblyEvaluate=function(t,e,i,s){return!!t.expression.evaluate(e,null,{},i,s)},Ia.prototype.interpolate=function(){return!1};var Kr=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var i=t[e];i.specification.overridable&&this.overridableProperties.push(e);var s=this.defaultPropertyValues[e]=new ia(i,void 0),u=this.defaultTransitionablePropertyValues[e]=new jo(i);this.defaultTransitioningPropertyValues[e]=u.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=s.possiblyEvaluate({})}};qt("DataDrivenProperty",fe),qt("DataConstantProperty",ye),qt("CrossFadedDataDrivenProperty",yl),qt("CrossFadedProperty",vo),qt("ColorRampProperty",Ia);var Ba=function(t){function e(i,s){if(t.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==i.type&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),s.layout&&(this._unevaluatedLayout=new go(s.layout)),s.paint)){for(var u in this._transitionablePaint=new hr(s.paint),i.paint)this.setPaintProperty(u,i.paint[u],{validate:!1});for(var p in i.layout)this.setLayoutProperty(p,i.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new cs(s.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)},e.prototype.setLayoutProperty=function(i,s,u){void 0===u&&(u={}),null!=s&&this._validate(qe,"layers."+this.id+".layout."+i,i,s,u)||("visibility"!==i?this._unevaluatedLayout.setValue(i,s):this.visibility=s)},e.prototype.getPaintProperty=function(i){return Ln(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},e.prototype.setPaintProperty=function(i,s,u){if(void 0===u&&(u={}),null!=s&&this._validate(ni,"layers."+this.id+".paint."+i,i,s,u))return!1;if(Ln(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),s||void 0),!1;var p=this._transitionablePaint._values[i],f="cross-faded-data-driven"===p.property.specification["property-type"],v=p.value.isDataDriven(),T=p.value;this._transitionablePaint.setValue(i,s),this._handleSpecialPaintPropertyUpdate(i);var I=this._transitionablePaint._values[i].value;return I.isDataDriven()||v||f||this._handleOverridablePaintPropertyUpdate(i,T,I)},e.prototype._handleSpecialPaintPropertyUpdate=function(i){},e.prototype._handleOverridablePaintPropertyUpdate=function(i,s,u){return!1},e.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(i,s){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,s)},e.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),on(i,function(s,u){return!(void 0===s||"layout"===u&&!Object.keys(s).length||"paint"===u&&!Object.keys(s).length)})},e.prototype._validate=function(i,s,u,p,f){return void 0===f&&(f={}),(!f||!1!==f.validate)&&ji(this,i.call(Ue,{key:s,layerType:this.type,objectKey:u,value:p,styleSpec:N,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var i in this.paint._values){var s=this.paint.get(i);if(s instanceof Or&&pa(s.property.specification)&&("source"===s.value.kind||"composite"===s.value.kind)&&s.value.isStateDependent)return!0}return!1},e}(ut),Jl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},gl=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Vi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Rr(t,e){void 0===e&&(e=1);var i=0,s=0;return{members:t.map(function(u){var p=Jl[u.type].BYTES_PER_ELEMENT,f=i=Pu(i,Math.max(e,p)),v=u.components||1;return s=Math.max(s,p),i+=p*v,{name:u.name,type:u.type,components:v,offset:f}}),size:Pu(i,Math.max(s,e)),alignment:e}}function Pu(t,e){return Math.ceil(t/e)*e}Vi.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Vi.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Vi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Vi.prototype.clear=function(){this.length=0},Vi.prototype.resize=function(t){this.reserve(t),this.length=t},Vi.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Vi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var ks=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s){var u=this.length;return this.resize(u+1),this.emplace(u,i,s)},e.prototype.emplace=function(i,s,u){var p=2*i;return this.int16[p+0]=s,this.int16[p+1]=u,i},e}(Vi);ks.prototype.bytesPerElement=4,qt("StructArrayLayout2i4",ks);var Yl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p){var f=this.length;return this.resize(f+1),this.emplace(f,i,s,u,p)},e.prototype.emplace=function(i,s,u,p,f){var v=4*i;return this.int16[v+0]=s,this.int16[v+1]=u,this.int16[v+2]=p,this.int16[v+3]=f,i},e}(Vi);Yl.prototype.bytesPerElement=8,qt("StructArrayLayout4i8",Yl);var Ya=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p,f,v){var T=this.length;return this.resize(T+1),this.emplace(T,i,s,u,p,f,v)},e.prototype.emplace=function(i,s,u,p,f,v,T){var I=6*i;return this.int16[I+0]=s,this.int16[I+1]=u,this.int16[I+2]=p,this.int16[I+3]=f,this.int16[I+4]=v,this.int16[I+5]=T,i},e}(Vi);Ya.prototype.bytesPerElement=12,qt("StructArrayLayout2i4i12",Ya);var Vo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p,f,v){var T=this.length;return this.resize(T+1),this.emplace(T,i,s,u,p,f,v)},e.prototype.emplace=function(i,s,u,p,f,v,T){var I=4*i,A=8*i;return this.int16[I+0]=s,this.int16[I+1]=u,this.uint8[A+4]=p,this.uint8[A+5]=f,this.uint8[A+6]=v,this.uint8[A+7]=T,i},e}(Vi);Vo.prototype.bytesPerElement=8,qt("StructArrayLayout2i4ub8",Vo);var Gs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s){var u=this.length;return this.resize(u+1),this.emplace(u,i,s)},e.prototype.emplace=function(i,s,u){var p=2*i;return this.float32[p+0]=s,this.float32[p+1]=u,i},e}(Vi);Gs.prototype.bytesPerElement=8,qt("StructArrayLayout2f8",Gs);var Oa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p,f,v,T,I,A,k){var R=this.length;return this.resize(R+1),this.emplace(R,i,s,u,p,f,v,T,I,A,k)},e.prototype.emplace=function(i,s,u,p,f,v,T,I,A,k,R){var U=10*i;return this.uint16[U+0]=s,this.uint16[U+1]=u,this.uint16[U+2]=p,this.uint16[U+3]=f,this.uint16[U+4]=v,this.uint16[U+5]=T,this.uint16[U+6]=I,this.uint16[U+7]=A,this.uint16[U+8]=k,this.uint16[U+9]=R,i},e}(Vi);Oa.prototype.bytesPerElement=20,qt("StructArrayLayout10ui20",Oa);var vl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p,f,v,T,I,A,k,R,U){var K=this.length;return this.resize(K+1),this.emplace(K,i,s,u,p,f,v,T,I,A,k,R,U)},e.prototype.emplace=function(i,s,u,p,f,v,T,I,A,k,R,U,K){var $=12*i;return this.int16[$+0]=s,this.int16[$+1]=u,this.int16[$+2]=p,this.int16[$+3]=f,this.uint16[$+4]=v,this.uint16[$+5]=T,this.uint16[$+6]=I,this.uint16[$+7]=A,this.int16[$+8]=k,this.int16[$+9]=R,this.int16[$+10]=U,this.int16[$+11]=K,i},e}(Vi);vl.prototype.bytesPerElement=24,qt("StructArrayLayout4i4ui4i24",vl);var Ws=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,u)},e.prototype.emplace=function(i,s,u,p){var f=3*i;return this.float32[f+0]=s,this.float32[f+1]=u,this.float32[f+2]=p,i},e}(Vi);Ws.prototype.bytesPerElement=12,qt("StructArrayLayout3f12",Ws);var rl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var s=this.length;return this.resize(s+1),this.emplace(s,i)},e.prototype.emplace=function(i,s){return this.uint32[1*i+0]=s,i},e}(Vi);rl.prototype.bytesPerElement=4,qt("StructArrayLayout1ul4",rl);var $l=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p,f,v,T,I,A){var k=this.length;return this.resize(k+1),this.emplace(k,i,s,u,p,f,v,T,I,A)},e.prototype.emplace=function(i,s,u,p,f,v,T,I,A,k){var R=10*i,U=5*i;return this.int16[R+0]=s,this.int16[R+1]=u,this.int16[R+2]=p,this.int16[R+3]=f,this.int16[R+4]=v,this.int16[R+5]=T,this.uint32[U+3]=I,this.uint16[R+8]=A,this.uint16[R+9]=k,i},e}(Vi);$l.prototype.bytesPerElement=20,qt("StructArrayLayout6i1ul2ui20",$l);var Hs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p,f,v){var T=this.length;return this.resize(T+1),this.emplace(T,i,s,u,p,f,v)},e.prototype.emplace=function(i,s,u,p,f,v,T){var I=6*i;return this.int16[I+0]=s,this.int16[I+1]=u,this.int16[I+2]=p,this.int16[I+3]=f,this.int16[I+4]=v,this.int16[I+5]=T,i},e}(Vi);Hs.prototype.bytesPerElement=12,qt("StructArrayLayout2i2i2i12",Hs);var Ms=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p,f){var v=this.length;return this.resize(v+1),this.emplace(v,i,s,u,p,f)},e.prototype.emplace=function(i,s,u,p,f,v){var T=4*i,I=8*i;return this.float32[T+0]=s,this.float32[T+1]=u,this.float32[T+2]=p,this.int16[I+6]=f,this.int16[I+7]=v,i},e}(Vi);Ms.prototype.bytesPerElement=16,qt("StructArrayLayout2f1f2i16",Ms);var Ql=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p){var f=this.length;return this.resize(f+1),this.emplace(f,i,s,u,p)},e.prototype.emplace=function(i,s,u,p,f){var v=12*i,T=3*i;return this.uint8[v+0]=s,this.uint8[v+1]=u,this.float32[T+1]=p,this.float32[T+2]=f,i},e}(Vi);Ql.prototype.bytesPerElement=12,qt("StructArrayLayout2ub2f12",Ql);var ps=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,u)},e.prototype.emplace=function(i,s,u,p){var f=3*i;return this.uint16[f+0]=s,this.uint16[f+1]=u,this.uint16[f+2]=p,i},e}(Vi);ps.prototype.bytesPerElement=6,qt("StructArrayLayout3ui6",ps);var ds=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p,f,v,T,I,A,k,R,U,K,$,lt,nt,dt){var yt=this.length;return this.resize(yt+1),this.emplace(yt,i,s,u,p,f,v,T,I,A,k,R,U,K,$,lt,nt,dt)},e.prototype.emplace=function(i,s,u,p,f,v,T,I,A,k,R,U,K,$,lt,nt,dt,yt){var xt=24*i,Tt=12*i,zt=48*i;return this.int16[xt+0]=s,this.int16[xt+1]=u,this.uint16[xt+2]=p,this.uint16[xt+3]=f,this.uint32[Tt+2]=v,this.uint32[Tt+3]=T,this.uint32[Tt+4]=I,this.uint16[xt+10]=A,this.uint16[xt+11]=k,this.uint16[xt+12]=R,this.float32[Tt+7]=U,this.float32[Tt+8]=K,this.uint8[zt+36]=$,this.uint8[zt+37]=lt,this.uint8[zt+38]=nt,this.uint32[Tt+10]=dt,this.int16[xt+22]=yt,i},e}(Vi);ds.prototype.bytesPerElement=48,qt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ds);var xl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p,f,v,T,I,A,k,R,U,K,$,lt,nt,dt,yt,xt,Tt,zt,Wt,te,ge,ae,xe,se,$e){var Le=this.length;return this.resize(Le+1),this.emplace(Le,i,s,u,p,f,v,T,I,A,k,R,U,K,$,lt,nt,dt,yt,xt,Tt,zt,Wt,te,ge,ae,xe,se,$e)},e.prototype.emplace=function(i,s,u,p,f,v,T,I,A,k,R,U,K,$,lt,nt,dt,yt,xt,Tt,zt,Wt,te,ge,ae,xe,se,$e,Le){var me=34*i,oi=17*i;return this.int16[me+0]=s,this.int16[me+1]=u,this.int16[me+2]=p,this.int16[me+3]=f,this.int16[me+4]=v,this.int16[me+5]=T,this.int16[me+6]=I,this.int16[me+7]=A,this.uint16[me+8]=k,this.uint16[me+9]=R,this.uint16[me+10]=U,this.uint16[me+11]=K,this.uint16[me+12]=$,this.uint16[me+13]=lt,this.uint16[me+14]=nt,this.uint16[me+15]=dt,this.uint16[me+16]=yt,this.uint16[me+17]=xt,this.uint16[me+18]=Tt,this.uint16[me+19]=zt,this.uint16[me+20]=Wt,this.uint16[me+21]=te,this.uint16[me+22]=ge,this.uint32[oi+12]=ae,this.float32[oi+13]=xe,this.float32[oi+14]=se,this.float32[oi+15]=$e,this.float32[oi+16]=Le,i},e}(Vi);xl.prototype.bytesPerElement=68,qt("StructArrayLayout8i15ui1ul4f68",xl);var fs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var s=this.length;return this.resize(s+1),this.emplace(s,i)},e.prototype.emplace=function(i,s){return this.float32[1*i+0]=s,i},e}(Vi);fs.prototype.bytesPerElement=4,qt("StructArrayLayout1f4",fs);var ya=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,u)},e.prototype.emplace=function(i,s,u,p){var f=3*i;return this.int16[f+0]=s,this.int16[f+1]=u,this.int16[f+2]=p,i},e}(Vi);ya.prototype.bytesPerElement=6,qt("StructArrayLayout3i6",ya);var tu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,u)},e.prototype.emplace=function(i,s,u,p){var f=4*i;return this.uint32[2*i+0]=s,this.uint16[f+2]=u,this.uint16[f+3]=p,i},e}(Vi);tu.prototype.bytesPerElement=8,qt("StructArrayLayout1ul2ui8",tu);var ol=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s){var u=this.length;return this.resize(u+1),this.emplace(u,i,s)},e.prototype.emplace=function(i,s,u){var p=2*i;return this.uint16[p+0]=s,this.uint16[p+1]=u,i},e}(Vi);ol.prototype.bytesPerElement=4,qt("StructArrayLayout2ui4",ol);var eu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var s=this.length;return this.resize(s+1),this.emplace(s,i)},e.prototype.emplace=function(i,s){return this.uint16[1*i+0]=s,i},e}(Vi);eu.prototype.bytesPerElement=2,qt("StructArrayLayout1ui2",eu);var bl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,u,p){var f=this.length;return this.resize(f+1),this.emplace(f,i,s,u,p)},e.prototype.emplace=function(i,s,u,p,f){var v=4*i;return this.float32[v+0]=s,this.float32[v+1]=u,this.float32[v+2]=p,this.float32[v+3]=f,i},e}(Vi);bl.prototype.bytesPerElement=16,qt("StructArrayLayout4f16",bl);var n=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new le(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,i),e}(gl);n.prototype.size=20;var a=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new n(this,i)},e}($l);qt("CollisionBoxArray",a);var o=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(s){this._structArray.uint8[this._pos1+37]=s},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(s){this._structArray.uint8[this._pos1+38]=s},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(s){this._structArray.uint32[this._pos4+10]=s},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,i),e}(gl);o.prototype.size=48;var l=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new o(this,i)},e}(ds);qt("PlacedSymbolArray",l);var d=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(s){this._structArray.uint32[this._pos4+12]=s},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,i),e}(gl);d.prototype.size=68;var _=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new d(this,i)},e}(xl);qt("SymbolInstanceArray",_);var g=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(i){return this.float32[1*i+0]},e}(fs);qt("GlyphOffsetArray",g);var w=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(i){return this.int16[3*i+0]},e.prototype.gety=function(i){return this.int16[3*i+1]},e.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},e}(ya);qt("SymbolLineVertexArray",w);var P=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,i),e}(gl);P.prototype.size=8;var M=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new P(this,i)},e}(tu);qt("FeatureIndexArray",M);var j=Rr([{name:"a_pos",components:2,type:"Int16"}],4).members,V=function(t){void 0===t&&(t=[]),this.segments=t};function q(t,e){return 256*(t=jn(Math.floor(t),0,255))+jn(Math.floor(e),0,255)}V.prototype.prepareSegment=function(t,e,i,s){var u=this.segments[this.segments.length-1];return t>V.MAX_VERTEX_ARRAY_LENGTH&&Ye("Max vertices per segment is "+V.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!u||u.vertexLength+t>V.MAX_VERTEX_ARRAY_LENGTH||u.sortKey!==s)&&(u={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==s&&(u.sortKey=s),this.segments.push(u)),u},V.prototype.get=function(){return this.segments},V.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var i=e[t];for(var s in i.vaos)i.vaos[s].destroy()}},V.simpleSegment=function(t,e,i,s){return new V([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:s,vaos:{},sortKey:0}])},V.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,qt("SegmentVector",V);var tt=Rr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Q=mi(function(t){t.exports=function(e,i){var s,u,p,f,v,T,I,A;for(u=e.length-(s=3&e.length),p=i,v=3432918353,T=461845907,A=0;A<u;)I=255&e.charCodeAt(A)|(255&e.charCodeAt(++A))<<8|(255&e.charCodeAt(++A))<<16|(255&e.charCodeAt(++A))<<24,++A,p=27492+(65535&(f=5*(65535&(p=(p^=I=(65535&(I=(I=(65535&I)*v+(((I>>>16)*v&65535)<<16)&4294967295)<<15|I>>>17))*T+(((I>>>16)*T&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(I=0,s){case 3:I^=(255&e.charCodeAt(A+2))<<16;case 2:I^=(255&e.charCodeAt(A+1))<<8;case 1:p^=I=(65535&(I=(I=(65535&(I^=255&e.charCodeAt(A)))*v+(((I>>>16)*v&65535)<<16)&4294967295)<<15|I>>>17))*T+(((I>>>16)*T&65535)<<16)&4294967295}return p^=e.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),st=mi(function(t){t.exports=function(e,i){for(var s,u=e.length,p=i^u,f=0;u>=4;)s=1540483477*(65535&(s=255&e.charCodeAt(f)|(255&e.charCodeAt(++f))<<8|(255&e.charCodeAt(++f))<<16|(255&e.charCodeAt(++f))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),u-=4,++f;switch(u){case 3:p^=(255&e.charCodeAt(f+2))<<16;case 2:p^=(255&e.charCodeAt(f+1))<<8;case 1:p=1540483477*(65535&(p^=255&e.charCodeAt(f)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),X=Q,at=st;X.murmur3=Q,X.murmur2=at;var ht=function(){this.ids=[],this.positions=[],this.indexed=!1};ht.prototype.add=function(t,e,i,s){this.ids.push(Et(t)),this.positions.push(e,i,s)},ht.prototype.getPositions=function(t){for(var e=Et(t),i=0,s=this.ids.length-1;i<s;){var u=i+s>>1;this.ids[u]>=e?s=u:i=u+1}for(var p=[];this.ids[i]===e;)p.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return p},ht.serialize=function(t,e){var i=new Float64Array(t.ids),s=new Uint32Array(t.positions);return function u(p,f,v,T){for(;v<T;){for(var I=p[v+T>>1],A=v-1,k=T+1;;){do{A++}while(p[A]<I);do{k--}while(p[k]>I);if(A>=k)break;wt(p,A,k),wt(f,3*A,3*k),wt(f,3*A+1,3*k+1),wt(f,3*A+2,3*k+2)}k-v<T-k?(u(p,f,v,k),v=k+1):(u(p,f,k+1,T),T=k)}}(i,s,0,i.length-1),e&&e.push(i.buffer,s.buffer),{ids:i,positions:s}},ht.deserialize=function(t){var e=new ht;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var _t=Math.pow(2,53)-1;function Et(t){var e=+t;return!isNaN(e)&&e<=_t?e:X(String(t))}function wt(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}qt("FeaturePositionMap",ht);var It=function(t,e){this.gl=t.gl,this.location=e},Rt=function(t){function e(i,s){t.call(this,i,s),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},e}(It),Yt=function(t){function e(i,s){t.call(this,i,s),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},e}(It),Xt=function(t){function e(i,s){t.call(this,i,s),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},e}(It),ue=function(t){function e(i,s){t.call(this,i,s),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},e}(It),ve=function(t){function e(i,s){t.call(this,i,s),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},e}(It),Se=function(t){function e(i,s){t.call(this,i,s),this.current=si.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},e}(It),we=new Float32Array(16),Ei=function(t){function e(i,s){t.call(this,i,s),this.current=we}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var s=1;s<16;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},e}(It);function pe(t){return[q(255*t.r,255*t.g),q(255*t.b,255*t.a)]}var Re=function(t,e,i){this.value=t,this.uniformNames=e.map(function(s){return"u_"+s}),this.type=i};Re.prototype.setUniform=function(t,e,i){t.set(i.constantOr(this.value))},Re.prototype.getBinding=function(t,e,i){return"color"===this.type?new Se(t,e):new Yt(t,e)};var Je=function(t,e){this.uniformNames=e.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Je.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},Je.prototype.setUniform=function(t,e,i,s){var u="u_pattern_to"===s?this.patternTo:"u_pattern_from"===s?this.patternFrom:"u_pixel_ratio_to"===s?this.pixelRatioTo:"u_pixel_ratio_from"===s?this.pixelRatioFrom:null;u&&t.set(u)},Je.prototype.getBinding=function(t,e,i){return"u_pattern"===i.substr(0,9)?new ve(t,e):new Yt(t,e)};var Be=function(t,e,i,s){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map(function(u){return{name:"a_"+u,type:"Float32",components:"color"===i?2:1,offset:0}}),this.paintVertexArray=new s};Be.prototype.populatePaintArray=function(t,e,i,s,u){var p=this.paintVertexArray.length,f=this.expression.evaluate(new ri(0),e,{},s,[],u);this.paintVertexArray.resize(t),this._setPaintValue(p,t,f)},Be.prototype.updatePaintArray=function(t,e,i,s){var u=this.expression.evaluate({zoom:0},i,s);this._setPaintValue(t,e,u)},Be.prototype._setPaintValue=function(t,e,i){if("color"===this.type)for(var s=pe(i),u=t;u<e;u++)this.paintVertexArray.emplace(u,s[0],s[1]);else{for(var p=t;p<e;p++)this.paintVertexArray.emplace(p,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Be.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Be.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ke=function(t,e,i,s,u,p){this.expression=t,this.uniformNames=e.map(function(f){return"u_"+f+"_t"}),this.type=i,this.useIntegerZoom=s,this.zoom=u,this.maxValue=0,this.paintVertexAttributes=e.map(function(f){return{name:"a_"+f,type:"Float32",components:"color"===i?4:2,offset:0}}),this.paintVertexArray=new p};ke.prototype.populatePaintArray=function(t,e,i,s,u){var p=this.expression.evaluate(new ri(this.zoom),e,{},s,[],u),f=this.expression.evaluate(new ri(this.zoom+1),e,{},s,[],u),v=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(v,t,p,f)},ke.prototype.updatePaintArray=function(t,e,i,s){var u=this.expression.evaluate({zoom:this.zoom},i,s),p=this.expression.evaluate({zoom:this.zoom+1},i,s);this._setPaintValue(t,e,u,p)},ke.prototype._setPaintValue=function(t,e,i,s){if("color"===this.type)for(var u=pe(i),p=pe(s),f=t;f<e;f++)this.paintVertexArray.emplace(f,u[0],u[1],p[0],p[1]);else{for(var v=t;v<e;v++)this.paintVertexArray.emplace(v,i,s);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(s))}},ke.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ke.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ke.prototype.setUniform=function(t,e){var i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,s=jn(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(s)},ke.prototype.getBinding=function(t,e,i){return new Yt(t,e)};var Xe=function(t,e,i,s,u,p){this.expression=t,this.type=e,this.useIntegerZoom=i,this.zoom=s,this.layerId=p,this.zoomInPaintVertexArray=new u,this.zoomOutPaintVertexArray=new u};Xe.prototype.populatePaintArray=function(t,e,i){var s=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(s,t,e.patterns&&e.patterns[this.layerId],i)},Xe.prototype.updatePaintArray=function(t,e,i,s,u){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],u)},Xe.prototype._setPaintValues=function(t,e,i,s){if(s&&i){var u=s[i.min],p=s[i.mid],f=s[i.max];if(u&&p&&f)for(var v=t;v<e;v++)this.zoomInPaintVertexArray.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],p.pixelRatio,u.pixelRatio),this.zoomOutPaintVertexArray.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],p.pixelRatio,f.pixelRatio)}},Xe.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,tt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,tt.members,this.expression.isStateDependent))},Xe.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ze=function(t,e,i){this.binders={},this._buffers=[];var s=[];for(var u in t.paint._values)if(i(u)){var p=t.paint.get(u);if(p instanceof Or&&pa(p.property.specification)){var f=Er(u,t.type),v=p.value,T=p.property.specification.type,I=p.property.useIntegerZoom,A=p.property.specification["property-type"],k="cross-faded"===A||"cross-faded-data-driven"===A;if("constant"===v.kind)this.binders[u]=k?new Je(v.value,f):new Re(v.value,f,T),s.push("/u_"+u);else if("source"===v.kind||k){var R=Fn(u,T,"source");this.binders[u]=k?new Xe(v,T,I,e,R,t.id):new Be(v,f,T,R),s.push("/a_"+u)}else{var U=Fn(u,T,"composite");this.binders[u]=new ke(v,f,T,I,e,U),s.push("/z_"+u)}}}this.cacheKey=s.sort().join("")};ze.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof Be||e instanceof ke?e.maxValue:0},ze.prototype.populatePaintArrays=function(t,e,i,s,u){for(var p in this.binders){var f=this.binders[p];(f instanceof Be||f instanceof ke||f instanceof Xe)&&f.populatePaintArray(t,e,i,s,u)}},ze.prototype.setConstantPatternPositions=function(t,e){for(var i in this.binders){var s=this.binders[i];s instanceof Je&&s.setConstantPatternPositions(t,e)}},ze.prototype.updatePaintArrays=function(t,e,i,s,u){var p=!1;for(var f in t)for(var v=0,T=e.getPositions(f);v<T.length;v+=1){var I=T[v],A=i.feature(I.index);for(var k in this.binders){var R=this.binders[k];if((R instanceof Be||R instanceof ke||R instanceof Xe)&&!0===R.expression.isStateDependent){var U=s.paint.get(k);R.expression=U.value,R.updatePaintArray(I.start,I.end,A,t[f],u),p=!0}}}return p},ze.prototype.defines=function(){var t=[];for(var e in this.binders){var i=this.binders[e];(i instanceof Re||i instanceof Je)&&t.push.apply(t,i.uniformNames.map(function(s){return"#define HAS_UNIFORM_"+s}))}return t},ze.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof Be||i instanceof ke)for(var s=0;s<i.paintVertexAttributes.length;s++)t.push(i.paintVertexAttributes[s].name);else if(i instanceof Xe)for(var u=0;u<tt.members.length;u++)t.push(tt.members[u].name)}return t},ze.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof Re||i instanceof Je||i instanceof ke)for(var s=0,u=i.uniformNames;s<u.length;s+=1)t.push(u[s])}return t},ze.prototype.getPaintVertexBuffers=function(){return this._buffers},ze.prototype.getUniforms=function(t,e){var i=[];for(var s in this.binders){var u=this.binders[s];if(u instanceof Re||u instanceof Je||u instanceof ke)for(var p=0,f=u.uniformNames;p<f.length;p+=1){var v=f[p];if(e[v]){var T=u.getBinding(t,e[v],v);i.push({name:v,property:s,binding:T})}}}return i},ze.prototype.setUniforms=function(t,e,i,s){for(var u=0,p=e;u<p.length;u+=1){var f=p[u],v=f.name,T=f.property;this.binders[T].setUniform(f.binding,s,i.get(T),v)}},ze.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var i=this.binders[e];if(t&&i instanceof Xe){var s=2===t.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;s&&this._buffers.push(s)}else(i instanceof Be||i instanceof ke)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},ze.prototype.upload=function(t){for(var e in this.binders){var i=this.binders[e];(i instanceof Be||i instanceof ke||i instanceof Xe)&&i.upload(t)}this.updatePaintBuffers()},ze.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof Be||e instanceof ke||e instanceof Xe)&&e.destroy()}};var Ce=function(t,e,i){void 0===i&&(i=function(){return!0}),this.programConfigurations={};for(var s=0,u=t;s<u.length;s+=1){var p=u[s];this.programConfigurations[p.id]=new ze(p,e,i)}this.needsUpload=!1,this._featureMap=new ht,this._bufferOffset=0};function Er(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function Fn(t,e,i){var u={"line-pattern":{source:Oa,composite:Oa},"fill-pattern":{source:Oa,composite:Oa},"fill-extrusion-pattern":{source:Oa,composite:Oa}}[t];return u&&u[i]||{color:{source:Gs,composite:bl},number:{source:fs,composite:Gs}}[e][i]}Ce.prototype.populatePaintArrays=function(t,e,i,s,u,p){for(var f in this.programConfigurations)this.programConfigurations[f].populatePaintArrays(t,e,s,u,p);void 0!==e.id&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Ce.prototype.updatePaintArrays=function(t,e,i,s){for(var u=0,p=i;u<p.length;u+=1){var f=p[u];this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(t,this._featureMap,e,f,s)||this.needsUpload}},Ce.prototype.get=function(t){return this.programConfigurations[t]},Ce.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Ce.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},qt("ConstantBinder",Re),qt("CrossFadedConstantBinder",Je),qt("SourceExpressionBinder",Be),qt("CrossFadedCompositeBinder",Xe),qt("CompositeExpressionBinder",ke),qt("ProgramConfiguration",ze,{omit:["_buffers"]}),qt("ProgramConfigurationSet",Ce);var so=Math.pow(2,14)-1,Fr=-so-1;function An(t){for(var e=8192/t.extent,i=t.loadGeometry(),s=0;s<i.length;s++)for(var u=i[s],p=0;p<u.length;p++){var f=u[p],v=Math.round(f.x*e),T=Math.round(f.y*e);f.x=jn(v,Fr,so),f.y=jn(T,Fr,so),(v<f.x||v>f.x+1||T<f.y||T>f.y+1)&&Ye("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function Kn(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?An(t):[]}}function Zo(t,e,i,s,u){t.emplaceBack(2*e+(s+1)/2,2*i+(u+1)/2)}var xo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ks,this.indexArray=new ps,this.segments=new V,this.programConfigurations=new Ce(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function ms(t,e){for(var i=0;i<t.length;i++)if(Ra(e,t[i]))return!0;for(var s=0;s<e.length;s++)if(Ra(t,e[s]))return!0;return!!al(t,e)}function Ao(t,e,i){return!!Ra(t,e)||!!_s(e,t,i)}function Pa(t,e){if(1===t.length)return sl(e,t[0]);for(var i=0;i<e.length;i++)for(var s=e[i],u=0;u<s.length;u++)if(Ra(t,s[u]))return!0;for(var p=0;p<t.length;p++)if(sl(e,t[p]))return!0;for(var f=0;f<e.length;f++)if(al(t,e[f]))return!0;return!1}function ga(t,e,i){if(t.length>1){if(al(t,e))return!0;for(var s=0;s<e.length;s++)if(_s(e[s],t,i))return!0}for(var u=0;u<t.length;u++)if(_s(t[u],e,i))return!0;return!1}function al(t,e){if(0===t.length||0===e.length)return!1;for(var i=0;i<t.length-1;i++)for(var s=t[i],u=t[i+1],p=0;p<e.length-1;p++)if(Xs(s,u,e[p],e[p+1]))return!0;return!1}function Xs(t,e,i,s){return _e(t,i,s)!==_e(e,i,s)&&_e(t,e,i)!==_e(t,e,s)}function _s(t,e,i){var s=i*i;if(1===e.length)return t.distSqr(e[0])<s;for(var u=1;u<e.length;u++)if(Ks(t,e[u-1],e[u])<s)return!0;return!1}function Ks(t,e,i){var s=e.distSqr(i);if(0===s)return t.distSqr(e);var u=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/s;return t.distSqr(u<0?e:u>1?i:i.sub(e)._mult(u)._add(e))}function sl(t,e){for(var i,s,u,p=!1,f=0;f<t.length;f++)for(var v=0,T=(i=t[f]).length-1;v<i.length;T=v++)(s=i[v]).y>e.y!=(u=i[T]).y>e.y&&e.x<(u.x-s.x)*(e.y-s.y)/(u.y-s.y)+s.x&&(p=!p);return p}function Ra(t,e){for(var i=!1,s=0,u=t.length-1;s<t.length;u=s++){var p=t[s],f=t[u];p.y>e.y!=f.y>e.y&&e.x<(f.x-p.x)*(e.y-p.y)/(f.y-p.y)+p.x&&(i=!i)}return i}function ll(t,e,i){var s=i[0],u=i[2];if(t.x<s.x&&e.x<s.x||t.x>u.x&&e.x>u.x||t.y<s.y&&e.y<s.y||t.y>u.y&&e.y>u.y)return!1;var p=_e(t,e,i[0]);return p!==_e(t,e,i[1])||p!==_e(t,e,i[2])||p!==_e(t,e,i[3])}function Fa(t,e,i){var s=e.paint.get(t).value;return"constant"===s.kind?s.value:i.programConfigurations.get(e.id).getMaxValue(t)}function Ir(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function $a(t,e,i,s,u){if(!e[0]&&!e[1])return t;var p=le.convert(e)._mult(u);"viewport"===i&&p._rotate(-s);for(var f=[],v=0;v<t.length;v++)f.push(t[v].sub(p));return f}xo.prototype.populate=function(t,e,i){var s=this.layers[0],u=[],p=null;"circle"===s.type&&(p=s.layout.get("circle-sort-key"));for(var f=0,v=t;f<v.length;f+=1){var T=v[f],I=T.feature,A=T.id,k=T.index,R=T.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,K=Kn(I,U);if(this.layers[0]._featureFilter.filter(new ri(this.zoom),K,i)){var $=p?p.evaluate(K,{},i):void 0,lt={id:A,properties:I.properties,type:I.type,sourceLayerIndex:R,index:k,geometry:U?K.geometry:An(I),patterns:{},sortKey:$};u.push(lt)}}p&&u.sort(function(te,ge){return te.sortKey-ge.sortKey});for(var nt=0,dt=u;nt<dt.length;nt+=1){var yt=dt[nt],xt=yt.geometry,Tt=yt.index,zt=yt.sourceLayerIndex,Wt=t[Tt].feature;this.addFeature(yt,xt,Tt,i),e.featureIndex.insert(Wt,xt,Tt,zt,this.index)}},xo.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},xo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},xo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,j),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},xo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xo.prototype.addFeature=function(t,e,i,s){for(var u=0,p=e;u<p.length;u+=1)for(var f=0,v=p[u];f<v.length;f+=1){var T=v[f],I=T.x,A=T.y;if(!(I<0||I>=8192||A<0||A>=8192)){var k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),R=k.vertexLength;Zo(this.layoutVertexArray,I,A,-1,-1),Zo(this.layoutVertexArray,I,A,1,-1),Zo(this.layoutVertexArray,I,A,1,1),Zo(this.layoutVertexArray,I,A,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+3,R+2),k.vertexLength+=4,k.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},s)},qt("CircleBucket",xo,{omit:["layers"]});var ys=new Kr({"circle-sort-key":new fe(N.layout_circle["circle-sort-key"])}),Ds={paint:new Kr({"circle-radius":new fe(N.paint_circle["circle-radius"]),"circle-color":new fe(N.paint_circle["circle-color"]),"circle-blur":new fe(N.paint_circle["circle-blur"]),"circle-opacity":new fe(N.paint_circle["circle-opacity"]),"circle-translate":new ye(N.paint_circle["circle-translate"]),"circle-translate-anchor":new ye(N.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ye(N.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ye(N.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new fe(N.paint_circle["circle-stroke-width"]),"circle-stroke-color":new fe(N.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new fe(N.paint_circle["circle-stroke-opacity"])}),layout:ys},Oi=typeof Float32Array<"u"?Float32Array:Array;function na(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Co(t,e,i){var s=e[0],u=e[1],p=e[2],f=e[3],v=e[4],T=e[5],I=e[6],A=e[7],k=e[8],R=e[9],U=e[10],K=e[11],$=e[12],lt=e[13],nt=e[14],dt=e[15],yt=i[0],xt=i[1],Tt=i[2],zt=i[3];return t[0]=yt*s+xt*v+Tt*k+zt*$,t[1]=yt*u+xt*T+Tt*R+zt*lt,t[2]=yt*p+xt*I+Tt*U+zt*nt,t[3]=yt*f+xt*A+Tt*K+zt*dt,t[4]=(yt=i[4])*s+(xt=i[5])*v+(Tt=i[6])*k+(zt=i[7])*$,t[5]=yt*u+xt*T+Tt*R+zt*lt,t[6]=yt*p+xt*I+Tt*U+zt*nt,t[7]=yt*f+xt*A+Tt*K+zt*dt,t[8]=(yt=i[8])*s+(xt=i[9])*v+(Tt=i[10])*k+(zt=i[11])*$,t[9]=yt*u+xt*T+Tt*R+zt*lt,t[10]=yt*p+xt*I+Tt*U+zt*nt,t[11]=yt*f+xt*A+Tt*K+zt*dt,t[12]=(yt=i[12])*s+(xt=i[13])*v+(Tt=i[14])*k+(zt=i[15])*$,t[13]=yt*u+xt*T+Tt*R+zt*lt,t[14]=yt*p+xt*I+Tt*U+zt*nt,t[15]=yt*f+xt*A+Tt*K+zt*dt,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,i=arguments.length;i--;)e+=t[i]*t[i];return Math.sqrt(e)});var Bs,t,sh=Co;function wl(t,e,i){var s=e[0],u=e[1],p=e[2],f=e[3];return t[0]=i[0]*s+i[4]*u+i[8]*p+i[12]*f,t[1]=i[1]*s+i[5]*u+i[9]*p+i[13]*f,t[2]=i[2]*s+i[6]*u+i[10]*p+i[14]*f,t[3]=i[3]*s+i[7]*u+i[11]*p+i[15]*f,t}Bs=new Oi(3),Oi!=Float32Array&&(Bs[0]=0,Bs[1]=0,Bs[2]=0),t=new Oi(4),Oi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0);var lh=(function(){var t=new Oi(2);Oi!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(i){t.call(this,i,Ds)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new xo(i)},e.prototype.queryRadius=function(i){var s=i;return Fa("circle-radius",this,s)+Fa("circle-stroke-width",this,s)+Ir(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(i,s,u,p,f,v,T,I){for(var A=$a(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,T),k=this.paint.get("circle-radius").evaluate(s,u)+this.paint.get("circle-stroke-width").evaluate(s,u),R="map"===this.paint.get("circle-pitch-alignment"),U=R?A:function(Wt,te){return Wt.map(function(ge){return ul(ge,te)})}(A,I),K=R?k*T:k,$=0,lt=p;$<lt.length;$+=1)for(var nt=0,dt=lt[$];nt<dt.length;nt+=1){var yt=dt[nt],xt=R?yt:ul(yt,I),Tt=K,zt=wl([],[yt.x,yt.y,0,1],I);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?Tt*=zt[3]/v.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(Tt*=v.cameraToCenterDistance/zt[3]),Ao(U,xt,Tt))return!0}return!1},e}(Ba));function ul(t,e){var i=wl([],[t.x,t.y,0,1],e);return new le(i[0]/i[3],i[1]/i[3])}var Au=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(xo);function Js(t,e,i,s){var u=e.width,p=e.height;if(s){if(s instanceof Uint8ClampedArray)s=new Uint8Array(s.buffer);else if(s.length!==u*p*i)throw new RangeError("mismatched image size")}else s=new Uint8Array(u*p*i);return t.width=u,t.height=p,t.data=s,t}function Tl(t,e,i){var s=e.width,u=e.height;if(s!==t.width||u!==t.height){var p=Js({},{width:s,height:u},i);uh(t,p,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,s),height:Math.min(t.height,u)},i),t.width=s,t.height=u,t.data=p.data}}function uh(t,e,i,s,u,p){if(0===u.width||0===u.height)return e;if(u.width>t.width||u.height>t.height||i.x>t.width-u.width||i.y>t.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||s.x>e.width-u.width||s.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");for(var f=t.data,v=e.data,T=0;T<u.height;T++)for(var I=((i.y+T)*t.width+i.x)*p,A=((s.y+T)*e.width+s.x)*p,k=0;k<u.width*p;k++)v[A+k]=f[I+k];return e}qt("HeatmapBucket",Au,{omit:["layers"]});var hl=function(t,e){Js(this,t,1,e)};hl.prototype.resize=function(t){Tl(this,t,1)},hl.prototype.clone=function(){return new hl({width:this.width,height:this.height},new Uint8Array(this.data))},hl.copy=function(t,e,i,s,u){uh(t,e,i,s,u,1)};var qo=function(t,e){Js(this,t,4,e)};qo.prototype.resize=function(t){Tl(this,t,4)},qo.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},qo.prototype.clone=function(){return new qo({width:this.width,height:this.height},new Uint8Array(this.data))},qo.copy=function(t,e,i,s,u){uh(t,e,i,s,u,4)},qt("AlphaImage",hl),qt("RGBAImage",qo);var op={paint:new Kr({"heatmap-radius":new fe(N.paint_heatmap["heatmap-radius"]),"heatmap-weight":new fe(N.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ye(N.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ia(N.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ye(N.paint_heatmap["heatmap-opacity"])})};function Uh(t){var e={},i=t.resolution||256,s=t.clips?t.clips.length:1,u=t.image||new qo({width:i,height:s}),p=function(K,$,lt){e[t.evaluationKey]=lt;var nt=t.expression.evaluate(e);u.data[K+$+0]=Math.floor(255*nt.r/nt.a),u.data[K+$+1]=Math.floor(255*nt.g/nt.a),u.data[K+$+2]=Math.floor(255*nt.b/nt.a),u.data[K+$+3]=Math.floor(255*nt.a)};if(t.clips)for(var f=0,v=0;f<s;++f,v+=4*i)for(var T=0,I=0;T<i;T++,I+=4){var A=T/(i-1),k=t.clips[f];p(v,I,k.start*(1-A)+k.end*A)}else for(var R=0,U=0;R<i;R++,U+=4)p(0,U,R/(i-1));return u}var ap=function(t){function e(i){t.call(this,i,op),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new Au(i)},e.prototype._handleSpecialPaintPropertyUpdate=function(i){"heatmap-color"===i&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=Uh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(Ba),sp={paint:new Kr({"hillshade-illumination-direction":new ye(N.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ye(N.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ye(N.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ye(N.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ye(N.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ye(N.paint_hillshade["hillshade-accent-color"])})},lp=function(t){function e(i){t.call(this,i,sp)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(Ba),up=Rr([{name:"a_pos",components:2,type:"Int16"}],4).members,hh=Cu,hp=Cu;function Cu(t,e,i){i=i||2;var s,u,p,f,v,T,I,A=e&&e.length,k=A?e[0]*i:t.length,R=Nh(t,0,k,i,!0),U=[];if(!R||R.next===R.prev)return U;if(A&&(R=function($,lt,nt,dt){var yt,xt,Tt,zt=[];for(yt=0,xt=lt.length;yt<xt;yt++)(Tt=Nh($,lt[yt]*dt,yt<xt-1?lt[yt+1]*dt:$.length,dt,!1))===Tt.next&&(Tt.steiner=!0),zt.push(gp(Tt));for(zt.sort(mp),yt=0;yt<zt.length;yt++)_p(zt[yt],nt),nt=Ys(nt,nt.next);return nt}(t,e,R,i)),t.length>80*i){s=p=t[0],u=f=t[1];for(var K=i;K<k;K+=i)(v=t[K])<s&&(s=v),(T=t[K+1])<u&&(u=T),v>p&&(p=v),T>f&&(f=T);I=0!==(I=Math.max(p-s,f-u))?1/I:0}return iu(R,U,i,s,u,I),U}function Nh(t,e,i,s,u){var p,f;if(u===dh(t,e,i,s)>0)for(p=e;p<i;p+=s)f=Zh(p,t[p],t[p+1],f);else for(p=i-s;p>=e;p-=s)f=Zh(p,t[p],t[p+1],f);return f&&Lu(f,f.next)&&(ru(f),f=f.next),f}function Ys(t,e){if(!t)return t;e||(e=t);var i,s=t;do{if(i=!1,s.steiner||!Lu(s,s.next)&&0!==cr(s.prev,s,s.next))s=s.next;else{if(ru(s),(s=e=s.prev)===s.next)break;i=!0}}while(i||s!==e);return e}function iu(t,e,i,s,u,p,f){if(t){!f&&p&&function(A,k,R,U){var K=A;do{null===K.z&&(K.z=ch(K.x,K.y,k,R,U)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next}while(K!==A);K.prevZ.nextZ=null,K.prevZ=null,function($){var lt,nt,dt,yt,xt,Tt,zt,Wt,te=1;do{for(nt=$,$=null,xt=null,Tt=0;nt;){for(Tt++,dt=nt,zt=0,lt=0;lt<te&&(zt++,dt=dt.nextZ);lt++);for(Wt=te;zt>0||Wt>0&&dt;)0!==zt&&(0===Wt||!dt||nt.z<=dt.z)?(yt=nt,nt=nt.nextZ,zt--):(yt=dt,dt=dt.nextZ,Wt--),xt?xt.nextZ=yt:$=yt,yt.prevZ=xt,xt=yt;nt=dt}xt.nextZ=null,te*=2}while(Tt>1)}(K)}(t,s,u,p);for(var v,T,I=t;t.prev!==t.next;)if(v=t.prev,T=t.next,p?pp(t,s,u,p):cp(t))e.push(v.i/i),e.push(t.i/i),e.push(T.i/i),ru(t),t=T.next,I=T.next;else if((t=T)===I){f?1===f?iu(t=dp(Ys(t),e,i),e,i,s,u,p,2):2===f&&fp(t,e,i,s,u,p):iu(Ys(t),e,i,s,u,p,1);break}}}function cp(t){var e=t.prev,i=t,s=t.next;if(cr(e,i,s)>=0)return!1;for(var u=t.next.next;u!==t.prev;){if(Sl(e.x,e.y,i.x,i.y,s.x,s.y,u.x,u.y)&&cr(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function pp(t,e,i,s){var u=t.prev,p=t,f=t.next;if(cr(u,p,f)>=0)return!1;for(var v=u.x>p.x?u.x>f.x?u.x:f.x:p.x>f.x?p.x:f.x,T=u.y>p.y?u.y>f.y?u.y:f.y:p.y>f.y?p.y:f.y,I=ch(u.x<p.x?u.x<f.x?u.x:f.x:p.x<f.x?p.x:f.x,u.y<p.y?u.y<f.y?u.y:f.y:p.y<f.y?p.y:f.y,e,i,s),A=ch(v,T,e,i,s),k=t.prevZ,R=t.nextZ;k&&k.z>=I&&R&&R.z<=A;){if(k!==t.prev&&k!==t.next&&Sl(u.x,u.y,p.x,p.y,f.x,f.y,k.x,k.y)&&cr(k.prev,k,k.next)>=0||(k=k.prevZ,R!==t.prev&&R!==t.next&&Sl(u.x,u.y,p.x,p.y,f.x,f.y,R.x,R.y)&&cr(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;k&&k.z>=I;){if(k!==t.prev&&k!==t.next&&Sl(u.x,u.y,p.x,p.y,f.x,f.y,k.x,k.y)&&cr(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;R&&R.z<=A;){if(R!==t.prev&&R!==t.next&&Sl(u.x,u.y,p.x,p.y,f.x,f.y,R.x,R.y)&&cr(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function dp(t,e,i){var s=t;do{var u=s.prev,p=s.next.next;!Lu(u,p)&&jh(u,s,s.next,p)&&nu(u,p)&&nu(p,u)&&(e.push(u.i/i),e.push(s.i/i),e.push(p.i/i),ru(s),ru(s.next),s=t=p),s=s.next}while(s!==t);return Ys(s)}function fp(t,e,i,s,u,p){var f=t;do{for(var v=f.next.next;v!==f.prev;){if(f.i!==v.i&&vp(f,v)){var T=Vh(f,v);return f=Ys(f,f.next),T=Ys(T,T.next),iu(f,e,i,s,u,p),void iu(T,e,i,s,u,p)}v=v.next}f=f.next}while(f!==t)}function mp(t,e){return t.x-e.x}function _p(t,e){if(e=function(s,u){var p,f=u,v=s.x,T=s.y,I=-1/0;do{if(T<=f.y&&T>=f.next.y&&f.next.y!==f.y){var A=f.x+(T-f.y)*(f.next.x-f.x)/(f.next.y-f.y);if(A<=v&&A>I){if(I=A,A===v){if(T===f.y)return f;if(T===f.next.y)return f.next}p=f.x<f.next.x?f:f.next}}f=f.next}while(f!==u);if(!p)return null;if(v===I)return p;var k,R=p,U=p.x,K=p.y,$=1/0;f=p;do{v>=f.x&&f.x>=U&&v!==f.x&&Sl(T<K?v:I,T,U,K,T<K?I:v,T,f.x,f.y)&&(k=Math.abs(T-f.y)/(v-f.x),nu(f,s)&&(k<$||k===$&&(f.x>p.x||f.x===p.x&&yp(p,f)))&&(p=f,$=k)),f=f.next}while(f!==R);return p}(t,e)){var i=Vh(e,t);Ys(e,e.next),Ys(i,i.next)}}function yp(t,e){return cr(t.prev,t,e.prev)<0&&cr(e.next,t,t.next)<0}function ch(t,e,i,s,u){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*u)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*u)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function gp(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Sl(t,e,i,s,u,p,f,v){return(u-f)*(e-v)-(t-f)*(p-v)>=0&&(t-f)*(s-v)-(i-f)*(e-v)>=0&&(i-f)*(p-v)-(u-f)*(s-v)>=0}function vp(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(i,s){var u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==s.i&&u.next.i!==s.i&&jh(u,u.next,i,s))return!0;u=u.next}while(u!==i);return!1}(t,e)&&(nu(t,e)&&nu(e,t)&&function(i,s){var u=i,p=!1,f=(i.x+s.x)/2,v=(i.y+s.y)/2;do{u.y>v!=u.next.y>v&&u.next.y!==u.y&&f<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(p=!p),u=u.next}while(u!==i);return p}(t,e)&&(cr(t.prev,t,e.prev)||cr(t,e.prev,e))||Lu(t,e)&&cr(t.prev,t,t.next)>0&&cr(e.prev,e,e.next)>0)}function cr(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Lu(t,e){return t.x===e.x&&t.y===e.y}function jh(t,e,i,s){var u=ku(cr(t,e,i)),p=ku(cr(t,e,s)),f=ku(cr(i,s,t)),v=ku(cr(i,s,e));return u!==p&&f!==v||!(0!==u||!zu(t,i,e))||!(0!==p||!zu(t,s,e))||!(0!==f||!zu(i,t,s))||!(0!==v||!zu(i,e,s))}function zu(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function ku(t){return t>0?1:t<0?-1:0}function nu(t,e){return cr(t.prev,t,t.next)<0?cr(t,e,t.next)>=0&&cr(t,t.prev,e)>=0:cr(t,e,t.prev)<0||cr(t,t.next,e)<0}function Vh(t,e){var i=new ph(t.i,t.x,t.y),s=new ph(e.i,e.x,e.y),u=t.next,p=e.prev;return t.next=e,e.prev=t,i.next=u,u.prev=i,s.next=i,i.prev=s,p.next=s,s.prev=p,s}function Zh(t,e,i,s){var u=new ph(t,e,i);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function ru(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ph(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function dh(t,e,i,s){for(var u=0,p=e,f=i-s;p<i;p+=s)u+=(t[f]-t[p])*(t[p+1]+t[f+1]),f=p;return u}function xp(t,e,i,s,u){!function p(f,v,T,I,A){for(;I>T;){if(I-T>600){var k=I-T+1,R=v-T+1,U=Math.log(k),K=.5*Math.exp(2*U/3),$=.5*Math.sqrt(U*K*(k-K)/k)*(R-k/2<0?-1:1);p(f,v,Math.max(T,Math.floor(v-R*K/k+$)),Math.min(I,Math.floor(v+(k-R)*K/k+$)),A)}var lt=f[v],nt=T,dt=I;for(ou(f,T,v),A(f[I],lt)>0&&ou(f,T,I);nt<dt;){for(ou(f,nt,dt),nt++,dt--;A(f[nt],lt)<0;)nt++;for(;A(f[dt],lt)>0;)dt--}0===A(f[T],lt)?ou(f,T,dt):ou(f,++dt,I),dt<=v&&(T=dt+1),v<=dt&&(I=dt-1)}}(t,e,i||0,s||t.length-1,u||bp)}function ou(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function bp(t,e){return t<e?-1:t>e?1:0}function fh(t,e){var i=t.length;if(i<=1)return[t];for(var s,u,p=[],f=0;f<i;f++){var v=Go(t[f]);0!==v&&(t[f].area=Math.abs(v),void 0===u&&(u=v<0),u===v<0?(s&&p.push(s),s=[t[f]]):s.push(t[f]))}if(s&&p.push(s),e>1)for(var T=0;T<p.length;T++)p[T].length<=e||(xp(p[T],e,1,p[T].length-1,wp),p[T]=p[T].slice(0,e));return p}function wp(t,e){return e.area-t.area}function mh(t,e,i){for(var s=i.patternDependencies,u=!1,p=0,f=e;p<f.length;p+=1){var v=f[p].paint.get(t+"-pattern");v.isConstant()||(u=!0);var T=v.constantOr(null);T&&(u=!0,s[T.to]=!0,s[T.from]=!0)}return u}function _h(t,e,i,s,u){for(var p=u.patternDependencies,f=0,v=e;f<v.length;f+=1){var T=v[f],I=T.paint.get(t+"-pattern").value;if("constant"!==I.kind){var A=I.evaluate({zoom:s-1},i,{},u.availableImages),k=I.evaluate({zoom:s},i,{},u.availableImages),R=I.evaluate({zoom:s+1},i,{},u.availableImages);k=k&&k.name?k.name:k,R=R&&R.name?R.name:R,p[A=A&&A.name?A.name:A]=!0,p[k]=!0,p[R]=!0,i.patterns[T.id]={min:A,mid:k,max:R}}}return i}Cu.deviation=function(t,e,i,s){var u=e&&e.length,p=Math.abs(dh(t,0,u?e[0]*i:t.length,i));if(u)for(var f=0,v=e.length;f<v;f++)p-=Math.abs(dh(t,e[f]*i,f<v-1?e[f+1]*i:t.length,i));var T=0;for(f=0;f<s.length;f+=3){var I=s[f]*i,A=s[f+1]*i,k=s[f+2]*i;T+=Math.abs((t[I]-t[k])*(t[A+1]-t[I+1])-(t[I]-t[A])*(t[k+1]-t[I+1]))}return 0===p&&0===T?0:Math.abs((T-p)/p)},Cu.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,u=0;u<t.length;u++){for(var p=0;p<t[u].length;p++)for(var f=0;f<e;f++)i.vertices.push(t[u][p][f]);u>0&&i.holes.push(s+=t[u-1].length)}return i},hh.default=hp;var Qa=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ks,this.indexArray=new ps,this.indexArray2=new ol,this.programConfigurations=new Ce(t.layers,t.zoom),this.segments=new V,this.segments2=new V,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};Qa.prototype.populate=function(t,e,i){this.hasPattern=mh("fill",this.layers,e);for(var s=this.layers[0].layout.get("fill-sort-key"),u=[],p=0,f=t;p<f.length;p+=1){var v=f[p],T=v.feature,I=v.id,A=v.index,k=v.sourceLayerIndex,R=this.layers[0]._featureFilter.needGeometry,U=Kn(T,R);if(this.layers[0]._featureFilter.filter(new ri(this.zoom),U,i)){var K=s?s.evaluate(U,{},i,e.availableImages):void 0,$={id:I,properties:T.properties,type:T.type,sourceLayerIndex:k,index:A,geometry:R?U.geometry:An(T),patterns:{},sortKey:K};u.push($)}}s&&u.sort(function(Wt,te){return Wt.sortKey-te.sortKey});for(var lt=0,nt=u;lt<nt.length;lt+=1){var dt=nt[lt],yt=dt.geometry,xt=dt.index,Tt=dt.sourceLayerIndex;if(this.hasPattern){var zt=_h("fill",this.layers,dt,this.zoom,e);this.patternFeatures.push(zt)}else this.addFeature(dt,yt,xt,i,{});e.featureIndex.insert(t[xt].feature,yt,xt,Tt,this.index)}},Qa.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},Qa.prototype.addFeatures=function(t,e,i){for(var s=0,u=this.patternFeatures;s<u.length;s+=1){var p=u[s];this.addFeature(p,p.geometry,p.index,e,i)}},Qa.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Qa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qa.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,up),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},Qa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Qa.prototype.addFeature=function(t,e,i,s,u){for(var p=0,f=fh(e,500);p<f.length;p+=1){for(var v=f[p],T=0,I=0,A=v;I<A.length;I+=1)T+=A[I].length;for(var k=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),R=k.vertexLength,U=[],K=[],$=0,lt=v;$<lt.length;$+=1){var nt=lt[$];if(0!==nt.length){nt!==v[0]&&K.push(U.length/2);var dt=this.segments2.prepareSegment(nt.length,this.layoutVertexArray,this.indexArray2),yt=dt.vertexLength;this.layoutVertexArray.emplaceBack(nt[0].x,nt[0].y),this.indexArray2.emplaceBack(yt+nt.length-1,yt),U.push(nt[0].x),U.push(nt[0].y);for(var xt=1;xt<nt.length;xt++)this.layoutVertexArray.emplaceBack(nt[xt].x,nt[xt].y),this.indexArray2.emplaceBack(yt+xt-1,yt+xt),U.push(nt[xt].x),U.push(nt[xt].y);dt.vertexLength+=nt.length,dt.primitiveLength+=nt.length}}for(var Tt=hh(U,K),zt=0;zt<Tt.length;zt+=3)this.indexArray.emplaceBack(R+Tt[zt],R+Tt[zt+1],R+Tt[zt+2]);k.vertexLength+=T,k.primitiveLength+=Tt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,u,s)},qt("FillBucket",Qa,{omit:["layers","patternFeatures"]});var Tp=new Kr({"fill-sort-key":new fe(N.layout_fill["fill-sort-key"])}),Sp={paint:new Kr({"fill-antialias":new ye(N.paint_fill["fill-antialias"]),"fill-opacity":new fe(N.paint_fill["fill-opacity"]),"fill-color":new fe(N.paint_fill["fill-color"]),"fill-outline-color":new fe(N.paint_fill["fill-outline-color"]),"fill-translate":new ye(N.paint_fill["fill-translate"]),"fill-translate-anchor":new ye(N.paint_fill["fill-translate-anchor"]),"fill-pattern":new yl(N.paint_fill["fill-pattern"])}),layout:Tp},Ep=function(t){function e(i){t.call(this,i,Sp)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(i,s){t.prototype.recalculate.call(this,i,s);var u=this.paint._values["fill-outline-color"];"constant"===u.value.kind&&void 0===u.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(i){return new Qa(i)},e.prototype.queryRadius=function(){return Ir(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(i,s,u,p,f,v,T){return Pa($a(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,T),p)},e.prototype.isTileClipped=function(){return!0},e}(Ba),Ip=Rr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,qh=El;function El(t,e,i,s,u){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=u,t.readFields(Pp,this,e)}function Pp(t,e,i){1==t?e.id=i.readVarint():2==t?function(s,u){for(var p=s.readVarint()+s.pos;s.pos<p;){var f=u._keys[s.readVarint()],v=u._values[s.readVarint()];u.properties[f]=v}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function Ap(t){for(var e,i,s=0,u=0,p=t.length,f=p-1;u<p;f=u++)s+=((i=t[f]).x-(e=t[u]).x)*(e.y+i.y);return s}El.types=["Unknown","Point","LineString","Polygon"],El.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,s=1,u=0,p=0,f=0,v=[];t.pos<i;){if(u<=0){var T=t.readVarint();s=7&T,u=T>>3}if(u--,1===s||2===s)p+=t.readSVarint(),f+=t.readSVarint(),1===s&&(e&&v.push(e),e=[]),e.push(new le(p,f));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&v.push(e),v},El.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,s=0,u=0,p=0,f=1/0,v=-1/0,T=1/0,I=-1/0;t.pos<e;){if(s<=0){var A=t.readVarint();i=7&A,s=A>>3}if(s--,1===i||2===i)(u+=t.readSVarint())<f&&(f=u),u>v&&(v=u),(p+=t.readSVarint())<T&&(T=p),p>I&&(I=p);else if(7!==i)throw new Error("unknown command "+i)}return[f,T,v,I]},El.prototype.toGeoJSON=function(t,e,i){var s,u,p=this.extent*Math.pow(2,i),f=this.extent*t,v=this.extent*e,T=this.loadGeometry(),I=El.types[this.type];function A(U){for(var K=0;K<U.length;K++){var $=U[K];U[K]=[360*($.x+f)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+v)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var k=[];for(s=0;s<T.length;s++)k[s]=T[s][0];A(T=k);break;case 2:for(s=0;s<T.length;s++)A(T[s]);break;case 3:for(T=function(U){var K=U.length;if(K<=1)return[U];for(var $,lt,nt=[],dt=0;dt<K;dt++){var yt=Ap(U[dt]);0!==yt&&(void 0===lt&&(lt=yt<0),lt===yt<0?($&&nt.push($),$=[U[dt]]):$.push(U[dt]))}return $&&nt.push($),nt}(T),s=0;s<T.length;s++)for(u=0;u<T[s].length;u++)A(T[s][u])}1===T.length?T=T[0]:I="Multi"+I;var R={type:"Feature",geometry:{type:I,coordinates:T},properties:this.properties};return"id"in this&&(R.id=this.id),R};var Gh=Wh;function Wh(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Cp,this,e),this.length=this._features.length}function Cp(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(s){for(var u=null,p=s.readVarint()+s.pos;s.pos<p;){var f=s.readVarint()>>3;u=1===f?s.readString():2===f?s.readFloat():3===f?s.readDouble():4===f?s.readVarint64():5===f?s.readVarint():6===f?s.readSVarint():7===f?s.readBoolean():null}return u}(i))}function Lp(t,e,i){if(3===t){var s=new Gh(i,i.readVarint()+i.pos);s.length&&(e[s.name]=s)}}Wh.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new qh(this._pbf,e,this.extent,this._keys,this._values)};var Il={VectorTile:function(t,e){this.layers=t.readFields(Lp,{},e)},VectorTileFeature:qh,VectorTileLayer:Gh},zp=Il.VectorTileFeature.types,yh=Math.pow(2,13);function au(t,e,i,s,u,p,f,v){t.emplaceBack(e,i,2*Math.floor(s*yh)+f,u*yh*2,p*yh*2,Math.round(v))}var ts=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ya,this.indexArray=new ps,this.programConfigurations=new Ce(t.layers,t.zoom),this.segments=new V,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function kp(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}ts.prototype.populate=function(t,e,i){this.features=[],this.hasPattern=mh("fill-extrusion",this.layers,e);for(var s=0,u=t;s<u.length;s+=1){var p=u[s],f=p.feature,v=p.id,T=p.index,I=p.sourceLayerIndex,A=this.layers[0]._featureFilter.needGeometry,k=Kn(f,A);if(this.layers[0]._featureFilter.filter(new ri(this.zoom),k,i)){var R={id:v,sourceLayerIndex:I,index:T,geometry:A?k.geometry:An(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(_h("fill-extrusion",this.layers,R,this.zoom,e)):this.addFeature(R,R.geometry,T,i,{}),e.featureIndex.insert(f,R.geometry,T,I,this.index,!0)}}},ts.prototype.addFeatures=function(t,e,i){for(var s=0,u=this.features;s<u.length;s+=1){var p=u[s];this.addFeature(p,p.geometry,p.index,e,i)}},ts.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},ts.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ts.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ts.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ip),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ts.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ts.prototype.addFeature=function(t,e,i,s,u){for(var p=0,f=fh(e,500);p<f.length;p+=1){for(var v=f[p],T=0,I=0,A=v;I<A.length;I+=1)T+=A[I].length;for(var k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),R=0,U=v;R<U.length;R+=1){var K=U[R];if(0!==K.length&&!((oi=K).every(function(Ge){return Ge.x<0})||oi.every(function(Ge){return Ge.x>8192})||oi.every(function(Ge){return Ge.y<0})||oi.every(function(Ge){return Ge.y>8192})))for(var $=0,lt=0;lt<K.length;lt++){var nt=K[lt];if(lt>=1){var dt=K[lt-1];if(!kp(nt,dt)){k.vertexLength+4>V.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var yt=nt.sub(dt)._perp()._unit(),xt=dt.dist(nt);$+xt>32768&&($=0),au(this.layoutVertexArray,nt.x,nt.y,yt.x,yt.y,0,0,$),au(this.layoutVertexArray,nt.x,nt.y,yt.x,yt.y,0,1,$),au(this.layoutVertexArray,dt.x,dt.y,yt.x,yt.y,0,0,$+=xt),au(this.layoutVertexArray,dt.x,dt.y,yt.x,yt.y,0,1,$);var Tt=k.vertexLength;this.indexArray.emplaceBack(Tt,Tt+2,Tt+1),this.indexArray.emplaceBack(Tt+1,Tt+2,Tt+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+T>V.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),"Polygon"===zp[t.type]){for(var zt=[],Wt=[],te=k.vertexLength,ge=0,ae=v;ge<ae.length;ge+=1){var xe=ae[ge];if(0!==xe.length){xe!==v[0]&&Wt.push(zt.length/2);for(var se=0;se<xe.length;se++){var $e=xe[se];au(this.layoutVertexArray,$e.x,$e.y,0,0,1,1,0),zt.push($e.x),zt.push($e.y)}}}for(var Le=hh(zt,Wt),me=0;me<Le.length;me+=3)this.indexArray.emplaceBack(te+Le[me],te+Le[me+2],te+Le[me+1]);k.primitiveLength+=Le.length/3,k.vertexLength+=T}}var oi;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,u,s)},qt("FillExtrusionBucket",ts,{omit:["layers","features"]});var Mp={paint:new Kr({"fill-extrusion-opacity":new ye(N["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new fe(N["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ye(N["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ye(N["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yl(N["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new fe(N["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new fe(N["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ye(N["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Dp=function(t){function e(i){t.call(this,i,Mp)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new ts(i)},e.prototype.queryRadius=function(){return Ir(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(i,s,u,p,f,v,T,I){var A=$a(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,T),k=this.paint.get("fill-extrusion-height").evaluate(s,u),R=this.paint.get("fill-extrusion-base").evaluate(s,u),U=function($,lt,nt,dt){for(var yt=[],xt=0,Tt=$;xt<Tt.length;xt+=1){var zt=Tt[xt],Wt=[zt.x,zt.y,0,1];wl(Wt,Wt,lt),yt.push(new le(Wt[0]/Wt[3],Wt[1]/Wt[3]))}return yt}(A,I),K=function($,lt,nt,dt){for(var yt=[],xt=[],Tt=dt[8]*lt,zt=dt[9]*lt,Wt=dt[10]*lt,te=dt[11]*lt,ge=dt[8]*nt,ae=dt[9]*nt,xe=dt[10]*nt,se=dt[11]*nt,$e=0,Le=$;$e<Le.length;$e+=1){for(var me=[],oi=[],Ge=0,vi=Le[$e];Ge<vi.length;Ge+=1){var be=vi[Ge],ki=be.x,mn=be.y,Un=dt[0]*ki+dt[4]*mn+dt[12],Cn=dt[1]*ki+dt[5]*mn+dt[13],_n=dt[2]*ki+dt[6]*mn+dt[14],Nn=dt[3]*ki+dt[7]*mn+dt[15],Pr=_n+Wt,Ar=Nn+te,wo=Un+ge,Nr=Cn+ae,To=_n+xe,Jn=Nn+se,jr=new le((Un+Tt)/Ar,(Cn+zt)/Ar);jr.z=Pr/Ar,me.push(jr);var pi=new le(wo/Jn,Nr/Jn);pi.z=To/Jn,oi.push(pi)}yt.push(me),xt.push(oi)}return[yt,xt]}(p,R,k,I);return function($,lt,nt){var dt=1/0;Pa(nt,lt)&&(dt=Hh(nt,lt[0]));for(var yt=0;yt<lt.length;yt++)for(var xt=lt[yt],Tt=$[yt],zt=0;zt<xt.length-1;zt++){var Wt=xt[zt],te=[Wt,xt[zt+1],Tt[zt+1],Tt[zt],Wt];ms(nt,te)&&(dt=Math.min(dt,Hh(nt,te)))}return dt!==1/0&&dt}(K[0],K[1],U)},e}(Ba);function su(t,e){return t.x*e.x+t.y*e.y}function Hh(t,e){if(1===t.length){for(var i,s=0,u=e[s++];!i||u.equals(i);)if(!(i=e[s++]))return 1/0;for(;s<e.length;s++){var p=e[s],f=t[0],v=i.sub(u),T=p.sub(u),I=f.sub(u),A=su(v,v),k=su(v,T),R=su(T,T),U=su(I,v),K=su(I,T),$=A*R-k*k,lt=(R*U-k*K)/$,nt=(A*K-k*U)/$,dt=u.z*(1-lt-nt)+i.z*lt+p.z*nt;if(isFinite(dt))return dt}return 1/0}for(var yt=1/0,xt=0,Tt=e;xt<Tt.length;xt+=1)yt=Math.min(yt,Tt[xt].z);return yt}var Bp=Rr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Op=Rr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Rp=Il.VectorTileFeature.types,Fp=Math.cos(Math.PI/180*37.5),Xh=Math.pow(2,14)/.5,Lo=function(t){var e=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){e.gradients[i.id]={}}),this.layoutVertexArray=new Vo,this.layoutVertexArray2=new Gs,this.indexArray=new ps,this.programConfigurations=new Ce(t.layers,t.zoom),this.segments=new V,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};Lo.prototype.populate=function(t,e,i){this.hasPattern=mh("line",this.layers,e);for(var s=this.layers[0].layout.get("line-sort-key"),u=[],p=0,f=t;p<f.length;p+=1){var v=f[p],T=v.feature,I=v.id,A=v.index,k=v.sourceLayerIndex,R=this.layers[0]._featureFilter.needGeometry,U=Kn(T,R);if(this.layers[0]._featureFilter.filter(new ri(this.zoom),U,i)){var K=s?s.evaluate(U,{},i):void 0,$={id:I,properties:T.properties,type:T.type,sourceLayerIndex:k,index:A,geometry:R?U.geometry:An(T),patterns:{},sortKey:K};u.push($)}}s&&u.sort(function(Wt,te){return Wt.sortKey-te.sortKey});for(var lt=0,nt=u;lt<nt.length;lt+=1){var dt=nt[lt],yt=dt.geometry,xt=dt.index,Tt=dt.sourceLayerIndex;if(this.hasPattern){var zt=_h("line",this.layers,dt,this.zoom,e);this.patternFeatures.push(zt)}else this.addFeature(dt,yt,xt,i,{});e.featureIndex.insert(t[xt].feature,yt,xt,Tt,this.index)}},Lo.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},Lo.prototype.addFeatures=function(t,e,i){for(var s=0,u=this.patternFeatures;s<u.length;s+=1){var p=u[s];this.addFeature(p,p.geometry,p.index,e,i)}},Lo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Lo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Lo.prototype.upload=function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Op)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bp),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Lo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Lo.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},Lo.prototype.addFeature=function(t,e,i,s,u){var p=this.layers[0].layout,f=p.get("line-join").evaluate(t,{}),v=p.get("line-cap"),T=p.get("line-miter-limit"),I=p.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var A=0,k=e;A<k.length;A+=1)this.addLine(k[A],t,f,v,T,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,u,s)},Lo.prototype.addLine=function(t,e,i,s,u,p){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var f=0;f<t.length-1;f++)this.totalDistance+=t[f].dist(t[f+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var v="Polygon"===Rp[e.type],T=t.length;T>=2&&t[T-1].equals(t[T-2]);)T--;for(var I=0;I<T-1&&t[I].equals(t[I+1]);)I++;if(!(T<(v?3:2))){"bevel"===i&&(u=1.05);var A,k=this.overscaling<=16?122880/(512*this.overscaling):0,R=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray),U=void 0,K=void 0,$=void 0,lt=void 0;this.e1=this.e2=-1,v&&(lt=t[I].sub(A=t[T-2])._unit()._perp());for(var nt=I;nt<T;nt++)if(!(K=nt===T-1?v?t[I+1]:void 0:t[nt+1])||!t[nt].equals(K)){lt&&($=lt),A&&(U=A),A=t[nt],lt=K?K.sub(A)._unit()._perp():$;var dt=($=$||lt).add(lt);0===dt.x&&0===dt.y||dt._unit();var yt=$.x*lt.x+$.y*lt.y,xt=dt.x*lt.x+dt.y*lt.y,Tt=0!==xt?1/xt:1/0,zt=2*Math.sqrt(2-2*xt),Wt=xt<Fp&&U&&K,te=$.x*lt.y-$.y*lt.x>0;if(Wt&&nt>I){var ge=A.dist(U);if(ge>2*k){var ae=A.sub(A.sub(U)._mult(k/ge)._round());this.updateDistance(U,ae),this.addCurrentVertex(ae,$,0,0,R),U=ae}}var xe=U&&K,se=xe?i:v?"butt":s;if(xe&&"round"===se&&(Tt<p?se="miter":Tt<=2&&(se="fakeround")),"miter"===se&&Tt>u&&(se="bevel"),"bevel"===se&&(Tt>2&&(se="flipbevel"),Tt<u&&(se="miter")),U&&this.updateDistance(U,A),"miter"===se)dt._mult(Tt),this.addCurrentVertex(A,dt,0,0,R);else if("flipbevel"===se){if(Tt>100)dt=lt.mult(-1);else{var $e=Tt*$.add(lt).mag()/$.sub(lt).mag();dt._perp()._mult($e*(te?-1:1))}this.addCurrentVertex(A,dt,0,0,R),this.addCurrentVertex(A,dt.mult(-1),0,0,R)}else if("bevel"===se||"fakeround"===se){var Le=-Math.sqrt(Tt*Tt-1),me=te?Le:0,oi=te?0:Le;if(U&&this.addCurrentVertex(A,$,me,oi,R),"fakeround"===se)for(var Ge=Math.round(180*zt/Math.PI/20),vi=1;vi<Ge;vi++){var be=vi/Ge;if(.5!==be){var ki=be-.5;be+=be*ki*(be-1)*((1.0904+yt*(yt*(3.55645-1.43519*yt)-3.2452))*ki*ki+(.848013+yt*(.215638*yt-1.06021)))}var mn=lt.sub($)._mult(be)._add($)._unit()._mult(te?-1:1);this.addHalfVertex(A,mn.x,mn.y,!1,te,0,R)}K&&this.addCurrentVertex(A,lt,-me,-oi,R)}else if("butt"===se)this.addCurrentVertex(A,dt,0,0,R);else if("square"===se){var Un=U?1:-1;this.addCurrentVertex(A,dt,Un,Un,R)}else"round"===se&&(U&&(this.addCurrentVertex(A,$,0,0,R),this.addCurrentVertex(A,$,1,1,R,!0)),K&&(this.addCurrentVertex(A,lt,-1,-1,R,!0),this.addCurrentVertex(A,lt,0,0,R)));if(Wt&&nt<T-1){var Cn=A.dist(K);if(Cn>2*k){var _n=A.add(K.sub(A)._mult(k/Cn)._round());this.updateDistance(A,_n),this.addCurrentVertex(_n,lt,0,0,R),A=_n}}}}},Lo.prototype.addCurrentVertex=function(t,e,i,s,u,p){void 0===p&&(p=!1);var f=e.y*s-e.x,v=-e.y-e.x*s;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,p,!1,i,u),this.addHalfVertex(t,f,v,p,!0,-s,u),this.distance>Xh/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,i,s,u,p))},Lo.prototype.addHalfVertex=function(t,e,i,s,u,p,f){var v=.5*(this.lineClips?this.scaledDistance*(Xh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(s?1:0),(t.y<<1)+(u?1:0),Math.round(63*e)+128,Math.round(63*i)+128,1+(0===p?0:p<0?-1:1)|(63&v)<<2,v>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var T=f.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),f.primitiveLength++),u?this.e2=T:this.e1=T},Lo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Lo.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},qt("LineBucket",Lo,{omit:["layers","patternFeatures"]});var Up=new Kr({"line-cap":new ye(N.layout_line["line-cap"]),"line-join":new fe(N.layout_line["line-join"]),"line-miter-limit":new ye(N.layout_line["line-miter-limit"]),"line-round-limit":new ye(N.layout_line["line-round-limit"]),"line-sort-key":new fe(N.layout_line["line-sort-key"])}),Kh={paint:new Kr({"line-opacity":new fe(N.paint_line["line-opacity"]),"line-color":new fe(N.paint_line["line-color"]),"line-translate":new ye(N.paint_line["line-translate"]),"line-translate-anchor":new ye(N.paint_line["line-translate-anchor"]),"line-width":new fe(N.paint_line["line-width"]),"line-gap-width":new fe(N.paint_line["line-gap-width"]),"line-offset":new fe(N.paint_line["line-offset"]),"line-blur":new fe(N.paint_line["line-blur"]),"line-dasharray":new vo(N.paint_line["line-dasharray"]),"line-pattern":new yl(N.paint_line["line-pattern"]),"line-gradient":new Ia(N.paint_line["line-gradient"])}),layout:Up},Jh=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(i,s){return s=new ri(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),t.prototype.possiblyEvaluate.call(this,i,s)},e.prototype.evaluate=function(i,s,u,p){return s=je({},s,{zoom:Math.floor(s.zoom)}),t.prototype.evaluate.call(this,i,s,u,p)},e}(fe))(Kh.paint.properties["line-width"].specification);Jh.useIntegerZoom=!0;var Np=function(t){function e(i){t.call(this,i,Kh),this.gradientVersion=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(i){"line-gradient"===i&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof In,this.gradientVersion=(this.gradientVersion+1)%ln)},e.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},e.prototype.recalculate=function(i,s){t.prototype.recalculate.call(this,i,s),this.paint._values["line-floorwidth"]=Jh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},e.prototype.createBucket=function(i){return new Lo(i)},e.prototype.queryRadius=function(i){var s=i,u=Yh(Fa("line-width",this,s),Fa("line-gap-width",this,s)),p=Fa("line-offset",this,s);return u/2+Math.abs(p)+Ir(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(i,s,u,p,f,v,T){var I=$a(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,T),A=T/2*Yh(this.paint.get("line-width").evaluate(s,u),this.paint.get("line-gap-width").evaluate(s,u)),k=this.paint.get("line-offset").evaluate(s,u);return k&&(p=function(R,U){for(var K=[],$=new le(0,0),lt=0;lt<R.length;lt++){for(var nt=R[lt],dt=[],yt=0;yt<nt.length;yt++){var xt=nt[yt],Tt=nt[yt+1],zt=0===yt?$:xt.sub(nt[yt-1])._unit()._perp(),Wt=yt===nt.length-1?$:Tt.sub(xt)._unit()._perp(),te=zt._add(Wt)._unit();te._mult(1/(te.x*Wt.x+te.y*Wt.y)),dt.push(te._mult(U)._add(xt))}K.push(dt)}return K}(p,k*T)),function(R,U,K){for(var $=0;$<U.length;$++){var lt=U[$];if(R.length>=3)for(var nt=0;nt<lt.length;nt++)if(Ra(R,lt[nt]))return!0;if(ga(R,lt,K))return!0}return!1}(I,p,A)},e.prototype.isTileClipped=function(){return!0},e}(Ba);function Yh(t,e){return e>0?e+2*t:t}var jp=Rr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Vp=Rr([{name:"a_projected_pos",components:3,type:"Float32"}],4),Zp=(Rr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Rr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),$h=(Rr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Rr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),qp=Rr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Gp(t,e,i){return t.sections.forEach(function(s){var u,f,v;s.text=(u=s.text,f=i,"uppercase"===(v=e.layout.get("text-transform").evaluate(f,{}))?u=u.toLocaleUpperCase():"lowercase"===v&&(u=u.toLocaleLowerCase()),Po.applyArabicShaping&&(u=Po.applyArabicShaping(u)),u)}),t}Rr([{name:"triangle",components:3,type:"Uint16"}]),Rr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Rr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Rr([{type:"Float32",name:"offsetX"}]),Rr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var lu={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Qh=function(t,e,i,s,u){var p,f,v=8*u-s-1,T=(1<<v)-1,I=T>>1,A=-7,k=i?u-1:0,R=i?-1:1,U=t[e+k];for(k+=R,p=U&(1<<-A)-1,U>>=-A,A+=v;A>0;p=256*p+t[e+k],k+=R,A-=8);for(f=p&(1<<-A)-1,p>>=-A,A+=s;A>0;f=256*f+t[e+k],k+=R,A-=8);if(0===p)p=1-I;else{if(p===T)return f?NaN:1/0*(U?-1:1);f+=Math.pow(2,s),p-=I}return(U?-1:1)*f*Math.pow(2,p-s)},tc=function(t,e,i,s,u,p){var f,v,T,I=8*p-u-1,A=(1<<I)-1,k=A>>1,R=23===u?Math.pow(2,-24)-Math.pow(2,-77):0,U=s?0:p-1,K=s?1:-1,$=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,f=A):(f=Math.floor(Math.log(e)/Math.LN2),e*(T=Math.pow(2,-f))<1&&(f--,T*=2),(e+=f+k>=1?R/T:R*Math.pow(2,1-k))*T>=2&&(f++,T/=2),f+k>=A?(v=0,f=A):f+k>=1?(v=(e*T-1)*Math.pow(2,u),f+=k):(v=e*Math.pow(2,k-1)*Math.pow(2,u),f=0));u>=8;t[i+U]=255&v,U+=K,v/=256,u-=8);for(f=f<<u|v,I+=u;I>0;t[i+U]=255&f,U+=K,f/=256,I-=8);t[i+U-K]|=128*$},Mu=rn;function rn(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}rn.Varint=0,rn.Fixed64=1,rn.Bytes=2,rn.Fixed32=5;var ec=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Os(t){return t.type===rn.Bytes?t.readVarint()+t.pos:t.pos+1}function ic(t,e,i){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(s);for(var u=i.pos-1;u>=t;u--)i.buf[u+s]=i.buf[u]}function Wp(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Hp(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function Xp(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function Kp(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function Jp(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function Yp(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function $p(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Qp(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function td(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Du(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Al(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function nc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function ed(t,e,i){1===t&&i.readMessage(id,e)}function id(t,e,i){if(3===t){var s=i.readMessage(nd,{}),u=s.width,p=s.height,f=s.left,v=s.top,T=s.advance;e.push({id:s.id,bitmap:new hl({width:u+6,height:p+6},s.bitmap),metrics:{width:u,height:p,left:f,top:v,advance:T}})}}function nd(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}function rc(t){for(var e=0,i=0,s=0,u=t;s<u.length;s+=1){var p=u[s];e+=p.w*p.h,i=Math.max(i,p.w)}t.sort(function($,lt){return lt.h-$.h});for(var f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}],v=0,T=0,I=0,A=t;I<A.length;I+=1)for(var k=A[I],R=f.length-1;R>=0;R--){var U=f[R];if(!(k.w>U.w||k.h>U.h)){if(k.x=U.x,k.y=U.y,T=Math.max(T,k.y+k.h),v=Math.max(v,k.x+k.w),k.w===U.w&&k.h===U.h){var K=f.pop();R<f.length&&(f[R]=K)}else k.h===U.h?(U.x+=k.w,U.w-=k.w):k.w===U.w?(U.y+=k.h,U.h-=k.h):(f.push({x:U.x+k.w,y:U.y,w:U.w-k.w,h:k.h}),U.y+=k.h,U.h-=k.h);break}}return{w:v,h:T,fill:e/(v*T)||0}}rn.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),u=s>>3,p=this.pos;this.type=7&s,t(u,e,this),this.pos===p&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Du(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=nc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Du(this.buf,this.pos)+4294967296*Du(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Du(this.buf,this.pos)+4294967296*nc(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Qh(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Qh(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,s=this.buf;return e=127&(i=s[this.pos++]),i<128?e:(e|=(127&(i=s[this.pos++]))<<7,i<128?e:(e|=(127&(i=s[this.pos++]))<<14,i<128?e:(e|=(127&(i=s[this.pos++]))<<21,i<128?e:function(u,p,f){var v,T,I=f.buf;if(v=(112&(T=I[f.pos++]))>>4,T<128||(v|=(127&(T=I[f.pos++]))<<3,T<128)||(v|=(127&(T=I[f.pos++]))<<10,T<128)||(v|=(127&(T=I[f.pos++]))<<17,T<128)||(v|=(127&(T=I[f.pos++]))<<24,T<128)||(v|=(1&(T=I[f.pos++]))<<31,T<128))return function Pl(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}(u,v,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&ec?ec.decode(this.buf.subarray(e,t)):function(i,s,u){for(var p="",f=s;f<u;){var v,T,I,A=i[f],k=null,R=A>239?4:A>223?3:A>191?2:1;if(f+R>u)break;1===R?A<128&&(k=A):2===R?128==(192&(v=i[f+1]))&&(k=(31&A)<<6|63&v)<=127&&(k=null):3===R?(T=i[f+2],128==(192&(v=i[f+1]))&&128==(192&T)&&((k=(15&A)<<12|(63&v)<<6|63&T)<=2047||k>=55296&&k<=57343)&&(k=null)):4===R&&(T=i[f+2],I=i[f+3],128==(192&(v=i[f+1]))&&128==(192&T)&&128==(192&I)&&((k=(15&A)<<18|(63&v)<<12|(63&T)<<6|63&I)<=65535||k>=1114112)&&(k=null)),null===k?(k=65533,R=1):k>65535&&(k-=65536,p+=String.fromCharCode(k>>>10&1023|55296),k=56320|1023&k),p+=String.fromCharCode(k),f+=R}return p}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==rn.Bytes)return t.push(this.readVarint(e));var i=Os(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==rn.Bytes)return t.push(this.readSVarint());var e=Os(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==rn.Bytes)return t.push(this.readBoolean());var e=Os(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==rn.Bytes)return t.push(this.readFloat());var e=Os(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==rn.Bytes)return t.push(this.readDouble());var e=Os(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==rn.Bytes)return t.push(this.readFixed32());var e=Os(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==rn.Bytes)return t.push(this.readSFixed32());var e=Os(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==rn.Bytes)return t.push(this.readFixed64());var e=Os(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==rn.Bytes)return t.push(this.readSFixed64());var e=Os(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===rn.Varint)for(;this.buf[this.pos++]>127;);else if(e===rn.Bytes)this.pos=this.readVarint()+this.pos;else if(e===rn.Fixed32)this.pos+=4;else{if(e!==rn.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Al(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Al(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Al(this.buf,-1&t,this.pos),Al(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Al(this.buf,-1&t,this.pos),Al(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,i){var s,u,p,v;if(e>=0?(s=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,u=u+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),p=s,(v=i).buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,v.buf[v.pos]=127&(p>>>=7),function(p,f){var v=(7&p)<<4;f.buf[f.pos++]|=v|((p>>>=3)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p)))))}(u,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,u,p){for(var f,v,T=0;T<u.length;T++){if((f=u.charCodeAt(T))>55295&&f<57344){if(!v){f>56319||T+1===u.length?(s[p++]=239,s[p++]=191,s[p++]=189):v=f;continue}if(f<56320){s[p++]=239,s[p++]=191,s[p++]=189,v=f;continue}f=v-55296<<10|f-56320|65536,v=null}else v&&(s[p++]=239,s[p++]=191,s[p++]=189,v=null);f<128?s[p++]=f:(f<2048?s[p++]=f>>6|192:(f<65536?s[p++]=f>>12|224:(s[p++]=f>>18|240,s[p++]=f>>12&63|128),s[p++]=f>>6&63|128),s[p++]=63&f|128)}return p}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&ic(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),tc(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),tc(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var s=this.pos-i;s>=128&&ic(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,i){this.writeTag(t,rn.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Wp,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Hp,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Jp,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Xp,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Kp,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Yp,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,$p,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Qp,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,td,e)},writeBytesField:function(t,e){this.writeTag(t,rn.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,rn.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,rn.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,rn.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,rn.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,rn.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,rn.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,rn.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,rn.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,rn.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Bu=function(t,e){var i=e.pixelRatio,s=e.version,u=e.stretchX,p=e.stretchY,f=e.content;this.paddedRect=t,this.pixelRatio=i,this.stretchX=u,this.stretchY=p,this.content=f,this.version=s},uu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};uu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},uu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},uu.tlbr.get=function(){return this.tl.concat(this.br)},uu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Bu.prototype,uu);var hu=function(t,e){var i={},s={};this.haveRenderCallbacks=[];var u=[];this.addImages(t,i,u),this.addImages(e,s,u);var p=rc(u),f=new qo({width:p.w||1,height:p.h||1});for(var v in t){var T=t[v],I=i[v].paddedRect;qo.copy(T.data,f,{x:0,y:0},{x:I.x+1,y:I.y+1},T.data)}for(var A in e){var k=e[A],R=s[A].paddedRect,U=R.x+1,K=R.y+1,$=k.data.width,lt=k.data.height;qo.copy(k.data,f,{x:0,y:0},{x:U,y:K},k.data),qo.copy(k.data,f,{x:0,y:lt-1},{x:U,y:K-1},{width:$,height:1}),qo.copy(k.data,f,{x:0,y:0},{x:U,y:K+lt},{width:$,height:1}),qo.copy(k.data,f,{x:$-1,y:0},{x:U-1,y:K},{width:1,height:lt}),qo.copy(k.data,f,{x:0,y:0},{x:U+$,y:K},{width:1,height:lt})}this.image=f,this.iconPositions=i,this.patternPositions=s};hu.prototype.addImages=function(t,e,i){for(var s in t){var u=t[s],p={x:0,y:0,w:u.data.width+2,h:u.data.height+2};i.push(p),e[s]=new Bu(p,u),u.hasRenderCallback&&this.haveRenderCallbacks.push(s)}},hu.prototype.patchUpdatedImages=function(t,e){for(var i in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)},hu.prototype.patchUpdatedImage=function(t,e,i){if(t&&e&&t.version!==e.version){t.version=e.version;var s=t.tl;i.update(e.data,void 0,{x:s[0],y:s[1]})}},qt("ImagePosition",Bu),qt("ImageAtlas",hu);var va={horizontal:1,vertical:2,horizontalOnly:3},Cl=function(){this.scale=1,this.fontStack="",this.imageName=null};Cl.forText=function(t,e){var i=new Cl;return i.scale=t||1,i.fontStack=e,i},Cl.forImage=function(t){var e=new Cl;return e.imageName=t,e};var bo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ou(t,e,i,s,u,p,f,v,T,I,A,k,R,U,K,$){var lt,nt=bo.fromFeature(t,u);k===va.vertical&&nt.verticalizePunctuation();var dt=Po.processBidirectionalText,yt=Po.processStyledBidirectionalText;if(dt&&1===nt.sections.length){lt=[];for(var xt=0,Tt=dt(nt.toString(),gh(nt,I,p,e,s,U,K));xt<Tt.length;xt+=1){var zt=Tt[xt],Wt=new bo;Wt.text=zt,Wt.sections=nt.sections;for(var te=0;te<zt.length;te++)Wt.sectionIndex.push(0);lt.push(Wt)}}else if(yt){lt=[];for(var ge=0,ae=yt(nt.text,nt.sectionIndex,gh(nt,I,p,e,s,U,K));ge<ae.length;ge+=1){var xe=ae[ge],se=new bo;se.text=xe[0],se.sectionIndex=xe[1],se.sections=nt.sections,lt.push(se)}}else lt=function(me,oi){for(var Ge=[],vi=me.text,be=0,ki=0,mn=oi;ki<mn.length;ki+=1){var Un=mn[ki];Ge.push(me.substring(be,Un)),be=Un}return be<vi.length&&Ge.push(me.substring(be,vi.length)),Ge}(nt,gh(nt,I,p,e,s,U,K));var $e=[],Le={positionedLines:$e,text:nt.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:k,iconsInText:!1,verticalizable:!1};return function(me,oi,Ge,vi,be,ki,mn,Un,Cn,_n,Nn,Pr){for(var Ar=0,wo=-17,Nr=0,To=0,Jn="right"===Un?1:"left"===Un?0:.5,jr=0,pi=0,Ji=be;pi<Ji.length;pi+=1){var qi=Ji[pi];qi.trim();var Ii=qi.getMaxScale(),zo=24*(Ii-1),lo={positionedGlyphs:[],lineOffset:0};me.positionedLines[jr]=lo;var sn=lo.positionedGlyphs,rr=0;if(qi.length()){for(var uo=0;uo<qi.length();uo++){var Mi=qi.getSection(uo),gs=qi.getSectionIndex(uo),xa=qi.getCharCode(uo),vs=0,Yn=null,xs=null,Ua=null,Rl=24,fl=!(Cn===va.horizontal||!Nn&&!Fo(xa)||Nn&&(Ru[xa]||(Ns=xa,$t.Arabic(Ns)||$t["Arabic Supplement"](Ns)||$t["Arabic Extended-A"](Ns)||$t["Arabic Presentation Forms-A"](Ns)||$t["Arabic Presentation Forms-B"](Ns))));if(Mi.imageName){var Fl=vi[Mi.imageName];if(!Fl)continue;Ua=Mi.imageName,me.iconsInText=me.iconsInText||!0,xs=Fl.paddedRect;var Us=Fl.displaySize;Mi.scale=24*Mi.scale/Pr,vs=zo+(24-Us[1]*Mi.scale),Rl=(Yn={width:Us[0],height:Us[1],left:1,top:-3,advance:fl?Us[1]:Us[0]}).advance;var Ul=fl?Us[0]*Mi.scale-24*Ii:Us[1]*Mi.scale-24*Ii;Ul>0&&Ul>rr&&(rr=Ul)}else{var Wu=Ge[Mi.fontStack],Nl=Wu&&Wu[xa];if(Nl&&Nl.rect)xs=Nl.rect,Yn=Nl.metrics;else{var du=oi[Mi.fontStack],Hu=du&&du[xa];if(!Hu)continue;Yn=Hu.metrics}vs=24*(Ii-Mi.scale)}fl?(me.verticalizable=!0,sn.push({glyph:xa,imageName:Ua,x:Ar,y:wo+vs,vertical:fl,scale:Mi.scale,fontStack:Mi.fontStack,sectionIndex:gs,metrics:Yn,rect:xs}),Ar+=Rl*Mi.scale+_n):(sn.push({glyph:xa,imageName:Ua,x:Ar,y:wo+vs,vertical:fl,scale:Mi.scale,fontStack:Mi.fontStack,sectionIndex:gs,metrics:Yn,rect:xs}),Ar+=Yn.advance*Mi.scale+_n)}0!==sn.length&&(Nr=Math.max(Ar-_n,Nr),od(sn,0,sn.length-1,Jn,rr)),Ar=0;var Xu=ki*Ii+rr;lo.lineOffset=Math.max(rr,zo),wo+=Xu,To=Math.max(Xu,To),++jr}else wo+=ki,++jr}var Ns,fu=wo- -17,jl=vh(mn),Qs=jl.horizontalAlign,Vl=jl.verticalAlign;(function(Ku,Ju,mu,_u,Yu,yu,gu,vu,$u){var Zl,Qu=(Ju-mu)*Yu;Zl=yu!==gu?-vu*_u- -17:(-_u*$u+.5)*gu;for(var ql=0,xu=Ku;ql<xu.length;ql+=1)for(var ml=0,bu=xu[ql].positionedGlyphs;ml<bu.length;ml+=1){var Gl=bu[ml];Gl.x+=Qu,Gl.y+=Zl}})(me.positionedLines,Jn,Qs,Vl,Nr,To,ki,fu,be.length),me.top+=-Vl*fu,me.bottom=me.top+fu,me.left+=-Qs*Nr,me.right=me.left+Nr}(Le,e,i,s,lt,f,v,T,k,I,R,$),!function(me){for(var oi=0,Ge=me;oi<Ge.length;oi+=1)if(0!==Ge[oi].positionedGlyphs.length)return!1;return!0}($e)&&Le}bo.fromFeature=function(t,e){for(var i=new bo,s=0;s<t.sections.length;s++){var u=t.sections[s];u.image?i.addImageSection(u):i.addTextSection(u,e)}return i},bo.prototype.length=function(){return this.text.length},bo.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},bo.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},bo.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},bo.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",i=0;i<t.length;i++){var s=t.charCodeAt(i+1)||null,u=t.charCodeAt(i-1)||null;e+=s&&Tr(s)&&!lu[t[i+1]]||u&&Tr(u)&&!lu[t[i-1]]||!lu[t[i]]?t[i]:lu[t[i]]}return e}(this.text)},bo.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&Ru[this.text.charCodeAt(e)];e++)t++;for(var i=this.text.length,s=this.text.length-1;s>=0&&s>=t&&Ru[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)},bo.prototype.substring=function(t,e){var i=new bo;return i.text=this.text.substring(t,e),i.sectionIndex=this.sectionIndex.slice(t,e),i.sections=this.sections,i},bo.prototype.toString=function(){return this.text},bo.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,i){return Math.max(e,t.sections[i].scale)},0)},bo.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(Cl.forText(t.scale,t.fontStack||e));for(var i=this.sections.length-1,s=0;s<t.text.length;++s)this.sectionIndex.push(i)},bo.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(Cl.forImage(e)),this.sectionIndex.push(this.sections.length-1)):Ye("Reached maximum number of images 6401")}else Ye("Can't add FormattedSection with an empty image.")},bo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Ru={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ra={};function oc(t,e,i,s,u,p){if(e.imageName){var f=s[e.imageName];return f?f.displaySize[0]*e.scale*24/p+u:0}var v=i[e.fontStack],T=v&&v[t];return T?T.metrics.advance*e.scale+u:0}function ac(t,e,i,s){var u=Math.pow(t-e,2);return s?t<e?u/2:2*u:u+Math.abs(i)*i}function rd(t,e,i){var s=0;return 10===t&&(s-=1e4),i&&(s+=150),40!==t&&65288!==t||(s+=50),41!==e&&65289!==e||(s+=50),s}function sc(t,e,i,s,u,p){for(var f=null,v=ac(e,i,u,p),T=0,I=s;T<I.length;T+=1){var A=I[T],k=ac(e-A.x,i,u,p)+A.badness;k<=v&&(f=A,v=k)}return{index:t,x:e,priorBreak:f,badness:v}}function gh(t,e,i,s,u,p,f){if("point"!==p)return[];if(!t)return[];for(var v,T=[],I=function(lt,nt,dt,yt,xt,Tt){for(var zt=0,Wt=0;Wt<lt.length();Wt++){var te=lt.getSection(Wt);zt+=oc(lt.getCharCode(Wt),te,yt,xt,nt,Tt)}return zt/Math.max(1,Math.ceil(zt/dt))}(t,e,i,s,u,f),A=t.text.indexOf("\u200b")>=0,k=0,R=0;R<t.length();R++){var U=t.getSection(R),K=t.getCharCode(R);if(Ru[K]||(k+=oc(K,U,s,u,e,f)),R<t.length()-1){var $=!((v=K)<11904||!($t["Bopomofo Extended"](v)||$t.Bopomofo(v)||$t["CJK Compatibility Forms"](v)||$t["CJK Compatibility Ideographs"](v)||$t["CJK Compatibility"](v)||$t["CJK Radicals Supplement"](v)||$t["CJK Strokes"](v)||$t["CJK Symbols and Punctuation"](v)||$t["CJK Unified Ideographs Extension A"](v)||$t["CJK Unified Ideographs"](v)||$t["Enclosed CJK Letters and Months"](v)||$t["Halfwidth and Fullwidth Forms"](v)||$t.Hiragana(v)||$t["Ideographic Description Characters"](v)||$t["Kangxi Radicals"](v)||$t["Katakana Phonetic Extensions"](v)||$t.Katakana(v)||$t["Vertical Forms"](v)||$t["Yi Radicals"](v)||$t["Yi Syllables"](v)));(ra[K]||$||U.imageName)&&T.push(sc(R+1,k,I,T,rd(K,t.getCharCode(R+1),$&&A),!1))}}return function lt(nt){return nt?lt(nt.priorBreak).concat(nt.index):[]}(sc(t.length(),k,I,T,0,!0))}function vh(t){var e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function od(t,e,i,s,u){if(s||u)for(var p=t[i],f=(t[i].x+p.metrics.advance*p.scale)*s,v=e;v<=i;v++)t[v].x-=f,t[v].y+=u}function lc(t,e,i,s,u,p){var f,v=t.image;if(v.content){var T=v.content,I=v.pixelRatio||1;f=[T[0]/I,T[1]/I,v.displaySize[0]-T[2]/I,v.displaySize[1]-T[3]/I]}var A,k,R,U,K=e.left*p,$=e.right*p;"width"===i||"both"===i?(U=u[0]+K-s[3],k=u[0]+$+s[1]):k=(U=u[0]+(K+$-v.displaySize[0])/2)+v.displaySize[0];var lt=e.top*p,nt=e.bottom*p;return"height"===i||"both"===i?(A=u[1]+lt-s[0],R=u[1]+nt+s[2]):R=(A=u[1]+(lt+nt-v.displaySize[1])/2)+v.displaySize[1],{image:v,top:A,right:k,bottom:R,left:U,collisionPadding:f}}ra[10]=!0,ra[32]=!0,ra[38]=!0,ra[40]=!0,ra[41]=!0,ra[43]=!0,ra[45]=!0,ra[47]=!0,ra[173]=!0,ra[183]=!0,ra[8203]=!0,ra[8208]=!0,ra[8211]=!0,ra[8231]=!0;var Ll=function(t){function e(i,s,u,p){t.call(this,i,s),this.angle=u,void 0!==p&&(this.segment=p)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(le);function xh(t,e){var i=e.expression;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new ri(t+1))};if("source"===i.kind)return{kind:"source"};for(var s=i.zoomStops,u=i.interpolationType,p=0;p<s.length&&s[p]<=t;)p++;for(var f=p=Math.max(0,p-1);f<s.length&&s[f]<t+1;)f++;f=Math.min(s.length-1,f);var v=s[p],T=s[f];return"composite"===i.kind?{kind:"composite",minZoom:v,maxZoom:T,interpolationType:u}:{kind:"camera",minZoom:v,maxZoom:T,minSize:i.evaluate(new ri(v)),maxSize:i.evaluate(new ri(T)),interpolationType:u}}function uc(t,e,i){var s=e.uSize,u=i.lowerSize;return"source"===t.kind?u/128:"composite"===t.kind?Ki(u/128,i.upperSize/128,e.uSizeT):s}function hc(t,e){var i=0,s=0;if("constant"===t.kind)s=t.layoutSize;else if("source"!==t.kind){var u=t.interpolationType,p=u?jn(hn.interpolationFactor(u,e,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?s=Ki(t.minSize,t.maxSize,p):i=p}return{uSizeT:i,uSize:s}}qt("Anchor",Ll);var ad=Object.freeze({__proto__:null,getSizeData:xh,evaluateSizeForFeature:uc,evaluateSizeForZoom:hc,SIZE_PACK_FACTOR:128});function cc(t,e,i,s,u){if(void 0===e.segment)return!0;for(var p=e,f=e.segment+1,v=0;v>-i/2;){if(--f<0)return!1;v-=t[f].dist(p),p=t[f]}v+=t[f].dist(t[f+1]),f++;for(var T=[],I=0;v<i/2;){var A=t[f],k=t[f+1];if(!k)return!1;var R=t[f-1].angleTo(A)-A.angleTo(k);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:v,angleDelta:R}),I+=R;v-T[0].distance>s;)I-=T.shift().angleDelta;if(I>u)return!1;f++,v+=A.dist(k)}return!0}function pc(t){for(var e=0,i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function dc(t,e,i){return t?.6*e*i:0}function fc(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function sd(t,e,i,s,u,p){for(var f=dc(i,u,p),v=fc(i,s)*p,T=0,I=pc(t)/2,A=0;A<t.length-1;A++){var k=t[A],R=t[A+1],U=k.dist(R);if(T+U>I){var K=(I-T)/U,$=Ki(k.x,R.x,K),lt=Ki(k.y,R.y,K),nt=new Ll($,lt,R.angleTo(k),A);return nt._round(),!f||cc(t,nt,v,f,e)?nt:void 0}T+=U}}function ld(t,e,i,s,u,p,f,v,T){var I=dc(s,p,f),A=fc(s,u),k=A*f,R=0===t[0].x||t[0].x===T||0===t[0].y||t[0].y===T;return e-k<e/4&&(e=k+e/4),function U(K,$,lt,nt,dt,yt,xt,Tt,zt){for(var Wt=yt/2,te=pc(K),ge=0,ae=$-lt,xe=[],se=0;se<K.length-1;se++){for(var $e=K[se],Le=K[se+1],me=$e.dist(Le),oi=Le.angleTo($e);ae+lt<ge+me;){var Ge=((ae+=lt)-ge)/me,vi=Ki($e.x,Le.x,Ge),be=Ki($e.y,Le.y,Ge);if(vi>=0&&vi<zt&&be>=0&&be<zt&&ae-Wt>=0&&ae+Wt<=te){var ki=new Ll(vi,be,oi,se);ki._round(),nt&&!cc(K,ki,yt,nt,dt)||xe.push(ki)}}ge+=me}return Tt||xe.length||xt||(xe=U(K,ge/2,lt,nt,dt,yt,xt,!0,zt)),xe}(t,R?e/2*v%e:(A/2+2*p)*f*v%e,e,I,i,k,R,!1,T)}function mc(t,e,i,s,u){for(var p=[],f=0;f<t.length;f++)for(var v=t[f],T=void 0,I=0;I<v.length-1;I++){var A=v[I],k=v[I+1];A.x<e&&k.x<e||(A.x<e?A=new le(e,A.y+(e-A.x)/(k.x-A.x)*(k.y-A.y))._round():k.x<e&&(k=new le(e,A.y+(e-A.x)/(k.x-A.x)*(k.y-A.y))._round()),A.y<i&&k.y<i||(A.y<i?A=new le(A.x+(i-A.y)/(k.y-A.y)*(k.x-A.x),i)._round():k.y<i&&(k=new le(A.x+(i-A.y)/(k.y-A.y)*(k.x-A.x),i)._round()),A.x>=s&&k.x>=s||(A.x>=s?A=new le(s,A.y+(s-A.x)/(k.x-A.x)*(k.y-A.y))._round():k.x>=s&&(k=new le(s,A.y+(s-A.x)/(k.x-A.x)*(k.y-A.y))._round()),A.y>=u&&k.y>=u||(A.y>=u?A=new le(A.x+(u-A.y)/(k.y-A.y)*(k.x-A.x),u)._round():k.y>=u&&(k=new le(A.x+(u-A.y)/(k.y-A.y)*(k.x-A.x),u)._round()),T&&A.equals(T[T.length-1])||p.push(T=[A]),T.push(k)))))}return p}function _c(t,e,i,s){var u=[],p=t.image,f=p.pixelRatio,v=p.paddedRect.w-2,T=p.paddedRect.h-2,I=t.right-t.left,A=t.bottom-t.top,k=p.stretchX||[[0,v]],R=p.stretchY||[[0,T]],U=function(vi,be){return vi+be[1]-be[0]},K=k.reduce(U,0),$=R.reduce(U,0),lt=v-K,nt=T-$,dt=0,yt=K,xt=0,Tt=$,zt=0,Wt=lt,te=0,ge=nt;if(p.content&&s){var ae=p.content;dt=Fu(k,0,ae[0]),xt=Fu(R,0,ae[1]),yt=Fu(k,ae[0],ae[2]),Tt=Fu(R,ae[1],ae[3]),zt=ae[0]-dt,te=ae[1]-xt,Wt=ae[2]-ae[0]-yt,ge=ae[3]-ae[1]-Tt}var xe=function(vi,be,ki,mn){var Un=Uu(vi.stretch-dt,yt,I,t.left),Cn=Nu(vi.fixed-zt,Wt,vi.stretch,K),_n=Uu(be.stretch-xt,Tt,A,t.top),Nn=Nu(be.fixed-te,ge,be.stretch,$),Pr=Uu(ki.stretch-dt,yt,I,t.left),Ar=Nu(ki.fixed-zt,Wt,ki.stretch,K),wo=Uu(mn.stretch-xt,Tt,A,t.top),Nr=Nu(mn.fixed-te,ge,mn.stretch,$),To=new le(Un,_n),Jn=new le(Pr,_n),jr=new le(Pr,wo),pi=new le(Un,wo),Ji=new le(Cn/f,Nn/f),qi=new le(Ar/f,Nr/f),Ii=e*Math.PI/180;if(Ii){var zo=Math.sin(Ii),lo=Math.cos(Ii),sn=[lo,-zo,zo,lo];To._matMult(sn),Jn._matMult(sn),pi._matMult(sn),jr._matMult(sn)}var rr=vi.stretch+vi.fixed,uo=be.stretch+be.fixed;return{tl:To,tr:Jn,bl:pi,br:jr,tex:{x:p.paddedRect.x+1+rr,y:p.paddedRect.y+1+uo,w:ki.stretch+ki.fixed-rr,h:mn.stretch+mn.fixed-uo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ji,pixelOffsetBR:qi,minFontScaleX:Wt/f/I,minFontScaleY:ge/f/A,isSDF:i}};if(s&&(p.stretchX||p.stretchY))for(var se=yc(k,lt,K),$e=yc(R,nt,$),Le=0;Le<se.length-1;Le++)for(var me=se[Le],oi=se[Le+1],Ge=0;Ge<$e.length-1;Ge++)u.push(xe(me,$e[Ge],oi,$e[Ge+1]));else u.push(xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:T+1}));return u}function Fu(t,e,i){for(var s=0,u=0,p=t;u<p.length;u+=1){var f=p[u];s+=Math.max(e,Math.min(i,f[1]))-Math.max(e,Math.min(i,f[0]))}return s}function yc(t,e,i){for(var s=[{fixed:-1,stretch:0}],u=0,p=t;u<p.length;u+=1){var f=p[u],v=f[0],T=f[1],I=s[s.length-1];s.push({fixed:v-I.stretch,stretch:I.stretch}),s.push({fixed:v-I.stretch,stretch:I.stretch+(T-v)})}return s.push({fixed:e+1,stretch:i}),s}function Uu(t,e,i,s){return t/e*i+s}function Nu(t,e,i,s){return t-e*i/s}var ju=function(t,e,i,s,u,p,f,v,T,I){if(this.boxStartIndex=t.length,T){var A=p.top,k=p.bottom,R=p.collisionPadding;R&&(A-=R[1],k+=R[3]);var U=k-A;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{var K=p.top*f-v,$=p.bottom*f+v,lt=p.left*f-v,nt=p.right*f+v,dt=p.collisionPadding;if(dt&&(lt-=dt[0]*f,K-=dt[1]*f,nt+=dt[2]*f,$+=dt[3]*f),I){var yt=new le(lt,K),xt=new le(nt,K),Tt=new le(lt,$),zt=new le(nt,$),Wt=I*Math.PI/180;yt._rotate(Wt),xt._rotate(Wt),Tt._rotate(Wt),zt._rotate(Wt),lt=Math.min(yt.x,xt.x,Tt.x,zt.x),nt=Math.max(yt.x,xt.x,Tt.x,zt.x),K=Math.min(yt.y,xt.y,Tt.y,zt.y),$=Math.max(yt.y,xt.y,Tt.y,zt.y)}t.emplaceBack(e.x,e.y,lt,K,nt,$,i,s,u)}this.boxEndIndex=t.length},zl=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=ud),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function ud(t,e){return t<e?-1:t>e?1:0}function hd(t,e,i){void 0===e&&(e=1),void 0===i&&(i=!1);for(var s=1/0,u=1/0,p=-1/0,f=-1/0,v=t[0],T=0;T<v.length;T++){var I=v[T];(!T||I.x<s)&&(s=I.x),(!T||I.y<u)&&(u=I.y),(!T||I.x>p)&&(p=I.x),(!T||I.y>f)&&(f=I.y)}var A=Math.min(p-s,f-u),k=A/2,R=new zl([],cd);if(0===A)return new le(s,u);for(var U=s;U<p;U+=A)for(var K=u;K<f;K+=A)R.push(new kl(U+k,K+k,k,t));for(var $=function(dt){for(var yt=0,xt=0,Tt=0,zt=dt[0],Wt=0,te=zt.length,ge=te-1;Wt<te;ge=Wt++){var ae=zt[Wt],xe=zt[ge],se=ae.x*xe.y-xe.x*ae.y;xt+=(ae.x+xe.x)*se,Tt+=(ae.y+xe.y)*se,yt+=3*se}return new kl(xt/yt,Tt/yt,0,dt)}(t),lt=R.length;R.length;){var nt=R.pop();(nt.d>$.d||!$.d)&&($=nt,i&&console.log("found best %d after %d probes",Math.round(1e4*nt.d)/1e4,lt)),nt.max-$.d<=e||(R.push(new kl(nt.p.x-(k=nt.h/2),nt.p.y-k,k,t)),R.push(new kl(nt.p.x+k,nt.p.y-k,k,t)),R.push(new kl(nt.p.x-k,nt.p.y+k,k,t)),R.push(new kl(nt.p.x+k,nt.p.y+k,k,t)),lt+=4)}return i&&(console.log("num probes: "+lt),console.log("best distance: "+$.d)),$.p}function cd(t,e){return e.max-t.max}function kl(t,e,i,s){this.p=new le(t,e),this.h=i,this.d=function(u,p){for(var f=!1,v=1/0,T=0;T<p.length;T++)for(var I=p[T],A=0,k=I.length,R=k-1;A<k;R=A++){var U=I[A],K=I[R];U.y>u.y!=K.y>u.y&&u.x<(K.x-U.x)*(u.y-U.y)/(K.y-U.y)+U.x&&(f=!f),v=Math.min(v,Ks(u,U,K))}return(f?1:-1)*Math.sqrt(v)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}zl.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},zl.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},zl.prototype.peek=function(){return this.data[0]},zl.prototype._up=function(t){for(var e=this.data,i=this.compare,s=e[t];t>0;){var u=t-1>>1,p=e[u];if(i(s,p)>=0)break;e[t]=p,t=u}e[t]=s},zl.prototype._down=function(t){for(var e=this.data,i=this.compare,s=this.length>>1,u=e[t];t<s;){var p=1+(t<<1),f=e[p],v=p+1;if(v<this.length&&i(e[v],f)<0&&(p=v,f=e[v]),i(f,u)>=0)break;e[t]=f,t=p}e[t]=u};var bh=Number.POSITIVE_INFINITY;function gc(t,e){return e[1]!==bh?function(i,s,u){var p=0,f=0;switch(s=Math.abs(s),u=Math.abs(u),i){case"top-right":case"top-left":case"top":f=u-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-u}switch(i){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}return[p,f]}(t,e[0],e[1]):function(i,s){var u=0,p=0;s<0&&(s=0);var f=s/Math.sqrt(2);switch(i){case"top-right":case"top-left":p=f-7;break;case"bottom-right":case"bottom-left":p=7-f;break;case"bottom":p=7-s;break;case"top":p=s-7}switch(i){case"top-right":case"bottom-right":u=-f;break;case"top-left":case"bottom-left":u=f;break;case"left":u=s;break;case"right":u=-s}return[u,p]}(t,e[0])}function wh(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vc(t,e,i,s,u,p,f,v,T,I,A,k,R,U,K){var $=function(xt,Tt,zt,Wt,te,ge,ae,xe){for(var se=Wt.layout.get("text-rotate").evaluate(ge,{})*Math.PI/180,$e=[],Le=0,me=Tt.positionedLines;Le<me.length;Le+=1)for(var oi=me[Le],Ge=0,vi=oi.positionedGlyphs;Ge<vi.length;Ge+=1){var be=vi[Ge];if(be.rect){var ki=be.rect||{},mn=4,Un=!0,Cn=1,_n=0,Nn=(te||xe)&&be.vertical,Pr=be.metrics.advance*be.scale/2;if(xe&&Tt.verticalizable&&(_n=oi.lineOffset/2-(be.imageName?-(24-be.metrics.width*be.scale)/2:24*(be.scale-1))),be.imageName){var Ar=ae[be.imageName];Un=Ar.sdf,mn=1/(Cn=Ar.pixelRatio)}var wo=te?[be.x+Pr,be.y]:[0,0],Nr=te?[0,0]:[be.x+Pr+zt[0],be.y+zt[1]-_n],To=[0,0];Nn&&(To=Nr,Nr=[0,0]);var Jn=(be.metrics.left-mn)*be.scale-Pr+Nr[0],jr=(-be.metrics.top-mn)*be.scale+Nr[1],pi=Jn+ki.w*be.scale/Cn,Ji=jr+ki.h*be.scale/Cn,qi=new le(Jn,jr),Ii=new le(pi,jr),zo=new le(Jn,Ji),lo=new le(pi,Ji);if(Nn){var sn=new le(-Pr,Pr- -17),rr=-Math.PI/2,uo=12-Pr,Mi=new le(22-uo,-(be.imageName?uo:0)),gs=new(Function.prototype.bind.apply(le,[null].concat(To)));qi._rotateAround(rr,sn)._add(Mi)._add(gs),Ii._rotateAround(rr,sn)._add(Mi)._add(gs),zo._rotateAround(rr,sn)._add(Mi)._add(gs),lo._rotateAround(rr,sn)._add(Mi)._add(gs)}if(se){var xa=Math.sin(se),vs=Math.cos(se),Yn=[vs,-xa,xa,vs];qi._matMult(Yn),Ii._matMult(Yn),zo._matMult(Yn),lo._matMult(Yn)}var xs=new le(0,0),Ua=new le(0,0);$e.push({tl:qi,tr:Ii,bl:zo,br:lo,tex:ki,writingMode:Tt.writingMode,glyphOffset:wo,sectionIndex:be.sectionIndex,isSDF:Un,pixelOffsetTL:xs,pixelOffsetBR:Ua,minFontScaleX:0,minFontScaleY:0})}}return $e}(0,i,v,u,p,f,s,t.allowVerticalPlacement),lt=t.textSizeData,nt=null;"source"===lt.kind?(nt=[128*u.layout.get("text-size").evaluate(f,{})])[0]>32640&&Ye(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===lt.kind&&((nt=[128*U.compositeTextSizes[0].evaluate(f,{},K),128*U.compositeTextSizes[1].evaluate(f,{},K)])[0]>32640||nt[1]>32640)&&Ye(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,$,nt,v,p,f,I,e,T.lineStartIndex,T.lineLength,R,K);for(var dt=0,yt=A;dt<yt.length;dt+=1)k[yt[dt]]=t.text.placedSymbolArray.length-1;return 4*$.length}function xc(t){for(var e in t)return t[e];return null}function pd(t,e,i,s){var u=t.compareText;if(e in u){for(var p=u[e],f=p.length-1;f>=0;f--)if(s.dist(p[f])<i)return!0}else u[e]=[];return u[e].push(s),!1}var dd=Il.VectorTileFeature.types,fd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vu(t,e,i,s,u,p,f,v,T,I,A,k,R){var U=v?Math.min(32640,Math.round(v[0])):0,K=v?Math.min(32640,Math.round(v[1])):0;t.emplaceBack(e,i,Math.round(32*s),Math.round(32*u),p,f,(U<<1)+(T?1:0),K,16*I,16*A,256*k,256*R)}function Th(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function md(t){for(var e=0,i=t.sections;e<i.length;e+=1)if(Br(i[e].text))return!0;return!1}var Ml=function(t){this.layoutVertexArray=new vl,this.indexArray=new ps,this.programConfigurations=t,this.segments=new V,this.dynamicLayoutVertexArray=new Ws,this.opacityVertexArray=new rl,this.placedSymbolArray=new l};Ml.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Ml.prototype.upload=function(t,e,i,s){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,jp.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Vp.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,fd,!0),this.opacityVertexBuffer.itemSize=1),(i||s)&&this.programConfigurations.upload(t))},Ml.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},qt("SymbolBuffers",Ml);var cu=function(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new V,this.collisionVertexArray=new Ql};cu.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Zp.members,!0)},cu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},qt("CollisionBuffers",cu);var Wi=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(p){return p.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=na([]),this.placementViewportMatrix=na([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=xh(this.zoom,e["text-size"]),this.iconSizeData=xh(this.zoom,e["icon-size"]);var i=this.layers[0].layout,s=i.get("symbol-sort-key"),u=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==u&&void 0!==s.constantOr(1),this.sortFeaturesByY=("viewport-y"===u||"auto"===u&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map(function(p){return va[p]})),this.stateDependentLayerIds=this.layers.filter(function(p){return p.isStateDependent()}).map(function(p){return p.id}),this.sourceID=t.sourceID};Wi.prototype.createArrays=function(){this.text=new Ml(new Ce(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new Ml(new Ce(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new g,this.lineVertexArray=new w,this.symbolInstances=new _},Wi.prototype.calculateGlyphDependencies=function(t,e,i,s,u){for(var p=0;p<t.length;p++)if(e[t.charCodeAt(p)]=!0,(i||s)&&u){var f=lu[t.charAt(p)];f&&(e[f.charCodeAt(0)]=!0)}},Wi.prototype.populate=function(t,e,i){var s=this.layers[0],u=s.layout,p=u.get("text-font"),f=u.get("text-field"),v=u.get("icon-image"),T=("constant"!==f.value.kind||f.value.value instanceof Dn&&!f.value.value.isEmpty()||f.value.value.toString().length>0)&&("constant"!==p.value.kind||p.value.value.length>0),I="constant"!==v.value.kind||!!v.value.value||Object.keys(v.parameters).length>0,A=u.get("symbol-sort-key");if(this.features=[],T||I){for(var k=e.iconDependencies,R=e.glyphDependencies,U=e.availableImages,K=new ri(this.zoom),$=0,lt=t;$<lt.length;$+=1){var nt=lt[$],dt=nt.feature,yt=nt.id,xt=nt.index,Tt=nt.sourceLayerIndex,zt=s._featureFilter.needGeometry,Wt=Kn(dt,zt);if(s._featureFilter.filter(K,Wt,i)){zt||(Wt.geometry=An(dt));var te=void 0;if(T){var ge=s.getValueAndResolveTokens("text-field",Wt,i,U),ae=Dn.factory(ge);md(ae)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===nl()||this.hasRTLText&&Po.isParsed())&&(te=Gp(ae,s,Wt))}var xe=void 0;if(I){var se=s.getValueAndResolveTokens("icon-image",Wt,i,U);xe=se instanceof Oe?se:Oe.fromString(se)}if(te||xe){var $e=this.sortFeaturesByKey?A.evaluate(Wt,{},i):void 0;if(this.features.push({id:yt,text:te,icon:xe,index:xt,sourceLayerIndex:Tt,geometry:Wt.geometry,properties:dt.properties,type:dd[dt.type],sortKey:$e}),xe&&(k[xe.name]=!0),te){var Le=p.evaluate(Wt,{},i).join(","),me="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(va.vertical)>=0;for(var oi=0,Ge=te.sections;oi<Ge.length;oi+=1){var vi=Ge[oi];if(vi.image)k[vi.image.name]=!0;else{var be=ea(te.toString()),ki=vi.fontStack||Le,mn=R[ki]=R[ki]||{};this.calculateGlyphDependencies(vi.text,mn,me,this.allowVerticalPlacement,be)}}}}}}"line"===u.get("symbol-placement")&&(this.features=function(Un){var Cn={},_n={},Nn=[],Pr=0;function Ar(sn){Nn.push(Un[sn]),Pr++}function wo(sn,rr,uo){var Mi=_n[sn];return delete _n[sn],_n[rr]=Mi,Nn[Mi].geometry[0].pop(),Nn[Mi].geometry[0]=Nn[Mi].geometry[0].concat(uo[0]),Mi}function Nr(sn,rr,uo){var Mi=Cn[rr];return delete Cn[rr],Cn[sn]=Mi,Nn[Mi].geometry[0].shift(),Nn[Mi].geometry[0]=uo[0].concat(Nn[Mi].geometry[0]),Mi}function To(sn,rr,uo){var Mi=uo?rr[0][rr[0].length-1]:rr[0][0];return sn+":"+Mi.x+":"+Mi.y}for(var Jn=0;Jn<Un.length;Jn++){var jr=Un[Jn],pi=jr.geometry,Ji=jr.text?jr.text.toString():null;if(Ji){var qi=To(Ji,pi),Ii=To(Ji,pi,!0);if(qi in _n&&Ii in Cn&&_n[qi]!==Cn[Ii]){var zo=Nr(qi,Ii,pi),lo=wo(qi,Ii,Nn[zo].geometry);delete Cn[qi],delete _n[Ii],_n[To(Ji,Nn[lo].geometry,!0)]=lo,Nn[zo].geometry=null}else qi in _n?wo(qi,Ii,pi):Ii in Cn?Nr(qi,Ii,pi):(Ar(Jn),Cn[qi]=Pr-1,_n[Ii]=Pr-1)}else Ar(Jn)}return Nn.filter(function(sn){return sn.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Un,Cn){return Un.sortKey-Cn.sortKey})}},Wi.prototype.update=function(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))},Wi.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Wi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Wi.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Wi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Wi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Wi.prototype.addToLineVertexArray=function(t,e){var i=this.lineVertexArray.length;if(void 0!==t.segment){for(var s=t.dist(e[t.segment+1]),u=t.dist(e[t.segment]),p={},f=t.segment+1;f<e.length;f++)p[f]={x:e[f].x,y:e[f].y,tileUnitDistanceFromAnchor:s},f<e.length-1&&(s+=e[f+1].dist(e[f]));for(var v=t.segment||0;v>=0;v--)p[v]={x:e[v].x,y:e[v].y,tileUnitDistanceFromAnchor:u},v>0&&(u+=e[v-1].dist(e[v]));for(var T=0;T<e.length;T++){var I=p[T];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Wi.prototype.addSymbols=function(t,e,i,s,u,p,f,v,T,I,A,k){for(var R=t.indexArray,U=t.layoutVertexArray,K=t.segments.prepareSegment(4*e.length,U,R,this.canOverlap?p.sortKey:void 0),$=this.glyphOffsetArray.length,lt=K.vertexLength,nt=this.allowVerticalPlacement&&f===va.vertical?Math.PI/2:0,dt=p.text&&p.text.sections,yt=0;yt<e.length;yt++){var xt=e[yt],Tt=xt.tl,zt=xt.tr,Wt=xt.bl,te=xt.br,ge=xt.tex,ae=xt.pixelOffsetTL,xe=xt.pixelOffsetBR,se=xt.minFontScaleX,$e=xt.minFontScaleY,Le=xt.glyphOffset,me=xt.isSDF,oi=xt.sectionIndex,Ge=K.vertexLength,vi=Le[1];Vu(U,v.x,v.y,Tt.x,vi+Tt.y,ge.x,ge.y,i,me,ae.x,ae.y,se,$e),Vu(U,v.x,v.y,zt.x,vi+zt.y,ge.x+ge.w,ge.y,i,me,xe.x,ae.y,se,$e),Vu(U,v.x,v.y,Wt.x,vi+Wt.y,ge.x,ge.y+ge.h,i,me,ae.x,xe.y,se,$e),Vu(U,v.x,v.y,te.x,vi+te.y,ge.x+ge.w,ge.y+ge.h,i,me,xe.x,xe.y,se,$e),Th(t.dynamicLayoutVertexArray,v,nt),R.emplaceBack(Ge,Ge+1,Ge+2),R.emplaceBack(Ge+1,Ge+2,Ge+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Le[0]),yt!==e.length-1&&oi===e[yt+1].sectionIndex||t.programConfigurations.populatePaintArrays(U.length,p,p.index,{},k,dt&&dt[oi])}t.placedSymbolArray.emplaceBack(v.x,v.y,$,this.glyphOffsetArray.length-$,lt,T,I,v.segment,i?i[0]:0,i?i[1]:0,s[0],s[1],f,0,!1,0,A)},Wi.prototype._addCollisionDebugVertex=function(t,e,i,s,u,p){return e.emplaceBack(0,0),t.emplaceBack(i.x,i.y,s,u,Math.round(p.x),Math.round(p.y))},Wi.prototype.addCollisionDebugVertices=function(t,e,i,s,u,p,f){var v=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),T=v.vertexLength,I=u.layoutVertexArray,A=u.collisionVertexArray,k=f.anchorX,R=f.anchorY;this._addCollisionDebugVertex(I,A,p,k,R,new le(t,e)),this._addCollisionDebugVertex(I,A,p,k,R,new le(i,e)),this._addCollisionDebugVertex(I,A,p,k,R,new le(i,s)),this._addCollisionDebugVertex(I,A,p,k,R,new le(t,s)),v.vertexLength+=4;var U=u.indexArray;U.emplaceBack(T,T+1),U.emplaceBack(T+1,T+2),U.emplaceBack(T+2,T+3),U.emplaceBack(T+3,T),v.primitiveLength+=4},Wi.prototype.addDebugCollisionBoxes=function(t,e,i,s){for(var u=t;u<e;u++){var p=this.collisionBoxArray.get(u);this.addCollisionDebugVertices(p.x1,p.y1,p.x2,p.y2,s?this.textCollisionBox:this.iconCollisionBox,p.anchorPoint,i)}},Wi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new cu(Hs,$h.members,ol),this.iconCollisionBox=new cu(Hs,$h.members,ol);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},Wi.prototype._deserializeCollisionBoxesForSymbol=function(t,e,i,s,u,p,f,v,T){for(var I={},A=e;A<i;A++){var k=t.get(A);I.textBox={x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,anchorPointX:k.anchorPointX,anchorPointY:k.anchorPointY},I.textFeatureIndex=k.featureIndex;break}for(var R=s;R<u;R++){var U=t.get(R);I.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},I.verticalTextFeatureIndex=U.featureIndex;break}for(var K=p;K<f;K++){var $=t.get(K);I.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},I.iconFeatureIndex=$.featureIndex;break}for(var lt=v;lt<T;lt++){var nt=t.get(lt);I.verticalIconBox={x1:nt.x1,y1:nt.y1,x2:nt.x2,y2:nt.y2,anchorPointX:nt.anchorPointX,anchorPointY:nt.anchorPointY},I.verticalIconFeatureIndex=nt.featureIndex;break}return I},Wi.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Wi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Wi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Wi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Wi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Wi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Wi.prototype.addIndicesForPlacedSymbol=function(t,e){for(var i=t.placedSymbolArray.get(e),s=i.vertexStartIndex+4*i.numGlyphs,u=i.vertexStartIndex;u<s;u+=4)t.indexArray.emplaceBack(u,u+1,u+2),t.indexArray.emplaceBack(u+1,u+2,u+3)},Wi.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),i=Math.cos(t),s=[],u=[],p=[],f=0;f<this.symbolInstances.length;++f){p.push(f);var v=this.symbolInstances.get(f);s.push(0|Math.round(e*v.anchorX+i*v.anchorY)),u.push(v.featureIndex)}return p.sort(function(T,I){return s[T]-s[I]||u[I]-u[T]}),p},Wi.prototype.addToSortKeyRanges=function(t,e){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Wi.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,s=this.symbolInstanceIndexes;i<s.length;i+=1){var u=this.symbolInstances.get(s[i]);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach(function(p,f,v){p>=0&&v.indexOf(p)===f&&e.addIndicesForPlacedSymbol(e.text,p)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},qt("SymbolBucket",Wi,{omit:["layers","collisionBoxArray","features","compareText"]}),Wi.MAX_GLYPHS=65535,Wi.addDynamicAttributes=Th;var _d=new Kr({"symbol-placement":new ye(N.layout_symbol["symbol-placement"]),"symbol-spacing":new ye(N.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ye(N.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new fe(N.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ye(N.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ye(N.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ye(N.layout_symbol["icon-ignore-placement"]),"icon-optional":new ye(N.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ye(N.layout_symbol["icon-rotation-alignment"]),"icon-size":new fe(N.layout_symbol["icon-size"]),"icon-text-fit":new ye(N.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ye(N.layout_symbol["icon-text-fit-padding"]),"icon-image":new fe(N.layout_symbol["icon-image"]),"icon-rotate":new fe(N.layout_symbol["icon-rotate"]),"icon-padding":new ye(N.layout_symbol["icon-padding"]),"icon-keep-upright":new ye(N.layout_symbol["icon-keep-upright"]),"icon-offset":new fe(N.layout_symbol["icon-offset"]),"icon-anchor":new fe(N.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ye(N.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ye(N.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ye(N.layout_symbol["text-rotation-alignment"]),"text-field":new fe(N.layout_symbol["text-field"]),"text-font":new fe(N.layout_symbol["text-font"]),"text-size":new fe(N.layout_symbol["text-size"]),"text-max-width":new fe(N.layout_symbol["text-max-width"]),"text-line-height":new ye(N.layout_symbol["text-line-height"]),"text-letter-spacing":new fe(N.layout_symbol["text-letter-spacing"]),"text-justify":new fe(N.layout_symbol["text-justify"]),"text-radial-offset":new fe(N.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ye(N.layout_symbol["text-variable-anchor"]),"text-anchor":new fe(N.layout_symbol["text-anchor"]),"text-max-angle":new ye(N.layout_symbol["text-max-angle"]),"text-writing-mode":new ye(N.layout_symbol["text-writing-mode"]),"text-rotate":new fe(N.layout_symbol["text-rotate"]),"text-padding":new ye(N.layout_symbol["text-padding"]),"text-keep-upright":new ye(N.layout_symbol["text-keep-upright"]),"text-transform":new fe(N.layout_symbol["text-transform"]),"text-offset":new fe(N.layout_symbol["text-offset"]),"text-allow-overlap":new ye(N.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ye(N.layout_symbol["text-ignore-placement"]),"text-optional":new ye(N.layout_symbol["text-optional"])}),Sh={paint:new Kr({"icon-opacity":new fe(N.paint_symbol["icon-opacity"]),"icon-color":new fe(N.paint_symbol["icon-color"]),"icon-halo-color":new fe(N.paint_symbol["icon-halo-color"]),"icon-halo-width":new fe(N.paint_symbol["icon-halo-width"]),"icon-halo-blur":new fe(N.paint_symbol["icon-halo-blur"]),"icon-translate":new ye(N.paint_symbol["icon-translate"]),"icon-translate-anchor":new ye(N.paint_symbol["icon-translate-anchor"]),"text-opacity":new fe(N.paint_symbol["text-opacity"]),"text-color":new fe(N.paint_symbol["text-color"],{runtimeType:Jt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new fe(N.paint_symbol["text-halo-color"]),"text-halo-width":new fe(N.paint_symbol["text-halo-width"]),"text-halo-blur":new fe(N.paint_symbol["text-halo-blur"]),"text-translate":new ye(N.paint_symbol["text-translate"]),"text-translate-anchor":new ye(N.paint_symbol["text-translate-anchor"])}),layout:_d},Dl=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Gt,this.defaultValue=t};Dl.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Dl.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Dl.prototype.outputDefined=function(){return!1},Dl.prototype.serialize=function(){return null},qt("FormatSectionOverride",Dl,{omit:["defaultValue"]});var yd=function(t){function e(i){t.call(this,i,Sh)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(i,s){if(t.prototype.recalculate.call(this,i,s),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var u=this.layout.get("text-writing-mode");if(u){for(var p=[],f=0,v=u;f<v.length;f+=1){var T=v[f];p.indexOf(T)<0&&p.push(T)}this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(i,s,u,p){var T,f=this.layout.get(i).evaluate(s,{},u,p),v=this._unevaluatedLayout._values[i];return v.isDataDriven()||ka(v.value)||!f?f:(T=s.properties,f.replace(/{([^{}]+)}/g,function(A,k){return k in T?String(T[k]):""}))},e.prototype.createBucket=function(i){return new Wi(i)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var i=0,s=Sh.paint.overridableProperties;i<s.length;i+=1){var u=s[i];if(e.hasPaintOverride(this.layout,u)){var p,f=this.paint.get(u),v=new Dl(f),T=new Ro(v,f.property.specification);p="constant"===f.value.kind||"source"===f.value.kind?new ta("source",T):new ma("composite",T,f.value.zoomStops,f.value._interpolationType),this.paint._values[u]=new Or(f.property,p,f.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(i,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&e.hasPaintOverride(this.layout,i)},e.hasPaintOverride=function(i,s){var u=i.get("text-field"),p=Sh.paint.properties[s],f=!1,v=function(A){for(var k=0,R=A;k<R.length;k+=1)if(p.overrides&&p.overrides.hasOverride(R[k]))return void(f=!0)};if("constant"===u.value.kind&&u.value.value instanceof Dn)v(u.value.value.sections);else if("source"===u.value.kind){var T=function(A){f||(A instanceof Bn&&nn(A.value)===fi?v(A.value.sections):A instanceof yr?v(A.sections):A.eachChild(T))},I=u.value;I._styleExpression&&T(I._styleExpression.expression)}return f},e}(Ba),gd={paint:new Kr({"background-color":new ye(N.paint_background["background-color"]),"background-pattern":new vo(N.paint_background["background-pattern"]),"background-opacity":new ye(N.paint_background["background-opacity"])})},vd=function(t){function e(i){t.call(this,i,gd)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Ba),xd={paint:new Kr({"raster-opacity":new ye(N.paint_raster["raster-opacity"]),"raster-hue-rotate":new ye(N.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ye(N.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ye(N.paint_raster["raster-brightness-max"]),"raster-saturation":new ye(N.paint_raster["raster-saturation"]),"raster-contrast":new ye(N.paint_raster["raster-contrast"]),"raster-resampling":new ye(N.paint_raster["raster-resampling"]),"raster-fade-duration":new ye(N.paint_raster["raster-fade-duration"])})},bd=function(t){function e(i){t.call(this,i,xd)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Ba),wd=function(t){function e(i){t.call(this,i,{}),this.implementation=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},e.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},e}(Ba),Td={circle:lh,heatmap:ap,hillshade:lp,fill:Ep,"fill-extrusion":Dp,line:Np,symbol:yd,background:vd,raster:bd},bc=Zt.HTMLImageElement,wc=Zt.HTMLCanvasElement,Tc=Zt.HTMLVideoElement,Sc=Zt.ImageData,Zu=Zt.ImageBitmap,cl=function(t,e,i,s){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,s)};cl.prototype.update=function(t,e,i){var s=t.width,u=t.height,p=!(this.size&&this.size[0]===s&&this.size[1]===u||i),f=this.context,v=f.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),v.bindTexture(v.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!e||!1!==e.premultiply)),p)this.size=[s,u],t instanceof bc||t instanceof wc||t instanceof Tc||t instanceof Sc||Zu&&t instanceof Zu?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,t):v.texImage2D(v.TEXTURE_2D,0,this.format,s,u,0,this.format,v.UNSIGNED_BYTE,t.data);else{var T=i||{x:0,y:0},I=T.x,A=T.y;t instanceof bc||t instanceof wc||t instanceof Tc||t instanceof Sc||Zu&&t instanceof Zu?v.texSubImage2D(v.TEXTURE_2D,0,I,A,v.RGBA,v.UNSIGNED_BYTE,t):v.texSubImage2D(v.TEXTURE_2D,0,I,A,s,u,v.RGBA,v.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&v.generateMipmap(v.TEXTURE_2D)},cl.prototype.bind=function(t,e,i){var s=this.context.gl;s.bindTexture(s.TEXTURE_2D,this.texture),i!==s.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=s.LINEAR),t!==this.filter&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,e),this.wrap=e)},cl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},cl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Eh=function(t){var e=this;this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};Eh.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Eh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Bl=function(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},bi(["receive","process"],this),this.invoker=new Eh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Vn()?t:Zt};function Ec(t,e,i){var s=2*Math.PI*6378137/256/Math.pow(2,i);return[t*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}Bl.prototype.send=function(t,e,i,s,u){var p=this;void 0===u&&(u=!1);var f=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[f]=i);var v=_r(this.globalScope)?void 0:[];return this.target.postMessage({id:f,type:t,hasCallback:!!i,targetMapId:s,mustQueue:u,sourceMapId:this.mapId,data:cn(e,v)},v),{cancel:function(){i&&delete p.callbacks[f],p.target.postMessage({id:f,type:"<cancel>",targetMapId:s,sourceMapId:p.mapId})}}},Bl.prototype.receive=function(t){var e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[i];var s=this.cancelCallbacks[i];delete this.cancelCallbacks[i],s&&s()}else Vn()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)},Bl.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Bl.prototype.processTask=function(t,e){var i=this;if("<response>"===e.type){var s=this.callbacks[t];delete this.callbacks[t],s&&(e.error?s(pn(e.error)):s(null,pn(e.data)))}else{var u=!1,p=_r(this.globalScope)?void 0:[],f=e.hasCallback?function(A,k){u=!0,delete i.cancelCallbacks[t],i.target.postMessage({id:t,type:"<response>",sourceMapId:i.mapId,error:A?cn(A):null,data:cn(k,p)},p)}:function(A){u=!0},v=null,T=pn(e.data);if(this.parent[e.type])v=this.parent[e.type](e.sourceMapId,T,f);else if(this.parent.getWorkerSource){var I=e.type.split(".");v=this.parent.getWorkerSource(e.sourceMapId,I[0],T.source)[I[1]](T,f)}else f(new Error("Could not find function "+e.type));!u&&v&&v.cancel&&(this.cancelCallbacks[t]=v.cancel)}},Bl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var pr=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};pr.prototype.setNorthEast=function(t){return this._ne=t instanceof fn?new fn(t.lng,t.lat):fn.convert(t),this},pr.prototype.setSouthWest=function(t){return this._sw=t instanceof fn?new fn(t.lng,t.lat):fn.convert(t),this},pr.prototype.extend=function(t){var e,i,s=this._sw,u=this._ne;if(t instanceof fn)e=t,i=t;else{if(!(t instanceof pr))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(pr.convert(t)):this.extend(fn.convert(t)):this;if(i=t._ne,!(e=t._sw)||!i)return this}return s||u?(s.lng=Math.min(e.lng,s.lng),s.lat=Math.min(e.lat,s.lat),u.lng=Math.max(i.lng,u.lng),u.lat=Math.max(i.lat,u.lat)):(this._sw=new fn(e.lng,e.lat),this._ne=new fn(i.lng,i.lat)),this},pr.prototype.getCenter=function(){return new fn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},pr.prototype.getSouthWest=function(){return this._sw},pr.prototype.getNorthEast=function(){return this._ne},pr.prototype.getNorthWest=function(){return new fn(this.getWest(),this.getNorth())},pr.prototype.getSouthEast=function(){return new fn(this.getEast(),this.getSouth())},pr.prototype.getWest=function(){return this._sw.lng},pr.prototype.getSouth=function(){return this._sw.lat},pr.prototype.getEast=function(){return this._ne.lng},pr.prototype.getNorth=function(){return this._ne.lat},pr.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},pr.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},pr.prototype.isEmpty=function(){return!(this._sw&&this._ne)},pr.prototype.contains=function(t){var e=fn.convert(t),i=e.lng,s=e.lat,u=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u},pr.convert=function(t){return!t||t instanceof pr?t:new pr(t)};var fn=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};fn.prototype.wrap=function(){return new fn(ti(this.lng,-180,180),this.lat)},fn.prototype.toArray=function(){return[this.lng,this.lat]},fn.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},fn.prototype.distanceTo=function(t){var e=Math.PI/180,i=this.lat*e,s=t.lat*e,u=Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos((t.lng-this.lng)*e);return 6371008.8*Math.acos(Math.min(u,1))},fn.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return new pr(new fn(this.lng-i,this.lat-e),new fn(this.lng+i,this.lat+e))},fn.convert=function(t){if(t instanceof fn)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new fn(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new fn(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ic=2*Math.PI*6371008.8;function Pc(t){return Ic*Math.cos(t*Math.PI/180)}function Ac(t){return(180+t)/360}function Cc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Lc(t,e){return t/Pc(e)}function Ih(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var pl=function(t,e,i){void 0===i&&(i=0),this.x=+t,this.y=+e,this.z=+i};pl.fromLngLat=function(t,e){void 0===e&&(e=0);var i=fn.convert(t);return new pl(Ac(i.lng),Cc(i.lat),Lc(e,i.lat))},pl.prototype.toLngLat=function(){return new fn(360*this.x-180,Ih(this.y))},pl.prototype.toAltitude=function(){return this.z*Pc(Ih(this.y))},pl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ic*(t=Ih(this.y),1/Math.cos(t*Math.PI/180));var t};var dl=function(t,e,i){this.z=t,this.x=e,this.y=i,this.key=pu(0,t,t,e,i)};dl.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},dl.prototype.url=function(t,e){var i,s,u,p,f,v=(s=this.y,u=this.z,p=Ec(256*(i=this.x),256*(s=Math.pow(2,u)-s-1),u),f=Ec(256*(i+1),256*(s+1),u),p[0]+","+p[1]+","+f[0]+","+f[1]),T=function(I,A,k){for(var R,U="",K=I;K>0;K--)U+=(A&(R=1<<K-1)?1:0)+(k&R?2:0);return U}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",T).replace("{bbox-epsg-3857}",v)},dl.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new le(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},dl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var zc=function(t,e){this.wrap=t,this.canonical=e,this.key=pu(t,e.z,e.z,e.x,e.y)},dr=function(t,e,i,s,u){this.overscaledZ=t,this.wrap=e,this.canonical=new dl(i,+s,+u),this.key=pu(e,t,i,s,u)};function pu(t,e,i,s,u){(t*=2)<0&&(t=-1*t-1);var p=1<<i;return(p*p*t+p*u+s).toString(36)+i.toString(36)+e.toString(36)}dr.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},dr.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new dr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new dr(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},dr.prototype.calculateScaledKey=function(t,e){var i=this.canonical.z-t;return t>this.canonical.z?pu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):pu(this.wrap*+e,t,t,this.canonical.x>>i,this.canonical.y>>i)},dr.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},dr.prototype.children=function(t){if(this.overscaledZ>=t)return[new dr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,i=2*this.canonical.x,s=2*this.canonical.y;return[new dr(e,this.wrap,e,i,s),new dr(e,this.wrap,e,i+1,s),new dr(e,this.wrap,e,i,s+1),new dr(e,this.wrap,e,i+1,s+1)]},dr.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},dr.prototype.wrapped=function(){return new dr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},dr.prototype.unwrapTo=function(t){return new dr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},dr.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},dr.prototype.toUnwrapped=function(){return new zc(this.wrap,this.canonical)},dr.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},dr.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new pl(t.x-this.wrap,t.y))},qt("CanonicalTileID",dl),qt("OverscaledTileID",dr,{omit:["posMatrix"]});var Rs=function(t,e,i){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return Ye('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var s=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=i||"mapbox";for(var u=0;u<s;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(s,u)]=this.data[this._idx(s-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,s)]=this.data[this._idx(u,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)]};Rs.prototype.get=function(t,e){var i=new Uint8Array(this.data.buffer),s=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(i[s],i[s+1],i[s+2])},Rs.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Rs.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Rs.prototype._unpackMapbox=function(t,e,i){return(256*t*256+256*e+i)/10-1e4},Rs.prototype._unpackTerrarium=function(t,e,i){return 256*t+e+i/256-32768},Rs.prototype.getPixels=function(){return new qo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Rs.prototype.backfillBorder=function(t,e,i){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var s=e*this.dim,u=e*this.dim+this.dim,p=i*this.dim,f=i*this.dim+this.dim;switch(e){case-1:s=u-1;break;case 1:u=s+1}switch(i){case-1:p=f-1;break;case 1:f=p+1}for(var v=-e*this.dim,T=-i*this.dim,I=p;I<f;I++)for(var A=s;A<u;A++)this.data[this._idx(A,I)]=t.data[this._idx(A+v,I+T)]},qt("DEMData",Rs);var qu=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}};qu.prototype.encode=function(t){return this._stringToNumber[t]},qu.prototype.decode=function(t){return this._numberToString[t]};var Gu=function(t,e,i,s,u){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=s,this.properties=t.properties,this.id=u},Ph={geometry:{configurable:!0}};Ph.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ph.geometry.set=function(t){this._geometry=t},Gu.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Gu.prototype,Ph);var Ol=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ol.prototype.updateState=function(t,e,i){var s=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][s]=this.stateChanges[t][s]||{},je(this.stateChanges[t][s],i),null===this.deletedStates[t])for(var u in this.deletedStates[t]={},this.state[t])u!==s&&(this.deletedStates[t][u]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][s])for(var p in this.deletedStates[t][s]={},this.state[t][s])i[p]||(this.deletedStates[t][s][p]=null);else for(var f in i)this.deletedStates[t]&&this.deletedStates[t][s]&&null===this.deletedStates[t][s][f]&&delete this.deletedStates[t][s][f]},Ol.prototype.removeFeatureState=function(t,e,i){if(null!==this.deletedStates[t]){var s=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},i&&void 0!==e)null!==this.deletedStates[t][s]&&(this.deletedStates[t][s]=this.deletedStates[t][s]||{},this.deletedStates[t][s][i]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][s])for(i in this.deletedStates[t][s]={},this.stateChanges[t][s])this.deletedStates[t][s][i]=null;else this.deletedStates[t][s]=null;else this.deletedStates[t]=null}},Ol.prototype.getState=function(t,e){var i=String(e),s=je({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var u=this.deletedStates[t][e];if(null===u)return{};for(var p in u)delete s[p]}return s},Ol.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Ol.prototype.coalesceChanges=function(t,e){var i={};for(var s in this.stateChanges){this.state[s]=this.state[s]||{};var u={};for(var p in this.stateChanges[s])this.state[s][p]||(this.state[s][p]={}),je(this.state[s][p],this.stateChanges[s][p]),u[p]=this.state[s][p];i[s]=u}for(var f in this.deletedStates){this.state[f]=this.state[f]||{};var v={};if(null===this.deletedStates[f])for(var T in this.state[f])v[T]={},this.state[f][T]={};else for(var I in this.deletedStates[f]){if(null===this.deletedStates[f][I])this.state[f][I]={};else for(var A=0,k=Object.keys(this.deletedStates[f][I]);A<k.length;A+=1)delete this.state[f][I][k[A]];v[I]=this.state[f][I]}i[f]=i[f]||{},je(i[f],v)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(var R in t)t[R].setFeatureState(i,e)};var Fs=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ci(8192,16,0),this.grid3D=new ci(8192,16,0),this.featureIndexArray=new M,this.promoteId=e};function kc(t,e,i,s,u){return Ni(t,function(p,f){var v=e instanceof cs?e.get(f):null;return v&&v.evaluate?v.evaluate(i,s,u):v})}function Mc(t){for(var e=1/0,i=1/0,s=-1/0,u=-1/0,p=0,f=t;p<f.length;p+=1){var v=f[p];e=Math.min(e,v.x),i=Math.min(i,v.y),s=Math.max(s,v.x),u=Math.max(u,v.y)}return{minX:e,minY:i,maxX:s,maxY:u}}function Sd(t,e){return e-t}Fs.prototype.insert=function(t,e,i,s,u,p){var f=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,s,u);for(var v=p?this.grid3D:this.grid,T=0;T<e.length;T++){for(var I=e[T],A=[1/0,1/0,-1/0,-1/0],k=0;k<I.length;k++){var R=I[k];A[0]=Math.min(A[0],R.x),A[1]=Math.min(A[1],R.y),A[2]=Math.max(A[2],R.x),A[3]=Math.max(A[3],R.y)}A[0]<8192&&A[1]<8192&&A[2]>=0&&A[3]>=0&&v.insert(f,A[0],A[1],A[2],A[3])}},Fs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Il.VectorTile(new Mu(this.rawTileData)).layers,this.sourceLayerCoder=new qu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Fs.prototype.query=function(t,e,i,s){var u=this;this.loadVTLayers();for(var p=t.params||{},f=8192/t.tileSize/t.scale,v=C(p.filter),T=t.queryGeometry,I=t.queryPadding*f,A=Mc(T),k=this.grid.query(A.minX-I,A.minY-I,A.maxX+I,A.maxY+I),R=Mc(t.cameraQueryGeometry),K=0,$=this.grid3D.query(R.minX-I,R.minY-I,R.maxX+I,R.maxY+I,function(xt,Tt,zt,Wt){return function(te,ge,ae,xe,se){for(var $e=0,Le=te;$e<Le.length;$e+=1){var me=Le[$e];if(ge<=me.x&&ae<=me.y&&xe>=me.x&&se>=me.y)return!0}var oi=[new le(ge,ae),new le(ge,se),new le(xe,se),new le(xe,ae)];if(te.length>2)for(var Ge=0,vi=oi;Ge<vi.length;Ge+=1)if(Ra(te,vi[Ge]))return!0;for(var be=0;be<te.length-1;be++)if(ll(te[be],te[be+1],oi))return!0;return!1}(t.cameraQueryGeometry,xt-I,Tt-I,zt+I,Wt+I)});K<$.length;K+=1)k.push($[K]);k.sort(Sd);for(var lt,nt={},dt=function(xt){var Tt=k[xt];if(Tt!==lt){lt=Tt;var zt=u.featureIndexArray.get(Tt),Wt=null;u.loadMatchingFeature(nt,zt.bucketIndex,zt.sourceLayerIndex,zt.featureIndex,v,p.layers,p.availableImages,e,i,s,function(te,ge,ae){return Wt||(Wt=An(te)),ge.queryIntersectsFeature(T,te,ae,Wt,u.z,t.transform,f,t.pixelPosMatrix)})}},yt=0;yt<k.length;yt++)dt(yt);return nt},Fs.prototype.loadMatchingFeature=function(t,e,i,s,u,p,f,v,T,I,A){var k=this.bucketLayerIDs[e];if(!p||function(te,ge){for(var ae=0;ae<te.length;ae++)if(ge.indexOf(te[ae])>=0)return!0;return!1}(p,k)){var R=this.sourceLayerCoder.decode(i),U=this.vtLayers[R].feature(s);if(u.needGeometry){var K=Kn(U,!0);if(!u.filter(new ri(this.tileID.overscaledZ),K,this.tileID.canonical))return}else if(!u.filter(new ri(this.tileID.overscaledZ),U))return;for(var $=this.getId(U,R),lt=0;lt<k.length;lt++){var nt=k[lt];if(!(p&&p.indexOf(nt)<0)){var dt=v[nt];if(dt){var yt={};void 0!==$&&I&&(yt=I.getState(dt.sourceLayer||"_geojsonTileLayer",$));var xt=je({},T[nt]);xt.paint=kc(xt.paint,dt.paint,U,yt,f),xt.layout=kc(xt.layout,dt.layout,U,yt,f);var Tt=!A||A(U,dt,yt);if(Tt){var zt=new Gu(U,this.z,this.x,this.y,$);zt.layer=xt;var Wt=t[nt];void 0===Wt&&(Wt=t[nt]=[]),Wt.push({featureIndex:s,feature:zt,intersectionZ:Tt})}}}}}},Fs.prototype.lookupSymbolFeatures=function(t,e,i,s,u,p,f,v){var T={};this.loadVTLayers();for(var I=C(u),A=0,k=t;A<k.length;A+=1)this.loadMatchingFeature(T,i,s,k[A],I,p,f,v,e);return T},Fs.prototype.hasLayer=function(t){for(var e=0,i=this.bucketLayerIDs;e<i.length;e+=1)for(var s=0,u=i[e];s<u.length;s+=1)if(t===u[s])return!0;return!1},Fs.prototype.getId=function(t,e){var i=t.id;return this.promoteId&&"boolean"==typeof(i=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(i=Number(i)),i},qt("FeatureIndex",Fs,{omit:["rawTileData","sourceLayerCoder"]});var Ur=function(t,e){this.tileID=t,this.uid=Pi(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ur.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<Zr.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Ur.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Ur.prototype.loadVectorData=function(t,e,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var s in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(I,A){var k={};if(!A)return k;for(var R=function(){var $=K[U],lt=$.layerIds.map(function(yt){return A.getLayer(yt)}).filter(Boolean);if(0!==lt.length){$.layers=lt,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map(function(yt){return lt.filter(function(xt){return xt.id===yt})[0]}));for(var nt=0,dt=lt;nt<dt.length;nt+=1)k[dt[nt].id]=$}},U=0,K=I;U<K.length;U+=1)R();return k}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var u=this.buckets[s];if(u instanceof Wi){if(this.hasSymbolBuckets=!0,!i)break;u.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var p in this.buckets){var f=this.buckets[p];if(f instanceof Wi&&f.hasRTLText){this.hasRTLText=!0,Po.isLoading()||Po.isLoaded()||"deferred"!==nl()||No();break}}for(var v in this.queryPadding=0,this.buckets){var T=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(v).queryRadius(T))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new a},Ur.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ur.prototype.getBucket=function(t){return this.buckets[t.id]},Ur.prototype.upload=function(t){for(var e in this.buckets){var i=this.buckets[e];i.uploadPending()&&i.upload(t)}var s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new cl(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new cl(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)},Ur.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Ur.prototype.queryRenderedFeatures=function(t,e,i,s,u,p,f,v,T,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:s,cameraQueryGeometry:u,scale:p,tileSize:this.tileSize,pixelPosMatrix:I,transform:v,params:f,queryPadding:this.queryPadding*T},t,e,i):{}},Ur.prototype.querySourceFeatures=function(t,e){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var s=i.loadVTLayers(),u=e?e.sourceLayer:"",p=s._geojsonTileLayer||s[u];if(p)for(var f=C(e&&e.filter),v=this.tileID.canonical,T=v.z,I=v.x,A=v.y,k={z:T,x:I,y:A},R=0;R<p.length;R++){var U=p.feature(R);if(f.needGeometry){var K=Kn(U,!0);if(!f.filter(new ri(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!f.filter(new ri(this.tileID.overscaledZ),U))continue;var $=i.getId(U,u),lt=new Gu(U,T,I,A,$);lt.tile=k,t.push(lt)}}},Ur.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Ur.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ur.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var i=Wo(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var s=Date.now(),u=!1;if(this.expirationTime>s)u=!1;else if(e)if(this.expirationTime<e)u=!0;else{var p=this.expirationTime-e;p?this.expirationTime=s+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ur.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Ur.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var i=this.latestFeatureIndex.loadVTLayers();for(var s in this.buckets)if(e.style.hasLayer(s)){var u=this.buckets[s],p=u.layers[0].sourceLayer||"_geojsonTileLayer",f=i[p],v=t[p];if(f&&v&&0!==Object.keys(v).length){u.update(v,f,this.imageAtlas&&this.imageAtlas.patternPositions||{});var T=e&&e.style&&e.style.getLayer(s);T&&(this.queryPadding=Math.max(this.queryPadding,T.queryRadius(u)))}}}},Ur.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Ur.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Zr.now()},Ur.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ur.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=Zr.now()+t},Ur.prototype.setDependencies=function(t,e){for(var i={},s=0,u=e;s<u.length;s+=1)i[u[s]]=!0;this.dependencies[t]=i},Ur.prototype.hasDependency=function(t,e){for(var i=0,s=t;i<s.length;i+=1){var u=this.dependencies[s[i]];if(u)for(var p=0,f=e;p<f.length;p+=1)if(u[f[p]])return!0}return!1};var $s=Zt.performance,Dc=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},$s.mark(this._marks.start)};Dc.prototype.finish=function(){$s.mark(this._marks.end);var t=$s.getEntriesByName(this._marks.measure);return 0===t.length&&($s.measure(this._marks.measure,this._marks.start,this._marks.end),t=$s.getEntriesByName(this._marks.measure),$s.clearMarks(this._marks.start),$s.clearMarks(this._marks.end),$s.clearMeasures(this._marks.measure)),t},c.Actor=Bl,c.AlphaImage=hl,c.CanonicalTileID=dl,c.CollisionBoxArray=a,c.Color=si,c.DEMData=Rs,c.DataConstantProperty=ye,c.DictionaryCoder=qu,c.EXTENT=8192,c.ErrorEvent=ot,c.EvaluationParameters=ri,c.Event=J,c.Evented=ut,c.FeatureIndex=Fs,c.FillBucket=Qa,c.FillExtrusionBucket=ts,c.ImageAtlas=hu,c.ImagePosition=Bu,c.LineBucket=Lo,c.LngLat=fn,c.LngLatBounds=pr,c.MercatorCoordinate=pl,c.ONE_EM=24,c.OverscaledTileID=dr,c.Point=le,c.Point$1=le,c.Properties=Kr,c.Protobuf=Mu,c.RGBAImage=qo,c.RequestManager=xn,c.RequestPerformance=Dc,c.ResourceType=fo,c.SegmentVector=V,c.SourceFeatureState=Ol,c.StructArrayLayout1ui2=eu,c.StructArrayLayout2f1f2i16=Ms,c.StructArrayLayout2i4=ks,c.StructArrayLayout3ui6=ps,c.StructArrayLayout4i8=Yl,c.SymbolBucket=Wi,c.Texture=cl,c.Tile=Ur,c.Transitionable=hr,c.Uniform1f=Yt,c.Uniform1i=Rt,c.Uniform2f=Xt,c.Uniform3f=ue,c.Uniform4f=ve,c.UniformColor=Se,c.UniformMatrix4f=Ei,c.UnwrappedTileID=zc,c.ValidationError=et,c.WritingMode=va,c.ZoomHistory=Pn,c.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},c.addDynamicAttributes=Th,c.asyncAll=function(t,e,i){if(!t.length)return i(null,[]);var s=t.length,u=new Array(t.length),p=null;t.forEach(function(f,v){e(f,function(T,I){T&&(p=T),u[v]=I,0==--s&&i(p,u)})})},c.bezier=tn,c.bindAll=bi,c.browser=Zr,c.cacheEntryPossiblyAdded=function(t){++qn>Pe&&(t.getActor().send("enforceCacheSizeLimit",he),qn=0)},c.clamp=jn,c.clearTileCache=function(t){var e=Zt.caches.delete("mapbox-tiles");t&&e.catch(t).then(function(){return t()})},c.clipLine=mc,c.clone=function(t){var e=new Oi(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},c.clone$1=fr,c.clone$2=function(t){var e=new Oi(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},c.collisionCircleLayout=qp,c.config=_i,c.create=function(){var t=new Oi(16);return Oi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},c.create$1=function(){var t=new Oi(9);return Oi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},c.create$2=function(){var t=new Oi(4);return Oi!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},c.createCommonjsModule=mi,c.createExpression=Xa,c.createLayout=Rr,c.createStyleLayer=function(t){return"custom"===t.type?new wd(t):new Td[t.type](t)},c.cross=function(t,e,i){var s=e[0],u=e[1],p=e[2],f=i[0],v=i[1],T=i[2];return t[0]=u*T-p*v,t[1]=p*f-s*T,t[2]=s*v-u*f,t},c.deepEqual=function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(var s=0;s<e.length;s++)if(!t(e[s],i[s]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==i){if("object"!=typeof i||Object.keys(e).length!==Object.keys(i).length)return!1;for(var u in e)if(!t(e[u],i[u]))return!1;return!0}return e===i},c.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},c.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},c.ease=Ee,c.emitValidationErrors=ji,c.endsWith=Ln,c.enforceCacheSizeLimit=function(t){ui(),S&&S.then(function(e){e.keys().then(function(i){for(var s=0;s<i.length-t;s++)e.delete(i[s])})})},c.evaluateSizeForFeature=uc,c.evaluateSizeForZoom=hc,c.evaluateVariableOffset=gc,c.evented=il,c.extend=je,c.featureFilter=C,c.filterObject=on,c.fromRotation=function(t,e){var i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=-i,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},c.getAnchorAlignment=vh,c.getAnchorJustification=wh,c.getArrayBuffer=lr,c.getImage=B,c.getJSON=function(t,e){return ko(je(t,{type:"json"}),e)},c.getRTLTextPluginStatus=nl,c.getReferrer=sr,c.getVideo=function(t,e){var i,s,u=Zt.document.createElement("video");u.muted=!0,u.onloadstart=function(){e(null,u)};for(var p=0;p<t.length;p++){var f=Zt.document.createElement("source");i=t[p],s=void 0,(s=Zt.document.createElement("a")).href=i,(s.protocol!==Zt.document.location.protocol||s.host!==Zt.document.location.host)&&(u.crossOrigin="Anonymous"),f.src=t[p],u.appendChild(f)}return{cancel:function(){}}},c.identity=na,c.invert=function(t,e){var i=e[0],s=e[1],u=e[2],p=e[3],f=e[4],v=e[5],T=e[6],I=e[7],A=e[8],k=e[9],R=e[10],U=e[11],K=e[12],$=e[13],lt=e[14],nt=e[15],dt=i*v-s*f,yt=i*T-u*f,xt=i*I-p*f,Tt=s*T-u*v,zt=s*I-p*v,Wt=u*I-p*T,te=A*$-k*K,ge=A*lt-R*K,ae=A*nt-U*K,xe=k*lt-R*$,se=k*nt-U*$,$e=R*nt-U*lt,Le=dt*$e-yt*se+xt*xe+Tt*ae-zt*ge+Wt*te;return Le?(t[0]=(v*$e-T*se+I*xe)*(Le=1/Le),t[1]=(u*se-s*$e-p*xe)*Le,t[2]=($*Wt-lt*zt+nt*Tt)*Le,t[3]=(R*zt-k*Wt-U*Tt)*Le,t[4]=(T*ae-f*$e-I*ge)*Le,t[5]=(i*$e-u*ae+p*ge)*Le,t[6]=(lt*xt-K*Wt-nt*yt)*Le,t[7]=(A*Wt-R*xt+U*yt)*Le,t[8]=(f*se-v*ae+I*te)*Le,t[9]=(s*ae-i*se-p*te)*Le,t[10]=(K*zt-$*xt+nt*dt)*Le,t[11]=(k*xt-A*zt-U*dt)*Le,t[12]=(v*ge-f*xe-T*te)*Le,t[13]=(i*xe-s*ge+u*te)*Le,t[14]=($*yt-K*Tt-lt*dt)*Le,t[15]=(A*Tt-k*yt+R*dt)*Le,t):null},c.isChar=$t,c.isMapboxURL=un,c.keysDifference=function(t,e){var i=[];for(var s in t)s in e||i.push(s);return i},c.makeRequest=ko,c.mapObject=Ni,c.mercatorXfromLng=Ac,c.mercatorYfromLat=Cc,c.mercatorZfromAltitude=Lc,c.mul=sh,c.multiply=Co,c.mvt=Il,c.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},c.normalize=function(t,e){var i=e[0],s=e[1],u=e[2],p=i*i+s*s+u*u;return p>0&&(p=1/Math.sqrt(p)),t[0]=e[0]*p,t[1]=e[1]*p,t[2]=e[2]*p,t},c.number=Ki,c.offscreenCanvasSupported=Gn,c.ortho=function(t,e,i,s,u,p,f){var v=1/(e-i),T=1/(s-u),I=1/(p-f);return t[0]=-2*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*T,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*I,t[11]=0,t[12]=(e+i)*v,t[13]=(u+s)*T,t[14]=(f+p)*I,t[15]=1,t},c.parseGlyphPBF=function(t){return new Mu(t).readFields(ed,[])},c.pbf=Mu,c.performSymbolLayout=function(t,e,i,s,u,p,f){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var v=t.layers[0].layout,T=t.layers[0]._unevaluatedLayout._values,I={};if("composite"===t.textSizeData.kind){var A=t.textSizeData,k=A.maxZoom;I.compositeTextSizes=[T["text-size"].possiblyEvaluate(new ri(A.minZoom),f),T["text-size"].possiblyEvaluate(new ri(k),f)]}if("composite"===t.iconSizeData.kind){var R=t.iconSizeData,U=R.maxZoom;I.compositeIconSizes=[T["icon-size"].possiblyEvaluate(new ri(R.minZoom),f),T["icon-size"].possiblyEvaluate(new ri(U),f)]}I.layoutTextSize=T["text-size"].possiblyEvaluate(new ri(t.zoom+1),f),I.layoutIconSize=T["icon-size"].possiblyEvaluate(new ri(t.zoom+1),f),I.textMaxSize=T["text-size"].possiblyEvaluate(new ri(18));for(var K=24*v.get("text-line-height"),$="map"===v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement"),lt=v.get("text-keep-upright"),nt=v.get("text-size"),dt=function(){var Tt=xt[yt],zt=v.get("text-font").evaluate(Tt,{},f).join(","),Wt=nt.evaluate(Tt,{},f),te=I.layoutTextSize.evaluate(Tt,{},f),ge=I.layoutIconSize.evaluate(Tt,{},f),ae={horizontal:{},vertical:void 0},xe=Tt.text,se=[0,0];if(xe){var $e=xe.toString(),Le=24*v.get("text-letter-spacing").evaluate(Tt,{},f),me=function(pi){for(var Ji=0,qi=pi;Ji<qi.length;Ji+=1)if(Ii=qi[Ji].charCodeAt(0),$t.Arabic(Ii)||$t["Arabic Supplement"](Ii)||$t["Arabic Extended-A"](Ii)||$t["Arabic Presentation Forms-A"](Ii)||$t["Arabic Presentation Forms-B"](Ii))return!1;var Ii;return!0}($e)?Le:0,oi=v.get("text-anchor").evaluate(Tt,{},f),Ge=v.get("text-variable-anchor");if(!Ge){var vi=v.get("text-radial-offset").evaluate(Tt,{},f);se=vi?gc(oi,[24*vi,bh]):v.get("text-offset").evaluate(Tt,{},f).map(function(pi){return 24*pi})}var be=$?"center":v.get("text-justify").evaluate(Tt,{},f),ki=v.get("symbol-placement"),mn="point"===ki?24*v.get("text-max-width").evaluate(Tt,{},f):0,Un=function(){t.allowVerticalPlacement&&ea($e)&&(ae.vertical=Ou(xe,e,i,u,zt,mn,K,oi,"left",me,se,va.vertical,!0,ki,te,Wt))};if(!$&&Ge){for(var Cn="auto"===be?Ge.map(function(pi){return wh(pi)}):[be],_n=!1,Nn=0;Nn<Cn.length;Nn++){var Pr=Cn[Nn];if(!ae.horizontal[Pr])if(_n)ae.horizontal[Pr]=ae.horizontal[0];else{var Ar=Ou(xe,e,i,u,zt,mn,K,"center",Pr,me,se,va.horizontal,!1,ki,te,Wt);Ar&&(ae.horizontal[Pr]=Ar,_n=1===Ar.positionedLines.length)}}Un()}else{"auto"===be&&(be=wh(oi));var wo=Ou(xe,e,i,u,zt,mn,K,oi,be,me,se,va.horizontal,!1,ki,te,Wt);wo&&(ae.horizontal[be]=wo),Un(),ea($e)&&$&&lt&&(ae.vertical=Ou(xe,e,i,u,zt,mn,K,oi,be,me,se,va.vertical,!1,ki,te,Wt))}}var pi,Ji,Ii,zo,lo,Nr=void 0,To=!1;if(Tt.icon&&Tt.icon.name){var Jn=s[Tt.icon.name];Jn&&(pi=u[Tt.icon.name],Ji=v.get("icon-offset").evaluate(Tt,{},f),Ii=vh(v.get("icon-anchor").evaluate(Tt,{},f)),Nr={image:pi,top:lo=Ji[1]-pi.displaySize[1]*Ii.verticalAlign,bottom:lo+pi.displaySize[1],left:zo=Ji[0]-pi.displaySize[0]*Ii.horizontalAlign,right:zo+pi.displaySize[0]},To=Jn.sdf,void 0===t.sdfIcons?t.sdfIcons=Jn.sdf:t.sdfIcons!==Jn.sdf&&Ye("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Jn.pixelRatio!==t.pixelRatio||0!==v.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var jr=xc(ae.horizontal)||ae.vertical;t.iconsInText=!!jr&&jr.iconsInText,(jr||Nr)&&function(pi,Ji,qi,Ii,zo,lo,sn,rr,uo,Mi,gs){var xa=lo.textMaxSize.evaluate(Ji,{});void 0===xa&&(xa=sn);var vs,Yn=pi.layers[0].layout,xs=Yn.get("icon-offset").evaluate(Ji,{},gs),Ua=xc(qi.horizontal),Rl=sn/24,fl=pi.tilePixelRatio*Rl,Fl=pi.tilePixelRatio*xa/24,Us=pi.tilePixelRatio*rr,Ul=pi.tilePixelRatio*Yn.get("symbol-spacing"),Wu=Yn.get("text-padding")*pi.tilePixelRatio,Nl=Yn.get("icon-padding")*pi.tilePixelRatio,du=Yn.get("text-max-angle")/180*Math.PI,Hu="map"===Yn.get("text-rotation-alignment")&&"point"!==Yn.get("symbol-placement"),Xu="map"===Yn.get("icon-rotation-alignment")&&"point"!==Yn.get("symbol-placement"),Ns=Yn.get("symbol-placement"),fu=Ul/2,jl=Yn.get("icon-text-fit");Ii&&"none"!==jl&&(pi.allowVerticalPlacement&&qi.vertical&&(vs=lc(Ii,qi.vertical,jl,Yn.get("icon-text-fit-padding"),xs,Rl)),Ua&&(Ii=lc(Ii,Ua,jl,Yn.get("icon-text-fit-padding"),xs,Rl)));var Qs=function(Ed,wu){wu.x<0||wu.x>=8192||wu.y<0||wu.y>=8192||function($n,es,Id,tl,zh,Rc,th,bs,eh,Tu,ih,nh,kh,Fc,Su,Uc,Nc,jc,Vc,Zc,ba,rh,qc,ws,Pd){var Gc,_l,Wl,Hl,Xl,Kl=$n.addToLineVertexArray(es,Id),Wc=0,Hc=0,Xc=0,Kc=0,Mh=-1,Dh=-1,js={},Jc=X(""),Bh=0,Oh=0;if(void 0===bs._unevaluatedLayout.getValue("text-radial-offset")?(Bh=(Gc=bs.layout.get("text-offset").evaluate(ba,{},ws).map(function(Iu){return 24*Iu}))[0],Oh=Gc[1]):(Bh=24*bs.layout.get("text-radial-offset").evaluate(ba,{},ws),Oh=bh),$n.allowVerticalPlacement&&tl.vertical){var Yc=bs.layout.get("text-rotate").evaluate(ba,{},ws)+90;Hl=new ju(eh,es,Tu,ih,nh,tl.vertical,kh,Fc,Su,Yc),th&&(Xl=new ju(eh,es,Tu,ih,nh,th,Nc,jc,Su,Yc))}if(zh){var Rh=bs.layout.get("icon-rotate").evaluate(ba,{}),$c="none"!==bs.layout.get("icon-text-fit"),Qc=_c(zh,Rh,qc,$c),Fh=th?_c(th,Rh,qc,$c):void 0;Wl=new ju(eh,es,Tu,ih,nh,zh,Nc,jc,!1,Rh),Wc=4*Qc.length;var tp=$n.iconSizeData,Eu=null;"source"===tp.kind?(Eu=[128*bs.layout.get("icon-size").evaluate(ba,{})])[0]>32640&&Ye($n.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===tp.kind&&((Eu=[128*rh.compositeIconSizes[0].evaluate(ba,{},ws),128*rh.compositeIconSizes[1].evaluate(ba,{},ws)])[0]>32640||Eu[1]>32640)&&Ye($n.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),$n.addSymbols($n.icon,Qc,Eu,Zc,Vc,ba,!1,es,Kl.lineStartIndex,Kl.lineLength,-1,ws),Mh=$n.icon.placedSymbolArray.length-1,Fh&&(Hc=4*Fh.length,$n.addSymbols($n.icon,Fh,Eu,Zc,Vc,ba,va.vertical,es,Kl.lineStartIndex,Kl.lineLength,-1,ws),Dh=$n.icon.placedSymbolArray.length-1)}for(var ep in tl.horizontal){var oh=tl.horizontal[ep];if(!_l){Jc=X(oh.text);var Ad=bs.layout.get("text-rotate").evaluate(ba,{},ws);_l=new ju(eh,es,Tu,ih,nh,oh,kh,Fc,Su,Ad)}var ip=1===oh.positionedLines.length;if(Xc+=vc($n,es,oh,Rc,bs,Su,ba,Uc,Kl,tl.vertical?va.horizontal:va.horizontalOnly,ip?Object.keys(tl.horizontal):[ep],js,Mh,rh,ws),ip)break}tl.vertical&&(Kc+=vc($n,es,tl.vertical,Rc,bs,Su,ba,Uc,Kl,va.vertical,["vertical"],js,Dh,rh,ws));var Cd=_l?_l.boxStartIndex:$n.collisionBoxArray.length,Ld=_l?_l.boxEndIndex:$n.collisionBoxArray.length,zd=Hl?Hl.boxStartIndex:$n.collisionBoxArray.length,kd=Hl?Hl.boxEndIndex:$n.collisionBoxArray.length,Md=Wl?Wl.boxStartIndex:$n.collisionBoxArray.length,Dd=Wl?Wl.boxEndIndex:$n.collisionBoxArray.length,Bd=Xl?Xl.boxStartIndex:$n.collisionBoxArray.length,Od=Xl?Xl.boxEndIndex:$n.collisionBoxArray.length,Ts=-1,ah=function(Iu,rp){return Iu&&Iu.circleDiameter?Math.max(Iu.circleDiameter,rp):rp};Ts=ah(_l,Ts),Ts=ah(Hl,Ts),Ts=ah(Wl,Ts);var np=(Ts=ah(Xl,Ts))>-1?1:0;np&&(Ts*=Pd/24),$n.glyphOffsetArray.length>=Wi.MAX_GLYPHS&&Ye("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==ba.sortKey&&$n.addToSortKeyRanges($n.symbolInstances.length,ba.sortKey),$n.symbolInstances.emplaceBack(es.x,es.y,js.right>=0?js.right:-1,js.center>=0?js.center:-1,js.left>=0?js.left:-1,js.vertical||-1,Mh,Dh,Jc,Cd,Ld,zd,kd,Md,Dd,Bd,Od,Tu,Xc,Kc,Wc,Hc,np,0,kh,Bh,Oh,Ts)}(pi,wu,Ed,qi,Ii,zo,vs,pi.layers[0],pi.collisionBoxArray,Ji.index,Ji.sourceLayerIndex,pi.index,fl,Wu,Hu,uo,Us,Nl,Xu,xs,Ji,lo,Mi,gs,sn)};if("line"===Ns)for(var Vl=0,Ku=mc(Ji.geometry,0,0,8192,8192);Vl<Ku.length;Vl+=1)for(var Ju=Ku[Vl],mu=0,_u=ld(Ju,Ul,du,qi.vertical||Ua,Ii,24,Fl,pi.overscaling,8192);mu<_u.length;mu+=1){var Yu=_u[mu];Ua&&pd(pi,Ua.text,fu,Yu)||Qs(Ju,Yu)}else if("line-center"===Ns)for(var yu=0,gu=Ji.geometry;yu<gu.length;yu+=1){var vu=gu[yu];if(vu.length>1){var $u=sd(vu,du,qi.vertical||Ua,Ii,24,Fl);$u&&Qs(vu,$u)}}else if("Polygon"===Ji.type)for(var Zl=0,Qu=fh(Ji.geometry,0);Zl<Qu.length;Zl+=1){var ql=Qu[Zl],xu=hd(ql,16);Qs(ql[0],new Ll(xu.x,xu.y,0))}else if("LineString"===Ji.type)for(var ml=0,bu=Ji.geometry;ml<bu.length;ml+=1){var Gl=bu[ml];Qs(Gl,new Ll(Gl[0].x,Gl[0].y,0))}else if("Point"===Ji.type)for(var Ah=0,Bc=Ji.geometry;Ah<Bc.length;Ah+=1)for(var Ch=0,Oc=Bc[Ah];Ch<Oc.length;Ch+=1){var Lh=Oc[Ch];Qs([Lh],new Ll(Lh.x,Lh.y,0))}}(t,Tt,ae,Nr,s,I,te,ge,se,To,f)},yt=0,xt=t.features;yt<xt.length;yt+=1)dt();p&&t.generateCollisionDebugBuffers()},c.perspective=function(t,e,i,s,u){var p,f=1/Math.tan(e/2);return t[0]=f/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=u&&u!==1/0?(t[10]=(u+s)*(p=1/(s-u)),t[14]=2*u*s*p):(t[10]=-1,t[14]=-2*s),t},c.pick=function(t,e){for(var i={},s=0;s<e.length;s++){var u=e[s];u in t&&(i[u]=t[u])}return i},c.plugin=Po,c.polygonIntersectsPolygon=ms,c.postMapLoadEvent=Qt,c.postTurnstileEvent=pt,c.potpack=rc,c.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],c.register=qt,c.registerForPluginStateChange=function(t){return t({pluginStatus:dn,pluginURL:Uo}),il.on("pluginStateChange",t),t},c.renderColorRamp=Uh,c.rotate=function(t,e,i){var s=e[0],u=e[1],p=e[2],f=e[3],v=Math.sin(i),T=Math.cos(i);return t[0]=s*T+p*v,t[1]=u*T+f*v,t[2]=s*-v+p*T,t[3]=u*-v+f*T,t},c.rotateX=function(t,e,i){var s=Math.sin(i),u=Math.cos(i),p=e[4],f=e[5],v=e[6],T=e[7],I=e[8],A=e[9],k=e[10],R=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=p*u+I*s,t[5]=f*u+A*s,t[6]=v*u+k*s,t[7]=T*u+R*s,t[8]=I*u-p*s,t[9]=A*u-f*s,t[10]=k*u-v*s,t[11]=R*u-T*s,t},c.rotateZ=function(t,e,i){var s=Math.sin(i),u=Math.cos(i),p=e[0],f=e[1],v=e[2],T=e[3],I=e[4],A=e[5],k=e[6],R=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=p*u+I*s,t[1]=f*u+A*s,t[2]=v*u+k*s,t[3]=T*u+R*s,t[4]=I*u-p*s,t[5]=A*u-f*s,t[6]=k*u-v*s,t[7]=R*u-T*s,t},c.scale=function(t,e,i){var s=i[0],u=i[1],p=i[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*u,t[5]=e[5]*u,t[6]=e[6]*u,t[7]=e[7]*u,t[8]=e[8]*p,t[9]=e[9]*p,t[10]=e[10]*p,t[11]=e[11]*p,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},c.scale$1=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},c.scale$2=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},c.setCacheLimits=function(t,e){he=t,Pe=e},c.setRTLTextPlugin=function(t,e,i){if(void 0===i&&(i=!1),"deferred"===dn||"loading"===dn||"loaded"===dn)throw new Error("setRTLTextPlugin cannot be called multiple times.");Uo=Zr.resolveURL(t),dn="deferred",Sr=e,_a(),i||No()},c.sphericalToCartesian=function(t){var e=t[0],i=t[1],s=t[2];return i+=90,i*=Math.PI/180,s*=Math.PI/180,{x:e*Math.cos(i)*Math.sin(s),y:e*Math.sin(i)*Math.sin(s),z:e*Math.cos(s)}},c.sqrLen=function(t){var e=t[0],i=t[1];return e*e+i*i},c.styleSpec=N,c.sub=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},c.symbolSize=ad,c.transformMat3=function(t,e,i){var s=e[0],u=e[1],p=e[2];return t[0]=s*i[0]+u*i[3]+p*i[6],t[1]=s*i[1]+u*i[4]+p*i[7],t[2]=s*i[2]+u*i[5]+p*i[8],t},c.transformMat4=wl,c.translate=function(t,e,i){var s,u,p,f,v,T,I,A,k,R,U,K,$=i[0],lt=i[1],nt=i[2];return e===t?(t[12]=e[0]*$+e[4]*lt+e[8]*nt+e[12],t[13]=e[1]*$+e[5]*lt+e[9]*nt+e[13],t[14]=e[2]*$+e[6]*lt+e[10]*nt+e[14],t[15]=e[3]*$+e[7]*lt+e[11]*nt+e[15]):(u=e[1],p=e[2],f=e[3],v=e[4],T=e[5],I=e[6],A=e[7],k=e[8],R=e[9],U=e[10],K=e[11],t[0]=s=e[0],t[1]=u,t[2]=p,t[3]=f,t[4]=v,t[5]=T,t[6]=I,t[7]=A,t[8]=k,t[9]=R,t[10]=U,t[11]=K,t[12]=s*$+v*lt+k*nt+e[12],t[13]=u*$+T*lt+R*nt+e[13],t[14]=p*$+I*lt+U*nt+e[14],t[15]=f*$+A*lt+K*nt+e[15]),t},c.triggerPluginCompletionEvent=hs,c.uniqueId=Pi,c.validateCustomStyleLayer=function(t){var e=[],i=t.id;return void 0===i&&e.push({message:"layers."+i+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+i+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),e},c.validateLight=Ze,c.validateStyle=Ue,c.values=function(t){var e=[];for(var i in t)e.push(t[i]);return e},c.vectorTile=Il,c.version="1.13.1",c.warnOnce=Ye,c.webpSupported=or,c.window=Zt,c.wrap=ti}),gn(0,function(c){function mi(z){var B=typeof z;if("number"===B||"boolean"===B||"string"===B||null==z)return JSON.stringify(z);if(Array.isArray(z)){for(var F="[",H=0,J=z;H<J.length;H+=1)F+=mi(J[H])+",";return F+"]"}for(var ot=Object.keys(z).sort(),ut="{",N=0;N<ot.length;N++)ut+=JSON.stringify(ot[N])+":"+mi(z[ot[N]])+",";return ut+"}"}function Mt(z){for(var B="",F=0,H=c.refProperties;F<H.length;F+=1)B+="/"+mi(z[H[F]]);return B}var Me=function(z){this.keyCache={},z&&this.replace(z)};Me.prototype.replace=function(z){this._layerConfigs={},this._layers={},this.update(z,[])},Me.prototype.update=function(z,B){for(var F=this,H=0,J=z;H<J.length;H+=1){var ot=J[H];this._layerConfigs[ot.id]=ot;var ut=this._layers[ot.id]=c.createStyleLayer(ot);ut._featureFilter=c.featureFilter(ut.filter),this.keyCache[ot.id]&&delete this.keyCache[ot.id]}for(var N=0,et=B;N<et.length;N+=1){var mt=et[N];delete this.keyCache[mt],delete this._layerConfigs[mt],delete this._layers[mt]}this.familiesBySource={};for(var Dt=0,Nt=function(Kt,Jt){for(var re={},Vt=0;Vt<Kt.length;Vt++){var Ke=Jt&&Jt[Kt[Vt].id]||Mt(Kt[Vt]);Jt&&(Jt[Kt[Vt].id]=Ke);var fi=re[Ke];fi||(fi=re[Ke]=[]),fi.push(Kt[Vt])}var Ae=[];for(var hi in re)Ae.push(re[hi]);return Ae}(c.values(this._layerConfigs),this.keyCache);Dt<Nt.length;Dt+=1){var bt=Nt[Dt].map(function(Kt){return F._layers[Kt.id]}),Bt=bt[0];if("none"!==Bt.visibility){var jt=Bt.source||"",Gt=this.familiesBySource[jt];Gt||(Gt=this.familiesBySource[jt]={});var St=Bt.sourceLayer||"_geojsonTileLayer",ie=Gt[St];ie||(ie=Gt[St]=[]),ie.push(bt)}}};var le=function(z){var B={},F=[];for(var H in z){var J=z[H],ot=B[H]={};for(var ut in J){var N=J[+ut];if(N&&0!==N.bitmap.width&&0!==N.bitmap.height){var et={x:0,y:0,w:N.bitmap.width+2,h:N.bitmap.height+2};F.push(et),ot[ut]={rect:et,metrics:N.metrics}}}}var mt=c.potpack(F),Dt=new c.AlphaImage({width:mt.w||1,height:mt.h||1});for(var Nt in z){var bt=z[Nt];for(var Bt in bt){var jt=bt[+Bt];if(jt&&0!==jt.bitmap.width&&0!==jt.bitmap.height){var Gt=B[Nt][Bt].rect;c.AlphaImage.copy(jt.bitmap,Dt,{x:0,y:0},{x:Gt.x+1,y:Gt.y+1},jt.bitmap)}}}this.image=Dt,this.positions=B};c.register("GlyphAtlas",le);var Qi=function(z){this.tileID=new c.OverscaledTileID(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId};function Zt(z,B,F){for(var H=new c.EvaluationParameters(B),J=0,ot=z;J<ot.length;J+=1)ot[J].recalculate(H,F)}function ln(z,B){var F=c.getArrayBuffer(z.request,function(H,J,ot,ut){H?B(H):J&&B(null,{vectorTile:new c.vectorTile.VectorTile(new c.pbf(J)),rawData:J,cacheControl:ot,expires:ut})});return function(){F.cancel(),B()}}Qi.prototype.parse=function(z,B,F,H,J){var ot=this;this.status="parsing",this.data=z,this.collisionBoxArray=new c.CollisionBoxArray;var ut=new c.DictionaryCoder(Object.keys(z.layers).sort()),N=new c.FeatureIndex(this.tileID,this.promoteId);N.bucketLayerIDs=[];var et,mt,Dt,Nt,bt={},Bt={featureIndex:N,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:F},jt=B.familiesBySource[this.source];for(var Gt in jt){var St=z.layers[Gt];if(St){1===St.version&&c.warnOnce('Vector tile source "'+this.source+'" layer "'+Gt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var ie=ut.encode(Gt),Kt=[],Jt=0;Jt<St.length;Jt++){var re=St.feature(Jt),Vt=N.getId(re,Gt);Kt.push({feature:re,id:Vt,index:Jt,sourceLayerIndex:ie})}for(var Ke=0,fi=jt[Gt];Ke<fi.length;Ke+=1){var Ae=fi[Ke],hi=Ae[0];hi.minzoom&&this.zoom<Math.floor(hi.minzoom)||hi.maxzoom&&this.zoom>=hi.maxzoom||"none"!==hi.visibility&&(Zt(Ae,this.zoom,F),(bt[hi.id]=hi.createBucket({index:N.bucketLayerIDs.length,layers:Ae,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ie,sourceID:this.source})).populate(Kt,Bt,this.tileID.canonical),N.bucketLayerIDs.push(Ae.map(function(yi){return yi.id})))}}}var Ne=c.mapObject(Bt.glyphDependencies,function(yi){return Object.keys(yi).map(Number)});Object.keys(Ne).length?H.send("getGlyphs",{uid:this.uid,stacks:Ne},function(yi,He){et||(et=yi,mt=He,Xi.call(ot))}):mt={};var Ti=Object.keys(Bt.iconDependencies);Ti.length?H.send("getImages",{icons:Ti,source:this.source,tileID:this.tileID,type:"icons"},function(yi,He){et||(et=yi,Dt=He,Xi.call(ot))}):Dt={};var ei=Object.keys(Bt.patternDependencies);function Xi(){if(et)return J(et);if(mt&&Dt&&Nt){var yi=new le(mt),He=new c.ImageAtlas(Dt,Nt);for(var si in bt){var Mn=bt[si];Mn instanceof c.SymbolBucket?(Zt(Mn.layers,this.zoom,F),c.performSymbolLayout(Mn,mt,yi.positions,Dt,He.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Mn.hasPattern&&(Mn instanceof c.LineBucket||Mn instanceof c.FillBucket||Mn instanceof c.FillExtrusionBucket)&&(Zt(Mn.layers,this.zoom,F),Mn.addFeatures(Bt,this.tileID.canonical,He.patternPositions))}this.status="done",J(null,{buckets:c.values(bt).filter(function(Ho){return!Ho.isEmpty()}),featureIndex:N,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:yi.image,imageAtlas:He,glyphMap:this.returnDependencies?mt:null,iconMap:this.returnDependencies?Dt:null,glyphPositions:this.returnDependencies?yi.positions:null})}}ei.length?H.send("getImages",{icons:ei,source:this.source,tileID:this.tileID,type:"patterns"},function(yi,He){et||(et=yi,Nt=He,Xi.call(ot))}):Nt={},Xi.call(this)};var tn=function(z,B,F,H){this.actor=z,this.layerIndex=B,this.availableImages=F,this.loadVectorData=H||ln,this.loading={},this.loaded={}};tn.prototype.loadTile=function(z,B){var F=this,H=z.uid;this.loading||(this.loading={});var J=!!(z&&z.request&&z.request.collectResourceTiming)&&new c.RequestPerformance(z.request),ot=this.loading[H]=new Qi(z);ot.abort=this.loadVectorData(z,function(ut,N){if(delete F.loading[H],ut||!N)return ot.status="done",F.loaded[H]=ot,B(ut);var et=N.rawData,mt={};N.expires&&(mt.expires=N.expires),N.cacheControl&&(mt.cacheControl=N.cacheControl);var Dt={};if(J){var Nt=J.finish();Nt&&(Dt.resourceTiming=JSON.parse(JSON.stringify(Nt)))}ot.vectorTile=N.vectorTile,ot.parse(N.vectorTile,F.layerIndex,F.availableImages,F.actor,function(bt,Bt){if(bt||!Bt)return B(bt);B(null,c.extend({rawTileData:et.slice(0)},Bt,mt,Dt))}),F.loaded=F.loaded||{},F.loaded[H]=ot})},tn.prototype.reloadTile=function(z,B){var F=this,H=this.loaded,J=z.uid,ot=this;if(H&&H[J]){var ut=H[J];ut.showCollisionBoxes=z.showCollisionBoxes;var N=function(et,mt){var Dt=ut.reloadCallback;Dt&&(delete ut.reloadCallback,ut.parse(ut.vectorTile,ot.layerIndex,F.availableImages,ot.actor,Dt)),B(et,mt)};"parsing"===ut.status?ut.reloadCallback=N:"done"===ut.status&&(ut.vectorTile?ut.parse(ut.vectorTile,this.layerIndex,this.availableImages,this.actor,N):N())}},tn.prototype.abortTile=function(z,B){var F=this.loading,H=z.uid;F&&F[H]&&F[H].abort&&(F[H].abort(),delete F[H]),B()},tn.prototype.removeTile=function(z,B){var F=this.loaded,H=z.uid;F&&F[H]&&delete F[H],B()};var Ee=c.window.ImageBitmap,jn=function(){this.loaded={}};function ti(z,B){if(0!==z.length){je(z[0],B);for(var F=1;F<z.length;F++)je(z[F],!B)}}function je(z,B){for(var F=0,H=0,J=z.length,ot=J-1;H<J;ot=H++)F+=(z[H][0]-z[ot][0])*(z[ot][1]+z[H][1]);F>=0!=!!B&&z.reverse()}jn.prototype.loadTile=function(z,B){var F=z.uid,H=z.encoding,J=z.rawImageData,ot=Ee&&J instanceof Ee?this.getImageData(J):J,ut=new c.DEMData(F,ot,H);this.loaded=this.loaded||{},this.loaded[F]=ut,B(null,ut)},jn.prototype.getImageData=function(z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(z.width,z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=z.width,this.offscreenCanvas.height=z.height,this.offscreenCanvasContext.drawImage(z,0,0,z.width,z.height);var B=this.offscreenCanvasContext.getImageData(-1,-1,z.width+2,z.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new c.RGBAImage({width:B.width,height:B.height},B.data)},jn.prototype.removeTile=function(z){var B=this.loaded,F=z.uid;B&&B[F]&&delete B[F]};var Ut=c.vectorTile.VectorTileFeature.prototype.toGeoJSON,Pi=function(z){this._feature=z,this.extent=c.EXTENT,this.type=z.type,this.properties=z.tags,"id"in z&&!isNaN(z.id)&&(this.id=parseInt(z.id,10))};Pi.prototype.loadGeometry=function(){if(1===this._feature.type){for(var z=[],B=0,F=this._feature.geometry;B<F.length;B+=1){var H=F[B];z.push([new c.Point$1(H[0],H[1])])}return z}for(var J=[],ot=0,ut=this._feature.geometry;ot<ut.length;ot+=1){for(var N=[],et=0,mt=ut[ot];et<mt.length;et+=1){var Dt=mt[et];N.push(new c.Point$1(Dt[0],Dt[1]))}J.push(N)}return J},Pi.prototype.toGeoJSON=function(z,B,F){return Ut.call(this,z,B,F)};var Ci=function(z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.EXTENT,this.length=z.length,this._features=z};Ci.prototype.feature=function(z){return new Pi(this._features[z])};var We=c.vectorTile.VectorTileFeature,bi=Ln;function Ln(z,B){this.options=B||{},this.features=z,this.length=z.length}function Ni(z,B){this.id="number"==typeof z.id?z.id:void 0,this.type=z.type,this.rawGeometry=1===z.type?[z.geometry]:z.geometry,this.properties=z.tags,this.extent=B||4096}Ln.prototype.feature=function(z){return new Ni(this.features[z],this.options.extent)},Ni.prototype.loadGeometry=function(){var z=this.rawGeometry;this.geometry=[];for(var B=0;B<z.length;B++){for(var F=z[B],H=[],J=0;J<F.length;J++)H.push(new c.Point$1(F[J][0],F[J][1]));this.geometry.push(H)}return this.geometry},Ni.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var z=this.geometry,B=1/0,F=-1/0,H=1/0,J=-1/0,ot=0;ot<z.length;ot++)for(var ut=z[ot],N=0;N<ut.length;N++){var et=ut[N];B=Math.min(B,et.x),F=Math.max(F,et.x),H=Math.min(H,et.y),J=Math.max(J,et.y)}return[B,H,F,J]},Ni.prototype.toGeoJSON=We.prototype.toGeoJSON;var on=zr,fr=bi;function zr(z){var B=new c.pbf;return function(F,H){for(var J in F.layers)H.writeMessage(3,Ye,F.layers[J])}(z,B),B.finish()}function Ye(z,B){var F;B.writeVarintField(15,z.version||1),B.writeStringField(1,z.name||""),B.writeVarintField(5,z.extent||4096);var H={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<z.length;F++)H.feature=z.feature(F),B.writeMessage(2,_e,H);var J=H.keys;for(F=0;F<J.length;F++)B.writeStringField(3,J[F]);var ot=H.values;for(F=0;F<ot.length;F++)B.writeMessage(4,_r,ot[F])}function _e(z,B){var F=z.feature;void 0!==F.id&&B.writeVarintField(1,F.id),B.writeMessage(2,Go,z),B.writeVarintField(3,F.type),B.writeMessage(4,mr,F)}function Go(z,B){var F=z.feature,H=z.keys,J=z.values,ot=z.keycache,ut=z.valuecache;for(var N in F.properties){var et=ot[N];void 0===et&&(H.push(N),ot[N]=et=H.length-1),B.writeVarint(et);var mt=F.properties[N],Dt=typeof mt;"string"!==Dt&&"boolean"!==Dt&&"number"!==Dt&&(mt=JSON.stringify(mt));var Nt=Dt+":"+mt,bt=ut[Nt];void 0===bt&&(J.push(mt),ut[Nt]=bt=J.length-1),B.writeVarint(bt)}}function Vn(z,B){return(B<<3)+(7&z)}function Wo(z){return z<<1^z>>31}function mr(z,B){for(var F=z.loadGeometry(),H=z.type,J=0,ot=0,ut=F.length,N=0;N<ut;N++){var et=F[N],mt=1;1===H&&(mt=et.length),B.writeVarint(Vn(1,mt));for(var Dt=3===H?et.length-1:et.length,Nt=0;Nt<Dt;Nt++){1===Nt&&1!==H&&B.writeVarint(Vn(2,Dt-1));var bt=et[Nt].x-J,Bt=et[Nt].y-ot;B.writeVarint(Wo(bt)),B.writeVarint(Wo(Bt)),J+=bt,ot+=Bt}3===H&&B.writeVarint(Vn(7,1))}}function _r(z,B){var F=typeof z;"string"===F?B.writeStringField(1,z):"boolean"===F?B.writeBooleanField(7,z):"number"===F&&(z%1!=0?B.writeDoubleField(3,z):z<0?B.writeSVarintField(6,z):B.writeVarintField(5,z))}function Zn(z,B,F,H){Tn(z,F,H),Tn(B,2*F,2*H),Tn(B,2*F+1,2*H+1)}function Tn(z,B,F){var H=z[B];z[B]=z[F],z[F]=H}function Qn(z,B,F,H){var J=z-F,ot=B-H;return J*J+ot*ot}on.fromVectorTileJs=zr,on.fromGeojsonVt=function(z,B){B=B||{};var F={};for(var H in z)F[H]=new bi(z[H].features,B),F[H].name=H,F[H].version=B.version,F[H].extent=B.extent;return zr({layers:F})},on.GeoJSONWrapper=fr;var Vr=function(z){return z[0]},Sn=function(z){return z[1]},tr=function(z,B,F,H,J){void 0===B&&(B=Vr),void 0===F&&(F=Sn),void 0===H&&(H=64),void 0===J&&(J=Float64Array),this.nodeSize=H,this.points=z;for(var ot=z.length<65536?Uint16Array:Uint32Array,ut=this.ids=new ot(z.length),N=this.coords=new J(2*z.length),et=0;et<z.length;et++)ut[et]=et,N[2*et]=B(z[et]),N[2*et+1]=F(z[et]);!function mt(Dt,Nt,bt,Bt,jt,Gt){if(!(jt-Bt<=bt)){var St=Bt+jt>>1;(function ie(Kt,Jt,re,Vt,Ke,fi){for(;Ke>Vt;){if(Ke-Vt>600){var Ae=Ke-Vt+1,hi=re-Vt+1,Ne=Math.log(Ae),Ti=.5*Math.exp(2*Ne/3),ei=.5*Math.sqrt(Ne*Ti*(Ae-Ti)/Ae)*(hi-Ae/2<0?-1:1);ie(Kt,Jt,re,Math.max(Vt,Math.floor(re-hi*Ti/Ae+ei)),Math.min(Ke,Math.floor(re+(Ae-hi)*Ti/Ae+ei)),fi)}var Xi=Jt[2*re+fi],yi=Vt,He=Ke;for(Zn(Kt,Jt,Vt,re),Jt[2*Ke+fi]>Xi&&Zn(Kt,Jt,Vt,Ke);yi<He;){for(Zn(Kt,Jt,yi,He),yi++,He--;Jt[2*yi+fi]<Xi;)yi++;for(;Jt[2*He+fi]>Xi;)He--}Jt[2*Vt+fi]===Xi?Zn(Kt,Jt,Vt,He):Zn(Kt,Jt,++He,Ke),He<=re&&(Vt=He+1),re<=He&&(Ke=He-1)}})(Dt,Nt,St,Bt,jt,Gt%2),mt(Dt,Nt,bt,Bt,St-1,Gt+1),mt(Dt,Nt,bt,St+1,jt,Gt+1)}}(ut,N,H,0,ut.length-1,0)};tr.prototype.range=function(z,B,F,H){return function(J,ot,ut,N,et,mt,Dt){for(var Nt,bt,Bt=[0,J.length-1,0],jt=[];Bt.length;){var Gt=Bt.pop(),St=Bt.pop(),ie=Bt.pop();if(St-ie<=Dt)for(var Kt=ie;Kt<=St;Kt++)bt=ot[2*Kt+1],(Nt=ot[2*Kt])>=ut&&Nt<=et&&bt>=N&&bt<=mt&&jt.push(J[Kt]);else{var Jt=Math.floor((ie+St)/2);bt=ot[2*Jt+1],(Nt=ot[2*Jt])>=ut&&Nt<=et&&bt>=N&&bt<=mt&&jt.push(J[Jt]);var re=(Gt+1)%2;(0===Gt?ut<=Nt:N<=bt)&&(Bt.push(ie),Bt.push(Jt-1),Bt.push(re)),(0===Gt?et>=Nt:mt>=bt)&&(Bt.push(Jt+1),Bt.push(St),Bt.push(re))}}return jt}(this.ids,this.coords,z,B,F,H,this.nodeSize)},tr.prototype.within=function(z,B,F){return function(H,J,ot,ut,N,et){for(var mt=[0,H.length-1,0],Dt=[],Nt=N*N;mt.length;){var bt=mt.pop(),Bt=mt.pop(),jt=mt.pop();if(Bt-jt<=et)for(var Gt=jt;Gt<=Bt;Gt++)Qn(J[2*Gt],J[2*Gt+1],ot,ut)<=Nt&&Dt.push(H[Gt]);else{var St=Math.floor((jt+Bt)/2),ie=J[2*St],Kt=J[2*St+1];Qn(ie,Kt,ot,ut)<=Nt&&Dt.push(H[St]);var Jt=(bt+1)%2;(0===bt?ot-N<=ie:ut-N<=Kt)&&(mt.push(jt),mt.push(St-1),mt.push(Jt)),(0===bt?ot+N>=ie:ut+N>=Kt)&&(mt.push(St+1),mt.push(Bt),mt.push(Jt))}}return Dt}(this.ids,this.coords,z,B,F,this.nodeSize)};var zn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(z){return z}},kn=function(z){this.options=po(Object.create(zn),z),this.trees=new Array(this.options.maxZoom+1)};function Zr(z,B,F,H,J){return{x:z,y:B,zoom:1/0,id:F,parentId:-1,numPoints:H,properties:J}}function _i(z,B){var F=z.geometry.coordinates,H=F[1];return{x:vn(F[0]),y:Ve(H),zoom:1/0,index:B,parentId:-1}}function or(z){return{type:"Feature",id:z.id,properties:Bi(z),geometry:{type:"Point",coordinates:[(H=z.x,360*(H-.5)),(B=z.y,F=(180-360*B)*Math.PI/180,360*Math.atan(Math.exp(F))/Math.PI-90)]}};var B,F,H}function Bi(z){var B=z.numPoints,F=B>=1e4?Math.round(B/1e3)+"k":B>=1e3?Math.round(B/100)/10+"k":B;return po(po({},z.properties),{cluster:!0,cluster_id:z.id,point_count:B,point_count_abbreviated:F})}function vn(z){return z/360+.5}function Ve(z){var B=Math.sin(z*Math.PI/180),F=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return F<0?0:F>1?1:F}function po(z,B){for(var F in B)z[F]=B[F];return z}function xn(z){return z.x}function un(z){return z.y}function En(z,B,F,H,J,ot){var ut=J-F,N=ot-H;if(0!==ut||0!==N){var et=((z-F)*ut+(B-H)*N)/(ut*ut+N*N);et>1?(F=J,H=ot):et>0&&(F+=ut*et,H+=N*et)}return(ut=z-F)*ut+(N=B-H)*N}function Zi(z,B,F,H){var J={id:void 0===z?null:z,type:B,geometry:F,tags:H,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ot){var ut=ot.geometry,N=ot.type;if("Point"===N||"MultiPoint"===N||"LineString"===N)di(ot,ut);else if("Polygon"===N||"MultiLineString"===N)for(var et=0;et<ut.length;et++)di(ot,ut[et]);else if("MultiPolygon"===N)for(et=0;et<ut.length;et++)for(var mt=0;mt<ut[et].length;mt++)di(ot,ut[et][mt])}(J),J}function di(z,B){for(var F=0;F<B.length;F+=3)z.minX=Math.min(z.minX,B[F]),z.minY=Math.min(z.minY,B[F+1]),z.maxX=Math.max(z.maxX,B[F]),z.maxY=Math.max(z.maxY,B[F+1])}function wi(z,B,F,H){if(B.geometry){var J=B.geometry.coordinates,ot=B.geometry.type,ut=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2),N=[],et=B.id;if(F.promoteId?et=B.properties[F.promoteId]:F.generateId&&(et=H||0),"Point"===ot)Qr(J,N);else if("MultiPoint"===ot)for(var mt=0;mt<J.length;mt++)Qr(J[mt],N);else if("LineString"===ot)to(J,N,ut,!1);else if("MultiLineString"===ot){if(F.lineMetrics){for(mt=0;mt<J.length;mt++)to(J[mt],N=[],ut,!1),z.push(Zi(et,"LineString",N,B.properties));return}x(J,N,ut,!1)}else if("Polygon"===ot)x(J,N,ut,!0);else{if("MultiPolygon"!==ot){if("GeometryCollection"===ot){for(mt=0;mt<B.geometry.geometries.length;mt++)wi(z,{id:et,geometry:B.geometry.geometries[mt],properties:B.properties},F,H);return}throw new Error("Input data is not a valid GeoJSON object.")}for(mt=0;mt<J.length;mt++){var Dt=[];x(J[mt],Dt,ut,!0),N.push(Dt)}}z.push(Zi(et,ot,N,B.properties))}}function Qr(z,B){B.push(S(z[0])),B.push(D(z[1])),B.push(0)}function to(z,B,F,H){for(var J,ot,ut=0,N=0;N<z.length;N++){var et=S(z[N][0]),mt=D(z[N][1]);B.push(et),B.push(mt),B.push(0),N>0&&(ut+=H?(J*mt-et*ot)/2:Math.sqrt(Math.pow(et-J,2)+Math.pow(mt-ot,2))),J=et,ot=mt}var Dt=B.length-3;B[2]=1,function Nt(bt,Bt,jt,Gt){for(var St,ie=Gt,Kt=jt-Bt>>1,Jt=jt-Bt,re=bt[Bt],Vt=bt[Bt+1],Ke=bt[jt],fi=bt[jt+1],Ae=Bt+3;Ae<jt;Ae+=3){var hi=En(bt[Ae],bt[Ae+1],re,Vt,Ke,fi);if(hi>ie)St=Ae,ie=hi;else if(hi===ie){var Ne=Math.abs(Ae-Kt);Ne<Jt&&(St=Ae,Jt=Ne)}}ie>Gt&&(St-Bt>3&&Nt(bt,Bt,St,Gt),bt[St+2]=ie,jt-St>3&&Nt(bt,St,jt,Gt))}(B,0,Dt,F),B[Dt+2]=1,B.size=Math.abs(ut),B.start=0,B.end=B.size}function x(z,B,F,H){for(var J=0;J<z.length;J++){var ot=[];to(z[J],ot,F,H),B.push(ot)}}function S(z){return z/360+.5}function D(z){var B=Math.sin(z*Math.PI/180),F=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return F<0?0:F>1?1:F}function W(z,B,F,H,J,ot,ut,N){if(H/=B,ot>=(F/=B)&&ut<H)return z;if(ut<F||ot>=H)return null;for(var et=[],mt=0;mt<z.length;mt++){var Dt=z[mt],Nt=Dt.geometry,bt=Dt.type,Bt=0===J?Dt.minX:Dt.minY,jt=0===J?Dt.maxX:Dt.maxY;if(Bt>=F&&jt<H)et.push(Dt);else if(!(jt<F||Bt>=H)){var Gt=[];if("Point"===bt||"MultiPoint"===bt)it(Nt,Gt,F,H,J);else if("LineString"===bt)pt(Nt,Gt,F,H,J,!1,N.lineMetrics);else if("MultiLineString"===bt)Qt(Nt,Gt,F,H,J,!1);else if("Polygon"===bt)Qt(Nt,Gt,F,H,J,!0);else if("MultiPolygon"===bt)for(var St=0;St<Nt.length;St++){var ie=[];Qt(Nt[St],ie,F,H,J,!0),ie.length&&Gt.push(ie)}if(Gt.length){if(N.lineMetrics&&"LineString"===bt){for(St=0;St<Gt.length;St++)et.push(Zi(Dt.id,bt,Gt[St],Dt.tags));continue}"LineString"!==bt&&"MultiLineString"!==bt||(1===Gt.length?(bt="LineString",Gt=Gt[0]):bt="MultiLineString"),"Point"!==bt&&"MultiPoint"!==bt||(bt=3===Gt.length?"Point":"MultiPoint"),et.push(Zi(Dt.id,bt,Gt,Dt.tags))}}}return et.length?et:null}function it(z,B,F,H,J){for(var ot=0;ot<z.length;ot+=3){var ut=z[ot+J];ut>=F&&ut<=H&&(B.push(z[ot]),B.push(z[ot+1]),B.push(z[ot+2]))}}function pt(z,B,F,H,J,ot,ut){for(var N,et,mt=At(z),Dt=0===J?Pe:ui,Nt=z.start,bt=0;bt<z.length-3;bt+=3){var Bt=z[bt],jt=z[bt+1],Gt=z[bt+2],St=z[bt+3],ie=z[bt+4],Kt=0===J?Bt:jt,Jt=0===J?St:ie,re=!1;ut&&(N=Math.sqrt(Math.pow(Bt-St,2)+Math.pow(jt-ie,2))),Kt<F?Jt>F&&(et=Dt(mt,Bt,jt,St,ie,F),ut&&(mt.start=Nt+N*et)):Kt>H?Jt<H&&(et=Dt(mt,Bt,jt,St,ie,H),ut&&(mt.start=Nt+N*et)):he(mt,Bt,jt,Gt),Jt<F&&Kt>=F&&(et=Dt(mt,Bt,jt,St,ie,F),re=!0),Jt>H&&Kt<=H&&(et=Dt(mt,Bt,jt,St,ie,H),re=!0),!ot&&re&&(ut&&(mt.end=Nt+N*et),B.push(mt),mt=At(z)),ut&&(Nt+=N)}var Vt=z.length-3;Bt=z[Vt],jt=z[Vt+1],Gt=z[Vt+2],(Kt=0===J?Bt:jt)>=F&&Kt<=H&&he(mt,Bt,jt,Gt),Vt=mt.length-3,ot&&Vt>=3&&(mt[Vt]!==mt[0]||mt[Vt+1]!==mt[1])&&he(mt,mt[0],mt[1],mt[2]),mt.length&&B.push(mt)}function At(z){var B=[];return B.size=z.size,B.start=z.start,B.end=z.end,B}function Qt(z,B,F,H,J,ot){for(var ut=0;ut<z.length;ut++)pt(z[ut],B,F,H,J,ot,!1)}function he(z,B,F,H){z.push(B),z.push(F),z.push(H)}function Pe(z,B,F,H,J,ot){var ut=(ot-B)/(H-B);return z.push(ot),z.push(F+(J-F)*ut),z.push(1),ut}function ui(z,B,F,H,J,ot){var ut=(ot-F)/(J-F);return z.push(B+(H-B)*ut),z.push(ot),z.push(1),ut}function bn(z,B){for(var F=[],H=0;H<z.length;H++){var J,ot=z[H],ut=ot.type;if("Point"===ut||"MultiPoint"===ut||"LineString"===ut)J=Ri(ot.geometry,B);else if("MultiLineString"===ut||"Polygon"===ut){J=[];for(var N=0;N<ot.geometry.length;N++)J.push(Ri(ot.geometry[N],B))}else if("MultiPolygon"===ut)for(J=[],N=0;N<ot.geometry.length;N++){for(var et=[],mt=0;mt<ot.geometry[N].length;mt++)et.push(Ri(ot.geometry[N][mt],B));J.push(et)}F.push(Zi(ot.id,ut,J,ot.tags))}return F}function Ri(z,B){var F=[];F.size=z.size,void 0!==z.start&&(F.start=z.start,F.end=z.end);for(var H=0;H<z.length;H+=3)F.push(z[H]+B,z[H+1],z[H+2]);return F}function qn(z,B){if(z.transformed)return z;var F,H,J,ot=1<<z.z,ut=z.x,N=z.y;for(F=0;F<z.features.length;F++){var et=z.features[F],mt=et.geometry,Dt=et.type;if(et.geometry=[],1===Dt)for(H=0;H<mt.length;H+=2)et.geometry.push(Gn(mt[H],mt[H+1],B,ot,ut,N));else for(H=0;H<mt.length;H++){var Nt=[];for(J=0;J<mt[H].length;J+=2)Nt.push(Gn(mt[H][J],mt[H][J+1],B,ot,ut,N));et.geometry.push(Nt)}}return z.transformed=!0,z}function Gn(z,B,F,H,J,ot){return[Math.round(F*(z*H-J)),Math.round(F*(B*H-ot))]}function fo(z,B,F,H,J){for(var ot=B===J.maxZoom?0:J.tolerance/((1<<B)*J.extent),ut={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:F,y:H,z:B,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},N=0;N<z.length;N++){ut.numFeatures++,ar(ut,z[N],ot,J);var et=z[N].minX,mt=z[N].minY,Dt=z[N].maxX,Nt=z[N].maxY;et<ut.minX&&(ut.minX=et),mt<ut.minY&&(ut.minY=mt),Dt>ut.maxX&&(ut.maxX=Dt),Nt>ut.maxY&&(ut.maxY=Nt)}return ut}function ar(z,B,F,H){var J=B.geometry,ot=B.type,ut=[];if("Point"===ot||"MultiPoint"===ot)for(var N=0;N<J.length;N+=3)ut.push(J[N]),ut.push(J[N+1]),z.numPoints++,z.numSimplified++;else if("LineString"===ot)eo(ut,J,z,F,!1,!1);else if("MultiLineString"===ot||"Polygon"===ot)for(N=0;N<J.length;N++)eo(ut,J[N],z,F,"Polygon"===ot,0===N);else if("MultiPolygon"===ot)for(var et=0;et<J.length;et++){var mt=J[et];for(N=0;N<mt.length;N++)eo(ut,mt[N],z,F,!0,0===N)}if(ut.length){var Dt=B.tags||null;if("LineString"===ot&&H.lineMetrics){for(var Nt in Dt={},B.tags)Dt[Nt]=B.tags[Nt];Dt.mapbox_clip_start=J.start/J.size,Dt.mapbox_clip_end=J.end/J.size}var bt={geometry:ut,type:"Polygon"===ot||"MultiPolygon"===ot?3:"LineString"===ot||"MultiLineString"===ot?2:1,tags:Dt};null!==B.id&&(bt.id=B.id),z.features.push(bt)}}function eo(z,B,F,H,J,ot){var ut=H*H;if(H>0&&B.size<(J?ut:H))F.numPoints+=B.length/3;else{for(var N=[],et=0;et<B.length;et+=3)(0===H||B[et+2]>ut)&&(F.numSimplified++,N.push(B[et]),N.push(B[et+1])),F.numPoints++;J&&function(mt,Dt){for(var Nt=0,bt=0,Bt=mt.length,jt=Bt-2;bt<Bt;jt=bt,bt+=2)Nt+=(mt[bt]-mt[jt])*(mt[bt+1]+mt[jt+1]);if(Nt>0===Dt)for(bt=0,Bt=mt.length;bt<Bt/2;bt+=2){var Gt=mt[bt],St=mt[bt+1];mt[bt]=mt[Bt-2-bt],mt[bt+1]=mt[Bt-1-bt],mt[Bt-2-bt]=Gt,mt[Bt-1-bt]=St}}(N,ot),z.push(N)}}function er(z,B){var F=(B=this.options=function(J,ot){for(var ut in ot)J[ut]=ot[ut];return J}(Object.create(this.options),B)).debug;if(F&&console.time("preprocess data"),B.maxZoom<0||B.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(B.promoteId&&B.generateId)throw new Error("promoteId and generateId cannot be used together.");var J,ot,ut,N,et,mt,H=function(J,ot){var ut=[];if("FeatureCollection"===J.type)for(var N=0;N<J.features.length;N++)wi(ut,J.features[N],ot,N);else wi(ut,"Feature"===J.type?J:{geometry:J},ot);return ut}(z,B);this.tiles={},this.tileCoords=[],F&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",B.indexMaxZoom,B.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(J=H,ot=B,ut=ot.buffer/ot.extent,N=J,et=W(J,1,-1-ut,ut,0,-1,2,ot),mt=W(J,1,1-ut,2+ut,0,-1,2,ot),(et||mt)&&(N=W(J,1,-ut,1+ut,0,-1,2,ot)||[],et&&(N=bn(et,1).concat(N)),mt&&(N=N.concat(bn(mt,-1)))),H=N).length&&this.splitTile(H,0,0,0),F&&(H.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function sr(z,B,F){return 32*((1<<z)*F+B)+z}function ko(z,B){var F=z.tileID.canonical;if(!this._geoJSONIndex)return B(null,null);var H=this._geoJSONIndex.getTile(F.z,F.x,F.y);if(!H)return B(null,null);var J=new Ci(H.features),ot=on(J);0===ot.byteOffset&&ot.byteLength===ot.buffer.byteLength||(ot=new Uint8Array(ot)),B(null,{vectorTile:J,rawData:ot.buffer})}kn.prototype.load=function(z){var B=this.options,F=B.log,H=B.minZoom,J=B.maxZoom,ot=B.nodeSize;F&&console.time("total time");var ut="prepare "+z.length+" points";F&&console.time(ut),this.points=z;for(var N=[],et=0;et<z.length;et++)z[et].geometry&&N.push(_i(z[et],et));this.trees[J+1]=new tr(N,xn,un,ot,Float32Array),F&&console.timeEnd(ut);for(var mt=J;mt>=H;mt--){var Dt=+Date.now();N=this._cluster(N,mt),this.trees[mt]=new tr(N,xn,un,ot,Float32Array),F&&console.log("z%d: %d clusters in %dms",mt,N.length,+Date.now()-Dt)}return F&&console.timeEnd("total time"),this},kn.prototype.getClusters=function(z,B){var F=((z[0]+180)%360+360)%360-180,H=Math.max(-90,Math.min(90,z[1])),J=180===z[2]?180:((z[2]+180)%360+360)%360-180,ot=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)F=-180,J=180;else if(F>J){var ut=this.getClusters([F,H,180,ot],B),N=this.getClusters([-180,H,J,ot],B);return ut.concat(N)}for(var et=this.trees[this._limitZoom(B)],mt=[],Dt=0,Nt=et.range(vn(F),Ve(ot),vn(J),Ve(H));Dt<Nt.length;Dt+=1){var bt=et.points[Nt[Dt]];mt.push(bt.numPoints?or(bt):this.points[bt.index])}return mt},kn.prototype.getChildren=function(z){var B=this._getOriginId(z),F=this._getOriginZoom(z),H="No cluster with the specified id.",J=this.trees[F];if(!J)throw new Error(H);var ot=J.points[B];if(!ot)throw new Error(H);for(var ut=this.options.radius/(this.options.extent*Math.pow(2,F-1)),N=[],et=0,mt=J.within(ot.x,ot.y,ut);et<mt.length;et+=1){var Dt=J.points[mt[et]];Dt.parentId===z&&N.push(Dt.numPoints?or(Dt):this.points[Dt.index])}if(0===N.length)throw new Error(H);return N},kn.prototype.getLeaves=function(z,B,F){var H=[];return this._appendLeaves(H,z,B=B||10,F=F||0,0),H},kn.prototype.getTile=function(z,B,F){var H=this.trees[this._limitZoom(z)],J=Math.pow(2,z),ot=this.options,ut=ot.radius/ot.extent,N=(F-ut)/J,et=(F+1+ut)/J,mt={features:[]};return this._addTileFeatures(H.range((B-ut)/J,N,(B+1+ut)/J,et),H.points,B,F,J,mt),0===B&&this._addTileFeatures(H.range(1-ut/J,N,1,et),H.points,J,F,J,mt),B===J-1&&this._addTileFeatures(H.range(0,N,ut/J,et),H.points,-1,F,J,mt),mt.features.length?mt:null},kn.prototype.getClusterExpansionZoom=function(z){for(var B=this._getOriginZoom(z)-1;B<=this.options.maxZoom;){var F=this.getChildren(z);if(B++,1!==F.length)break;z=F[0].properties.cluster_id}return B},kn.prototype._appendLeaves=function(z,B,F,H,J){for(var ot=0,ut=this.getChildren(B);ot<ut.length;ot+=1){var N=ut[ot],et=N.properties;if(et&&et.cluster?J+et.point_count<=H?J+=et.point_count:J=this._appendLeaves(z,et.cluster_id,F,H,J):J<H?J++:z.push(N),z.length===F)break}return J},kn.prototype._addTileFeatures=function(z,B,F,H,J,ot){for(var ut=0,N=z;ut<N.length;ut+=1){var et=B[N[ut]],mt=et.numPoints,Dt={type:1,geometry:[[Math.round(this.options.extent*(et.x*J-F)),Math.round(this.options.extent*(et.y*J-H))]],tags:mt?Bi(et):this.points[et.index].properties},Nt=void 0;mt?Nt=et.id:this.options.generateId?Nt=et.index:this.points[et.index].id&&(Nt=this.points[et.index].id),void 0!==Nt&&(Dt.id=Nt),ot.features.push(Dt)}},kn.prototype._limitZoom=function(z){return Math.max(this.options.minZoom,Math.min(+z,this.options.maxZoom+1))},kn.prototype._cluster=function(z,B){for(var F=[],H=this.options,J=H.reduce,ot=H.minPoints,ut=H.radius/(H.extent*Math.pow(2,B)),N=0;N<z.length;N++){var et=z[N];if(!(et.zoom<=B)){et.zoom=B;for(var mt=this.trees[B+1],Dt=mt.within(et.x,et.y,ut),Nt=et.numPoints||1,bt=Nt,Bt=0,jt=Dt;Bt<jt.length;Bt+=1){var Gt=mt.points[jt[Bt]];Gt.zoom>B&&(bt+=Gt.numPoints||1)}if(bt>=ot){for(var St=et.x*Nt,ie=et.y*Nt,Kt=J&&Nt>1?this._map(et,!0):null,Jt=(N<<5)+(B+1)+this.points.length,re=0,Vt=Dt;re<Vt.length;re+=1){var Ke=mt.points[Vt[re]];if(!(Ke.zoom<=B)){Ke.zoom=B;var fi=Ke.numPoints||1;St+=Ke.x*fi,ie+=Ke.y*fi,Ke.parentId=Jt,J&&(Kt||(Kt=this._map(et,!0)),J(Kt,this._map(Ke)))}}et.parentId=Jt,F.push(Zr(St/bt,ie/bt,Jt,bt,Kt))}else if(F.push(et),bt>1)for(var Ae=0,hi=Dt;Ae<hi.length;Ae+=1){var Ne=mt.points[hi[Ae]];Ne.zoom<=B||(Ne.zoom=B,F.push(Ne))}}}return F},kn.prototype._getOriginId=function(z){return z-this.points.length>>5},kn.prototype._getOriginZoom=function(z){return(z-this.points.length)%32},kn.prototype._map=function(z,B){if(z.numPoints)return B?po({},z.properties):z.properties;var F=this.points[z.index].properties,H=this.options.map(F);return B&&H===F?po({},H):H},er.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},er.prototype.splitTile=function(z,B,F,H,J,ot,ut){for(var N=[z,B,F,H],et=this.options,mt=et.debug;N.length;){H=N.pop(),F=N.pop(),B=N.pop(),z=N.pop();var Dt=1<<B,Nt=sr(B,F,H),bt=this.tiles[Nt];if(!bt&&(mt>1&&console.time("creation"),bt=this.tiles[Nt]=fo(z,B,F,H,et),this.tileCoords.push({z:B,x:F,y:H}),mt)){mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",B,F,H,bt.numFeatures,bt.numPoints,bt.numSimplified),console.timeEnd("creation"));var Bt="z"+B;this.stats[Bt]=(this.stats[Bt]||0)+1,this.total++}if(bt.source=z,J){if(B===et.maxZoom||B===J)continue;var jt=1<<J-B;if(F!==Math.floor(ot/jt)||H!==Math.floor(ut/jt))continue}else if(B===et.indexMaxZoom||bt.numPoints<=et.indexMaxPoints)continue;if(bt.source=null,0!==z.length){mt>1&&console.time("clipping");var Gt,St,ie,Kt,Jt,re,Vt=.5*et.buffer/et.extent,Ke=.5-Vt,fi=.5+Vt,Ae=1+Vt;Gt=St=ie=Kt=null,Jt=W(z,Dt,F-Vt,F+fi,0,bt.minX,bt.maxX,et),re=W(z,Dt,F+Ke,F+Ae,0,bt.minX,bt.maxX,et),z=null,Jt&&(Gt=W(Jt,Dt,H-Vt,H+fi,1,bt.minY,bt.maxY,et),St=W(Jt,Dt,H+Ke,H+Ae,1,bt.minY,bt.maxY,et),Jt=null),re&&(ie=W(re,Dt,H-Vt,H+fi,1,bt.minY,bt.maxY,et),Kt=W(re,Dt,H+Ke,H+Ae,1,bt.minY,bt.maxY,et),re=null),mt>1&&console.timeEnd("clipping"),N.push(Gt||[],B+1,2*F,2*H),N.push(St||[],B+1,2*F,2*H+1),N.push(ie||[],B+1,2*F+1,2*H),N.push(Kt||[],B+1,2*F+1,2*H+1)}}},er.prototype.getTile=function(z,B,F){var H=this.options,J=H.extent,ot=H.debug;if(z<0||z>24)return null;var ut=1<<z,N=sr(z,B=(B%ut+ut)%ut,F);if(this.tiles[N])return qn(this.tiles[N],J);ot>1&&console.log("drilling down to z%d-%d-%d",z,B,F);for(var et,mt=z,Dt=B,Nt=F;!et&&mt>0;)mt--,Dt=Math.floor(Dt/2),Nt=Math.floor(Nt/2),et=this.tiles[sr(mt,Dt,Nt)];return et&&et.source?(ot>1&&console.log("found parent tile z%d-%d-%d",mt,Dt,Nt),ot>1&&console.time("drilling down"),this.splitTile(et.source,mt,Dt,Nt,z,B,F),ot>1&&console.timeEnd("drilling down"),this.tiles[N]?qn(this.tiles[N],J):null):null};var lr=function(z){function B(F,H,J,ot){z.call(this,F,H,J,ko),ot&&(this.loadGeoJSON=ot)}return z&&(B.__proto__=z),(B.prototype=Object.create(z&&z.prototype)).constructor=B,B.prototype.loadData=function(F,H){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=H,this._pendingLoadDataParams=F,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},B.prototype._loadData=function(){var F=this;if(this._pendingCallback&&this._pendingLoadDataParams){var H=this._pendingCallback,J=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ot=!!(J&&J.request&&J.request.collectResourceTiming)&&new c.RequestPerformance(J.request);this.loadGeoJSON(J,function(ut,N){if(ut||!N)return H(ut);if("object"!=typeof N)return H(new Error("Input data given to '"+J.source+"' is not a valid GeoJSON object."));!function bt(Bt,jt){var Gt,St=Bt&&Bt.type;if("FeatureCollection"===St)for(Gt=0;Gt<Bt.features.length;Gt++)bt(Bt.features[Gt],jt);else if("GeometryCollection"===St)for(Gt=0;Gt<Bt.geometries.length;Gt++)bt(Bt.geometries[Gt],jt);else if("Feature"===St)bt(Bt.geometry,jt);else if("Polygon"===St)ti(Bt.coordinates,jt);else if("MultiPolygon"===St)for(Gt=0;Gt<Bt.coordinates.length;Gt++)ti(Bt.coordinates[Gt],jt);return Bt}(N,!0);try{if(J.filter){var et=c.createExpression(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===et.result)throw new Error(et.value.map(function(bt){return bt.key+": "+bt.message}).join(", "));var mt=N.features.filter(function(bt){return et.value.evaluate({zoom:0},bt)});N={type:"FeatureCollection",features:mt}}F._geoJSONIndex=J.cluster?new kn(function(bt){var Bt=bt.superclusterOptions,jt=bt.clusterProperties;if(!jt||!Bt)return Bt;for(var Gt={},St={},ie={accumulated:null,zoom:0},Kt={properties:null},Jt=Object.keys(jt),re=0,Vt=Jt;re<Vt.length;re+=1){var Ke=Vt[re],fi=jt[Ke],Ae=fi[0],hi=c.createExpression(fi[1]),Ne=c.createExpression("string"==typeof Ae?[Ae,["accumulated"],["get",Ke]]:Ae);Gt[Ke]=hi.value,St[Ke]=Ne.value}return Bt.map=function(Ti){Kt.properties=Ti;for(var ei={},Xi=0,yi=Jt;Xi<yi.length;Xi+=1){var He=yi[Xi];ei[He]=Gt[He].evaluate(ie,Kt)}return ei},Bt.reduce=function(Ti,ei){Kt.properties=ei;for(var Xi=0,yi=Jt;Xi<yi.length;Xi+=1){var He=yi[Xi];ie.accumulated=Ti[He],Ti[He]=St[He].evaluate(ie,Kt)}},Bt}(J)).load(N.features):new er(bt=N,J.geojsonVtOptions)}catch(bt){return H(bt)}var bt;F.loaded={};var Dt={};if(ot){var Nt=ot.finish();Nt&&(Dt.resourceTiming={},Dt.resourceTiming[J.source]=JSON.parse(JSON.stringify(Nt)))}H(null,Dt)})}},B.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},B.prototype.reloadTile=function(F,H){var J=this.loaded;return J&&J[F.uid]?z.prototype.reloadTile.call(this,F,H):this.loadTile(F,H)},B.prototype.loadGeoJSON=function(F,H){if(F.request)c.getJSON(F.request,H);else{if("string"!=typeof F.data)return H(new Error("Input data given to '"+F.source+"' is not a valid GeoJSON object."));try{return H(null,JSON.parse(F.data))}catch{return H(new Error("Input data given to '"+F.source+"' is not a valid GeoJSON object."))}}},B.prototype.removeSource=function(F,H){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),H()},B.prototype.getClusterExpansionZoom=function(F,H){try{H(null,this._geoJSONIndex.getClusterExpansionZoom(F.clusterId))}catch(J){H(J)}},B.prototype.getClusterChildren=function(F,H){try{H(null,this._geoJSONIndex.getChildren(F.clusterId))}catch(J){H(J)}},B.prototype.getClusterLeaves=function(F,H){try{H(null,this._geoJSONIndex.getLeaves(F.clusterId,F.limit,F.offset))}catch(J){H(J)}},B}(tn),Yi=function(z){var B=this;this.self=z,this.actor=new c.Actor(z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:tn,geojson:lr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(F,H){if(B.workerSourceTypes[F])throw new Error('Worker source with name "'+F+'" already registered.');B.workerSourceTypes[F]=H},this.self.registerRTLTextPlugin=function(F){if(c.plugin.isParsed())throw new Error("RTL text plugin already registered.");c.plugin.applyArabicShaping=F.applyArabicShaping,c.plugin.processBidirectionalText=F.processBidirectionalText,c.plugin.processStyledBidirectionalText=F.processStyledBidirectionalText}};return Yi.prototype.setReferrer=function(z,B){this.referrer=B},Yi.prototype.setImages=function(z,B,F){for(var H in this.availableImages[z]=B,this.workerSources[z]){var J=this.workerSources[z][H];for(var ot in J)J[ot].availableImages=B}F()},Yi.prototype.setLayers=function(z,B,F){this.getLayerIndex(z).replace(B),F()},Yi.prototype.updateLayers=function(z,B,F){this.getLayerIndex(z).update(B.layers,B.removedIds),F()},Yi.prototype.loadTile=function(z,B,F){this.getWorkerSource(z,B.type,B.source).loadTile(B,F)},Yi.prototype.loadDEMTile=function(z,B,F){this.getDEMWorkerSource(z,B.source).loadTile(B,F)},Yi.prototype.reloadTile=function(z,B,F){this.getWorkerSource(z,B.type,B.source).reloadTile(B,F)},Yi.prototype.abortTile=function(z,B,F){this.getWorkerSource(z,B.type,B.source).abortTile(B,F)},Yi.prototype.removeTile=function(z,B,F){this.getWorkerSource(z,B.type,B.source).removeTile(B,F)},Yi.prototype.removeDEMTile=function(z,B){this.getDEMWorkerSource(z,B.source).removeTile(B)},Yi.prototype.removeSource=function(z,B,F){if(this.workerSources[z]&&this.workerSources[z][B.type]&&this.workerSources[z][B.type][B.source]){var H=this.workerSources[z][B.type][B.source];delete this.workerSources[z][B.type][B.source],void 0!==H.removeSource?H.removeSource(B,F):F()}},Yi.prototype.loadWorkerSource=function(z,B,F){try{this.self.importScripts(B.url),F()}catch(H){F(H.toString())}},Yi.prototype.syncRTLPluginState=function(z,B,F){try{c.plugin.setState(B);var H=c.plugin.getPluginURL();if(c.plugin.isLoaded()&&!c.plugin.isParsed()&&null!=H){this.self.importScripts(H);var J=c.plugin.isParsed();F(J?void 0:new Error("RTL Text Plugin failed to import scripts from "+H),J)}}catch(ot){F(ot.toString())}},Yi.prototype.getAvailableImages=function(z){var B=this.availableImages[z];return B||(B=[]),B},Yi.prototype.getLayerIndex=function(z){var B=this.layerIndexes[z];return B||(B=this.layerIndexes[z]=new Me),B},Yi.prototype.getWorkerSource=function(z,B,F){var H=this;return this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][B]||(this.workerSources[z][B]={}),this.workerSources[z][B][F]||(this.workerSources[z][B][F]=new this.workerSourceTypes[B]({send:function(J,ot,ut){H.actor.send(J,ot,ut,z)}},this.getLayerIndex(z),this.getAvailableImages(z))),this.workerSources[z][B][F]},Yi.prototype.getDEMWorkerSource=function(z,B){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][B]||(this.demWorkerSources[z][B]=new jn),this.demWorkerSources[z][B]},Yi.prototype.enforceCacheSizeLimit=function(z,B){c.enforceCacheSizeLimit(B)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Yi(self)),Yi}),gn(0,function(c){var mi=c.createCommonjsModule(function(n){function a(d){return!o(d)}function o(d){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,w,P=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(P);try{w=new Worker(M),g=!0}catch{g=!1}return w&&w.terminate(),URL.revokeObjectURL(M),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var w=g.getContext("2d");if(!w)return!1;var P=w.getImageData(0,0,1,1);return P&&P.width===g.width}()?(void 0===l[_=d&&d.failIfMajorPerformanceCaveat]&&(l[_]=function(g){var M,j,V,w=(M=g,j=document.createElement("canvas"),(V=Object.create(a.webGLContextAttributes)).failIfMajorPerformanceCaveat=M,j.probablySupportsContext?j.probablySupportsContext("webgl",V)||j.probablySupportsContext("experimental-webgl",V):j.supportsContext?j.supportsContext("webgl",V)||j.supportsContext("experimental-webgl",V):j.getContext("webgl",V)||j.getContext("experimental-webgl",V));if(!w)return!1;var P=w.createShader(w.VERTEX_SHADER);return!(!P||w.isContextLost())&&(w.shaderSource(P,"void main() {}"),w.compileShader(P),!0===w.getShaderParameter(P,w.COMPILE_STATUS))}(_)),l[_]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}n.exports?n.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=o);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),Mt={create:function(n,a,o){var l=c.window.document.createElement(n);return void 0!==a&&(l.className=a),o&&o.appendChild(l),l},createNS:function(n,a){return c.window.document.createElementNS(n,a)}},Me=c.window.document&&c.window.document.documentElement.style;function le(n){if(!Me)return n[0];for(var a=0;a<n.length;a++)if(n[a]in Me)return n[a];return n[0]}var Qi,Zt=le(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);Mt.disableDrag=function(){Me&&Zt&&(Qi=Me[Zt],Me[Zt]="none")},Mt.enableDrag=function(){Me&&Zt&&(Me[Zt]=Qi)};var ln=le(["transform","WebkitTransform"]);Mt.setTransform=function(n,a){n.style[ln]=a};var tn=!1;try{var Ee=Object.defineProperty({},"passive",{get:function(){tn=!0}});c.window.addEventListener("test",Ee,Ee),c.window.removeEventListener("test",Ee,Ee)}catch{tn=!1}Mt.addEventListener=function(n,a,o,l){void 0===l&&(l={}),n.addEventListener(a,o,"passive"in l&&tn?l:l.capture)},Mt.removeEventListener=function(n,a,o,l){void 0===l&&(l={}),n.removeEventListener(a,o,"passive"in l&&tn?l:l.capture)};var jn=function(n){n.preventDefault(),n.stopPropagation(),c.window.removeEventListener("click",jn,!0)};function ti(n){var a=n.userImage;return!!(a&&a.render&&a.render())&&(n.data.replace(new Uint8Array(a.data.buffer)),!0)}Mt.suppressClick=function(){c.window.addEventListener("click",jn,!0),c.window.setTimeout(function(){c.window.removeEventListener("click",jn,!0)},0)},Mt.mousePos=function(n,a){var o=n.getBoundingClientRect();return new c.Point(a.clientX-o.left-n.clientLeft,a.clientY-o.top-n.clientTop)},Mt.touchPos=function(n,a){for(var o=n.getBoundingClientRect(),l=[],d=0;d<a.length;d++)l.push(new c.Point(a[d].clientX-o.left-n.clientLeft,a[d].clientY-o.top-n.clientTop));return l},Mt.mouseButton=function(n){return void 0!==c.window.InstallTrigger&&2===n.button&&n.ctrlKey&&c.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},Mt.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var je=function(n){function a(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var l=0,d=this.requestors;l<d.length;l+=1){var _=d[l];this._notify(_.ids,_.callback)}this.requestors=[]}},a.prototype.getImage=function(o){return this.images[o]},a.prototype.addImage=function(o,l){this._validate(o,l)&&(this.images[o]=l)},a.prototype._validate=function(o,l){var d=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new c.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),d=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new c.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),d=!1),this._validateContent(l.content,l)||(this.fire(new c.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),d=!1),d},a.prototype._validateStretch=function(o,l){if(!o)return!0;for(var d=0,_=0,g=o;_<g.length;_+=1){var w=g[_];if(w[0]<d||w[1]<w[0]||l<w[1])return!1;d=w[1]}return!0},a.prototype._validateContent=function(o,l){return!(o&&(4!==o.length||o[0]<0||l.data.width<o[0]||o[1]<0||l.data.height<o[1]||o[2]<0||l.data.width<o[2]||o[3]<0||l.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},a.prototype.updateImage=function(o,l){l.version=this.images[o].version+1,this.images[o]=l,this.updatedImages[o]=!0},a.prototype.removeImage=function(o){var l=this.images[o];delete this.images[o],delete this.patterns[o],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(o,l){var d=!0;if(!this.isLoaded())for(var _=0,g=o;_<g.length;_+=1)this.images[g[_]]||(d=!1);this.isLoaded()||d?this._notify(o,l):this.requestors.push({ids:o,callback:l})},a.prototype._notify=function(o,l){for(var d={},_=0,g=o;_<g.length;_+=1){var w=g[_];this.images[w]||this.fire(new c.Event("styleimagemissing",{id:w}));var P=this.images[w];P?d[w]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:Boolean(P.userImage&&P.userImage.render)}:c.warnOnce('Image "'+w+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,d)},a.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},a.prototype.getPattern=function(o){var l=this.patterns[o],d=this.getImage(o);if(!d)return null;if(l&&l.position.version===d.version)return l.position;if(l)l.position.version=d.version;else{var _={w:d.data.width+2,h:d.data.height+2,x:0,y:0},g=new c.ImagePosition(_,d);this.patterns[o]={bin:_,position:g}}return this._updatePatternAtlas(),this.patterns[o].position},a.prototype.bind=function(o){var l=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.Texture(o,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var o=[];for(var l in this.patterns)o.push(this.patterns[l].bin);var d=c.potpack(o),_=d.w,g=d.h,w=this.atlasImage;for(var P in w.resize({width:_||1,height:g||1}),this.patterns){var M=this.patterns[P].bin,j=M.x+1,V=M.y+1,q=this.images[P].data,tt=q.width,Q=q.height;c.RGBAImage.copy(q,w,{x:0,y:0},{x:j,y:V},{width:tt,height:Q}),c.RGBAImage.copy(q,w,{x:0,y:Q-1},{x:j,y:V-1},{width:tt,height:1}),c.RGBAImage.copy(q,w,{x:0,y:0},{x:j,y:V+Q},{width:tt,height:1}),c.RGBAImage.copy(q,w,{x:tt-1,y:0},{x:j-1,y:V},{width:1,height:Q}),c.RGBAImage.copy(q,w,{x:0,y:0},{x:j+tt,y:V},{width:1,height:Q})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(o){for(var l=0,d=o;l<d.length;l+=1){var _=d[l];if(!this.callbackDispatchedThisFrame[_]){this.callbackDispatchedThisFrame[_]=!0;var g=this.images[_];ti(g)&&this.updateImage(_,g)}}},a}(c.Evented),Ut=We,Pi=We,Ci=1e20;function We(n,a,o,l,d,_){this.fontSize=n||24,this.buffer=void 0===a?3:a,this.cutoff=l||.25,this.fontFamily=d||"sans-serif",this.fontWeight=_||"normal",this.radius=o||8;var g=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=g,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.d=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Int16Array(g),this.middle=Math.round(g/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function bi(n,a,o,l,d,_,g){for(var w=0;w<a;w++){for(var P=0;P<o;P++)l[P]=n[P*a+w];for(Ln(l,d,_,g,o),P=0;P<o;P++)n[P*a+w]=d[P]}for(P=0;P<o;P++){for(w=0;w<a;w++)l[w]=n[P*a+w];for(Ln(l,d,_,g,a),w=0;w<a;w++)n[P*a+w]=Math.sqrt(d[w])}}function Ln(n,a,o,l,d){o[0]=0,l[0]=-Ci,l[1]=+Ci;for(var _=1,g=0;_<d;_++){for(var w=(n[_]+_*_-(n[o[g]]+o[g]*o[g]))/(2*_-2*o[g]);w<=l[g];)g--,w=(n[_]+_*_-(n[o[g]]+o[g]*o[g]))/(2*_-2*o[g]);o[++g]=_,l[g]=w,l[g+1]=+Ci}for(_=0,g=0;_<d;_++){for(;l[g+1]<_;)g++;a[_]=(_-o[g])*(_-o[g])+n[o[g]]}}We.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var d=a.data[4*l+3]/255;this.gridOuter[l]=1===d?0:0===d?Ci:Math.pow(Math.max(0,.5-d),2),this.gridInner[l]=1===d?Ci:0===d?0:Math.pow(Math.max(0,d-.5),2)}for(bi(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),bi(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)o[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return o},Ut.default=Pi;var Ni=function(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}};Ni.prototype.setURL=function(n){this.url=n},Ni.prototype.getGlyphs=function(n,a){var o=this,l=[];for(var d in n)for(var _=0,g=n[d];_<g.length;_+=1)l.push({stack:d,id:g[_]});c.asyncAll(l,function(w,P){var M=w.stack,j=w.id,V=o.entries[M];V||(V=o.entries[M]={glyphs:{},requests:{},ranges:{}});var q=V.glyphs[j];if(void 0===q){if(q=o._tinySDF(V,M,j))return V.glyphs[j]=q,void P(null,{stack:M,id:j,glyph:q});var tt=Math.floor(j/256);if(256*tt>65535)P(new Error("glyphs > 65535 not supported"));else if(V.ranges[tt])P(null,{stack:M,id:j,glyph:q});else{var Q=V.requests[tt];Q||(Q=V.requests[tt]=[],Ni.loadGlyphRange(M,tt,o.url,o.requestManager,function(st,X){if(X){for(var at in X)o._doesCharSupportLocalGlyph(+at)||(V.glyphs[+at]=X[+at]);V.ranges[tt]=!0}for(var ht=0,_t=Q;ht<_t.length;ht+=1)(0,_t[ht])(st,X);delete V.requests[tt]})),Q.push(function(st,X){st?P(st):X&&P(null,{stack:M,id:j,glyph:X[j]||null})})}}else P(null,{stack:M,id:j,glyph:q})},function(w,P){if(w)a(w);else if(P){for(var M={},j=0,V=P;j<V.length;j+=1){var q=V[j],tt=q.stack,Q=q.id,st=q.glyph;(M[tt]||(M[tt]={}))[Q]=st&&{id:st.id,bitmap:st.bitmap.clone(),metrics:st.metrics}}a(null,M)}})},Ni.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(c.isChar["CJK Unified Ideographs"](n)||c.isChar["Hangul Syllables"](n)||c.isChar.Hiragana(n)||c.isChar.Katakana(n))},Ni.prototype._tinySDF=function(n,a,o){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(o)){var d=n.tinySDF;if(!d){var _="400";/bold/i.test(a)?_="900":/medium/i.test(a)?_="500":/light/i.test(a)&&(_="200"),d=n.tinySDF=new Ni.TinySDF(24,3,8,.25,l,_)}return{id:o,bitmap:new c.AlphaImage({width:30,height:30},d.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ni.loadGlyphRange=function(n,a,o,l,d){var _=256*a,g=_+255,w=l.transformRequest(l.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",_+"-"+g),c.ResourceType.Glyphs);c.getArrayBuffer(w,function(P,M){if(P)d(P);else if(M){for(var j={},V=0,q=c.parseGlyphPBF(M);V<q.length;V+=1){var tt=q[V];j[tt.id]=tt}d(null,j)}})},Ni.TinySDF=Ut;var on=function(){this.specification=c.styleSpec.light.position};on.prototype.possiblyEvaluate=function(n,a){return c.sphericalToCartesian(n.expression.evaluate(a))},on.prototype.interpolate=function(n,a,o){return{x:c.number(n.x,a.x,o),y:c.number(n.y,a.y,o),z:c.number(n.z,a.z,o)}};var fr=new c.Properties({anchor:new c.DataConstantProperty(c.styleSpec.light.anchor),position:new on,color:new c.DataConstantProperty(c.styleSpec.light.color),intensity:new c.DataConstantProperty(c.styleSpec.light.intensity)}),zr=function(n){function a(o){n.call(this),this._transitionable=new c.Transitionable(fr),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(o,l){if(void 0===l&&(l={}),!this._validate(c.validateLight,o,l))for(var d in o){var _=o[d];c.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-11),_):this._transitionable.setValue(d,_)}},a.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},a.prototype._validate=function(o,l,d){return(!d||!1!==d.validate)&&c.emitValidationErrors(this,o.call(c.validateStyle,c.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.styleSpec})))},a}(c.Evented),Ye=function(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Ye.prototype.getDash=function(n,a){var o=n.join(",")+String(a);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,a)),this.dashEntry[o]},Ye.prototype.getDashRanges=function(n,a,o){var l=[],d=n.length%2==1?-n[n.length-1]*o:0,_=n[0]*o,g=!0;l.push({left:d,right:_,isDash:g,zeroLength:0===n[0]});for(var w=n[0],P=1;P<n.length;P++){var M=n[P];l.push({left:d=w*o,right:_=(w+=M)*o,isDash:g=!g,zeroLength:0===M})}return l},Ye.prototype.addRoundDash=function(n,a,o){for(var l=a/2,d=-o;d<=o;d++)for(var _=this.width*(this.nextRow+o+d),g=0,w=n[g],P=0;P<this.width;P++){P/w.right>1&&(w=n[++g]);var M=Math.abs(P-w.left),j=Math.abs(P-w.right),V=Math.min(M,j),q=void 0,tt=d/o*(l+1);if(w.isDash){var Q=l-Math.abs(tt);q=Math.sqrt(V*V+Q*Q)}else q=l-Math.sqrt(V*V+tt*tt);this.data[_+P]=Math.max(0,Math.min(255,q+128))}},Ye.prototype.addRegularDash=function(n){for(var a=n.length-1;a>=0;--a){var o=n[a],l=n[a+1];o.zeroLength?n.splice(a,1):l&&l.isDash===o.isDash&&(l.left=o.left,n.splice(a,1))}var d=n[0],_=n[n.length-1];d.isDash===_.isDash&&(d.left=_.left-this.width,_.right=d.right+this.width);for(var g=this.width*this.nextRow,w=0,P=n[w],M=0;M<this.width;M++){M/P.right>1&&(P=n[++w]);var j=Math.abs(M-P.left),V=Math.abs(M-P.right),q=Math.min(j,V);this.data[g+M]=Math.max(0,Math.min(255,(P.isDash?q:-q)+128))}},Ye.prototype.addDash=function(n,a){var o=a?7:0,l=2*o+1;if(this.nextRow+l>this.height)return c.warnOnce("LineAtlas out of space"),null;for(var d=0,_=0;_<n.length;_++)d+=n[_];if(0!==d){var g=this.width/d,w=this.getDashRanges(n,this.width,g);a?this.addRoundDash(w,g,o):this.addRegularDash(w)}var P={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:d};return this.nextRow+=l,this.dirty=!0,P},Ye.prototype.bind=function(n){var a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var _e=function n(a,o){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=c.uniqueId();for(var l=this.workerPool.acquire(this.id),d=0;d<l.length;d++){var _=new n.Actor(l[d],o,this.id);_.name="Worker "+d,this.actors.push(_)}};function Go(n,a,o){var l=function(d,_){if(d)return o(d);if(_){var g=c.pick(c.extend(_,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(g.vectorLayers=_.vector_layers,g.vectorLayerIds=g.vectorLayers.map(function(w){return w.id})),g.tiles=a.canonicalizeTileset(g,n.url),o(null,g)}};return n.url?c.getJSON(a.transformRequest(a.normalizeSourceURL(n.url),c.ResourceType.Source),l):c.browser.frame(function(){return l(null,n)})}_e.prototype.broadcast=function(n,a,o){c.asyncAll(this.actors,function(l,d){l.send(n,a,d)},o=o||function(){})},_e.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},_e.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},_e.Actor=c.Actor;var Vn=function(n,a,o){this.bounds=c.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=o||24};Vn.prototype.validateBounds=function(n){return Array.isArray(n)&&4===n.length?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},Vn.prototype.contains=function(n){var a=Math.pow(2,n.z),o=Math.floor(c.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(c.mercatorYfromLat(this.bounds.getNorth())*a),d=Math.ceil(c.mercatorXfromLng(this.bounds.getEast())*a),_=Math.ceil(c.mercatorYfromLat(this.bounds.getSouth())*a);return n.x>=o&&n.x<d&&n.y>=l&&n.y<_};var Wo=function(n){function a(o,l,d,_){if(n.call(this),this.id=o,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.extend(this,c.pick(l,["url","scheme","tileSize","promoteId"])),this._options=c.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Go(this._options,this.map._requestManager,function(l,d){o._tileJSONRequest=null,o._loaded=!0,l?o.fire(new c.ErrorEvent(l)):d&&(c.extend(o,d),d.bounds&&(o.tileBounds=new Vn(d.bounds,o.minzoom,o.maxzoom)),c.postTurnstileEvent(d.tiles,o.map._requestManager._customAccessToken),c.postMapLoadEvent(d.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(o){var l=this;return this.setSourceProperty(function(){l._options.tiles=o}),this},a.prototype.setUrl=function(o){var l=this;return this.setSourceProperty(function(){l.url=o,l._options.url=o}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return c.extend({},this._options)},a.prototype.loadTile=function(o,l){var d=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(d,c.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:c.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function g(w,P){return delete o.request,o.aborted?l(null):w&&404!==w.status?l(w):(P&&P.resourceTiming&&(o.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&o.setExpiryData(P),o.loadVectorData(P,this.map.painter),c.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,o.actor&&"expired"!==o.state?"loading"===o.state?o.reloadCallback=l:o.request=o.actor.send("reloadTile",_,g.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",_,g.bind(this)))},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(c.Evented),mr=function(n){function a(o,l,d,_){n.call(this),this.id=o,this.dispatcher=d,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.extend({type:"raster"},l),c.extend(this,c.pick(l,["url","scheme","tileSize"]))}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Go(this._options,this.map._requestManager,function(l,d){o._tileJSONRequest=null,o._loaded=!0,l?o.fire(new c.ErrorEvent(l)):d&&(c.extend(o,d),d.bounds&&(o.tileBounds=new Vn(d.bounds,o.minzoom,o.maxzoom)),c.postTurnstileEvent(d.tiles),c.postMapLoadEvent(d.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return c.extend({},this._options)},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.loadTile=function(o,l){var d=this,_=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=c.getImage(this.map._requestManager.transformRequest(_,c.ResourceType.Tile),function(g,w){if(delete o.request,o.aborted)o.state="unloaded",l(null);else if(g)o.state="errored",l(g);else if(w){d.map._refreshExpiredTiles&&o.setExpiryData(w),delete w.cacheControl,delete w.expires;var P=d.map.painter.context,M=P.gl;o.texture=d.map.painter.getTileTexture(w.width),o.texture?o.texture.update(w,{useMipmap:!0}):(o.texture=new c.Texture(P,w,M.RGBA,{useMipmap:!0}),o.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),P.extTextureFilterAnisotropic&&M.texParameterf(M.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax)),o.state="loaded",c.cacheEntryPossiblyAdded(d.dispatcher),l(null)}})},a.prototype.abortTile=function(o,l){o.request&&(o.request.cancel(),delete o.request),l()},a.prototype.unloadTile=function(o,l){o.texture&&this.map.painter.saveTileTexture(o.texture),l()},a.prototype.hasTransition=function(){return!1},a}(c.Evented),_r=function(n){function a(o,l,d,_){n.call(this,o,l,d,_),this.type="raster-dem",this.maxzoom=22,this._options=c.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(o,l){var d=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function _(g,w){g&&(o.state="errored",l(g)),w&&(o.dem=w,o.needsHillshadePrepare=!0,o.state="loaded",l(null))}o.request=c.getImage(this.map._requestManager.transformRequest(d,c.ResourceType.Tile),function(g,w){if(delete o.request,o.aborted)o.state="unloaded",l(null);else if(g)o.state="errored",l(g);else if(w){this.map._refreshExpiredTiles&&o.setExpiryData(w),delete w.cacheControl,delete w.expires;var P=c.window.ImageBitmap&&w instanceof c.window.ImageBitmap&&c.offscreenCanvasSupported()?w:c.browser.getImageData(w,1),M={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:P,encoding:this.encoding};o.actor&&"expired"!==o.state||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",M,_.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},a.prototype._getNeighboringTiles=function(o){var l=o.canonical,d=Math.pow(2,l.z),_=(l.x-1+d)%d,g=0===l.x?o.wrap-1:o.wrap,w=(l.x+1+d)%d,P=l.x+1===d?o.wrap+1:o.wrap,M={};return M[new c.OverscaledTileID(o.overscaledZ,g,l.z,_,l.y).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,P,l.z,w,l.y).key]={backfilled:!1},l.y>0&&(M[new c.OverscaledTileID(o.overscaledZ,g,l.z,_,l.y-1).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,o.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,P,l.z,w,l.y-1).key]={backfilled:!1}),l.y+1<d&&(M[new c.OverscaledTileID(o.overscaledZ,g,l.z,_,l.y+1).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,o.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,P,l.z,w,l.y+1).key]={backfilled:!1}),M},a.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},a}(mr),Zn=function(n){function a(o,l,d,_){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(_),this._data=l.data,this._options=c.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],void 0!==l.maxzoom&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var g=c.EXTENT/this.tileSize;this.workerOptions=c.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(void 0!==l.buffer?l.buffer:128)*g,tolerance:(void 0!==l.tolerance?l.tolerance:.375)*g,extent:c.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:void 0!==l.clusterMaxZoom?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:c.EXTENT,radius:(l.clusterRadius||50)*g,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this.fire(new c.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)o.fire(new c.ErrorEvent(l));else{var d={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(d.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new c.Event("data",d))}})},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setData=function(o){var l=this;return this._data=o,this.fire(new c.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(d){if(d)l.fire(new c.ErrorEvent(d));else{var _={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(_.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new c.Event("data",_))}}),this},a.prototype.getClusterExpansionZoom=function(o,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},l),this},a.prototype.getClusterChildren=function(o,l){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},l),this},a.prototype.getClusterLeaves=function(o,l,d,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:l,offset:d},_),this},a.prototype._updateWorkerData=function(o){var l=this;this._loaded=!1;var d=c.extend({},this.workerOptions),_=this._data;"string"==typeof _?(d.request=this.map._requestManager.transformRequest(c.browser.resolveURL(_),c.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(_),this.actor.send(this.type+".loadData",d,function(g,w){l._removed||w&&w.abandoned||(l._loaded=!0,w&&w.resourceTiming&&w.resourceTiming[l.id]&&(l._resourceTiming=w.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:d.source},null),o(g))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(o,l){var d=this,_=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(_,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:c.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(g,w){return delete o.request,o.unloadVectorData(),o.aborted?l(null):g?l(g):(o.loadVectorData(w,d.map.painter,"reloadTile"===_),l(null))})},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},a.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return c.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(c.Evented),Tn=c.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Qn=function(n){function a(o,l,d,_){n.call(this),this.id=o,this.dispatcher=d,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=l}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(o,l){var d=this;this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this.url=this.options.url,c.getImage(this.map._requestManager.transformRequest(this.url,c.ResourceType.Image),function(_,g){d._loaded=!0,_?d.fire(new c.ErrorEvent(_)):g&&(d.image=g,o&&(d.coordinates=o),l&&l(),d._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(o){var l=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setCoordinates=function(o){var l=this;this.coordinates=o;var d=o.map(c.MercatorCoordinate.fromLngLat);this.tileID=function(g){for(var w=1/0,P=1/0,M=-1/0,j=-1/0,V=0,q=g;V<q.length;V+=1){var tt=q[V];w=Math.min(w,tt.x),P=Math.min(P,tt.y),M=Math.max(M,tt.x),j=Math.max(j,tt.y)}var Q=Math.max(M-w,j-P),st=Math.max(0,Math.floor(-Math.log(Q)/Math.LN2)),X=Math.pow(2,st);return new c.CanonicalTileID(st,Math.floor((w+M)/2*X),Math.floor((P+j)/2*X))}(d),this.minzoom=this.maxzoom=this.tileID.z;var _=d.map(function(g){return l.tileID.getTilePoint(g)._round()});return this._boundsArray=new c.StructArrayLayout4i8,this._boundsArray.emplaceBack(_[0].x,_[0].y,0,0),this._boundsArray.emplaceBack(_[1].x,_[1].y,c.EXTENT,0),this._boundsArray.emplaceBack(_[3].x,_[3].y,0,c.EXTENT),this._boundsArray.emplaceBack(_[2].x,_[2].y,c.EXTENT,c.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var o=this.map.painter.context,l=o.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Tn.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new c.Texture(o,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[d];"loaded"!==_.state&&(_.state="loaded",_.texture=this.texture)}}},a.prototype.loadTile=function(o,l){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},l(null)):(o.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(c.Evented),Vr=function(n){function a(o,l,d,_){n.call(this,o,l,d,_),this.roundZoom=!0,this.type="video",this.options=l}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1;var l=this.options;this.urls=[];for(var d=0,_=l.urls;d<_.length;d+=1)this.urls.push(this.map._requestManager.transformRequest(_[d],c.ResourceType.Source).url);c.getVideo(this.urls,function(g,w){o._loaded=!0,g?o.fire(new c.ErrorEvent(g)):w&&(o.video=w,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(o){if(this.video){var l=this.video.seekable;o<l.start(0)||o>l.end(0)?this.fire(new c.ErrorEvent(new c.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=o}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var o=this.map.painter.context,l=o.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Tn.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new c.Texture(o,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[d];"loaded"!==_.state&&(_.state="loaded",_.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(Qn),Sn=function(n){function a(o,l,d,_){n.call(this,o,l,d,_),l.coordinates?Array.isArray(l.coordinates)&&4===l.coordinates.length&&!l.coordinates.some(function(g){return!Array.isArray(g)||2!==g.length||g.some(function(w){return"number"!=typeof w})})||this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'missing required property "coordinates"'))),l.animate&&"boolean"!=typeof l.animate&&this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),l.canvas?"string"==typeof l.canvas||l.canvas instanceof c.window.HTMLCanvasElement||this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=l,this.animate=void 0===l.animate||l.animate}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof c.window.HTMLCanvasElement?this.options.canvas:c.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var l=this.map.painter.context,d=l.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Tn.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.Texture(l,this.canvas,d.RGBA,{premultiply:!0}),this.tiles){var g=this.tiles[_];"loaded"!==g.state&&(g.state="loaded",g.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var o=0,l=[this.canvas.width,this.canvas.height];o<l.length;o+=1){var d=l[o];if(isNaN(d)||d<=0)return!0}return!1},a}(Qn),tr={vector:Wo,raster:mr,"raster-dem":_r,geojson:Zn,video:Vr,image:Qn,canvas:Sn};function zn(n,a){var o=c.identity([]);return c.translate(o,o,[1,1,0]),c.scale(o,o,[.5*n.width,.5*n.height,1]),c.multiply(o,o,n.calculatePosMatrix(a.toUnwrapped()))}function kn(n,a,o,l,d,_){var g=function(st,X,at){if(st)for(var ht=0,_t=st;ht<_t.length;ht+=1){var Et=X[_t[ht]];if(Et&&Et.source===at&&"fill-extrusion"===Et.type)return!0}else for(var wt in X){var It=X[wt];if(It.source===at&&"fill-extrusion"===It.type)return!0}return!1}(d&&d.layers,a,n.id),w=_.maxPitchScaleFactor(),P=n.tilesIn(l,w,g);P.sort(Zr);for(var M=[],j=0,V=P;j<V.length;j+=1){var q=V[j];M.push({wrappedTileID:q.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(a,o,n._state,q.queryGeometry,q.cameraQueryGeometry,q.scale,d,_,w,zn(n.transform,q.tileID))})}var tt=function(st){for(var X={},at={},ht=0,_t=st;ht<_t.length;ht+=1){var Et=_t[ht],wt=Et.queryResults,It=Et.wrappedTileID,Rt=at[It]=at[It]||{};for(var Yt in wt)for(var Xt=wt[Yt],ue=Rt[Yt]=Rt[Yt]||{},ve=X[Yt]=X[Yt]||[],Se=0,we=Xt;Se<we.length;Se+=1){var Ei=we[Se];ue[Ei.featureIndex]||(ue[Ei.featureIndex]=!0,ve.push(Ei))}}return X}(M);for(var Q in tt)tt[Q].forEach(function(st){var X=st.feature,at=n.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=at});return tt}function Zr(n,a){var o=n.tileID,l=a.tileID;return o.overscaledZ-l.overscaledZ||o.canonical.y-l.canonical.y||o.wrap-l.wrap||o.canonical.x-l.canonical.x}var _i=function(n,a){this.max=n,this.onRemove=a,this.reset()};_i.prototype.reset=function(){for(var n in this.data)for(var a=0,o=this.data[n];a<o.length;a+=1){var l=o[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},_i.prototype.add=function(n,a,o){var l=this,d=n.wrapped().key;void 0===this.data[d]&&(this.data[d]=[]);var _={value:a,timeout:void 0};if(void 0!==o&&(_.timeout=setTimeout(function(){l.remove(n,_)},o)),this.data[d].push(_),this.order.push(d),this.order.length>this.max){var g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this},_i.prototype.has=function(n){return n.wrapped().key in this.data},_i.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},_i.prototype._getAndRemoveByKey=function(n){var a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),0===this.data[n].length&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value},_i.prototype.getByKey=function(n){var a=this.data[n];return a?a[0].value:null},_i.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},_i.prototype.remove=function(n,a){if(!this.has(n))return this;var o=n.wrapped().key,l=void 0===a?0:this.data[o].indexOf(a),d=this.data[o][l];return this.data[o].splice(l,1),d.timeout&&clearTimeout(d.timeout),0===this.data[o].length&&delete this.data[o],this.onRemove(d.value),this.order.splice(this.order.indexOf(o),1),this},_i.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},_i.prototype.filter=function(n){var a=[];for(var o in this.data)for(var l=0,d=this.data[o];l<d.length;l+=1){var _=d[l];n(_.value)||a.push(_)}for(var g=0,w=a;g<w.length;g+=1){var P=w[g];this.remove(P.value.tileID,P)}};var or=function(n,a,o){this.context=n;var l=n.gl;this.buffer=l.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};or.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},or.prototype.updateData=function(n){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},or.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Bi={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},vn=function(n,a,o,l){this.length=a.length,this.attributes=o,this.itemSize=a.bytesPerElement,this.dynamicDraw=l,this.context=n;var d=n.gl;this.buffer=d.createBuffer(),n.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};vn.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},vn.prototype.updateData=function(n){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)},vn.prototype.enableAttributes=function(n,a){for(var o=0;o<this.attributes.length;o++){var l=a.attributes[this.attributes[o].name];void 0!==l&&n.enableVertexAttribArray(l)}},vn.prototype.setVertexAttribPointers=function(n,a,o){for(var l=0;l<this.attributes.length;l++){var d=this.attributes[l],_=a.attributes[d.name];void 0!==_&&n.vertexAttribPointer(_,d.components,n[Bi[d.type]],!1,this.itemSize,d.offset+this.itemSize*(o||0))}},vn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ve=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Ve.prototype.get=function(){return this.current},Ve.prototype.set=function(n){},Ve.prototype.getDefault=function(){return this.default},Ve.prototype.setDefault=function(){this.set(this.default)};var po=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return c.Color.transparent},a.prototype.set=function(o){var l=this.current;(o.r!==l.r||o.g!==l.g||o.b!==l.b||o.a!==l.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(Ve),xn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},a}(Ve),un=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},a}(Ve),En=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(Ve),Zi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},a}(Ve),di=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},a}(Ve),wi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(o){var l=this.current;(o.func!==l.func||o.ref!==l.ref||o.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},a}(Ve),Qr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},a}(Ve),to=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=o,this.dirty=!1}},a}(Ve),x=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},a}(Ve),S=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=o,this.dirty=!1}},a}(Ve),D=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},a}(Ve),W=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.BLEND):l.disable(l.BLEND),this.current=o,this.dirty=!1}},a}(Ve),it=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},a}(Ve),pt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return c.Color.transparent},a.prototype.set=function(o){var l=this.current;(o.r!==l.r||o.g!==l.g||o.b!==l.b||o.a!==l.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(Ve),At=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},a}(Ve),Qt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=o,this.dirty=!1}},a}(Ve),he=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},a}(Ve),Pe=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},a}(Ve),ui=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},a}(Ve),bn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},a}(Ve),Ri=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(Ve),qn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},a}(Ve),Gn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}(Ve),fo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,o),this.current=o,this.dirty=!1}},a}(Ve),ar=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},a}(Ve),eo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},a}(Ve),er=function(n){function a(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},a}(Ve),sr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},a}(Ve),ko=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},a}(Ve),lr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},a}(Ve),Yi=function(n){function a(o,l){n.call(this,o),this.context=o,this.parent=l}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(Ve),z=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},a}(Yi),B=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}(Yi),F=function(n,a,o,l){this.context=n,this.width=a,this.height=o;var d=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new z(n,d),l&&(this.depthAttachment=new B(n,d))};F.prototype.destroy=function(){var n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var H=function(n,a,o){this.func=n,this.mask=a,this.range=o};H.ReadOnly=!1,H.ReadWrite=!0,H.disabled=new H(519,H.ReadOnly,[0,1]);var J=function(n,a,o,l,d,_){this.test=n,this.ref=a,this.mask=o,this.fail=l,this.depthFail=d,this.pass=_};J.disabled=new J({func:519,mask:0},0,0,7680,7680,7680);var ot=function(n,a,o){this.blendFunction=n,this.blendColor=a,this.mask=o};ot.disabled=new ot(ot.Replace=[1,0],c.Color.transparent,[!1,!1,!1,!1]),ot.unblended=new ot(ot.Replace,c.Color.transparent,[!0,!0,!0,!0]),ot.alphaBlended=new ot([1,771],c.Color.transparent,[!0,!0,!0,!0]);var ut=function(n,a,o){this.enable=n,this.mode=a,this.frontFace=o};ut.disabled=new ut(!1,1029,2305),ut.backCCW=new ut(!0,1029,2305);var N=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new po(this),this.clearDepth=new xn(this),this.clearStencil=new un(this),this.colorMask=new En(this),this.depthMask=new Zi(this),this.stencilMask=new di(this),this.stencilFunc=new wi(this),this.stencilOp=new Qr(this),this.stencilTest=new to(this),this.depthRange=new x(this),this.depthTest=new S(this),this.depthFunc=new D(this),this.blend=new W(this),this.blendFunc=new it(this),this.blendColor=new pt(this),this.blendEquation=new At(this),this.cullFace=new Qt(this),this.cullFaceSide=new he(this),this.frontFace=new Pe(this),this.program=new ui(this),this.activeTexture=new bn(this),this.viewport=new Ri(this),this.bindFramebuffer=new qn(this),this.bindRenderbuffer=new Gn(this),this.bindTexture=new fo(this),this.bindVertexBuffer=new ar(this),this.bindElementBuffer=new eo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new er(this),this.pixelStoreUnpack=new sr(this),this.pixelStoreUnpackPremultiplyAlpha=new ko(this),this.pixelStoreUnpackFlipY=new lr(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};N.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},N.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},N.prototype.createIndexBuffer=function(n,a){return new or(this,n,a)},N.prototype.createVertexBuffer=function(n,a,o){return new vn(this,n,a,o)},N.prototype.createRenderbuffer=function(n,a,o){var l=this.gl,d=l.createRenderbuffer();return this.bindRenderbuffer.set(d),l.renderbufferStorage(l.RENDERBUFFER,n,a,o),this.bindRenderbuffer.set(null),d},N.prototype.createFramebuffer=function(n,a,o){return new F(this,n,a,o)},N.prototype.clear=function(n){var a=n.color,o=n.depth,l=this.gl,d=0;a&&(d|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),void 0!==o&&(d|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),l.clear(d)},N.prototype.setCullFace=function(n){!1===n.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},N.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},N.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},N.prototype.setColorMode=function(n){c.deepEqual(n.blendFunction,ot.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},N.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var et=function(n){function a(o,l,d){var _=this;n.call(this),this.id=o,this.dispatcher=d,this.on("data",function(g){"source"===g.dataType&&"metadata"===g.sourceDataType&&(_._sourceLoaded=!0),_._sourceLoaded&&!_._paused&&"source"===g.dataType&&"content"===g.sourceDataType&&(_.reload(),_.transform&&_.update(_.transform))}),this.on("error",function(){_._sourceErrored=!0}),this._source=function(g,w,P,M){var j=new tr[w.type](g,w,P,M);if(j.id!==g)throw new Error("Expected Source id to be "+g+" instead of "+j.id);return c.bindAll(["load","abort","unload","serialize","prepare"],j),j}(o,l,d,this),this._tiles={},this._cache=new _i(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new c.SourceFeatureState}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},a.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var l=this._tiles[o];if("loaded"!==l.state&&"errored"!==l.state)return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(o,l){return this._source.loadTile(o,l)},a.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},a.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(o){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var d=this._tiles[l];d.upload(o),d.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return c.values(this._tiles).map(function(o){return o.tileID}).sort(mt).map(function(o){return o.key})},a.prototype.getRenderableIds=function(o){var l=this,d=[];for(var _ in this._tiles)this._isIdRenderable(_,o)&&d.push(this._tiles[_]);return o?d.sort(function(g,w){var P=g.tileID,M=w.tileID,j=new c.Point(P.canonical.x,P.canonical.y)._rotate(l.transform.angle),V=new c.Point(M.canonical.x,M.canonical.y)._rotate(l.transform.angle);return P.overscaledZ-M.overscaledZ||V.y-j.y||V.x-j.x}).map(function(g){return g.tileID.key}):d.map(function(g){return g.tileID}).sort(mt).map(function(g){return g.key})},a.prototype.hasRenderableParent=function(o){var l=this.findLoadedParent(o,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(o,l){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(l||!this._tiles[o].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(o,"reloading")},a.prototype._reloadTile=function(o,l){var d=this._tiles[o];d&&("loading"!==d.state&&(d.state=l),this._loadTile(d,this._tileLoaded.bind(this,d,o,l)))},a.prototype._tileLoaded=function(o,l,d,_){if(_)return o.state="errored",void(404!==_.status?this._source.fire(new c.ErrorEvent(_,{tile:o})):this.update(this.transform));o.timeAdded=c.browser.now(),"expired"===d&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(l,o),"raster-dem"===this.getSource().type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new c.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},a.prototype._backfillDEM=function(o){for(var l=this.getRenderableIds(),d=0;d<l.length;d++){var _=l[d];if(o.neighboringTiles&&o.neighboringTiles[_]){var g=this.getTileByID(_);w(o,g),w(g,o)}}function w(P,M){P.needsHillshadePrepare=!0;var j=M.tileID.canonical.x-P.tileID.canonical.x,V=M.tileID.canonical.y-P.tileID.canonical.y,q=Math.pow(2,P.tileID.canonical.z),tt=M.tileID.key;0===j&&0===V||Math.abs(V)>1||(Math.abs(j)>1&&(1===Math.abs(j+q)?j+=q:1===Math.abs(j-q)&&(j-=q)),M.dem&&P.dem&&(P.dem.backfillBorder(M.dem,j,V),P.neighboringTiles&&P.neighboringTiles[tt]&&(P.neighboringTiles[tt].backfilled=!0)))}},a.prototype.getTile=function(o){return this.getTileByID(o.key)},a.prototype.getTileByID=function(o){return this._tiles[o]},a.prototype._retainLoadedChildren=function(o,l,d,_){for(var g in this._tiles){var w=this._tiles[g];if(!(_[g]||!w.hasData()||w.tileID.overscaledZ<=l||w.tileID.overscaledZ>d)){for(var P=w.tileID;w&&w.tileID.overscaledZ>l+1;){var M=w.tileID.scaledTo(w.tileID.overscaledZ-1);(w=this._tiles[M.key])&&w.hasData()&&(P=M)}for(var j=P;j.overscaledZ>l;)if(o[(j=j.scaledTo(j.overscaledZ-1)).key]){_[P.key]=P;break}}}},a.prototype.findLoadedParent=function(o,l){if(o.key in this._loadedParentTiles){var d=this._loadedParentTiles[o.key];return d&&d.tileID.overscaledZ>=l?d:null}for(var _=o.overscaledZ-1;_>=l;_--){var g=o.scaledTo(_),w=this._getLoadedTile(g);if(w)return w}},a.prototype._getLoadedTile=function(o){var l=this._tiles[o.key];return l&&l.hasData()?l:this._cache.getByKey(o.wrapped().key)},a.prototype.updateCacheSize=function(o){var l=Math.ceil(o.width/this._source.tileSize)+1,d=Math.ceil(o.height/this._source.tileSize)+1,_=Math.floor(l*d*5),g="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(g)},a.prototype.handleWrapJump=function(o){var l=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,l){var d={};for(var _ in this._tiles){var g=this._tiles[_];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+l),d[g.tileID.key]=g}for(var w in this._tiles=d,this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(var P in this._tiles)this._setTileReloadTimer(P,this._tiles[P])}},a.prototype.update=function(o){var l=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var d;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?d=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Rt){return new c.OverscaledTileID(Rt.canonical.z,Rt.wrap,Rt.canonical.z,Rt.canonical.x,Rt.canonical.y)}):(d=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(d=d.filter(function(Rt){return l._source.hasTile(Rt)}))):d=[];var _=o.coveringZoomLevel(this._source),g=Math.max(_-a.maxOverzooming,this._source.minzoom),w=Math.max(_+a.maxUnderzooming,this._source.minzoom),P=this._updateRetainedTiles(d,_);if(Dt(this._source.type)){for(var M={},j={},V=0,q=Object.keys(P);V<q.length;V+=1){var tt=q[V],Q=P[tt],st=this._tiles[tt];if(st&&!(st.fadeEndTime&&st.fadeEndTime<=c.browser.now())){var X=this.findLoadedParent(Q,g);X&&(this._addTile(X.tileID),M[X.tileID.key]=X.tileID),j[tt]=Q}}for(var at in this._retainLoadedChildren(j,_,w,P),M)P[at]||(this._coveredTiles[at]=!0,P[at]=M[at])}for(var ht in P)this._tiles[ht].clearFadeHold();for(var _t=0,Et=c.keysDifference(this._tiles,P);_t<Et.length;_t+=1){var wt=Et[_t],It=this._tiles[wt];It.hasSymbolBuckets&&!It.holdingForFade()?It.setHoldDuration(this.map._fadeDuration):It.hasSymbolBuckets&&!It.symbolFadeFinished()||this._removeTile(wt)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},a.prototype._updateRetainedTiles=function(o,l){for(var d={},_={},g=Math.max(l-a.maxOverzooming,this._source.minzoom),w=Math.max(l+a.maxUnderzooming,this._source.minzoom),P={},M=0,j=o;M<j.length;M+=1){var V=j[M],q=this._addTile(V);d[V.key]=V,q.hasData()||l<this._source.maxzoom&&(P[V.key]=V)}this._retainLoadedChildren(P,l,w,d);for(var tt=0,Q=o;tt<Q.length;tt+=1){var st=Q[tt],X=this._tiles[st.key];if(!X.hasData()){if(l+1>this._source.maxzoom){var at=st.children(this._source.maxzoom)[0],ht=this.getTile(at);if(ht&&ht.hasData()){d[at.key]=at;continue}}else{var _t=st.children(this._source.maxzoom);if(d[_t[0].key]&&d[_t[1].key]&&d[_t[2].key]&&d[_t[3].key])continue}for(var Et=X.wasRequested(),wt=st.overscaledZ-1;wt>=g;--wt){var It=st.scaledTo(wt);if(_[It.key]||(_[It.key]=!0,!(X=this.getTile(It))&&Et&&(X=this._addTile(It)),X&&(d[It.key]=It,Et=X.wasRequested(),X.hasData())))break}}}return d},a.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var l=[],d=void 0,_=this._tiles[o].tileID;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){d=this._loadedParentTiles[_.key];break}l.push(_.key);var g=_.scaledTo(_.overscaledZ-1);if(d=this._getLoadedTile(g))break;_=g}for(var w=0,P=l;w<P.length;w+=1)this._loadedParentTiles[P[w]]=d}},a.prototype._addTile=function(o){var l=this._tiles[o.key];if(l)return l;(l=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,l),l.tileID=o,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,l)));var d=Boolean(l);return d||(l=new c.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,o.key,l.state))),l?(l.uses++,this._tiles[o.key]=l,d||this._source.fire(new c.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(o,l){var d=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var _=l.getExpiryTimeout();_&&(this._timers[o]=setTimeout(function(){d._reloadTile(o,"expired"),delete d._timers[o]},_))},a.prototype._removeTile=function(o){var l=this._tiles[o];l&&(l.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),l.uses>0||(l.hasData()&&"reloading"!==l.state?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},a.prototype.tilesIn=function(o,l,d){var _=this,g=[],w=this.transform;if(!w)return g;for(var P=d?w.getCameraQueryGeometry(o):o,M=o.map(function(wt){return w.pointCoordinate(wt)}),j=P.map(function(wt){return w.pointCoordinate(wt)}),V=this.getIds(),q=1/0,tt=1/0,Q=-1/0,st=-1/0,X=0,at=j;X<at.length;X+=1){var ht=at[X];q=Math.min(q,ht.x),tt=Math.min(tt,ht.y),Q=Math.max(Q,ht.x),st=Math.max(st,ht.y)}for(var _t=function(wt){var It=_._tiles[V[wt]];if(!It.holdingForFade()){var Rt=It.tileID,Yt=Math.pow(2,w.zoom-It.tileID.overscaledZ),Xt=l*It.queryPadding*c.EXTENT/It.tileSize/Yt,ue=[Rt.getTilePoint(new c.MercatorCoordinate(q,tt)),Rt.getTilePoint(new c.MercatorCoordinate(Q,st))];if(ue[0].x-Xt<c.EXTENT&&ue[0].y-Xt<c.EXTENT&&ue[1].x+Xt>=0&&ue[1].y+Xt>=0){var ve=M.map(function(we){return Rt.getTilePoint(we)}),Se=j.map(function(we){return Rt.getTilePoint(we)});g.push({tile:It,tileID:Rt,queryGeometry:ve,cameraQueryGeometry:Se,scale:Yt})}}},Et=0;Et<V.length;Et++)_t(Et);return g},a.prototype.getVisibleCoordinates=function(o){for(var l=this,d=this.getRenderableIds(o).map(function(P){return l._tiles[P].tileID}),_=0,g=d;_<g.length;_+=1){var w=g[_];w.posMatrix=this.transform.calculatePosMatrix(w.toUnwrapped())}return d},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Dt(this._source.type))for(var o in this._tiles){var l=this._tiles[o];if(void 0!==l.fadeEndTime&&l.fadeEndTime>=c.browser.now())return!0}return!1},a.prototype.setFeatureState=function(o,l,d){this._state.updateState(o=o||"_geojsonTileLayer",l,d)},a.prototype.removeFeatureState=function(o,l,d){this._state.removeFeatureState(o=o||"_geojsonTileLayer",l,d)},a.prototype.getFeatureState=function(o,l){return this._state.getState(o=o||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(o,l,d){var _=this._tiles[o];_&&_.setDependencies(l,d)},a.prototype.reloadTilesForDependencies=function(o,l){for(var d in this._tiles)this._tiles[d].hasDependency(o,l)&&this._reloadTile(d,"reloading");this._cache.filter(function(_){return!_.hasDependency(o,l)})},a}(c.Evented);function mt(n,a){var o=Math.abs(2*n.wrap)-+(n.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return n.overscaledZ-a.overscaledZ||l-o||a.canonical.y-n.canonical.y||a.canonical.x-n.canonical.x}function Dt(n){return"raster"===n||"image"===n||"video"===n}function Nt(){return new c.window.Worker(bl.workerUrl)}et.maxOverzooming=10,et.maxUnderzooming=3;var bt="mapboxgl_preloaded_worker_pool",Bt=function(){this.active={}};Bt.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Bt.workerCount;)this.workers.push(new Nt);return this.active[n]=!0,this.workers.slice()},Bt.prototype.release=function(n){delete this.active[n],0===this.numActive()&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Bt.prototype.isPreloaded=function(){return!!this.active[bt]},Bt.prototype.numActive=function(){return Object.keys(this.active).length};var jt,Gt=Math.floor(c.browser.hardwareConcurrency/2);function St(){return jt||(jt=new Bt),jt}function ie(n,a){var o={};for(var l in n)"ref"!==l&&(o[l]=n[l]);return c.refProperties.forEach(function(d){d in a&&(o[d]=a[d])}),o}function Kt(n){n=n.slice();for(var a=Object.create(null),o=0;o<n.length;o++)a[n[o].id]=n[o];for(var l=0;l<n.length;l++)"ref"in n[l]&&(n[l]=ie(n[l],a[n[l].ref]));return n}Bt.workerCount=Math.max(Math.min(Gt,6),1);var Jt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function re(n,a,o){o.push({command:Jt.addSource,args:[n,a[n]]})}function Vt(n,a,o){a.push({command:Jt.removeSource,args:[n]}),o[n]=!0}function Ke(n,a,o,l){Vt(n,o,l),re(n,a,o)}function fi(n,a,o){var l;for(l in n[o])if(n[o].hasOwnProperty(l)&&"data"!==l&&!c.deepEqual(n[o][l],a[o][l]))return!1;for(l in a[o])if(a[o].hasOwnProperty(l)&&"data"!==l&&!c.deepEqual(n[o][l],a[o][l]))return!1;return!0}function Ae(n,a,o,l,d,_){var g;for(g in a=a||{},n=n||{})n.hasOwnProperty(g)&&(c.deepEqual(n[g],a[g])||o.push({command:_,args:[l,g,a[g],d]}));for(g in a)a.hasOwnProperty(g)&&!n.hasOwnProperty(g)&&(c.deepEqual(n[g],a[g])||o.push({command:_,args:[l,g,a[g],d]}))}function hi(n){return n.id}function Ne(n,a){return n[a.id]=a,n}var Ti=function(n,a){this.reset(n,a)};Ti.prototype.reset=function(n,a){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ti.prototype.lerp=function(n){if(1===this.points.length)return this.points[0];n=c.clamp(n,0,1);for(var a=1,o=this._distances[a],l=n*this.paddedLength+this.padding;o<l&&a<this._distances.length;)o=this._distances[++a];var d=a-1,_=this._distances[d],g=o-_,w=g>0?(l-_)/g:0;return this.points[d].mult(1-w).add(this.points[a].mult(w))};var ei=function(n,a,o){var l=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(a/o);for(var _=0;_<this.xCellCount*this.yCellCount;_++)l.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0};function Xi(n,a,o,l,d){var _=c.create();return a?(c.scale(_,_,[1/d,1/d,1]),o||c.rotateZ(_,_,l.angle)):c.multiply(_,l.labelPlaneMatrix,n),_}function yi(n,a,o,l,d){if(a){var _=c.clone(n);return c.scale(_,_,[d,d,1]),o||c.rotateZ(_,_,-l.angle),_}return l.glCoordMatrix}function He(n,a){var o=[n.x,n.y,0,1];wn(o,o,a);var l=o[3];return{point:new c.Point(o[0]/l,o[1]/l),signedDistanceFromCamera:l}}function si(n,a){return.5+n/a*.5}function Mn(n,a){var o=n[0]/n[3],l=n[1]/n[3];return o>=-a[0]&&o<=a[0]&&l>=-a[1]&&l<=a[1]}function Ho(n,a,o,l,d,_,g,w){var P=l?n.textSizeData:n.iconSizeData,M=c.evaluateSizeForZoom(P,o.transform.zoom),j=[256/o.width*2+1,256/o.height*2+1],V=l?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;V.clear();for(var q=n.lineVertexArray,tt=l?n.text.placedSymbolArray:n.icon.placedSymbolArray,Q=o.transform.width/o.transform.height,st=!1,X=0;X<tt.length;X++){var at=tt.get(X);if(at.hidden||at.writingMode===c.WritingMode.vertical&&!st)Bn(at.numGlyphs,V);else{st=!1;var ht=[at.anchorX,at.anchorY,0,1];if(c.transformMat4(ht,ht,a),Mn(ht,j)){var _t=si(o.transform.cameraToCenterDistance,ht[3]),Et=c.evaluateSizeForFeature(P,M,at),wt=g?Et/_t:Et*_t,It=new c.Point(at.anchorX,at.anchorY),Rt=He(It,d).point,Yt={},Xt=ir(at,wt,!1,w,a,d,_,n.glyphOffsetArray,q,V,Rt,It,Yt,Q);st=Xt.useVertical,(Xt.notEnoughRoom||st||Xt.needsFlipping&&ir(at,wt,!0,w,a,d,_,n.glyphOffsetArray,q,V,Rt,It,Yt,Q).notEnoughRoom)&&Bn(at.numGlyphs,V)}else Bn(at.numGlyphs,V)}}l?n.text.dynamicLayoutVertexBuffer.updateData(V):n.icon.dynamicLayoutVertexBuffer.updateData(V)}function Dn(n,a,o,l,d,_,g,w,P,M,j){var V=w.glyphStartIndex+w.numGlyphs,q=w.lineStartIndex,tt=w.lineStartIndex+w.lineLength,Q=a.getoffsetX(w.glyphStartIndex),st=a.getoffsetX(V-1),X=nn(n*Q,o,l,d,_,g,w.segment,q,tt,P,M,j);if(!X)return null;var at=nn(n*st,o,l,d,_,g,w.segment,q,tt,P,M,j);return at?{first:X,last:at}:null}function Oe(n,a,o,l){return n===c.WritingMode.horizontal&&Math.abs(o.y-a.y)>Math.abs(o.x-a.x)*l?{useVertical:!0}:(n===c.WritingMode.vertical?a.y<o.y:a.x>o.x)?{needsFlipping:!0}:null}function ir(n,a,o,l,d,_,g,w,P,M,j,V,q,tt){var Q,st=a/24,X=n.lineOffsetX*st,at=n.lineOffsetY*st;if(n.numGlyphs>1){var ht=n.glyphStartIndex+n.numGlyphs,_t=n.lineStartIndex,Et=n.lineStartIndex+n.lineLength,wt=Dn(st,w,X,at,o,j,V,n,P,_,q);if(!wt)return{notEnoughRoom:!0};var It=He(wt.first.point,g).point,Rt=He(wt.last.point,g).point;if(l&&!o){var Yt=Oe(n.writingMode,It,Rt,tt);if(Yt)return Yt}Q=[wt.first];for(var Xt=n.glyphStartIndex+1;Xt<ht-1;Xt++)Q.push(nn(st*w.getoffsetX(Xt),X,at,o,j,V,n.segment,_t,Et,P,_,q));Q.push(wt.last)}else{if(l&&!o){var ue=He(V,d).point,ve=n.lineStartIndex+n.segment+1,Se=new c.Point(P.getx(ve),P.gety(ve)),we=He(Se,d),Ei=we.signedDistanceFromCamera>0?we.point:en(V,Se,ue,1,d),pe=Oe(n.writingMode,ue,Ei,tt);if(pe)return pe}var Re=nn(st*w.getoffsetX(n.glyphStartIndex),X,at,o,j,V,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,P,_,q);if(!Re)return{notEnoughRoom:!0};Q=[Re]}for(var Je=0,Be=Q;Je<Be.length;Je+=1){var ke=Be[Je];c.addDynamicAttributes(M,ke.point,ke.angle)}return{}}function en(n,a,o,l,d){var _=He(n.add(n.sub(a)._unit()),d).point,g=o.sub(_);return o.add(g._mult(l/g.mag()))}function nn(n,a,o,l,d,_,g,w,P,M,j,V){var q=l?n-a:n+a,tt=q>0?1:-1,Q=0;l&&(tt*=-1,Q=Math.PI),tt<0&&(Q+=Math.PI);for(var st=tt>0?w+g:w+g+1,X=d,at=d,ht=0,_t=0,Et=Math.abs(q),wt=[];ht+_t<=Et;){if((st+=tt)<w||st>=P)return null;if(at=X,wt.push(X),void 0===(X=V[st])){var It=new c.Point(M.getx(st),M.gety(st)),Rt=He(It,j);if(Rt.signedDistanceFromCamera>0)X=V[st]=Rt.point;else{var Yt=st-tt;X=en(0===ht?_:new c.Point(M.getx(Yt),M.gety(Yt)),It,at,Et-ht+1,j)}}ht+=_t,_t=at.dist(X)}var Xt=(Et-ht)/_t,ue=X.sub(at),ve=ue.mult(Xt)._add(at);ve._add(ue._unit()._perp()._mult(o*tt));var Se=Q+Math.atan2(X.y-at.y,X.x-at.x);return wt.push(ve),{point:ve,angle:Se,path:wt}}ei.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ei.prototype.insert=function(n,a,o,l,d){this._forEachCell(a,o,l,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(d)},ei.prototype.insertCircle=function(n,a,o,l){this._forEachCell(a-l,o-l,a+l,o+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(o),this.circles.push(l)},ei.prototype._insertBoxCell=function(n,a,o,l,d,_){this.boxCells[d].push(_)},ei.prototype._insertCircleCell=function(n,a,o,l,d,_){this.circleCells[d].push(_)},ei.prototype._query=function(n,a,o,l,d,_){if(o<0||n>this.width||l<0||a>this.height)return!d&&[];var g=[];if(n<=0&&a<=0&&this.width<=o&&this.height<=l){if(d)return!0;for(var w=0;w<this.boxKeys.length;w++)g.push({key:this.boxKeys[w],x1:this.bboxes[4*w],y1:this.bboxes[4*w+1],x2:this.bboxes[4*w+2],y2:this.bboxes[4*w+3]});for(var P=0;P<this.circleKeys.length;P++){var M=this.circles[3*P],j=this.circles[3*P+1],V=this.circles[3*P+2];g.push({key:this.circleKeys[P],x1:M-V,y1:j-V,x2:M+V,y2:j+V})}return _?g.filter(_):g}return this._forEachCell(n,a,o,l,this._queryCell,g,{hitTest:d,seenUids:{box:{},circle:{}}},_),d?g.length>0:g},ei.prototype._queryCircle=function(n,a,o,l,d){var _=n-o,g=n+o,w=a-o,P=a+o;if(g<0||_>this.width||P<0||w>this.height)return!l&&[];var M=[];return this._forEachCell(_,w,g,P,this._queryCellCircle,M,{hitTest:l,circle:{x:n,y:a,radius:o},seenUids:{box:{},circle:{}}},d),l?M.length>0:M},ei.prototype.query=function(n,a,o,l,d){return this._query(n,a,o,l,!1,d)},ei.prototype.hitTest=function(n,a,o,l,d){return this._query(n,a,o,l,!0,d)},ei.prototype.hitTestCircle=function(n,a,o,l){return this._queryCircle(n,a,o,!0,l)},ei.prototype._queryCell=function(n,a,o,l,d,_,g,w){var P=g.seenUids,M=this.boxCells[d];if(null!==M)for(var j=this.bboxes,V=0,q=M;V<q.length;V+=1){var tt=q[V];if(!P.box[tt]){P.box[tt]=!0;var Q=4*tt;if(n<=j[Q+2]&&a<=j[Q+3]&&o>=j[Q+0]&&l>=j[Q+1]&&(!w||w(this.boxKeys[tt]))){if(g.hitTest)return _.push(!0),!0;_.push({key:this.boxKeys[tt],x1:j[Q],y1:j[Q+1],x2:j[Q+2],y2:j[Q+3]})}}}var st=this.circleCells[d];if(null!==st)for(var X=this.circles,at=0,ht=st;at<ht.length;at+=1){var _t=ht[at];if(!P.circle[_t]){P.circle[_t]=!0;var Et=3*_t;if(this._circleAndRectCollide(X[Et],X[Et+1],X[Et+2],n,a,o,l)&&(!w||w(this.circleKeys[_t]))){if(g.hitTest)return _.push(!0),!0;var wt=X[Et],It=X[Et+1],Rt=X[Et+2];_.push({key:this.circleKeys[_t],x1:wt-Rt,y1:It-Rt,x2:wt+Rt,y2:It+Rt})}}}},ei.prototype._queryCellCircle=function(n,a,o,l,d,_,g,w){var P=g.circle,M=g.seenUids,j=this.boxCells[d];if(null!==j)for(var V=this.bboxes,q=0,tt=j;q<tt.length;q+=1){var Q=tt[q];if(!M.box[Q]){M.box[Q]=!0;var st=4*Q;if(this._circleAndRectCollide(P.x,P.y,P.radius,V[st+0],V[st+1],V[st+2],V[st+3])&&(!w||w(this.boxKeys[Q])))return _.push(!0),!0}}var X=this.circleCells[d];if(null!==X)for(var at=this.circles,ht=0,_t=X;ht<_t.length;ht+=1){var Et=_t[ht];if(!M.circle[Et]){M.circle[Et]=!0;var wt=3*Et;if(this._circlesCollide(at[wt],at[wt+1],at[wt+2],P.x,P.y,P.radius)&&(!w||w(this.circleKeys[Et])))return _.push(!0),!0}}},ei.prototype._forEachCell=function(n,a,o,l,d,_,g,w){for(var P=this._convertToXCellCoord(n),M=this._convertToYCellCoord(a),j=this._convertToXCellCoord(o),V=this._convertToYCellCoord(l),q=P;q<=j;q++)for(var tt=M;tt<=V;tt++)if(d.call(this,n,a,o,l,this.xCellCount*tt+q,_,g,w))return},ei.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},ei.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},ei.prototype._circlesCollide=function(n,a,o,l,d,_){var g=l-n,w=d-a,P=o+_;return P*P>g*g+w*w},ei.prototype._circleAndRectCollide=function(n,a,o,l,d,_,g){var w=(_-l)/2,P=Math.abs(n-(l+w));if(P>w+o)return!1;var M=(g-d)/2,j=Math.abs(a-(d+M));if(j>M+o)return!1;if(P<=w||j<=M)return!0;var V=P-w,q=j-M;return V*V+q*q<=o*o};var sa=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Bn(n,a){for(var o=0;o<n;o++){var l=a.length;a.resize(l+4),a.float32.set(sa,3*l)}}function wn(n,a,o){var l=a[0],d=a[1];return n[0]=o[0]*l+o[4]*d+o[12],n[1]=o[1]*l+o[5]*d+o[13],n[3]=o[3]*l+o[7]*d+o[15],n}var Wn=function(n,a,o){void 0===a&&(a=new ei(n.width+200,n.height+200,25)),void 0===o&&(o=new ei(n.width+200,n.height+200,25)),this.transform=n,this.grid=a,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Fi(n,a,o){return a*(c.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}Wn.prototype.placeCollisionBox=function(n,a,o,l,d){var _=this.projectAndGetPerspectiveRatio(l,n.anchorPointX,n.anchorPointY),g=o*_.perspectiveRatio,w=n.x1*g+_.point.x,P=n.y1*g+_.point.y,M=n.x2*g+_.point.x,j=n.y2*g+_.point.y;return!this.isInsideGrid(w,P,M,j)||!a&&this.grid.hitTest(w,P,M,j,d)?{box:[],offscreen:!1}:{box:[w,P,M,j],offscreen:this.isOffscreen(w,P,M,j)}},Wn.prototype.placeCollisionCircles=function(n,a,o,l,d,_,g,w,P,M,j,V,q){var tt=[],Q=new c.Point(a.anchorX,a.anchorY),st=He(Q,_),X=si(this.transform.cameraToCenterDistance,st.signedDistanceFromCamera),at=(M?d/X:d*X)/c.ONE_EM,ht=He(Q,g).point,_t=Dn(at,l,a.lineOffsetX*at,a.lineOffsetY*at,!1,ht,Q,a,o,g,{}),Et=!1,wt=!1,It=!0;if(_t){for(var Rt=.5*V*X+q,Yt=new c.Point(-100,-100),Xt=new c.Point(this.screenRightBoundary,this.screenBottomBoundary),ue=new Ti,ve=_t.first,Se=_t.last,we=[],Ei=ve.path.length-1;Ei>=1;Ei--)we.push(ve.path[Ei]);for(var pe=1;pe<Se.path.length;pe++)we.push(Se.path[pe]);var Re=2.5*Rt;if(w){var Je=we.map(function(ga){return He(ga,w)});we=Je.some(function(ga){return ga.signedDistanceFromCamera<=0})?[]:Je.map(function(ga){return ga.point})}var Be=[];if(we.length>0){for(var ke=we[0].clone(),Xe=we[0].clone(),ze=1;ze<we.length;ze++)ke.x=Math.min(ke.x,we[ze].x),ke.y=Math.min(ke.y,we[ze].y),Xe.x=Math.max(Xe.x,we[ze].x),Xe.y=Math.max(Xe.y,we[ze].y);Be=ke.x>=Yt.x&&Xe.x<=Xt.x&&ke.y>=Yt.y&&Xe.y<=Xt.y?[we]:Xe.x<Yt.x||ke.x>Xt.x||Xe.y<Yt.y||ke.y>Xt.y?[]:c.clipLine([we],Yt.x,Yt.y,Xt.x,Xt.y)}for(var Ce=0,Er=Be;Ce<Er.length;Ce+=1){var Fn;ue.reset(Er[Ce],.25*Rt),Fn=ue.length<=.5*Rt?1:Math.ceil(ue.paddedLength/Re)+1;for(var so=0;so<Fn;so++){var Fr=so/Math.max(Fn-1,1),An=ue.lerp(Fr),Kn=An.x+100,Zo=An.y+100;tt.push(Kn,Zo,Rt,0);var xo=Kn-Rt,ms=Zo-Rt,Ao=Kn+Rt,Pa=Zo+Rt;if(It=It&&this.isOffscreen(xo,ms,Ao,Pa),wt=wt||this.isInsideGrid(xo,ms,Ao,Pa),!n&&this.grid.hitTestCircle(Kn,Zo,Rt,j)&&(Et=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Et}}}}return{circles:!P&&Et||!wt?[]:tt,offscreen:It,collisionDetected:Et}},Wn.prototype.queryRenderedSymbols=function(n){if(0===n.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var a=[],o=1/0,l=1/0,d=-1/0,_=-1/0,g=0,w=n;g<w.length;g+=1){var P=w[g],M=new c.Point(P.x+100,P.y+100);o=Math.min(o,M.x),l=Math.min(l,M.y),d=Math.max(d,M.x),_=Math.max(_,M.y),a.push(M)}for(var j={},V={},q=0,tt=this.grid.query(o,l,d,_).concat(this.ignoredGrid.query(o,l,d,_));q<tt.length;q+=1){var Q=tt[q],st=Q.key;if(void 0===j[st.bucketInstanceId]&&(j[st.bucketInstanceId]={}),!j[st.bucketInstanceId][st.featureIndex]){var X=[new c.Point(Q.x1,Q.y1),new c.Point(Q.x2,Q.y1),new c.Point(Q.x2,Q.y2),new c.Point(Q.x1,Q.y2)];c.polygonIntersectsPolygon(a,X)&&(j[st.bucketInstanceId][st.featureIndex]=!0,void 0===V[st.bucketInstanceId]&&(V[st.bucketInstanceId]=[]),V[st.bucketInstanceId].push(st.featureIndex))}}return V},Wn.prototype.insertCollisionBox=function(n,a,o,l,d){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:l,collisionGroupID:d},n[0],n[1],n[2],n[3])},Wn.prototype.insertCollisionCircles=function(n,a,o,l,d){for(var _=a?this.ignoredGrid:this.grid,g={bucketInstanceId:o,featureIndex:l,collisionGroupID:d},w=0;w<n.length;w+=4)_.insertCircle(g,n[w],n[w+1],n[w+2])},Wn.prototype.projectAndGetPerspectiveRatio=function(n,a,o){var l=[a,o,0,1];return wn(l,l,n),{point:new c.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},Wn.prototype.isOffscreen=function(n,a,o,l){return o<100||n>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},Wn.prototype.isInsideGrid=function(n,a,o,l){return o>=0&&n<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},Wn.prototype.getViewportMatrix=function(){var n=c.identity([]);return c.translate(n,n,[-100,-100,0]),n};var yr=function(n,a,o,l){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):l&&o?1:0,this.placed=o};yr.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var an=function(n,a,o,l,d){this.text=new yr(n?n.text:null,a,o,d),this.icon=new yr(n?n.icon:null,a,l,d)};an.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Mo=function(n,a,o){this.text=n,this.icon=a,this.skipFade=o},qr=function(){this.invProjMatrix=c.create(),this.viewportMatrix=c.create(),this.circles=[]},Vs=function(n,a,o,l,d){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=o,this.bucketIndex=l,this.tileID=d},io=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function On(n,a,o,l,d){var _=c.getAnchorAlignment(n),g=-(_.horizontalAlign-.5)*a,w=-(_.verticalAlign-.5)*o,P=c.evaluateVariableOffset(n,l);return new c.Point(g+P[0]*d,w+P[1]*d)}function mo(n,a,o,l,d,_){var g=n.x1,w=n.x2,P=n.y1,M=n.y2,j=n.anchorPointX,V=n.anchorPointY,q=new c.Point(a,o);return l&&q._rotate(d?_:-_),{x1:g+q.x,y1:P+q.y,x2:w+q.x,y2:M+q.y,anchorPointX:j,anchorPointY:V}}io.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:function(o){return o.collisionGroupID===a}}}return this.collisionGroups[n]};var Rn=function(n,a,o,l){this.transform=n.clone(),this.collisionIndex=new Wn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new io(o),this.collisionCircleArrays={},this.prevPlacement=l,l&&(l.prevPlacement=void 0),this.placedOrientations={}};function So(n,a,o,l,d){n.emplaceBack(a?1:0,o?1:0,l||0,d||0),n.emplaceBack(a?1:0,o?1:0,l||0,d||0),n.emplaceBack(a?1:0,o?1:0,l||0,d||0),n.emplaceBack(a?1:0,o?1:0,l||0,d||0)}Rn.prototype.getBucketParts=function(n,a,o,l){var d=o.getBucket(a),_=o.latestFeatureIndex;if(d&&_&&a.id===d.layerIds[0]){var g=o.collisionBoxArray,w=d.layers[0].layout,P=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),M=o.tileSize/c.EXTENT,j=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),V="map"===w.get("text-pitch-alignment"),q="map"===w.get("text-rotation-alignment"),tt=Fi(o,1,this.transform.zoom),Q=Xi(j,V,q,this.transform,tt),st=null;if(V){var X=yi(j,V,q,this.transform,tt);st=c.multiply([],this.transform.labelPlaneMatrix,X)}this.retainedQueryData[d.bucketInstanceId]=new Vs(d.bucketInstanceId,_,d.sourceLayerIndex,d.index,o.tileID);var at={bucket:d,layout:w,posMatrix:j,textLabelPlaneMatrix:Q,labelToScreenMatrix:st,scale:P,textPixelRatio:M,holdingForFade:o.holdingForFade(),collisionBoxArray:g,partiallyEvaluatedTextSize:c.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(l)for(var ht=0,_t=d.sortKeyRanges;ht<_t.length;ht+=1){var Et=_t[ht];n.push({sortKey:Et.sortKey,symbolInstanceStart:Et.symbolInstanceStart,symbolInstanceEnd:Et.symbolInstanceEnd,parameters:at})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:at})}},Rn.prototype.attemptAnchorPlacement=function(n,a,o,l,d,_,g,w,P,M,j,V,q,tt,Q){var st,X=[V.textOffset0,V.textOffset1],at=On(n,o,l,X,d),ht=this.collisionIndex.placeCollisionBox(mo(a,at.x,at.y,_,g,this.transform.angle),j,w,P,M.predicate);if(!Q||0!==this.collisionIndex.placeCollisionBox(mo(Q,at.x,at.y,_,g,this.transform.angle),j,w,P,M.predicate).box.length)return ht.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID].text&&(st=this.prevPlacement.variableOffsets[V.crossTileID].anchor),this.variableOffsets[V.crossTileID]={textOffset:X,width:o,height:l,anchor:n,textBoxScale:d,prevAnchor:st},this.markUsedJustification(q,n,V,tt),q.allowVerticalPlacement&&(this.markUsedOrientation(q,tt,V),this.placedOrientations[V.crossTileID]=tt),{shift:at,placedGlyphBoxes:ht}):void 0},Rn.prototype.placeLayerBucketPart=function(n,a,o){var l=this,d=n.parameters,_=d.bucket,g=d.layout,w=d.posMatrix,P=d.textLabelPlaneMatrix,M=d.labelToScreenMatrix,j=d.textPixelRatio,V=d.holdingForFade,q=d.collisionBoxArray,tt=d.partiallyEvaluatedTextSize,Q=d.collisionGroup,st=g.get("text-optional"),X=g.get("icon-optional"),at=g.get("text-allow-overlap"),ht=g.get("icon-allow-overlap"),_t="map"===g.get("text-rotation-alignment"),Et="map"===g.get("text-pitch-alignment"),wt="none"!==g.get("icon-text-fit"),It="viewport-y"===g.get("symbol-z-order"),Rt=at&&(ht||!_.hasIconData()||X),Yt=ht&&(at||!_.hasTextData()||st);!_.collisionArrays&&q&&_.deserializeCollisionBoxes(q);var Xt=function(pe,Re){if(!a[pe.crossTileID])if(V)l.placements[pe.crossTileID]=new Mo(!1,!1,!1);else{var Je,Be=!1,ke=!1,Xe=!0,ze=null,Ce={box:null,offscreen:null},Er={box:null,offscreen:null},Fn=null,so=null,Fr=0,An=0,Kn=0;Re.textFeatureIndex?Fr=Re.textFeatureIndex:pe.useRuntimeCollisionCircles&&(Fr=pe.featureIndex),Re.verticalTextFeatureIndex&&(An=Re.verticalTextFeatureIndex);var Zo=Re.textBox;if(Zo){var xo=function(Oi){var na=c.WritingMode.horizontal;if(_.allowVerticalPlacement&&!Oi&&l.prevPlacement){var Co=l.prevPlacement.placedOrientations[pe.crossTileID];Co&&(l.placedOrientations[pe.crossTileID]=Co,l.markUsedOrientation(_,na=Co,pe))}return na},ms=function(Oi,na){if(_.allowVerticalPlacement&&pe.numVerticalGlyphVertices>0&&Re.verticalTextBox)for(var Co=0,Bs=_.writingModes;Co<Bs.length&&(Bs[Co]===c.WritingMode.vertical?(Ce=na(),Er=Ce):Ce=Oi(),!(Ce&&Ce.box&&Ce.box.length));Co+=1);else Ce=Oi()};if(g.get("text-variable-anchor")){var Ao=g.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[pe.crossTileID]){var Pa=l.prevPlacement.variableOffsets[pe.crossTileID];Ao.indexOf(Pa.anchor)>0&&(Ao=Ao.filter(function(Oi){return Oi!==Pa.anchor})).unshift(Pa.anchor)}var ga=function(Oi,na,Co){for(var Bs=Oi.x2-Oi.x1,sh=Oi.y2-Oi.y1,wl=pe.textBoxScale,lh=wt&&!ht?na:null,ul={box:[],offscreen:!1},Au=at?2*Ao.length:Ao.length,Js=0;Js<Au;++Js){var Tl=l.attemptAnchorPlacement(Ao[Js%Ao.length],Oi,Bs,sh,wl,_t,Et,j,w,Q,Js>=Ao.length,pe,_,Co,lh);if(Tl&&(ul=Tl.placedGlyphBoxes)&&ul.box&&ul.box.length){Be=!0,ze=Tl.shift;break}}return ul};ms(function(){return ga(Zo,Re.iconBox,c.WritingMode.horizontal)},function(){var Oi=Re.verticalTextBox;return _.allowVerticalPlacement&&!(Ce&&Ce.box&&Ce.box.length)&&pe.numVerticalGlyphVertices>0&&Oi?ga(Oi,Re.verticalIconBox,c.WritingMode.vertical):{box:null,offscreen:null}}),Ce&&(Be=Ce.box,Xe=Ce.offscreen);var al=xo(Ce&&Ce.box);if(!Be&&l.prevPlacement){var Xs=l.prevPlacement.variableOffsets[pe.crossTileID];Xs&&(l.variableOffsets[pe.crossTileID]=Xs,l.markUsedJustification(_,Xs.anchor,pe,al))}}else{var _s=function(Oi,na){var Co=l.collisionIndex.placeCollisionBox(Oi,at,j,w,Q.predicate);return Co&&Co.box&&Co.box.length&&(l.markUsedOrientation(_,na,pe),l.placedOrientations[pe.crossTileID]=na),Co};ms(function(){return _s(Zo,c.WritingMode.horizontal)},function(){var Oi=Re.verticalTextBox;return _.allowVerticalPlacement&&pe.numVerticalGlyphVertices>0&&Oi?_s(Oi,c.WritingMode.vertical):{box:null,offscreen:null}}),xo(Ce&&Ce.box&&Ce.box.length)}}if(Be=(Je=Ce)&&Je.box&&Je.box.length>0,Xe=Je&&Je.offscreen,pe.useRuntimeCollisionCircles){var Ks=_.text.placedSymbolArray.get(pe.centerJustifiedTextSymbolIndex),sl=c.evaluateSizeForFeature(_.textSizeData,tt,Ks),Ra=g.get("text-padding");Fn=l.collisionIndex.placeCollisionCircles(at,Ks,_.lineVertexArray,_.glyphOffsetArray,sl,w,P,M,o,Et,Q.predicate,pe.collisionCircleDiameter,Ra),Be=at||Fn.circles.length>0&&!Fn.collisionDetected,Xe=Xe&&Fn.offscreen}if(Re.iconFeatureIndex&&(Kn=Re.iconFeatureIndex),Re.iconBox){var ll=function(Oi){var na=wt&&ze?mo(Oi,ze.x,ze.y,_t,Et,l.transform.angle):Oi;return l.collisionIndex.placeCollisionBox(na,ht,j,w,Q.predicate)};ke=Er&&Er.box&&Er.box.length&&Re.verticalIconBox?(so=ll(Re.verticalIconBox)).box.length>0:(so=ll(Re.iconBox)).box.length>0,Xe=Xe&&so.offscreen}var Fa=st||0===pe.numHorizontalGlyphVertices&&0===pe.numVerticalGlyphVertices,Ir=X||0===pe.numIconVertices;if(Fa||Ir?Ir?Fa||(ke=ke&&Be):Be=ke&&Be:ke=Be=ke&&Be,Be&&Je&&Je.box&&l.collisionIndex.insertCollisionBox(Je.box,g.get("text-ignore-placement"),_.bucketInstanceId,Er&&Er.box&&An?An:Fr,Q.ID),ke&&so&&l.collisionIndex.insertCollisionBox(so.box,g.get("icon-ignore-placement"),_.bucketInstanceId,Kn,Q.ID),Fn&&(Be&&l.collisionIndex.insertCollisionCircles(Fn.circles,g.get("text-ignore-placement"),_.bucketInstanceId,Fr,Q.ID),o)){var $a=_.bucketInstanceId,ys=l.collisionCircleArrays[$a];void 0===ys&&(ys=l.collisionCircleArrays[$a]=new qr);for(var Ds=0;Ds<Fn.circles.length;Ds+=4)ys.circles.push(Fn.circles[Ds+0]),ys.circles.push(Fn.circles[Ds+1]),ys.circles.push(Fn.circles[Ds+2]),ys.circles.push(Fn.collisionDetected?1:0)}l.placements[pe.crossTileID]=new Mo(Be||Rt,ke||Yt,Xe||_.justReloaded),a[pe.crossTileID]=!0}};if(It)for(var ue=_.getSortedSymbolIndexes(this.transform.angle),ve=ue.length-1;ve>=0;--ve){var Se=ue[ve];Xt(_.symbolInstances.get(Se),_.collisionArrays[Se])}else for(var we=n.symbolInstanceStart;we<n.symbolInstanceEnd;we++)Xt(_.symbolInstances.get(we),_.collisionArrays[we]);if(o&&_.bucketInstanceId in this.collisionCircleArrays){var Ei=this.collisionCircleArrays[_.bucketInstanceId];c.invert(Ei.invProjMatrix,w),Ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1},Rn.prototype.markUsedJustification=function(n,a,o,l){var d;d=l===c.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[c.getAnchorJustification(a)];for(var _=0,g=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];_<g.length;_+=1){var w=g[_];w>=0&&(n.text.placedSymbolArray.get(w).crossTileID=d>=0&&w!==d?0:o.crossTileID)}},Rn.prototype.markUsedOrientation=function(n,a,o){for(var l=a===c.WritingMode.horizontal||a===c.WritingMode.horizontalOnly?a:0,d=a===c.WritingMode.vertical?a:0,_=0,g=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];_<g.length;_+=1)n.text.placedSymbolArray.get(g[_]).placedOrientation=l;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=d)},Rn.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,o=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(n):1,d=a?a.opacities:{},_=a?a.variableOffsets:{},g=a?a.placedOrientations:{};for(var w in this.placements){var P=this.placements[w],M=d[w];M?(this.opacities[w]=new an(M,l,P.text,P.icon),o=o||P.text!==M.text.placed||P.icon!==M.icon.placed):(this.opacities[w]=new an(null,l,P.text,P.icon,P.skipFade),o=o||P.text||P.icon)}for(var j in d){var V=d[j];if(!this.opacities[j]){var q=new an(V,l,!1,!1);q.isHidden()||(this.opacities[j]=q,o=o||V.text.placed||V.icon.placed)}}for(var tt in _)this.variableOffsets[tt]||!this.opacities[tt]||this.opacities[tt].isHidden()||(this.variableOffsets[tt]=_[tt]);for(var Q in g)this.placedOrientations[Q]||!this.opacities[Q]||this.opacities[Q].isHidden()||(this.placedOrientations[Q]=g[Q]);o?this.lastPlacementChangeTime=n:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)},Rn.prototype.updateLayerOpacities=function(n,a){for(var o={},l=0,d=a;l<d.length;l+=1){var _=d[l],g=_.getBucket(n);g&&_.latestFeatureIndex&&n.id===g.layerIds[0]&&this.updateBucketOpacities(g,o,_.collisionBoxArray)}},Rn.prototype.updateBucketOpacities=function(n,a,o){var l=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var d=n.layers[0].layout,_=new an(null,0,!1,!1,!0),g=d.get("text-allow-overlap"),w=d.get("icon-allow-overlap"),P=d.get("text-variable-anchor"),M="map"===d.get("text-rotation-alignment"),j="map"===d.get("text-pitch-alignment"),V="none"!==d.get("icon-text-fit"),q=new an(null,0,g&&(w||!n.hasIconData()||d.get("icon-optional")),w&&(g||!n.hasTextData()||d.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var tt=function(at,ht,_t){for(var Et=0;Et<ht/4;Et++)at.opacityVertexArray.emplaceBack(_t)},Q=function(at){var ht=n.symbolInstances.get(at),_t=ht.numHorizontalGlyphVertices,Et=ht.numVerticalGlyphVertices,wt=ht.crossTileID,It=l.opacities[wt];a[wt]?It=_:It||(l.opacities[wt]=It=q),a[wt]=!0;var Rt=ht.numIconVertices>0,Yt=l.placedOrientations[ht.crossTileID],Xt=Yt===c.WritingMode.vertical,ue=Yt===c.WritingMode.horizontal||Yt===c.WritingMode.horizontalOnly;if(_t>0||Et>0){var ve=ns(It.text);tt(n.text,_t,Xt?no:ve),tt(n.text,Et,ue?no:ve);var Se=It.text.isHidden();[ht.rightJustifiedTextSymbolIndex,ht.centerJustifiedTextSymbolIndex,ht.leftJustifiedTextSymbolIndex].forEach(function(Ce){Ce>=0&&(n.text.placedSymbolArray.get(Ce).hidden=Se||Xt?1:0)}),ht.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(ht.verticalPlacedTextSymbolIndex).hidden=Se||ue?1:0);var we=l.variableOffsets[ht.crossTileID];we&&l.markUsedJustification(n,we.anchor,ht,Yt);var Ei=l.placedOrientations[ht.crossTileID];Ei&&(l.markUsedJustification(n,"left",ht,Ei),l.markUsedOrientation(n,Ei,ht))}if(Rt){var pe=ns(It.icon),Re=!(V&&ht.verticalPlacedIconSymbolIndex&&Xt);ht.placedIconSymbolIndex>=0&&(tt(n.icon,ht.numIconVertices,Re?pe:no),n.icon.placedSymbolArray.get(ht.placedIconSymbolIndex).hidden=It.icon.isHidden()),ht.verticalPlacedIconSymbolIndex>=0&&(tt(n.icon,ht.numVerticalIconVertices,Re?no:pe),n.icon.placedSymbolArray.get(ht.verticalPlacedIconSymbolIndex).hidden=It.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Je=n.collisionArrays[at];if(Je){var Be=new c.Point(0,0);if(Je.textBox||Je.verticalTextBox){var ke=!0;if(P){var Xe=l.variableOffsets[wt];Xe?(Be=On(Xe.anchor,Xe.width,Xe.height,Xe.textOffset,Xe.textBoxScale),M&&Be._rotate(j?l.transform.angle:-l.transform.angle)):ke=!1}Je.textBox&&So(n.textCollisionBox.collisionVertexArray,It.text.placed,!ke||Xt,Be.x,Be.y),Je.verticalTextBox&&So(n.textCollisionBox.collisionVertexArray,It.text.placed,!ke||ue,Be.x,Be.y)}var ze=Boolean(!ue&&Je.verticalIconBox);Je.iconBox&&So(n.iconCollisionBox.collisionVertexArray,It.icon.placed,ze,V?Be.x:0,V?Be.y:0),Je.verticalIconBox&&So(n.iconCollisionBox.collisionVertexArray,It.icon.placed,!ze,V?Be.x:0,V?Be.y:0)}}},st=0;st<n.symbolInstances.length;st++)Q(st);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var X=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=X.invProjMatrix,n.placementViewportMatrix=X.viewportMatrix,n.collisionCircleArray=X.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Rn.prototype.symbolFadeChange=function(n){return 0===this.fadeDuration?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Rn.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Rn.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Rn.prototype.stillRecent=function(n,a){var o=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*o>n},Rn.prototype.setStale=function(){this.stale=!0};var Ss=Math.pow(2,25),is=Math.pow(2,24),gi=Math.pow(2,17),Aa=Math.pow(2,16),Gr=Math.pow(2,9),Zs=Math.pow(2,8),Na=Math.pow(2,1);function ns(n){if(0===n.opacity&&!n.placed)return 0;if(1===n.opacity&&n.placed)return 4294967295;var a=n.placed?1:0,o=Math.floor(127*n.opacity);return o*Ss+a*is+o*gi+a*Aa+o*Gr+a*Zs+o*Na+a}var no=0,gr=function(n){this._sortAcrossTiles="viewport-y"!==n.layout.get("symbol-z-order")&&void 0!==n.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};gr.prototype.continuePlacement=function(n,a,o,l,d){for(var _=this._bucketParts;this._currentTileIndex<n.length;)if(a.getBucketParts(_,l,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort(function(g,w){return g.sortKey-w.sortKey}));this._currentPartIndex<_.length;)if(a.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,d())return!0;return!1};var la=function(n,a,o,l,d,_,g){this.placement=new Rn(n,d,_,g),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=l,this._done=!1};la.prototype.isDone=function(){return this._done},la.prototype.continuePlacement=function(n,a,o){for(var l=this,d=c.browser.now(),_=function(){var P=c.browser.now()-d;return!l._forceFullPlacement&&P>2};this._currentPlacementIndex>=0;){var g=a[n[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if("symbol"===g.type&&(!g.minzoom||g.minzoom<=w)&&(!g.maxzoom||g.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new gr(g)),this._inProgressLayer.continuePlacement(o[g.source],this.placement,this._showCollisionBoxes,g,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},la.prototype.commit=function(n){return this.placement.commit(n),this.placement};var qs=512/c.EXTENT/2,ja=function(n,a,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var l=0;l<a.length;l++){var d=a.get(l),_=d.key;this.indexedSymbolInstances[_]||(this.indexedSymbolInstances[_]=[]),this.indexedSymbolInstances[_].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,n)})}};ja.prototype.getScaledCoordinates=function(n,a){var o=qs/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*c.EXTENT+n.anchorX)*o),y:Math.floor((a.canonical.y*c.EXTENT+n.anchorY)*o)}},ja.prototype.findMatches=function(n,a,o){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),d=0;d<n.length;d++){var _=n.get(d);if(!_.crossTileID){var g=this.indexedSymbolInstances[_.key];if(g)for(var w=this.getScaledCoordinates(_,a),P=0,M=g;P<M.length;P+=1){var j=M[P];if(Math.abs(j.coord.x-w.x)<=l&&Math.abs(j.coord.y-w.y)<=l&&!o[j.crossTileID]){o[j.crossTileID]=!0,_.crossTileID=j.crossTileID;break}}}}};var ro=function(){this.maxCrossTileID=0};ro.prototype.generate=function(){return++this.maxCrossTileID};var Do=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Do.prototype.handleWrapJump=function(n){var a=Math.round((n-this.lng)/360);if(0!==a)for(var o in this.indexes){var l=this.indexes[o],d={};for(var _ in l){var g=l[_];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),d[g.tileID.key]=g}this.indexes[o]=d}this.lng=n},Do.prototype.addBucket=function(n,a,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var d=this.usedCrossTileIDs[n.overscaledZ];for(var _ in this.indexes){var g=this.indexes[_];if(Number(_)>n.overscaledZ)for(var w in g){var P=g[w];P.tileID.isChildOf(n)&&P.findMatches(a.symbolInstances,n,d)}else{var M=g[n.scaledTo(Number(_)).key];M&&M.findMatches(a.symbolInstances,n,d)}}for(var j=0;j<a.symbolInstances.length;j++){var V=a.symbolInstances.get(j);V.crossTileID||(V.crossTileID=o.generate(),d[V.crossTileID]=!0)}return void 0===this.indexes[n.overscaledZ]&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new ja(n,a.symbolInstances,a.bucketInstanceId),!0},Do.prototype.removeBucketCrossTileIDs=function(n,a){for(var o in a.indexedSymbolInstances)for(var l=0,d=a.indexedSymbolInstances[o];l<d.length;l+=1)delete this.usedCrossTileIDs[n][d[l].crossTileID]},Do.prototype.removeStaleBuckets=function(n){var a=!1;for(var o in this.indexes){var l=this.indexes[o];for(var d in l)n[l[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,l[d]),delete l[d],a=!0)}return a};var Wr=function(){this.layerIndexes={},this.crossTileIDs=new ro,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Wr.prototype.addLayer=function(n,a,o){var l=this.layerIndexes[n.id];void 0===l&&(l=this.layerIndexes[n.id]=new Do);var d=!1,_={};l.handleWrapJump(o);for(var g=0,w=a;g<w.length;g+=1){var P=w[g],M=P.getBucket(n);M&&n.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(P.tileID,M,this.crossTileIDs)&&(d=!0),_[M.bucketInstanceId]=!0)}return l.removeStaleBuckets(_)&&(d=!0),d},Wr.prototype.pruneUnusedLayers=function(n){var a={};for(var o in n.forEach(function(l){a[l]=!0}),this.layerIndexes)a[o]||delete this.layerIndexes[o]};var ua=function(n,a){return c.emitValidationErrors(n,a&&a.filter(function(o){return"source.canvas"!==o.identifier}))},Xo=c.pick(Jt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ko=c.pick(Jt,["setCenter","setZoom","setBearing","setPitch"]),Hn=function(){var n={},a=c.styleSpec.$version;for(var o in c.styleSpec.$root){var l,d=c.styleSpec.$root[o];d.required&&null!=(l="version"===o?a:"array"===d.type?[]:{})&&(n[o]=l)}return n}(),In=function(n){function a(o,l){var d=this;void 0===l&&(l={}),n.call(this),this.map=o,this.dispatcher=new _e(St(),this),this.imageManager=new je,this.imageManager.setEventedParent(this),this.glyphManager=new Ni(o._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Ye(256,512),this.crossTileSymbolIndex=new Wr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.getReferrer());var _=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(g){_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},function(w,P){if(c.triggerPluginCompletionEvent(w),P&&P.every(function(j){return j}))for(var M in _.sourceCaches)_.sourceCaches[M].reload()})}),this.on("data",function(g){if("source"===g.dataType&&"metadata"===g.sourceDataType){var w=d.sourceCaches[g.sourceId];if(w){var P=w.getSource();if(P&&P.vectorLayerIds)for(var M in d._layers){var j=d._layers[M];j.source===P.id&&d._validateLayer(j)}}}})}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.loadURL=function(o,l){var d=this;void 0===l&&(l={}),this.fire(new c.Event("dataloading",{dataType:"style"}));var _="boolean"==typeof l.validate?l.validate:!c.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,l.accessToken);var g=this.map._requestManager.transformRequest(o,c.ResourceType.Style);this._request=c.getJSON(g,function(w,P){d._request=null,w?d.fire(new c.ErrorEvent(w)):P&&d._load(P,_)})},a.prototype.loadJSON=function(o,l){var d=this;void 0===l&&(l={}),this.fire(new c.Event("dataloading",{dataType:"style"})),this._request=c.browser.frame(function(){d._request=null,d._load(o,!1!==l.validate)})},a.prototype.loadEmpty=function(){this.fire(new c.Event("dataloading",{dataType:"style"})),this._load(Hn,!1)},a.prototype._load=function(o,l){if(!l||!ua(this,c.validateStyle(o))){for(var d in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(d,o.sources[d],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var _=Kt(this.stylesheet.layers);this._order=_.map(function(M){return M.id}),this._layers={},this._serializedLayers={};for(var g=0,w=_;g<w.length;g+=1){var P=w[g];(P=c.createStyleLayer(P)).setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new zr(this.stylesheet.light),this.fire(new c.Event("data",{dataType:"style"})),this.fire(new c.Event("style.load"))}},a.prototype._loadSprite=function(o){var l=this;this._spriteRequest=function(d,_,g){var w,P,M,j=c.browser.devicePixelRatio>1?"@2x":"",V=c.getJSON(_.transformRequest(_.normalizeSpriteURL(d,j,".json"),c.ResourceType.SpriteJSON),function(Q,st){V=null,M||(M=Q,w=st,tt())}),q=c.getImage(_.transformRequest(_.normalizeSpriteURL(d,j,".png"),c.ResourceType.SpriteImage),function(Q,st){q=null,M||(M=Q,P=st,tt())});function tt(){if(M)g(M);else if(w&&P){var Q=c.browser.getImageData(P),st={};for(var X in w){var at=w[X],ht=at.width,_t=at.height,Et=at.x,wt=at.y,It=at.sdf,Rt=at.pixelRatio,Yt=at.stretchX,Xt=at.stretchY,ue=at.content,ve=new c.RGBAImage({width:ht,height:_t});c.RGBAImage.copy(Q,ve,{x:Et,y:wt},{x:0,y:0},{width:ht,height:_t}),st[X]={data:ve,pixelRatio:Rt,sdf:It,stretchX:Yt,stretchY:Xt,content:ue}}g(null,st)}}return{cancel:function(){V&&(V.cancel(),V=null),q&&(q.cancel(),q=null)}}}(o,this.map._requestManager,function(d,_){if(l._spriteRequest=null,d)l.fire(new c.ErrorEvent(d));else if(_)for(var g in _)l.imageManager.addImage(g,_[g]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new c.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(o){var l=this.sourceCaches[o.source];if(l){var d=o.sourceLayer;if(d){var _=l.getSource();("geojson"===_.type||_.vectorLayerIds&&-1===_.vectorLayerIds.indexOf(d))&&this.fire(new c.ErrorEvent(new Error('Source layer "'+d+'" does not exist on source "'+_.id+'" as specified by style layer "'+o.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(o){for(var l=[],d=0,_=o;d<_.length;d+=1){var g=this._layers[_[d]];"custom"!==g.type&&l.push(g.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(o){if(this._loaded){var l=this._changed;if(this._changed){var d=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);for(var g in(d.length||_.length)&&this._updateWorkerLayers(d,_),this._updatedSources){var w=this._updatedSources[g];"reload"===w?this._reloadSource(g):"clear"===w&&this._clearSource(g)}for(var P in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var M={};for(var j in this.sourceCaches){var V=this.sourceCaches[j];M[j]=V.used,V.used=!1}for(var q=0,tt=this._order;q<tt.length;q+=1){var Q=this._layers[tt[q]];Q.recalculate(o,this._availableImages),!Q.isHidden(o.zoom)&&Q.source&&(this.sourceCaches[Q.source].used=!0)}for(var st in M){var X=this.sourceCaches[st];M[st]!==X.used&&X.fire(new c.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:st}))}this.light.recalculate(o),this.z=o.zoom,l&&this.fire(new c.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},a.prototype._updateWorkerLayers=function(o,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(o){var l=this;if(this._checkLoaded(),ua(this,c.validateStyle(o)))return!1;(o=c.clone$1(o)).layers=Kt(o.layers);var d=function(g,w){if(!g)return[{command:Jt.setStyle,args:[w]}];var P=[];try{if(!c.deepEqual(g.version,w.version))return[{command:Jt.setStyle,args:[w]}];c.deepEqual(g.center,w.center)||P.push({command:Jt.setCenter,args:[w.center]}),c.deepEqual(g.zoom,w.zoom)||P.push({command:Jt.setZoom,args:[w.zoom]}),c.deepEqual(g.bearing,w.bearing)||P.push({command:Jt.setBearing,args:[w.bearing]}),c.deepEqual(g.pitch,w.pitch)||P.push({command:Jt.setPitch,args:[w.pitch]}),c.deepEqual(g.sprite,w.sprite)||P.push({command:Jt.setSprite,args:[w.sprite]}),c.deepEqual(g.glyphs,w.glyphs)||P.push({command:Jt.setGlyphs,args:[w.glyphs]}),c.deepEqual(g.transition,w.transition)||P.push({command:Jt.setTransition,args:[w.transition]}),c.deepEqual(g.light,w.light)||P.push({command:Jt.setLight,args:[w.light]});var M={},j=[];!function(q,tt,Q,st){var X;for(X in tt=tt||{},q=q||{})q.hasOwnProperty(X)&&(tt.hasOwnProperty(X)||Vt(X,Q,st));for(X in tt)tt.hasOwnProperty(X)&&(q.hasOwnProperty(X)?c.deepEqual(q[X],tt[X])||("geojson"===q[X].type&&"geojson"===tt[X].type&&fi(q,tt,X)?Q.push({command:Jt.setGeoJSONSourceData,args:[X,tt[X].data]}):Ke(X,tt,Q,st)):re(X,tt,Q))}(g.sources,w.sources,j,M);var V=[];g.layers&&g.layers.forEach(function(q){M[q.source]?P.push({command:Jt.removeLayer,args:[q.id]}):V.push(q)}),P=P.concat(j),function(q,tt,Q){tt=tt||[];var st,X,at,ht,_t,Et,wt,It=(q=q||[]).map(hi),Rt=tt.map(hi),Yt=q.reduce(Ne,{}),Xt=tt.reduce(Ne,{}),ue=It.slice(),ve=Object.create(null);for(st=0,X=0;st<It.length;st++)Xt.hasOwnProperty(at=It[st])?X++:(Q.push({command:Jt.removeLayer,args:[at]}),ue.splice(ue.indexOf(at,X),1));for(st=0,X=0;st<Rt.length;st++)ue[ue.length-1-st]!==(at=Rt[Rt.length-1-st])&&(Yt.hasOwnProperty(at)?(Q.push({command:Jt.removeLayer,args:[at]}),ue.splice(ue.lastIndexOf(at,ue.length-X),1)):X++,Q.push({command:Jt.addLayer,args:[Xt[at],Et=ue[ue.length-st]]}),ue.splice(ue.length-st,0,at),ve[at]=!0);for(st=0;st<Rt.length;st++)if(ht=Yt[at=Rt[st]],_t=Xt[at],!ve[at]&&!c.deepEqual(ht,_t))if(c.deepEqual(ht.source,_t.source)&&c.deepEqual(ht["source-layer"],_t["source-layer"])&&c.deepEqual(ht.type,_t.type)){for(wt in Ae(ht.layout,_t.layout,Q,at,null,Jt.setLayoutProperty),Ae(ht.paint,_t.paint,Q,at,null,Jt.setPaintProperty),c.deepEqual(ht.filter,_t.filter)||Q.push({command:Jt.setFilter,args:[at,_t.filter]}),c.deepEqual(ht.minzoom,_t.minzoom)&&c.deepEqual(ht.maxzoom,_t.maxzoom)||Q.push({command:Jt.setLayerZoomRange,args:[at,_t.minzoom,_t.maxzoom]}),ht)ht.hasOwnProperty(wt)&&"layout"!==wt&&"paint"!==wt&&"filter"!==wt&&"metadata"!==wt&&"minzoom"!==wt&&"maxzoom"!==wt&&(0===wt.indexOf("paint.")?Ae(ht[wt],_t[wt],Q,at,wt.slice(6),Jt.setPaintProperty):c.deepEqual(ht[wt],_t[wt])||Q.push({command:Jt.setLayerProperty,args:[at,wt,_t[wt]]}));for(wt in _t)_t.hasOwnProperty(wt)&&!ht.hasOwnProperty(wt)&&"layout"!==wt&&"paint"!==wt&&"filter"!==wt&&"metadata"!==wt&&"minzoom"!==wt&&"maxzoom"!==wt&&(0===wt.indexOf("paint.")?Ae(ht[wt],_t[wt],Q,at,wt.slice(6),Jt.setPaintProperty):c.deepEqual(ht[wt],_t[wt])||Q.push({command:Jt.setLayerProperty,args:[at,wt,_t[wt]]}))}else Q.push({command:Jt.removeLayer,args:[at]}),Et=ue[ue.lastIndexOf(at)+1],Q.push({command:Jt.addLayer,args:[_t,Et]})}(V,w.layers,P)}catch(q){console.warn("Unable to compute style diff:",q),P=[{command:Jt.setStyle,args:[w]}]}return P}(this.serialize(),o).filter(function(g){return!(g.command in Ko)});if(0===d.length)return!1;var _=d.filter(function(g){return!(g.command in Xo)});if(_.length>0)throw new Error("Unimplemented: "+_.map(function(g){return g.command}).join(", ")+".");return d.forEach(function(g){"setTransition"!==g.command&&l[g.command].apply(l,g.args)}),this.stylesheet=o,!0},a.prototype.addImage=function(o,l){if(this.getImage(o))return this.fire(new c.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,l),this._afterImageUpdated(o)},a.prototype.updateImage=function(o,l){this.imageManager.updateImage(o,l)},a.prototype.getImage=function(o){return this.imageManager.getImage(o)},a.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new c.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},a.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(o,l,d){var _=this;if(void 0===d&&(d={}),this._checkLoaded(),void 0!==this.sourceCaches[o])throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(c.validateStyle.source,"sources."+o,l,null,d))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var g=this.sourceCaches[o]=new et(o,l,this.dispatcher);g.style=this,g.setEventedParent(this,function(){return{isSourceLoaded:_.loaded(),source:g.serialize(),sourceId:o}}),g.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(o){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===o)return this.fire(new c.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+l+'" is using it.')));var d=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],d.fire(new c.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.clearTiles(),d.onRemove&&d.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(o,l){this._checkLoaded(),this.sourceCaches[o].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},a.prototype.addLayer=function(o,l,d){void 0===d&&(d={}),this._checkLoaded();var _=o.id;if(this.getLayer(_))this.fire(new c.ErrorEvent(new Error('Layer with id "'+_+'" already exists on this map')));else{var g;if("custom"===o.type){if(ua(this,c.validateCustomStyleLayer(o)))return;g=c.createStyleLayer(o)}else{if("object"==typeof o.source&&(this.addSource(_,o.source),o=c.clone$1(o),o=c.extend(o,{source:_})),this._validate(c.validateStyle.layer,"layers."+_,o,{arrayIndex:-1},d))return;g=c.createStyleLayer(o),this._validateLayer(g),g.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[g.id]=g.serialize()}var w=l?this._order.indexOf(l):this._order.length;if(l&&-1===w)this.fire(new c.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(w,0,_),this._layerOrderChanged=!0,this._layers[_]=g,this._removedLayers[_]&&g.source&&"custom"!==g.type){var P=this._removedLayers[_];delete this._removedLayers[_],P.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}},a.prototype.moveLayer=function(o,l){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==l){var d=this._order.indexOf(o);this._order.splice(d,1);var _=l?this._order.indexOf(l):this._order.length;l&&-1===_?this.fire(new c.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(_,0,o),this._layerOrderChanged=!0)}}else this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(o){this._checkLoaded();var l=this._layers[o];if(l){l.setEventedParent(null);var d=this._order.indexOf(o);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=l,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],l.onRemove&&l.onRemove(this.map)}else this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(o){return this._layers[o]},a.prototype.hasLayer=function(o){return o in this._layers},a.prototype.setLayerZoomRange=function(o,l,d){this._checkLoaded();var _=this.getLayer(o);_?_.minzoom===l&&_.maxzoom===d||(null!=l&&(_.minzoom=l),null!=d&&(_.maxzoom=d),this._updateLayer(_)):this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(o,l,d){void 0===d&&(d={}),this._checkLoaded();var _=this.getLayer(o);if(_){if(!c.deepEqual(_.filter,l))return null==l?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(c.validateStyle.filter,"layers."+_.id+".filter",l,null,d)||(_.filter=c.clone$1(l),this._updateLayer(_)))}else this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(o){return c.clone$1(this.getLayer(o).filter)},a.prototype.setLayoutProperty=function(o,l,d,_){void 0===_&&(_={}),this._checkLoaded();var g=this.getLayer(o);g?c.deepEqual(g.getLayoutProperty(l),d)||(g.setLayoutProperty(l,d,_),this._updateLayer(g)):this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(o,l){var d=this.getLayer(o);if(d)return d.getLayoutProperty(l);this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(o,l,d,_){void 0===_&&(_={}),this._checkLoaded();var g=this.getLayer(o);g?c.deepEqual(g.getPaintProperty(l),d)||(g.setPaintProperty(l,d,_)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(o,l){return this.getLayer(o).getPaintProperty(l)},a.prototype.setFeatureState=function(o,l){this._checkLoaded();var d=o.source,_=o.sourceLayer,g=this.sourceCaches[d];if(void 0!==g){var w=g.getSource().type;"geojson"===w&&_?this.fire(new c.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==w||_?(void 0===o.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),g.setFeatureState(_,o.id,l)):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(o,l){this._checkLoaded();var d=o.source,_=this.sourceCaches[d];if(void 0!==_){var g=_.getSource().type,w="vector"===g?o.sourceLayer:void 0;"vector"!==g||w?l&&"string"!=typeof o.id&&"number"!=typeof o.id?this.fire(new c.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(w,o.id,l):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(o){this._checkLoaded();var l=o.source,d=o.sourceLayer,_=this.sourceCaches[l];if(void 0!==_){if("vector"!==_.getSource().type||d)return void 0===o.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(d,o.id);this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return c.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return c.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:c.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return void 0!==o})},a.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&"raster"!==this.sourceCaches[o.source].getSource().type&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(o){for(var l=this,d=function(Yt){return"fill-extrusion"===l._layers[Yt].type},_={},g=[],w=this._order.length-1;w>=0;w--){var P=this._order[w];if(d(P)){_[P]=w;for(var M=0,j=o;M<j.length;M+=1){var V=j[M][P];if(V)for(var q=0,tt=V;q<tt.length;q+=1)g.push(tt[q])}}}g.sort(function(Yt,Xt){return Xt.intersectionZ-Yt.intersectionZ});for(var Q=[],st=this._order.length-1;st>=0;st--){var X=this._order[st];if(d(X))for(var at=g.length-1;at>=0;at--){var ht=g[at].feature;if(_[ht.layer.id]<st)break;Q.push(ht),g.pop()}else for(var _t=0,Et=o;_t<Et.length;_t+=1){var wt=Et[_t][X];if(wt)for(var It=0,Rt=wt;It<Rt.length;It+=1)Q.push(Rt[It].feature)}}return Q},a.prototype.queryRenderedFeatures=function(o,l,d){l&&l.filter&&this._validate(c.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var _={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new c.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var g=0,w=l.layers;g<w.length;g+=1){var P=w[g],M=this._layers[P];if(!M)return this.fire(new c.ErrorEvent(new Error("The layer '"+P+"' does not exist in the map's style and cannot be queried for features."))),[];_[M.source]=!0}}var j=[];for(var V in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!_[V]||j.push(kn(this.sourceCaches[V],this._layers,this._serializedLayers,o,l,d));return this.placement&&j.push(function(q,tt,Q,st,X,at,ht){for(var _t={},Et=at.queryRenderedSymbols(st),wt=[],It=0,Rt=Object.keys(Et).map(Number);It<Rt.length;It+=1)wt.push(ht[Rt[It]]);wt.sort(Zr);for(var Yt=function(){var we=ue[Xt],Ei=we.featureIndex.lookupSymbolFeatures(Et[we.bucketInstanceId],tt,we.bucketIndex,we.sourceLayerIndex,X.filter,X.layers,X.availableImages,q);for(var pe in Ei){var Re=_t[pe]=_t[pe]||[],Je=Ei[pe];Je.sort(function(Xe,ze){var Ce=we.featureSortOrder;if(Ce){var Er=Ce.indexOf(Xe.featureIndex);return Ce.indexOf(ze.featureIndex)-Er}return ze.featureIndex-Xe.featureIndex});for(var Be=0,ke=Je;Be<ke.length;Be+=1)Re.push(ke[Be])}},Xt=0,ue=wt;Xt<ue.length;Xt+=1)Yt();var ve=function(we){_t[we].forEach(function(Ei){var pe=Ei.feature,Re=Q[q[we].source].getFeatureState(pe.layer["source-layer"],pe.id);pe.source=pe.layer.source,pe.layer["source-layer"]&&(pe.sourceLayer=pe.layer["source-layer"]),pe.state=Re})};for(var Se in _t)ve(Se);return _t}(this._layers,this._serializedLayers,this.sourceCaches,o,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(j)},a.prototype.querySourceFeatures=function(o,l){l&&l.filter&&this._validate(c.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var d=this.sourceCaches[o];return d?function(_,g){for(var w=_.getRenderableIds().map(function(tt){return _.getTileByID(tt)}),P=[],M={},j=0;j<w.length;j++){var V=w[j],q=V.tileID.canonical.key;M[q]||(M[q]=!0,V.querySourceFeatures(P,g))}return P}(d,l):[]},a.prototype.addSourceType=function(o,l,d){return a.getSourceType(o)?d(new Error('A source type called "'+o+'" already exists.')):(a.setSourceType(o,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:l.workerSourceURL},d):d(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(o,l){void 0===l&&(l={}),this._checkLoaded();var d=this.light.getLight(),_=!1;for(var g in o)if(!c.deepEqual(o[g],d[g])){_=!0;break}if(_){var w={now:c.browser.now(),transition:c.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,l),this.light.updateTransitions(w)}},a.prototype._validate=function(o,l,d,_,g){return void 0===g&&(g={}),(!g||!1!==g.validate)&&ua(this,o.call(c.validateStyle,c.extend({key:l,style:this.serialize(),value:d,styleSpec:c.styleSpec},_)))},a.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),c.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},a.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},a.prototype._updateSources=function(o){for(var l in this.sourceCaches)this.sourceCaches[l].update(o)},a.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},a.prototype._updatePlacement=function(o,l,d,_,g){void 0===g&&(g=!1);for(var w=!1,P=!1,M={},j=0,V=this._order;j<V.length;j+=1){var q=this._layers[V[j]];if("symbol"===q.type){if(!M[q.source]){var tt=this.sourceCaches[q.source];M[q.source]=tt.getRenderableIds(!0).map(function(ht){return tt.getTileByID(ht)}).sort(function(ht,_t){return _t.tileID.overscaledZ-ht.tileID.overscaledZ||(ht.tileID.isLessThan(_t.tileID)?-1:1)})}var Q=this.crossTileSymbolIndex.addLayer(q,M[q.source],o.center.lng);w=w||Q}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||0===d)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.browser.now(),o.zoom))&&(this.pauseablePlacement=new la(o,this._order,g,l,d,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.browser.now()),P=!0),w&&this.pauseablePlacement.placement.setStale()),P||w)for(var st=0,X=this._order;st<X.length;st+=1){var at=this._layers[X[st]];"symbol"===at.type&&this.placement.updateLayerOpacities(at,M[at.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},a.prototype.getImages=function(o,l,d){this.imageManager.getImages(l.icons,d),this._updateTilesForChangedImages();var _=this.sourceCaches[l.source];_&&_.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(o,l,d){this.glyphManager.getGlyphs(l.stacks,d)},a.prototype.getResource=function(o,l,d){return c.makeRequest(l,d)},a}(c.Evented);In.getSourceType=function(n){return tr[n]},In.setSourceType=function(n,a){tr[n]=a},In.registerForPluginStateChange=c.registerForPluginStateChange;var Ki=c.createLayout([{name:"a_pos",type:"Int16",components:2}]),vr=Li("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Es=Li("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),el=Li("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Is=Li("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Va=Li("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),rs=Li("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Za=Li("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),qa=Li("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ps=Li("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),As=Li("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Cs=Li("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Ca=Li("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),xr=Li("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ha=Li("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),hn=Li("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Jo=Li("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),oo=Li("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Bo=Li("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Eo=Li("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),kr=Li("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),_o=Li("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Oo=Li("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),br=Li("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Mr=Li("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),wr=Li("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Ga=Li("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Li(n,a){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),d=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=_?_.concat(d):d,w={};return{fragmentSource:n=n.replace(o,function(P,M,j,V,q){return w[q]=!0,"define"===M?"\n#ifndef HAS_UNIFORM_u_"+q+"\nvarying "+j+" "+V+" "+q+";\n#else\nuniform "+j+" "+V+" u_"+q+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+q+"\n    "+j+" "+V+" "+q+" = u_"+q+";\n#endif\n"}),vertexSource:a=a.replace(o,function(P,M,j,V,q){var tt="float"===V?"vec2":"vec4",Q=q.match(/color/)?"color":tt;return w[q]?"define"===M?"\n#ifndef HAS_UNIFORM_u_"+q+"\nuniform lowp float u_"+q+"_t;\nattribute "+j+" "+tt+" a_"+q+";\nvarying "+j+" "+V+" "+q+";\n#else\nuniform "+j+" "+V+" u_"+q+";\n#endif\n":"vec4"===Q?"\n#ifndef HAS_UNIFORM_u_"+q+"\n    "+q+" = a_"+q+";\n#else\n    "+j+" "+V+" "+q+" = u_"+q+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+q+"\n    "+q+" = unpack_mix_"+Q+"(a_"+q+", u_"+q+"_t);\n#else\n    "+j+" "+V+" "+q+" = u_"+q+";\n#endif\n":"define"===M?"\n#ifndef HAS_UNIFORM_u_"+q+"\nuniform lowp float u_"+q+"_t;\nattribute "+j+" "+tt+" a_"+q+";\n#else\nuniform "+j+" "+V+" u_"+q+";\n#endif\n":"vec4"===Q?"\n#ifndef HAS_UNIFORM_u_"+q+"\n    "+j+" "+V+" "+q+" = a_"+q+";\n#else\n    "+j+" "+V+" "+q+" = u_"+q+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+q+"\n    "+j+" "+V+" "+q+" = unpack_mix_"+Q+"(a_"+q+", u_"+q+"_t);\n#else\n    "+j+" "+V+" "+q+" = u_"+q+";\n#endif\n"}),staticAttributes:l,staticUniforms:g}}var Ls=Object.freeze({__proto__:null,prelude:vr,background:Es,backgroundPattern:el,circle:Is,clippingMask:Va,heatmap:rs,heatmapTexture:Za,collisionBox:qa,collisionCircle:Ps,debug:As,fill:Cs,fillOutline:Ca,fillOutlinePattern:xr,fillPattern:ha,fillExtrusion:hn,fillExtrusionPattern:Jo,hillshadePrepare:oo,hillshade:Bo,line:Eo,lineGradient:kr,linePattern:_o,lineSDF:Oo,raster:br,symbolIcon:Mr,symbolSDF:wr,symbolTextAndIcon:Ga}),ca=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Wa(n){for(var a=[],o=0;o<n.length;o++)if(null!==n[o]){var l=n[o].split(" ");a.push(l.pop())}return a}ca.prototype.bind=function(n,a,o,l,d,_,g,w){this.context=n;for(var P=this.boundPaintVertexBuffers.length!==l.length,M=0;!P&&M<l.length;M++)this.boundPaintVertexBuffers[M]!==l[M]&&(P=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===o&&!P&&this.boundIndexBuffer===d&&this.boundVertexOffset===_&&this.boundDynamicVertexBuffer===g&&this.boundDynamicVertexBuffer2===w?(n.bindVertexArrayOES.set(this.vao),g&&g.bind(),d&&d.dynamicDraw&&d.bind(),w&&w.bind()):this.freshBind(a,o,l,d,_,g,w)},ca.prototype.freshBind=function(n,a,o,l,d,_,g){var w,P=n.numAttributes,M=this.context,j=M.gl;if(M.extVertexArrayObject)this.vao&&this.destroy(),this.vao=M.extVertexArrayObject.createVertexArrayOES(),M.bindVertexArrayOES.set(this.vao),w=0,this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=l,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=g;else{w=M.currentNumAttributes||0;for(var V=P;V<w;V++)j.disableVertexAttribArray(V)}a.enableAttributes(j,n);for(var q=0,tt=o;q<tt.length;q+=1)tt[q].enableAttributes(j,n);_&&_.enableAttributes(j,n),g&&g.enableAttributes(j,n),a.bind(),a.setVertexAttribPointers(j,n,d);for(var Q=0,st=o;Q<st.length;Q+=1){var X=st[Q];X.bind(),X.setVertexAttribPointers(j,n,d)}_&&(_.bind(),_.setVertexAttribPointers(j,n,d)),l&&l.bind(),g&&(g.bind(),g.setVertexAttribPointers(j,n,d)),M.currentNumAttributes=P},ca.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var La=function(n,a,o,l,d,_){var g=n.gl;this.program=g.createProgram();for(var w=Wa(o.staticAttributes),P=l?l.getBinderAttributes():[],M=w.concat(P),j=o.staticUniforms?Wa(o.staticUniforms):[],V=l?l.getBinderUniforms():[],q=[],tt=0,Q=j.concat(V);tt<Q.length;tt+=1){var st=Q[tt];q.indexOf(st)<0&&q.push(st)}var X=l?l.defines():[];_&&X.push("#define OVERDRAW_INSPECTOR;");var at=X.concat(vr.fragmentSource,o.fragmentSource).join("\n"),ht=X.concat(vr.vertexSource,o.vertexSource).join("\n"),_t=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(_t,at),g.compileShader(_t),g.attachShader(this.program,_t);var Et=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(Et,ht),g.compileShader(Et),g.attachShader(this.program,Et),this.attributes={};var wt={};this.numAttributes=M.length;for(var It=0;It<this.numAttributes;It++)M[It]&&(g.bindAttribLocation(this.program,It,M[It]),this.attributes[M[It]]=It);g.linkProgram(this.program),g.deleteShader(Et),g.deleteShader(_t);for(var Rt=0;Rt<q.length;Rt++){var Yt=q[Rt];if(Yt&&!wt[Yt]){var Xt=g.getUniformLocation(this.program,Yt);Xt&&(wt[Yt]=Xt)}}this.fixedUniforms=d(n,wt),this.binderUniforms=l?l.getUniforms(n,wt):[]}}};function Hr(n,a,o){var l=1/Fi(o,1,a.transform.tileZoom),d=Math.pow(2,o.tileID.overscaledZ),_=o.tileSize*Math.pow(2,a.transform.tileZoom)/d,g=_*(o.tileID.canonical.x+o.tileID.wrap*d),w=_*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[l,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[g>>16,w>>16],u_pixel_coord_lower:[65535&g,65535&w]}}La.prototype.draw=function(n,a,o,l,d,_,g,w,P,M,j,V,q,tt,Q,st){var X,at=n.gl;if(!this.failedToCreate){for(var ht in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(l),n.setColorMode(d),n.setCullFace(_),this.fixedUniforms)this.fixedUniforms[ht].set(g[ht]);tt&&tt.setUniforms(n,this.binderUniforms,V,{zoom:q});for(var _t=(X={},X[at.LINES]=2,X[at.TRIANGLES]=3,X[at.LINE_STRIP]=1,X)[a],Et=0,wt=j.get();Et<wt.length;Et+=1){var It=wt[Et],Rt=It.vaos||(It.vaos={});(Rt[w]||(Rt[w]=new ca)).bind(n,this,P,tt?tt.getPaintVertexBuffers():[],M,It.vertexOffset,Q,st),at.drawElements(a,It.primitiveLength*_t,at.UNSIGNED_SHORT,It.primitiveOffset*_t*2)}}};var Ha=function(n,a,o,l){var d=a.style.light,_=d.properties.get("position"),g=[_.x,_.y,_.z],w=c.create$1();"viewport"===d.properties.get("anchor")&&c.fromRotation(w,-a.transform.angle),c.transformMat3(g,g,w);var P=d.properties.get("color");return{u_matrix:n,u_lightpos:g,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+o,u_opacity:l}},Yo=function(n,a,o,l,d,_,g){return c.extend(Ha(n,a,o,l),Hr(_,a,g),{u_height_factor:-Math.pow(2,d.overscaledZ)/g.tileSize/8})},$o=function(n){return{u_matrix:n}},wa=function(n,a,o,l){return c.extend($o(n),Hr(o,a,l))},za=function(n,a){return{u_matrix:n,u_world:a}},os=function(n,a,o,l,d){return c.extend(wa(n,a,o,l),{u_world:d})},as=function(n,a,o,l){var d,_,g=n.transform;if("map"===l.paint.get("circle-pitch-alignment")){var w=Fi(o,1,g.zoom);d=!0,_=[w,w]}else d=!1,_=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+("map"===l.paint.get("circle-pitch-scale")),u_matrix:n.translatePosMatrix(a.posMatrix,o,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:c.browser.devicePixelRatio,u_extrude_scale:_}},Dr=function(n,a,o){var l=Fi(o,1,a.zoom),d=Math.pow(2,a.zoom-o.tileID.overscaledZ),_=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:l,u_extrude_scale:[a.pixelsToGLUnits[0]/(l*d),a.pixelsToGLUnits[1]/(l*d)],u_overscale_factor:_}},Ta=function(n,a,o){return{u_matrix:n,u_inv_matrix:a,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},yo=function(n,a,o){return void 0===o&&(o=1),{u_matrix:n,u_color:a,u_overlay:0,u_overlay_scale:o}},pa=function(n){return{u_matrix:n}},Qo=function(n,a,o,l){return{u_matrix:n,u_extrude_scale:Fi(a,1,o),u_intensity:l}},Xr=function(n,a,o){var l=n.transform;return{u_matrix:ss(n,a,o),u_ratio:1/Fi(a,1,l.zoom),u_device_pixel_ratio:c.browser.devicePixelRatio,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]]}},Ai=function(n,a,o,l){return c.extend(Xr(n,a,o),{u_image:0,u_image_height:l})},Sa=function(n,a,o,l){var d=n.transform,_=da(a,d);return{u_matrix:ss(n,a,o),u_texsize:a.imageAtlasTexture.size,u_ratio:1/Fi(a,1,d.zoom),u_device_pixel_ratio:c.browser.devicePixelRatio,u_image:0,u_scale:[_,l.fromScale,l.toScale],u_fade:l.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Io=function(n,a,o,l,d){var _=n.lineAtlas,g=da(a,n.transform),w="round"===o.layout.get("line-cap"),P=_.getDash(l.from,w),M=_.getDash(l.to,w),j=P.width*d.fromScale,V=M.width*d.toScale;return c.extend(Xr(n,a,o),{u_patternscale_a:[g/j,-P.height/2],u_patternscale_b:[g/V,-M.height/2],u_sdfgamma:_.width/(256*Math.min(j,V)*c.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:M.y,u_mix:d.t})};function da(n,a){return 1/Fi(n,1,a.tileZoom)}function ss(n,a,o){return n.translatePosMatrix(a.tileID.posMatrix,a,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var fa=function(n,a,o,l,d){return{u_matrix:n,u_tl_parent:a,u_scale_parent:o,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(g=d.paint.get("raster-saturation"),g>0?1-1/(1.001-g):-g),u_contrast_factor:(_=d.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:zs(d.paint.get("raster-hue-rotate"))};var _,g};function zs(n){n*=Math.PI/180;var a=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*a-o+1)/3,(Math.sqrt(3)*a-o+1)/3]}var ao,Ro=function(n,a,o,l,d,_,g,w,P,M){var j=d.transform;return{u_is_size_zoom_constant:+("constant"===n||"source"===n),u_is_size_feature_constant:+("constant"===n||"camera"===n),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:j.width/j.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:g,u_coord_matrix:w,u_is_text:+P,u_pitch_with_map:+l,u_texsize:M,u_texture:0}},ka=function(n,a,o,l,d,_,g,w,P,M,j){var V=d.transform;return c.extend(Ro(n,a,o,l,d,_,g,w,P,M),{u_gamma_scale:l?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:c.browser.devicePixelRatio,u_is_halo:+j})},Xa=function(n,a,o,l,d,_,g,w,P,M){return c.extend(ka(n,a,o,l,d,_,g,w,!0,P,!0),{u_texsize_icon:M,u_texture_icon:1})},ta=function(n,a,o){return{u_matrix:n,u_opacity:a,u_color:o}},ma=function(n,a,o,l,d,_){return c.extend((w=_,M=d,j=(P=o).imageManager.getPattern((g=l).from.toString()),V=P.imageManager.getPattern(g.to.toString()),tt=(q=P.imageManager.getPixelSize()).width,Q=q.height,st=Math.pow(2,M.tileID.overscaledZ),at=(X=M.tileSize*Math.pow(2,P.transform.tileZoom)/st)*(M.tileID.canonical.x+M.tileID.wrap*st),ht=X*M.tileID.canonical.y,{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[tt,Q],u_mix:w.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/Fi(M,1,P.transform.tileZoom),u_pixel_coord_upper:[at>>16,ht>>16],u_pixel_coord_lower:[65535&at,65535&ht]}),{u_matrix:n,u_opacity:a});var g,w,P,M,j,V,q,tt,Q,st,X,at,ht},ls={fillExtrusion:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_lightpos:new c.Uniform3f(n,a.u_lightpos),u_lightintensity:new c.Uniform1f(n,a.u_lightintensity),u_lightcolor:new c.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new c.Uniform1f(n,a.u_vertical_gradient),u_opacity:new c.Uniform1f(n,a.u_opacity)}},fillExtrusionPattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_lightpos:new c.Uniform3f(n,a.u_lightpos),u_lightintensity:new c.Uniform1f(n,a.u_lightintensity),u_lightcolor:new c.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new c.Uniform1f(n,a.u_vertical_gradient),u_height_factor:new c.Uniform1f(n,a.u_height_factor),u_image:new c.Uniform1i(n,a.u_image),u_texsize:new c.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new c.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new c.Uniform3f(n,a.u_scale),u_fade:new c.Uniform1f(n,a.u_fade),u_opacity:new c.Uniform1f(n,a.u_opacity)}},fill:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix)}},fillPattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_image:new c.Uniform1i(n,a.u_image),u_texsize:new c.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new c.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new c.Uniform3f(n,a.u_scale),u_fade:new c.Uniform1f(n,a.u_fade)}},fillOutline:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_world:new c.Uniform2f(n,a.u_world)}},fillOutlinePattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_world:new c.Uniform2f(n,a.u_world),u_image:new c.Uniform1i(n,a.u_image),u_texsize:new c.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new c.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new c.Uniform3f(n,a.u_scale),u_fade:new c.Uniform1f(n,a.u_fade)}},circle:function(n,a){return{u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_scale_with_map:new c.Uniform1i(n,a.u_scale_with_map),u_pitch_with_map:new c.Uniform1i(n,a.u_pitch_with_map),u_extrude_scale:new c.Uniform2f(n,a.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(n,a.u_matrix)}},collisionBox:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_pixels_to_tile_units:new c.Uniform1f(n,a.u_pixels_to_tile_units),u_extrude_scale:new c.Uniform2f(n,a.u_extrude_scale),u_overscale_factor:new c.Uniform1f(n,a.u_overscale_factor)}},collisionCircle:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_inv_matrix:new c.UniformMatrix4f(n,a.u_inv_matrix),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_viewport_size:new c.Uniform2f(n,a.u_viewport_size)}},debug:function(n,a){return{u_color:new c.UniformColor(n,a.u_color),u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_overlay:new c.Uniform1i(n,a.u_overlay),u_overlay_scale:new c.Uniform1f(n,a.u_overlay_scale)}},clippingMask:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix)}},heatmap:function(n,a){return{u_extrude_scale:new c.Uniform1f(n,a.u_extrude_scale),u_intensity:new c.Uniform1f(n,a.u_intensity),u_matrix:new c.UniformMatrix4f(n,a.u_matrix)}},heatmapTexture:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_world:new c.Uniform2f(n,a.u_world),u_image:new c.Uniform1i(n,a.u_image),u_color_ramp:new c.Uniform1i(n,a.u_color_ramp),u_opacity:new c.Uniform1f(n,a.u_opacity)}},hillshade:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_image:new c.Uniform1i(n,a.u_image),u_latrange:new c.Uniform2f(n,a.u_latrange),u_light:new c.Uniform2f(n,a.u_light),u_shadow:new c.UniformColor(n,a.u_shadow),u_highlight:new c.UniformColor(n,a.u_highlight),u_accent:new c.UniformColor(n,a.u_accent)}},hillshadePrepare:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_image:new c.Uniform1i(n,a.u_image),u_dimension:new c.Uniform2f(n,a.u_dimension),u_zoom:new c.Uniform1f(n,a.u_zoom),u_unpack:new c.Uniform4f(n,a.u_unpack)}},line:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_ratio:new c.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(n,a.u_units_to_pixels)}},lineGradient:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_ratio:new c.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(n,a.u_units_to_pixels),u_image:new c.Uniform1i(n,a.u_image),u_image_height:new c.Uniform1f(n,a.u_image_height)}},linePattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_texsize:new c.Uniform2f(n,a.u_texsize),u_ratio:new c.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_image:new c.Uniform1i(n,a.u_image),u_units_to_pixels:new c.Uniform2f(n,a.u_units_to_pixels),u_scale:new c.Uniform3f(n,a.u_scale),u_fade:new c.Uniform1f(n,a.u_fade)}},lineSDF:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_ratio:new c.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(n,a.u_units_to_pixels),u_patternscale_a:new c.Uniform2f(n,a.u_patternscale_a),u_patternscale_b:new c.Uniform2f(n,a.u_patternscale_b),u_sdfgamma:new c.Uniform1f(n,a.u_sdfgamma),u_image:new c.Uniform1i(n,a.u_image),u_tex_y_a:new c.Uniform1f(n,a.u_tex_y_a),u_tex_y_b:new c.Uniform1f(n,a.u_tex_y_b),u_mix:new c.Uniform1f(n,a.u_mix)}},raster:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_tl_parent:new c.Uniform2f(n,a.u_tl_parent),u_scale_parent:new c.Uniform1f(n,a.u_scale_parent),u_buffer_scale:new c.Uniform1f(n,a.u_buffer_scale),u_fade_t:new c.Uniform1f(n,a.u_fade_t),u_opacity:new c.Uniform1f(n,a.u_opacity),u_image0:new c.Uniform1i(n,a.u_image0),u_image1:new c.Uniform1i(n,a.u_image1),u_brightness_low:new c.Uniform1f(n,a.u_brightness_low),u_brightness_high:new c.Uniform1f(n,a.u_brightness_high),u_saturation_factor:new c.Uniform1f(n,a.u_saturation_factor),u_contrast_factor:new c.Uniform1f(n,a.u_contrast_factor),u_spin_weights:new c.Uniform3f(n,a.u_spin_weights)}},symbolIcon:function(n,a){return{u_is_size_zoom_constant:new c.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new c.Uniform1f(n,a.u_size_t),u_size:new c.Uniform1f(n,a.u_size),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new c.Uniform1f(n,a.u_pitch),u_rotate_symbol:new c.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new c.Uniform1f(n,a.u_fade_change),u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new c.Uniform1i(n,a.u_is_text),u_pitch_with_map:new c.Uniform1i(n,a.u_pitch_with_map),u_texsize:new c.Uniform2f(n,a.u_texsize),u_texture:new c.Uniform1i(n,a.u_texture)}},symbolSDF:function(n,a){return{u_is_size_zoom_constant:new c.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new c.Uniform1f(n,a.u_size_t),u_size:new c.Uniform1f(n,a.u_size),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new c.Uniform1f(n,a.u_pitch),u_rotate_symbol:new c.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new c.Uniform1f(n,a.u_fade_change),u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new c.Uniform1i(n,a.u_is_text),u_pitch_with_map:new c.Uniform1i(n,a.u_pitch_with_map),u_texsize:new c.Uniform2f(n,a.u_texsize),u_texture:new c.Uniform1i(n,a.u_texture),u_gamma_scale:new c.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(n,a.u_is_halo)}},symbolTextAndIcon:function(n,a){return{u_is_size_zoom_constant:new c.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new c.Uniform1f(n,a.u_size_t),u_size:new c.Uniform1f(n,a.u_size),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new c.Uniform1f(n,a.u_pitch),u_rotate_symbol:new c.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new c.Uniform1f(n,a.u_fade_change),u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new c.Uniform1i(n,a.u_is_text),u_pitch_with_map:new c.Uniform1i(n,a.u_pitch_with_map),u_texsize:new c.Uniform2f(n,a.u_texsize),u_texsize_icon:new c.Uniform2f(n,a.u_texsize_icon),u_texture:new c.Uniform1i(n,a.u_texture),u_texture_icon:new c.Uniform1i(n,a.u_texture_icon),u_gamma_scale:new c.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(n,a.u_is_halo)}},background:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_opacity:new c.Uniform1f(n,a.u_opacity),u_color:new c.UniformColor(n,a.u_color)}},backgroundPattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_opacity:new c.Uniform1f(n,a.u_opacity),u_image:new c.Uniform1i(n,a.u_image),u_pattern_tl_a:new c.Uniform2f(n,a.u_pattern_tl_a),u_pattern_br_a:new c.Uniform2f(n,a.u_pattern_br_a),u_pattern_tl_b:new c.Uniform2f(n,a.u_pattern_tl_b),u_pattern_br_b:new c.Uniform2f(n,a.u_pattern_br_b),u_texsize:new c.Uniform2f(n,a.u_texsize),u_mix:new c.Uniform1f(n,a.u_mix),u_pattern_size_a:new c.Uniform2f(n,a.u_pattern_size_a),u_pattern_size_b:new c.Uniform2f(n,a.u_pattern_size_b),u_scale_a:new c.Uniform1f(n,a.u_scale_a),u_scale_b:new c.Uniform1f(n,a.u_scale_b),u_pixel_coord_upper:new c.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(n,a.u_pixel_coord_lower),u_tile_units_to_pixels:new c.Uniform1f(n,a.u_tile_units_to_pixels)}}};function Ea(n,a,o,l,d,_,g){for(var w=n.context,P=w.gl,M=n.useProgram("collisionBox"),j=[],V=0,q=0,tt=0;tt<l.length;tt++){var Q=l[tt],st=a.getTile(Q),X=st.getBucket(o);if(X){var at=Q.posMatrix;0===d[0]&&0===d[1]||(at=n.translatePosMatrix(Q.posMatrix,st,d,_));var ht=g?X.textCollisionBox:X.iconCollisionBox,_t=X.collisionCircleArray;if(_t.length>0){var Et=c.create(),wt=at;c.mul(Et,X.placementInvProjMatrix,n.transform.glCoordMatrix),c.mul(Et,Et,X.placementViewportMatrix),j.push({circleArray:_t,circleOffset:q,transform:wt,invTransform:Et}),q=V+=_t.length/4}ht&&M.draw(w,P.LINES,H.disabled,J.disabled,n.colorModeForRenderPass(),ut.disabled,Dr(at,n.transform,st),o.id,ht.layoutVertexBuffer,ht.indexBuffer,ht.segments,null,n.transform.zoom,null,null,ht.collisionVertexBuffer)}}if(g&&j.length){var It=n.useProgram("collisionCircle"),Rt=new c.StructArrayLayout2f1f2i16;Rt.resize(4*V),Rt._trim();for(var Yt=0,Xt=0,ue=j;Xt<ue.length;Xt+=1)for(var ve=ue[Xt],Se=0;Se<ve.circleArray.length/4;Se++){var we=4*Se,Ei=ve.circleArray[we+0],pe=ve.circleArray[we+1],Re=ve.circleArray[we+2],Je=ve.circleArray[we+3];Rt.emplace(Yt++,Ei,pe,Re,Je,0),Rt.emplace(Yt++,Ei,pe,Re,Je,1),Rt.emplace(Yt++,Ei,pe,Re,Je,2),Rt.emplace(Yt++,Ei,pe,Re,Je,3)}(!ao||ao.length<2*V)&&(ao=function(Fn){var so=2*Fn,Fr=new c.StructArrayLayout3ui6;Fr.resize(so),Fr._trim();for(var An=0;An<so;An++){var Kn=6*An;Fr.uint16[Kn+0]=4*An+0,Fr.uint16[Kn+1]=4*An+1,Fr.uint16[Kn+2]=4*An+2,Fr.uint16[Kn+3]=4*An+2,Fr.uint16[Kn+4]=4*An+3,Fr.uint16[Kn+5]=4*An+0}return Fr}(V));for(var Be=w.createIndexBuffer(ao,!0),ke=w.createVertexBuffer(Rt,c.collisionCircleLayout.members,!0),Xe=0,ze=j;Xe<ze.length;Xe+=1){var Ce=ze[Xe],Er=Ta(Ce.transform,Ce.invTransform,n.transform);It.draw(w,P.TRIANGLES,H.disabled,J.disabled,n.colorModeForRenderPass(),ut.disabled,Er,o.id,ke,Be,c.SegmentVector.simpleSegment(0,2*Ce.circleOffset,Ce.circleArray.length,Ce.circleArray.length/2),null,n.transform.zoom,null,null,null)}ke.destroy(),Be.destroy()}}var ur=c.identity(new Float32Array(16));function Ka(n,a,o,l,d,_){var g=c.getAnchorAlignment(n),w=-(g.horizontalAlign-.5)*a,P=-(g.verticalAlign-.5)*o,M=c.evaluateVariableOffset(n,l);return new c.Point((w/d+M[0])*_,(P/d+M[1])*_)}function us(n,a,o,l,d,_,g,w,P,M,j){var V=n.text.placedSymbolArray,q=n.text.dynamicLayoutVertexArray,tt=n.icon.dynamicLayoutVertexArray,Q={};q.clear();for(var st=0;st<V.length;st++){var X=V.get(st),at=X.hidden||!X.crossTileID||n.allowVerticalPlacement&&!X.placedOrientation?null:l[X.crossTileID];if(at){var ht=new c.Point(X.anchorX,X.anchorY),_t=He(ht,o?w:g),Et=si(_.cameraToCenterDistance,_t.signedDistanceFromCamera),wt=d.evaluateSizeForFeature(n.textSizeData,M,X)*Et/c.ONE_EM;o&&(wt*=n.tilePixelRatio/P);for(var It=Ka(at.anchor,at.width,at.height,at.textOffset,at.textBoxScale,wt),Rt=o?He(ht.add(It),g).point:_t.point.add(a?It.rotate(-_.angle):It),Yt=n.allowVerticalPlacement&&X.placedOrientation===c.WritingMode.vertical?Math.PI/2:0,Xt=0;Xt<X.numGlyphs;Xt++)c.addDynamicAttributes(q,Rt,Yt);j&&X.associatedIconIndex>=0&&(Q[X.associatedIconIndex]={shiftedAnchor:Rt,angle:Yt})}else Bn(X.numGlyphs,q)}if(j){tt.clear();for(var ue=n.icon.placedSymbolArray,ve=0;ve<ue.length;ve++){var Se=ue.get(ve);if(Se.hidden)Bn(Se.numGlyphs,tt);else{var we=Q[ve];if(we)for(var Ei=0;Ei<Se.numGlyphs;Ei++)c.addDynamicAttributes(tt,we.shiftedAnchor,we.angle);else Bn(Se.numGlyphs,tt)}}n.icon.dynamicLayoutVertexBuffer.updateData(tt)}n.text.dynamicLayoutVertexBuffer.updateData(q)}function Ma(n,a,o){return o.iconsInText&&a?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function r(n,a,o,l,d,_,g,w,P,M,j,V){for(var q=n.context,tt=q.gl,Q=n.transform,st="map"===w,X="map"===P,at=st&&"point"!==o.layout.get("symbol-placement"),ht=st&&!X&&!at,_t=void 0!==o.layout.get("symbol-sort-key").constantOr(1),Et=!1,wt=n.depthModeForSublayer(0,H.ReadOnly),It=o.layout.get("text-variable-anchor"),Rt=[],Yt=0,Xt=l;Yt<Xt.length;Yt+=1){var ue=Xt[Yt],ve=a.getTile(ue),Se=ve.getBucket(o);if(Se){var we=d?Se.text:Se.icon;if(we&&we.segments.get().length){var Ei=we.programConfigurations.get(o.id),pe=d||Se.sdfIcons,Re=d?Se.textSizeData:Se.iconSizeData,Je=X||0!==Q.pitch,Be=n.useProgram(Ma(pe,d,Se),Ei),ke=c.evaluateSizeForZoom(Re,Q.zoom),Xe=void 0,ze=[0,0],Ce=void 0,Er=void 0,Fn=null,so=void 0;if(d)Ce=ve.glyphAtlasTexture,Er=tt.LINEAR,Xe=ve.glyphAtlasTexture.size,Se.iconsInText&&(ze=ve.imageAtlasTexture.size,Fn=ve.imageAtlasTexture,so=Je||n.options.rotating||n.options.zooming||"composite"===Re.kind||"camera"===Re.kind?tt.LINEAR:tt.NEAREST);else{var Fr=1!==o.layout.get("icon-size").constantOr(0)||Se.iconsNeedLinear;Ce=ve.imageAtlasTexture,Er=pe||n.options.rotating||n.options.zooming||Fr||Je?tt.LINEAR:tt.NEAREST,Xe=ve.imageAtlasTexture.size}var An=Fi(ve,1,n.transform.zoom),Kn=Xi(ue.posMatrix,X,st,n.transform,An),Zo=yi(ue.posMatrix,X,st,n.transform,An),xo=It&&Se.hasTextData(),ms="none"!==o.layout.get("icon-text-fit")&&xo&&Se.hasIconData();at&&Ho(Se,ue.posMatrix,n,d,Kn,Zo,X,M);var Ao=n.translatePosMatrix(ue.posMatrix,ve,_,g),Pa=at||d&&It||ms?ur:Kn,ga=n.translatePosMatrix(Zo,ve,_,g,!0),al=pe&&0!==o.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1),Xs={program:Be,buffers:we,uniformValues:pe?Se.iconsInText?Xa(Re.kind,ke,ht,X,n,Ao,Pa,ga,Xe,ze):ka(Re.kind,ke,ht,X,n,Ao,Pa,ga,d,Xe,!0):Ro(Re.kind,ke,ht,X,n,Ao,Pa,ga,d,Xe),atlasTexture:Ce,atlasTextureIcon:Fn,atlasInterpolation:Er,atlasInterpolationIcon:so,isSDF:pe,hasHalo:al};if(_t&&Se.canOverlap){Et=!0;for(var _s=0,Ks=we.segments.get();_s<Ks.length;_s+=1){var sl=Ks[_s];Rt.push({segments:new c.SegmentVector([sl]),sortKey:sl.sortKey,state:Xs})}}else Rt.push({segments:we.segments,sortKey:0,state:Xs})}}}Et&&Rt.sort(function(ys,Ds){return ys.sortKey-Ds.sortKey});for(var Ra=0,ll=Rt;Ra<ll.length;Ra+=1){var Fa=ll[Ra],Ir=Fa.state;if(q.activeTexture.set(tt.TEXTURE0),Ir.atlasTexture.bind(Ir.atlasInterpolation,tt.CLAMP_TO_EDGE),Ir.atlasTextureIcon&&(q.activeTexture.set(tt.TEXTURE1),Ir.atlasTextureIcon&&Ir.atlasTextureIcon.bind(Ir.atlasInterpolationIcon,tt.CLAMP_TO_EDGE)),Ir.isSDF){var $a=Ir.uniformValues;Ir.hasHalo&&($a.u_is_halo=1,h(Ir.buffers,Fa.segments,o,n,Ir.program,wt,j,V,$a)),$a.u_is_halo=0}h(Ir.buffers,Fa.segments,o,n,Ir.program,wt,j,V,Ir.uniformValues)}}function h(n,a,o,l,d,_,g,w,P){var M=l.context;d.draw(M,M.gl.TRIANGLES,_,g,w,ut.disabled,P,o.id,n.layoutVertexBuffer,n.indexBuffer,a,o.paint,l.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function m(n,a,o,l,d,_,g){var w,P,M,j,V,q=n.context.gl,tt=o.paint.get("fill-pattern"),Q=tt&&tt.constantOr(1),st=o.getCrossfadeParameters();g?(P=Q&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=q.LINES):(P=Q?"fillPattern":"fill",w=q.TRIANGLES);for(var X=0,at=l;X<at.length;X+=1){var ht=at[X],_t=a.getTile(ht);if(!Q||_t.patternsLoaded()){var Et=_t.getBucket(o);if(Et){var wt=Et.programConfigurations.get(o.id),It=n.useProgram(P,wt);Q&&(n.context.activeTexture.set(q.TEXTURE0),_t.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),wt.updatePaintBuffers(st));var Rt=tt.constantOr(null);if(Rt&&_t.imageAtlas){var Yt=_t.imageAtlas,Xt=Yt.patternPositions[Rt.to.toString()],ue=Yt.patternPositions[Rt.from.toString()];Xt&&ue&&wt.setConstantPatternPositions(Xt,ue)}var ve=n.translatePosMatrix(ht.posMatrix,_t,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(g){j=Et.indexBuffer2,V=Et.segments2;var Se=[q.drawingBufferWidth,q.drawingBufferHeight];M="fillOutlinePattern"===P&&Q?os(ve,n,st,_t,Se):za(ve,Se)}else j=Et.indexBuffer,V=Et.segments,M=Q?wa(ve,n,st,_t):$o(ve);It.draw(n.context,w,d,n.stencilModeForClipping(ht),_,ut.disabled,M,o.id,Et.layoutVertexBuffer,j,V,o.paint,n.transform.zoom,wt)}}}}function b(n,a,o,l,d,_,g){for(var w=n.context,P=w.gl,M=o.paint.get("fill-extrusion-pattern"),j=M.constantOr(1),V=o.getCrossfadeParameters(),q=o.paint.get("fill-extrusion-opacity"),tt=0,Q=l;tt<Q.length;tt+=1){var st=Q[tt],X=a.getTile(st),at=X.getBucket(o);if(at){var ht=at.programConfigurations.get(o.id),_t=n.useProgram(j?"fillExtrusionPattern":"fillExtrusion",ht);j&&(n.context.activeTexture.set(P.TEXTURE0),X.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),ht.updatePaintBuffers(V));var Et=M.constantOr(null);if(Et&&X.imageAtlas){var wt=X.imageAtlas,It=wt.patternPositions[Et.to.toString()],Rt=wt.patternPositions[Et.from.toString()];It&&Rt&&ht.setConstantPatternPositions(It,Rt)}var Yt=n.translatePosMatrix(st.posMatrix,X,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Xt=o.paint.get("fill-extrusion-vertical-gradient"),ue=j?Yo(Yt,n,Xt,q,st,V,X):Ha(Yt,n,Xt,q);_t.draw(w,w.gl.TRIANGLES,d,_,g,ut.backCCW,ue,o.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,o.paint,n.transform.zoom,ht)}}}function C(n,a,o,l,d,_){var g=n.context,w=g.gl,P=a.fbo;if(P){var M=n.useProgram("hillshade");g.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,P.colorAttachment.get());var j=function(V,q,tt){var Q=tt.paint.get("hillshade-shadow-color"),st=tt.paint.get("hillshade-highlight-color"),X=tt.paint.get("hillshade-accent-color"),at=tt.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===tt.paint.get("hillshade-illumination-anchor")&&(at-=V.transform.angle);var ht,_t,Et,wt=!V.options.moving;return{u_matrix:V.transform.calculatePosMatrix(q.tileID.toUnwrapped(),wt),u_image:0,u_latrange:(ht=q.tileID,_t=Math.pow(2,ht.canonical.z),Et=ht.canonical.y,[new c.MercatorCoordinate(0,Et/_t).toLngLat().lat,new c.MercatorCoordinate(0,(Et+1)/_t).toLngLat().lat]),u_light:[tt.paint.get("hillshade-exaggeration"),at],u_shadow:Q,u_highlight:st,u_accent:X}}(n,a,o);M.draw(g,w.TRIANGLES,l,d,_,ut.disabled,j,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function G(n,a,o,l,d,_){var st,X,at,ht,g=n.context,w=g.gl,P=a.dem;if(P&&P.data){var M=P.dim,j=P.stride,V=P.getPixels();if(g.activeTexture.set(w.TEXTURE1),g.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||n.getTileTexture(j),a.demTexture){var q=a.demTexture;q.update(V,{premultiply:!1}),q.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else a.demTexture=new c.Texture(g,V,w.RGBA,{premultiply:!1}),a.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);g.activeTexture.set(w.TEXTURE0);var tt=a.fbo;if(!tt){var Q=new c.Texture(g,{width:M,height:M,data:null},w.RGBA);Q.bind(w.LINEAR,w.CLAMP_TO_EDGE),(tt=a.fbo=g.createFramebuffer(M,M,!0)).colorAttachment.set(Q.texture)}g.bindFramebuffer.set(tt.framebuffer),g.viewport.set([0,0,M,M]),n.useProgram("hillshadePrepare").draw(g,w.TRIANGLES,l,d,_,ut.disabled,(st=a.tileID,at=(X=P).stride,ht=c.create(),c.ortho(ht,0,c.EXTENT,-c.EXTENT,0,0,1),c.translate(ht,ht,[0,-c.EXTENT,0]),{u_matrix:ht,u_image:1,u_dimension:[at,at],u_zoom:st.overscaledZ,u_unpack:X.getUnpackVector()}),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function rt(n,a,o,l,d){var _=l.paint.get("raster-fade-duration");if(_>0){var g=c.browser.now(),w=(g-n.timeAdded)/_,P=a?(g-a.timeAdded)/_:-1,M=o.getSource(),j=d.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),V=!a||Math.abs(a.tileID.overscaledZ-j)>Math.abs(n.tileID.overscaledZ-j),q=V&&n.refreshedUponExpiration?1:c.clamp(V?w:1-P,0,1);return n.refreshedUponExpiration&&w>=1&&(n.refreshedUponExpiration=!1),a?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}var gt=new c.Color(1,0,0,1),kt=new c.Color(0,1,0,1),Lt=new c.Color(0,0,1,1),oe=new c.Color(1,0,1,1),de=new c.Color(0,1,1,1);function Qe(n,a,o,l){y(n,0,a+o/2,n.transform.width,o,l)}function O(n,a,o,l){y(n,a-o/2,0,o,n.transform.height,l)}function y(n,a,o,l,d,_){var g=n.context,w=g.gl;w.enable(w.SCISSOR_TEST),w.scissor(a*c.browser.devicePixelRatio,o*c.browser.devicePixelRatio,l*c.browser.devicePixelRatio,d*c.browser.devicePixelRatio),g.clear({color:_}),w.disable(w.SCISSOR_TEST)}function E(n,a,o){var l=n.context,d=l.gl,_=o.posMatrix,g=n.useProgram("debug"),w=H.disabled,P=J.disabled,M=n.colorModeForRenderPass();l.activeTexture.set(d.TEXTURE0),n.emptyTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),g.draw(l,d.LINE_STRIP,w,P,M,ut.disabled,yo(_,c.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var j=a.getTileByID(o.key).latestRawTileData,V=Math.floor((j&&j.byteLength||0)/1024),q=a.getTile(o).tileSize,tt=512/Math.min(q,512)*(o.overscaledZ/n.transform.zoom)*.5,Q=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(Q+=" => "+o.overscaledZ),function(st,X){st.initDebugOverlayCanvas();var at=st.debugOverlayCanvas,ht=st.context.gl,_t=st.debugOverlayCanvas.getContext("2d");_t.clearRect(0,0,at.width,at.height),_t.shadowColor="white",_t.shadowBlur=2,_t.lineWidth=1.5,_t.strokeStyle="white",_t.textBaseline="top",_t.font="bold 36px Open Sans, sans-serif",_t.fillText(X,5,5),_t.strokeText(X,5,5),st.debugOverlayTexture.update(at),st.debugOverlayTexture.bind(ht.LINEAR,ht.CLAMP_TO_EDGE)}(n,Q+" "+V+"kb"),g.draw(l,d.TRIANGLES,w,P,ot.alphaBlended,ut.disabled,yo(_,c.Color.transparent,tt),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var Z={symbol:function(n,a,o,l,d){if("translucent"===n.renderPass){var _=J.disabled,g=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(w,P,M,j,V,q,tt){for(var Q=P.transform,st="map"===V,X="map"===q,at=0,ht=w;at<ht.length;at+=1){var _t=ht[at],Et=j.getTile(_t),wt=Et.getBucket(M);if(wt&&wt.text&&wt.text.segments.get().length){var It=c.evaluateSizeForZoom(wt.textSizeData,Q.zoom),Rt=Fi(Et,1,P.transform.zoom),Yt=Xi(_t.posMatrix,X,st,P.transform,Rt),Xt="none"!==M.layout.get("icon-text-fit")&&wt.hasIconData();if(It){var ue=Math.pow(2,Q.zoom-Et.tileID.overscaledZ);us(wt,st,X,tt,c.symbolSize,Q,Yt,_t.posMatrix,ue,It,Xt)}}}}(l,n,o,a,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),d),0!==o.paint.get("icon-opacity").constantOr(1)&&r(n,a,o,l,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),_,g),0!==o.paint.get("text-opacity").constantOr(1)&&r(n,a,o,l,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),_,g),a.map.showCollisionBoxes&&(Ea(n,a,o,l,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Ea(n,a,o,l,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,a,o,l){if("translucent"===n.renderPass){var d=o.paint.get("circle-opacity"),_=o.paint.get("circle-stroke-width"),g=o.paint.get("circle-stroke-opacity"),w=void 0!==o.layout.get("circle-sort-key").constantOr(1);if(0!==d.constantOr(1)||0!==_.constantOr(1)&&0!==g.constantOr(1)){for(var P=n.context,M=P.gl,j=n.depthModeForSublayer(0,H.ReadOnly),V=J.disabled,q=n.colorModeForRenderPass(),tt=[],Q=0;Q<l.length;Q++){var st=l[Q],X=a.getTile(st),at=X.getBucket(o);if(at){var ht=at.programConfigurations.get(o.id),_t={programConfiguration:ht,program:n.useProgram("circle",ht),layoutVertexBuffer:at.layoutVertexBuffer,indexBuffer:at.indexBuffer,uniformValues:as(n,st,X,o)};if(w)for(var Et=0,wt=at.segments.get();Et<wt.length;Et+=1){var It=wt[Et];tt.push({segments:new c.SegmentVector([It]),sortKey:It.sortKey,state:_t})}else tt.push({segments:at.segments,sortKey:0,state:_t})}}w&&tt.sort(function(ve,Se){return ve.sortKey-Se.sortKey});for(var Rt=0,Yt=tt;Rt<Yt.length;Rt+=1){var Xt=Yt[Rt],ue=Xt.state;ue.program.draw(P,M.TRIANGLES,j,V,q,ut.disabled,ue.uniformValues,o.id,ue.layoutVertexBuffer,ue.indexBuffer,Xt.segments,o.paint,n.transform.zoom,ue.programConfiguration)}}}},heatmap:function(n,a,o,l){if(0!==o.paint.get("heatmap-opacity"))if("offscreen"===n.renderPass){var d=n.context,_=d.gl,g=J.disabled,w=new ot([_.ONE,_.ONE],c.Color.transparent,[!0,!0,!0,!0]);(function(tt,Q,st){var X=tt.gl;tt.activeTexture.set(X.TEXTURE1),tt.viewport.set([0,0,Q.width/4,Q.height/4]);var _t,Et,wt,It,Rt,at=st.heatmapFbo;if(at)X.bindTexture(X.TEXTURE_2D,at.colorAttachment.get()),tt.bindFramebuffer.set(at.framebuffer);else{var ht=X.createTexture();X.bindTexture(X.TEXTURE_2D,ht),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),wt=ht,It=at=st.heatmapFbo=tt.createFramebuffer(Q.width/4,Q.height/4,!1),(Rt=(_t=tt).gl).texImage2D(Rt.TEXTURE_2D,0,Rt.RGBA,(Et=Q).width/4,Et.height/4,0,Rt.RGBA,_t.extRenderToTextureHalfFloat?_t.extTextureHalfFloat.HALF_FLOAT_OES:Rt.UNSIGNED_BYTE,null),It.colorAttachment.set(wt)}})(d,n,o),d.clear({color:c.Color.transparent});for(var P=0;P<l.length;P++){var M=l[P];if(!a.hasRenderableParent(M)){var j=a.getTile(M),V=j.getBucket(o);if(V){var q=V.programConfigurations.get(o.id);n.useProgram("heatmap",q).draw(d,_.TRIANGLES,H.disabled,g,w,ut.disabled,Qo(M.posMatrix,j,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,o.paint,n.transform.zoom,q)}}}d.viewport.set([0,0,n.width,n.height])}else"translucent"===n.renderPass&&(n.context.setColorMode(n.colorModeForRenderPass()),function(tt,Q){var st=tt.context,X=st.gl,at=Q.heatmapFbo;if(at){st.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,at.colorAttachment.get()),st.activeTexture.set(X.TEXTURE1);var ht=Q.colorRampTexture;ht||(ht=Q.colorRampTexture=new c.Texture(st,Q.colorRamp,X.RGBA)),ht.bind(X.LINEAR,X.CLAMP_TO_EDGE),tt.useProgram("heatmapTexture").draw(st,X.TRIANGLES,H.disabled,J.disabled,tt.colorModeForRenderPass(),ut.disabled,function(_t,Et,wt,It){var Rt=c.create();c.ortho(Rt,0,_t.width,_t.height,0,0,1);var Yt=_t.context.gl;return{u_matrix:Rt,u_world:[Yt.drawingBufferWidth,Yt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Et.paint.get("heatmap-opacity")}}(tt,Q),Q.id,tt.viewportBuffer,tt.quadTriangleIndexBuffer,tt.viewportSegments,Q.paint,tt.transform.zoom)}}(n,o))},line:function(n,a,o,l){if("translucent"===n.renderPass){var d=o.paint.get("line-opacity"),_=o.paint.get("line-width");if(0!==d.constantOr(1)&&0!==_.constantOr(1))for(var g=n.depthModeForSublayer(0,H.ReadOnly),w=n.colorModeForRenderPass(),P=o.paint.get("line-dasharray"),M=o.paint.get("line-pattern"),j=M.constantOr(1),V=o.paint.get("line-gradient"),q=o.getCrossfadeParameters(),tt=j?"linePattern":P?"lineSDF":V?"lineGradient":"line",Q=n.context,st=Q.gl,X=!0,at=0,ht=l;at<ht.length;at+=1){var _t=ht[at],Et=a.getTile(_t);if(!j||Et.patternsLoaded()){var wt=Et.getBucket(o);if(wt){var It=wt.programConfigurations.get(o.id),Rt=n.context.program.get(),Yt=n.useProgram(tt,It),Xt=X||Yt.program!==Rt,ue=M.constantOr(null);if(ue&&Et.imageAtlas){var ve=Et.imageAtlas,Se=ve.patternPositions[ue.to.toString()],we=ve.patternPositions[ue.from.toString()];Se&&we&&It.setConstantPatternPositions(Se,we)}var Ei=j?Sa(n,Et,o,q):P?Io(n,Et,o,P,q):V?Ai(n,Et,o,wt.lineClipsArray.length):Xr(n,Et,o);if(j)Q.activeTexture.set(st.TEXTURE0),Et.imageAtlasTexture.bind(st.LINEAR,st.CLAMP_TO_EDGE),It.updatePaintBuffers(q);else if(P&&(Xt||n.lineAtlas.dirty))Q.activeTexture.set(st.TEXTURE0),n.lineAtlas.bind(Q);else if(V){var pe=wt.gradients[o.id],Re=pe.texture;if(o.gradientVersion!==pe.version){var Je=256;if(o.stepInterpolant){var Be=a.getSource().maxzoom,ke=_t.canonical.z===Be?Math.ceil(1<<n.transform.maxZoom-_t.canonical.z):1;Je=c.clamp(c.nextPowerOfTwo(wt.maxLineLength/c.EXTENT*1024*ke),256,Q.maxTextureSize)}pe.gradient=c.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Je,image:pe.gradient||void 0,clips:wt.lineClipsArray}),pe.texture?pe.texture.update(pe.gradient):pe.texture=new c.Texture(Q,pe.gradient,st.RGBA),pe.version=o.gradientVersion,Re=pe.texture}Q.activeTexture.set(st.TEXTURE0),Re.bind(o.stepInterpolant?st.NEAREST:st.LINEAR,st.CLAMP_TO_EDGE)}Yt.draw(Q,st.TRIANGLES,g,n.stencilModeForClipping(_t),w,ut.disabled,Ei,o.id,wt.layoutVertexBuffer,wt.indexBuffer,wt.segments,o.paint,n.transform.zoom,It,wt.layoutVertexBuffer2),X=!1}}}}},fill:function(n,a,o,l){var d=o.paint.get("fill-color"),_=o.paint.get("fill-opacity");if(0!==_.constantOr(1)){var g=n.colorModeForRenderPass(),w=o.paint.get("fill-pattern"),P=n.opaquePassEnabledForLayer()&&!w.constantOr(1)&&1===d.constantOr(c.Color.transparent).a&&1===_.constantOr(0)?"opaque":"translucent";if(n.renderPass===P){var M=n.depthModeForSublayer(1,"opaque"===n.renderPass?H.ReadWrite:H.ReadOnly);m(n,a,o,l,M,g,!1)}if("translucent"===n.renderPass&&o.paint.get("fill-antialias")){var j=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,H.ReadOnly);m(n,a,o,l,j,g,!0)}}},"fill-extrusion":function(n,a,o,l){var d=o.paint.get("fill-extrusion-opacity");if(0!==d&&"translucent"===n.renderPass){var _=new H(n.context.gl.LEQUAL,H.ReadWrite,n.depthRangeFor3D);if(1!==d||o.paint.get("fill-extrusion-pattern").constantOr(1))b(n,a,o,l,_,J.disabled,ot.disabled),b(n,a,o,l,_,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var g=n.colorModeForRenderPass();b(n,a,o,l,_,J.disabled,g)}}},hillshade:function(n,a,o,l){if("offscreen"===n.renderPass||"translucent"===n.renderPass){for(var d=n.context,_=n.depthModeForSublayer(0,H.ReadOnly),g=n.colorModeForRenderPass(),w="translucent"===n.renderPass?n.stencilConfigForOverlap(l):[{},l],P=w[0],M=0,j=w[1];M<j.length;M+=1){var V=j[M],q=a.getTile(V);q.needsHillshadePrepare&&"offscreen"===n.renderPass?G(n,q,o,_,J.disabled,g):"translucent"===n.renderPass&&C(n,q,o,_,P[V.overscaledZ],g)}d.viewport.set([0,0,n.width,n.height])}},raster:function(n,a,o,l){if("translucent"===n.renderPass&&0!==o.paint.get("raster-opacity")&&l.length)for(var d=n.context,_=d.gl,g=a.getSource(),w=n.useProgram("raster"),P=n.colorModeForRenderPass(),M=g instanceof Qn?[{},l]:n.stencilConfigForOverlap(l),j=M[0],V=M[1],q=V[V.length-1].overscaledZ,tt=!n.options.moving,Q=0,st=V;Q<st.length;Q+=1){var X=st[Q],at=n.depthModeForSublayer(X.overscaledZ-q,1===o.paint.get("raster-opacity")?H.ReadWrite:H.ReadOnly,_.LESS),ht=a.getTile(X),_t=n.transform.calculatePosMatrix(X.toUnwrapped(),tt);ht.registerFadeDuration(o.paint.get("raster-fade-duration"));var Et=a.findLoadedParent(X,0),wt=rt(ht,Et,a,o,n.transform),It=void 0,Rt=void 0,Yt="nearest"===o.paint.get("raster-resampling")?_.NEAREST:_.LINEAR;d.activeTexture.set(_.TEXTURE0),ht.texture.bind(Yt,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),d.activeTexture.set(_.TEXTURE1),Et?(Et.texture.bind(Yt,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),It=Math.pow(2,Et.tileID.overscaledZ-ht.tileID.overscaledZ),Rt=[ht.tileID.canonical.x*It%1,ht.tileID.canonical.y*It%1]):ht.texture.bind(Yt,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST);var Xt=fa(_t,Rt||[0,0],It||1,wt,o);g instanceof Qn?w.draw(d,_.TRIANGLES,at,J.disabled,P,ut.disabled,Xt,o.id,g.boundsBuffer,n.quadTriangleIndexBuffer,g.boundsSegments):w.draw(d,_.TRIANGLES,at,j[X.overscaledZ],P,ut.disabled,Xt,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,a,o){var l=o.paint.get("background-color"),d=o.paint.get("background-opacity");if(0!==d){var _=n.context,g=_.gl,w=n.transform,P=w.tileSize,M=o.paint.get("background-pattern");if(!n.isPatternMissing(M)){var j=!M&&1===l.a&&1===d&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===j){var V=J.disabled,q=n.depthModeForSublayer(0,"opaque"===j?H.ReadWrite:H.ReadOnly),tt=n.colorModeForRenderPass(),Q=n.useProgram(M?"backgroundPattern":"background"),st=w.coveringTiles({tileSize:P});M&&(_.activeTexture.set(g.TEXTURE0),n.imageManager.bind(n.context));for(var X=o.getCrossfadeParameters(),at=0,ht=st;at<ht.length;at+=1){var _t=ht[at],Et=n.transform.calculatePosMatrix(_t.toUnwrapped()),wt=M?ma(Et,d,n,M,{tileID:_t,tileSize:P},X):ta(Et,d,l);Q.draw(_,g.TRIANGLES,q,V,tt,ut.disabled,wt,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,a,o){for(var l=0;l<o.length;l++)E(n,a,o[l])},custom:function(n,a,o){var l=n.context,d=o.implementation;if("offscreen"===n.renderPass){var _=d.prerender;_&&(n.setCustomLayerDefaults(),l.setColorMode(n.colorModeForRenderPass()),_.call(d,l.gl,n.transform.customLayerMatrix()),l.setDirty(),n.setBaseState())}else if("translucent"===n.renderPass){n.setCustomLayerDefaults(),l.setColorMode(n.colorModeForRenderPass()),l.setStencilMode(J.disabled);var g="3d"===d.renderingMode?new H(n.context.gl.LEQUAL,H.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,H.ReadOnly);l.setDepthMode(g),d.render(l.gl,n.transform.customLayerMatrix()),l.setDirty(),n.setBaseState(),l.bindFramebuffer.set(null)}}},Y=function(n,a){this.context=new N(n),this.transform=a,this._tileTextures={},this.setup(),this.numSublayers=et.maxUnderzooming+et.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Wr,this.gpuTimers={}};Y.prototype.resize=function(n,a){if(this.width=n*c.browser.devicePixelRatio,this.height=a*c.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,l=this.style._order;o<l.length;o+=1)this.style._layers[l[o]].resize()},Y.prototype.setup=function(){var n=this.context,a=new c.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(c.EXTENT,0),a.emplaceBack(0,c.EXTENT),a.emplaceBack(c.EXTENT,c.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(a,Ki.members),this.tileExtentSegments=c.SegmentVector.simpleSegment(0,0,4,2);var o=new c.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(c.EXTENT,0),o.emplaceBack(0,c.EXTENT),o.emplaceBack(c.EXTENT,c.EXTENT),this.debugBuffer=n.createVertexBuffer(o,Ki.members),this.debugSegments=c.SegmentVector.simpleSegment(0,0,4,5);var l=new c.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(c.EXTENT,0,c.EXTENT,0),l.emplaceBack(0,c.EXTENT,0,c.EXTENT),l.emplaceBack(c.EXTENT,c.EXTENT,c.EXTENT,c.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(l,Tn.members),this.rasterBoundsSegments=c.SegmentVector.simpleSegment(0,0,4,2);var d=new c.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(d,Ki.members),this.viewportSegments=c.SegmentVector.simpleSegment(0,0,4,2);var _=new c.StructArrayLayout1ui2;_.emplaceBack(0),_.emplaceBack(1),_.emplaceBack(3),_.emplaceBack(2),_.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(_);var g=new c.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(g),this.emptyTexture=new c.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var w=this.context.gl;this.stencilClearMode=new J({func:w.ALWAYS,mask:0},0,255,w.ZERO,w.ZERO,w.ZERO)},Y.prototype.clearStencil=function(){var n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=c.create();c.ortho(o,0,this.width,this.height,0,0,1),c.scale(o,o,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,a.TRIANGLES,H.disabled,this.stencilClearMode,ot.disabled,ut.disabled,pa(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Y.prototype._renderTileClippingMasks=function(n,a){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&a&&a.length){this.currentStencilSource=n.source;var o=this.context,l=o.gl;this.nextStencilID+a.length>256&&this.clearStencil(),o.setColorMode(ot.disabled),o.setDepthMode(H.disabled);var d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var _=0,g=a;_<g.length;_+=1){var w=g[_],P=this._tileClippingMaskIDs[w.key]=this.nextStencilID++;d.draw(o,l.TRIANGLES,H.disabled,new J({func:l.ALWAYS,mask:0},P,255,l.KEEP,l.KEEP,l.REPLACE),ot.disabled,ut.disabled,pa(w.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Y.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,a=this.context.gl;return new J({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)},Y.prototype.stencilModeForClipping=function(n){var a=this.context.gl;return new J({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)},Y.prototype.stencilConfigForOverlap=function(n){var a,o=this.context.gl,l=n.sort(function(P,M){return M.overscaledZ-P.overscaledZ}),d=l[l.length-1].overscaledZ,_=l[0].overscaledZ-d+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();for(var g={},w=0;w<_;w++)g[w+d]=new J({func:o.GEQUAL,mask:255},w+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=_,[g,l]}return[(a={},a[d]=J.disabled,a),l]},Y.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new ot([n.CONSTANT_COLOR,n.ONE],new c.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ot.unblended:ot.alphaBlended},Y.prototype.depthModeForSublayer=function(n,a,o){if(!this.opaquePassEnabledForLayer())return H.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new H(o||this.context.gl.LEQUAL,a,[l,l])},Y.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Y.prototype.render=function(n,a){var o=this;this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(c.browser.now()),this.imageManager.beginFrame();var l=this.style._order,d=this.style.sourceCaches;for(var _ in d){var g=d[_];g.used&&g.prepare(this.context)}var w,P,M={},j={},V={};for(var q in d){var tt=d[q];M[q]=tt.getVisibleCoordinates(),j[q]=M[q].slice().reverse(),V[q]=tt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Q=0;Q<l.length;Q++)if(this.style._layers[l[Q]].is3D()){this.opaquePassCutoff=Q;break}this.renderPass="offscreen";for(var st=0,X=l;st<X.length;st+=1){var at=this.style._layers[X[st]];if(at.hasOffscreenPass()&&!at.isHidden(this.transform.zoom)){var ht=j[at.source];("custom"===at.type||ht.length)&&this.renderLayer(this,d[at.source],at,ht)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.Color.black:c.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var _t=this.style._layers[l[this.currentLayer]],Et=d[_t.source],wt=M[_t.source];this._renderTileClippingMasks(_t,wt),this.renderLayer(this,Et,_t,wt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var It=this.style._layers[l[this.currentLayer]],Rt=d[It.source],Yt=("symbol"===It.type?V:j)[It.source];this._renderTileClippingMasks(It,M[It.source]),this.renderLayer(this,Rt,It,Yt)}this.options.showTileBoundaries&&(c.values(this.style._layers).forEach(function(Xt){Xt.source&&!Xt.isHidden(o.transform.zoom)&&(Xt.source!==(P&&P.id)&&(P=o.style.sourceCaches[Xt.source]),(!w||w.getSource().maxzoom<P.getSource().maxzoom)&&(w=P))}),w&&Z.debug(this,w,w.getVisibleCoordinates())),this.options.showPadding&&function(Xt){var ue=Xt.transform.padding;Qe(Xt,Xt.transform.height-(ue.top||0),3,gt),Qe(Xt,ue.bottom||0,3,kt),O(Xt,ue.left||0,3,Lt),O(Xt,Xt.transform.width-(ue.right||0),3,oe);var Se,we,Ei,pe,ve=Xt.transform.centerPoint;y(Se=Xt,(we=ve.x)-1,(Ei=Xt.transform.height-ve.y)-10,2,20,pe=de),y(Se,we-10,Ei-1,20,2,pe)}(this),this.context.setDefault()},Y.prototype.renderLayer=function(n,a,o,l){o.isHidden(this.transform.zoom)||("background"===o.type||"custom"===o.type||l.length)&&(this.id=o.id,this.gpuTimingStart(o),Z[o.type](n,a,o,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},Y.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var a=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),o.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,o.query)}},Y.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Y.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Y.prototype.queryGpuTimers=function(n){var a={};for(var o in n){var l=n[o],d=this.context.extTimerQuery,_=d.getQueryObjectEXT(l.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(l.query),a[o]=_}return a},Y.prototype.translatePosMatrix=function(n,a,o,l,d){if(!o[0]&&!o[1])return n;var _=d?"map"===l?this.transform.angle:0:"viewport"===l?-this.transform.angle:0;if(_){var g=Math.sin(_),w=Math.cos(_);o=[o[0]*w-o[1]*g,o[0]*g+o[1]*w]}var P=[d?o[0]:Fi(a,o[0],this.transform.zoom),d?o[1]:Fi(a,o[1],this.transform.zoom),0],M=new Float32Array(16);return c.translate(M,n,P),M},Y.prototype.saveTileTexture=function(n){var a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]},Y.prototype.getTileTexture=function(n){var a=this._tileTextures[n];return a&&a.length>0?a.pop():null},Y.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var a=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!a||!o},Y.prototype.useProgram=function(n,a){this.cache=this.cache||{};var o=""+n+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new La(this.context,n,Ls[n],a,ls[n],this._showOverdrawInspector)),this.cache[o]},Y.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Y.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Y.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=c.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Y.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ct=function(n,a){this.points=n,this.planes=a};ct.fromInvProjectionMatrix=function(n,a,o){var l=Math.pow(2,o),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(g){return c.transformMat4([],g,n)}).map(function(g){return c.scale$1([],g,1/g[3]/a*l)}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(g){var w=c.sub([],d[g[0]],d[g[1]]),P=c.sub([],d[g[2]],d[g[1]]),M=c.normalize([],c.cross([],w,P)),j=-c.dot(M,d[g[1]]);return M.concat(j)});return new ct(d,_)};var vt=function(n,a){this.min=n,this.max=a,this.center=c.scale$2([],c.add([],this.min,this.max),.5)};vt.prototype.quadrant=function(n){for(var a=[n%2==0,n<2],o=c.clone$2(this.min),l=c.clone$2(this.max),d=0;d<a.length;d++)o[d]=a[d]?this.min[d]:this.center[d],l[d]=a[d]?this.center[d]:this.max[d];return l[2]=this.max[2],new vt(o,l)},vt.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},vt.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},vt.prototype.intersects=function(n){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,l=0;l<n.planes.length;l++){for(var d=n.planes[l],_=0,g=0;g<a.length;g++)_+=c.dot$1(d,a[g])>=0;if(0===_)return 0;_!==a.length&&(o=!1)}if(o)return 2;for(var w=0;w<3;w++){for(var P=Number.MAX_VALUE,M=-Number.MAX_VALUE,j=0;j<n.points.length;j++){var V=n.points[j][w]-this.min[w];P=Math.min(P,V),M=Math.max(M,V)}if(M<0||P>this.max[w]-this.min[w])return 0}return 1};var Ot=function(n,a,o,l){if(void 0===n&&(n=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===l&&(l=0),isNaN(n)||n<0||isNaN(a)||a<0||isNaN(o)||o<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=o,this.right=l};Ot.prototype.interpolate=function(n,a,o){return null!=a.top&&null!=n.top&&(this.top=c.number(n.top,a.top,o)),null!=a.bottom&&null!=n.bottom&&(this.bottom=c.number(n.bottom,a.bottom,o)),null!=a.left&&null!=n.left&&(this.left=c.number(n.left,a.left,o)),null!=a.right&&null!=n.right&&(this.right=c.number(n.right,a.right,o)),this},Ot.prototype.getCenter=function(n,a){var o=c.clamp((this.left+n-this.right)/2,0,n),l=c.clamp((this.top+a-this.bottom)/2,0,a);return new c.Point(o,l)},Ot.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},Ot.prototype.clone=function(){return new Ot(this.top,this.bottom,this.left,this.right)},Ot.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ct=function(n,a,o,l,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===d||d,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=o??0,this._maxPitch=l??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ot,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ht={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ct.prototype.clone=function(){var n=new Ct(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Ht.minZoom.get=function(){return this._minZoom},Ht.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Ht.maxZoom.get=function(){return this._maxZoom},Ht.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Ht.minPitch.get=function(){return this._minPitch},Ht.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Ht.maxPitch.get=function(){return this._maxPitch},Ht.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Ht.renderWorldCopies.get=function(){return this._renderWorldCopies},Ht.renderWorldCopies.set=function(n){void 0===n?n=!0:null===n&&(n=!1),this._renderWorldCopies=n},Ht.worldSize.get=function(){return this.tileSize*this.scale},Ht.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ht.size.get=function(){return new c.Point(this.width,this.height)},Ht.bearing.get=function(){return-this.angle/Math.PI*180},Ht.bearing.set=function(n){var a=-c.wrap(n,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=c.create$2(),c.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ht.pitch.get=function(){return this._pitch/Math.PI*180},Ht.pitch.set=function(n){var a=c.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},Ht.fov.get=function(){return this._fov/Math.PI*180},Ht.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Ht.zoom.get=function(){return this._zoom},Ht.zoom.set=function(n){var a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},Ht.center.get=function(){return this._center},Ht.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Ht.padding.get=function(){return this._edgeInsets.toJSON()},Ht.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Ht.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ct.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},Ct.prototype.interpolatePadding=function(n,a,o){this._unmodified=!1,this._edgeInsets.interpolate(n,a,o),this._constrain(),this._calcMatrices()},Ct.prototype.coveringZoomLevel=function(n){var a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)},Ct.prototype.getVisibleUnwrappedCoordinates=function(n){var a=[new c.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new c.Point(0,0)),l=this.pointCoordinate(new c.Point(this.width,0)),d=this.pointCoordinate(new c.Point(this.width,this.height)),_=this.pointCoordinate(new c.Point(0,this.height)),g=Math.floor(Math.min(o.x,l.x,d.x,_.x)),w=Math.floor(Math.max(o.x,l.x,d.x,_.x)),P=g-1;P<=w+1;P++)0!==P&&a.push(new c.UnwrappedTileID(P,n));return a},Ct.prototype.coveringTiles=function(n){var a=this.coveringZoomLevel(n),o=a;if(void 0!==n.minzoom&&a<n.minzoom)return[];void 0!==n.maxzoom&&a>n.maxzoom&&(a=n.maxzoom);var l=c.MercatorCoordinate.fromLngLat(this.center),d=Math.pow(2,a),_=[d*l.x,d*l.y,0],g=ct.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),w=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(w=a);var P=function(Xt){return{aabb:new vt([Xt*d,0,0],[(Xt+1)*d,d,0]),zoom:0,x:0,y:0,wrap:Xt,fullyVisible:!1}},M=[],j=[],V=a,q=n.reparseOverscaled?o:a;if(this._renderWorldCopies)for(var tt=1;tt<=3;tt++)M.push(P(-tt)),M.push(P(tt));for(M.push(P(0));M.length>0;){var Q=M.pop(),st=Q.x,X=Q.y,at=Q.fullyVisible;if(!at){var ht=Q.aabb.intersects(g);if(0===ht)continue;at=2===ht}var _t=Q.aabb.distanceX(_),Et=Q.aabb.distanceY(_),wt=Math.max(Math.abs(_t),Math.abs(Et));if(Q.zoom===V||wt>3+(1<<V-Q.zoom)-2&&Q.zoom>=w)j.push({tileID:new c.OverscaledTileID(Q.zoom===V?q:Q.zoom,Q.wrap,Q.zoom,st,X),distanceSq:c.sqrLen([_[0]-.5-st,_[1]-.5-X])});else for(var It=0;It<4;It++){var Rt=(st<<1)+It%2,Yt=(X<<1)+(It>>1);M.push({aabb:Q.aabb.quadrant(It),zoom:Q.zoom+1,x:Rt,y:Yt,wrap:Q.wrap,fullyVisible:at})}}return j.sort(function(Xt,ue){return Xt.distanceSq-ue.distanceSq}).map(function(Xt){return Xt.tileID})},Ct.prototype.resize=function(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()},Ht.unmodified.get=function(){return this._unmodified},Ct.prototype.zoomScale=function(n){return Math.pow(2,n)},Ct.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},Ct.prototype.project=function(n){var a=c.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new c.Point(c.mercatorXfromLng(n.lng)*this.worldSize,c.mercatorYfromLat(a)*this.worldSize)},Ct.prototype.unproject=function(n){return new c.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Ht.point.get=function(){return this.project(this.center)},Ct.prototype.setLocationAtPoint=function(n,a){var o=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(n),_=new c.MercatorCoordinate(d.x-(o.x-l.x),d.y-(o.y-l.y));this.center=this.coordinateLocation(_),this._renderWorldCopies&&(this.center=this.center.wrap())},Ct.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},Ct.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},Ct.prototype.locationCoordinate=function(n){return c.MercatorCoordinate.fromLngLat(n)},Ct.prototype.coordinateLocation=function(n){return n.toLngLat()},Ct.prototype.pointCoordinate=function(n){var a=[n.x,n.y,0,1],o=[n.x,n.y,1,1];c.transformMat4(a,a,this.pixelMatrixInverse),c.transformMat4(o,o,this.pixelMatrixInverse);var l=a[3],d=o[3],_=a[1]/l,g=o[1]/d,w=a[2]/l,P=o[2]/d,M=w===P?0:(0-w)/(P-w);return new c.MercatorCoordinate(c.number(a[0]/l,o[0]/d,M)/this.worldSize,c.number(_,g,M)/this.worldSize)},Ct.prototype.coordinatePoint=function(n){var a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.transformMat4(a,a,this.pixelMatrix),new c.Point(a[0]/a[3],a[1]/a[3])},Ct.prototype.getBounds=function(){return(new c.LngLatBounds).extend(this.pointLocation(new c.Point(0,0))).extend(this.pointLocation(new c.Point(this.width,0))).extend(this.pointLocation(new c.Point(this.width,this.height))).extend(this.pointLocation(new c.Point(0,this.height)))},Ct.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new c.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ct.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ct.prototype.calculatePosMatrix=function(n,a){void 0===a&&(a=!1);var o=n.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[o])return l[o];var d=n.canonical,_=this.worldSize/this.zoomScale(d.z),g=d.x+Math.pow(2,d.z)*n.wrap,w=c.identity(new Float64Array(16));return c.translate(w,w,[g*_,d.y*_,0]),c.scale(w,w,[_/c.EXTENT,_/c.EXTENT,1]),c.multiply(w,a?this.alignedProjMatrix:this.projMatrix,w),l[o]=new Float32Array(w),l[o]},Ct.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ct.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,a,o,l,d=-90,_=90,g=-180,w=180,P=this.size,M=this._unmodified;if(this.latRange){var j=this.latRange;d=c.mercatorYfromLat(j[1])*this.worldSize,n=(_=c.mercatorYfromLat(j[0])*this.worldSize)-d<P.y?P.y/(_-d):0}if(this.lngRange){var V=this.lngRange;g=c.mercatorXfromLng(V[0])*this.worldSize,a=(w=c.mercatorXfromLng(V[1])*this.worldSize)-g<P.x?P.x/(w-g):0}var q=this.point,tt=Math.max(a||0,n||0);if(tt)return this.center=this.unproject(new c.Point(a?(w+g)/2:q.x,n?(_+d)/2:q.y)),this.zoom+=this.scaleZoom(tt),this._unmodified=M,void(this._constraining=!1);if(this.latRange){var Q=q.y,st=P.y/2;Q-st<d&&(l=d+st),Q+st>_&&(l=_-st)}if(this.lngRange){var X=q.x,at=P.x/2;X-at<g&&(o=g+at),X+at>w&&(o=w-at)}void 0===o&&void 0===l||(this.center=this.unproject(new c.Point(void 0!==o?o:q.x,void 0!==l?l:q.y))),this._unmodified=M,this._constraining=!1}},Ct.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),l=Math.sin(o)*this.cameraToCenterDistance/Math.sin(c.clamp(Math.PI-a-o,.01,Math.PI-.01)),d=this.point,_=d.x,g=d.y,w=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),P=this.height/50,M=new Float64Array(16);c.perspective(M,this._fov,this.width/this.height,P,w),M[8]=2*-n.x/this.width,M[9]=2*n.y/this.height,c.scale(M,M,[1,-1,1]),c.translate(M,M,[0,0,-this.cameraToCenterDistance]),c.rotateX(M,M,this._pitch),c.rotateZ(M,M,this.angle),c.translate(M,M,[-_,-g,0]),this.mercatorMatrix=c.scale([],M,[this.worldSize,this.worldSize,this.worldSize]),c.scale(M,M,[1,1,c.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=M,this.invProjMatrix=c.invert([],this.projMatrix);var j=this.width%2/2,V=this.height%2/2,q=Math.cos(this.angle),tt=Math.sin(this.angle),Q=_-Math.round(_)+q*j+tt*V,st=g-Math.round(g)+q*V+tt*j,X=new Float64Array(M);if(c.translate(X,X,[Q>.5?Q-1:Q,st>.5?st-1:st,0]),this.alignedProjMatrix=X,M=c.create(),c.scale(M,M,[this.width/2,-this.height/2,1]),c.translate(M,M,[1,-1,0]),this.labelPlaneMatrix=M,M=c.create(),c.scale(M,M,[1,-1,1]),c.translate(M,M,[-1,-1,0]),c.scale(M,M,[2/this.width,2/this.height,1]),this.glCoordMatrix=M,this.pixelMatrix=c.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(M=c.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=M,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ct.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new c.Point(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ct.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.Point(0,n))},Ct.prototype.getCameraQueryGeometry=function(n){var a=this.getCameraPoint();if(1===n.length)return[n[0],a];for(var o=a.x,l=a.y,d=a.x,_=a.y,g=0,w=n;g<w.length;g+=1){var P=w[g];o=Math.min(o,P.x),l=Math.min(l,P.y),d=Math.max(d,P.x),_=Math.max(_,P.y)}return[new c.Point(o,l),new c.Point(d,l),new c.Point(d,_),new c.Point(o,_),new c.Point(o,l)]},Object.defineProperties(Ct.prototype,Ht);var ce=function(n){var a,o,l,d;this._hashName=n&&encodeURIComponent(n),c.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(a=this._updateHashUnthrottled.bind(this),o=!1,l=null,d=function(){l=null,o&&(a(),l=setTimeout(d,300),o=!1)},function(){return o=!0,l||d(),l})};ce.prototype.addTo=function(n){return this._map=n,c.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ce.prototype.remove=function(){return c.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ce.prototype.getHashString=function(n){var a=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,l=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,l),_=Math.round(a.lng*d)/d,g=Math.round(a.lat*d)/d,w=this._map.getBearing(),P=this._map.getPitch(),M="";if(M+=n?"/"+_+"/"+g+"/"+o:o+"/"+g+"/"+_,(w||P)&&(M+="/"+Math.round(10*w)/10),P&&(M+="/"+Math.round(P)),this._hashName){var j=this._hashName,V=!1,q=c.window.location.hash.slice(1).split("&").map(function(tt){var Q=tt.split("=")[0];return Q===j?(V=!0,Q+"="+M):tt}).filter(function(tt){return tt});return V||q.push(j+"="+M),"#"+q.join("&")}return"#"+M},ce.prototype._getCurrentHash=function(){var n,a=this,o=c.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(n=l)}),(n&&n[1]||"").split("/")):o.split("/")},ce.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:a,pitch:+(n[4]||0)}),!0}return!1},ce.prototype._updateHashUnthrottled=function(){var n=c.window.location.href.replace(/(#.+)?$/,this.getHashString());try{c.window.history.replaceState(c.window.history.state,null,n)}catch{}};var ne={linearity:.3,easing:c.bezier(0,0,.3,1)},ii=c.extend({deceleration:2500,maxSpeed:1400},ne),Ue=c.extend({deceleration:20,maxSpeed:1400},ne),Ze=c.extend({deceleration:1e3,maxSpeed:360},ne),ni=c.extend({deceleration:1e3,maxSpeed:90},ne),qe=function(n){this._map=n,this.clear()};function ji(n,a){(!n.duration||n.duration<a.duration)&&(n.duration=a.duration,n.easing=a.easing)}function ci(n,a,o){var l=o.maxSpeed,d=o.linearity,_=o.deceleration,g=c.clamp(n*d/(a/1e3),-l,l),w=Math.abs(g)/(_*d);return{easing:o.easing,duration:1e3*w,amount:g*(w/2)}}qe.prototype.clear=function(){this._inertiaBuffer=[]},qe.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.browser.now(),settings:n})},qe.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,a=c.browser.now();n.length>0&&a-n[0].time>160;)n.shift()},qe.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new c.Point(0,0),pinchAround:void 0,around:void 0},o=0,l=this._inertiaBuffer;o<l.length;o+=1){var d=l[o].settings;a.zoom+=d.zoomDelta||0,a.bearing+=d.bearingDelta||0,a.pitch+=d.pitchDelta||0,d.panDelta&&a.pan._add(d.panDelta),d.around&&(a.around=d.around),d.pinchAround&&(a.pinchAround=d.pinchAround)}var _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(a.pan.mag()){var w=ci(a.pan.mag(),_,c.extend({},ii,n||{}));g.offset=a.pan.mult(w.amount/a.pan.mag()),g.center=this._map.transform.center,ji(g,w)}if(a.zoom){var P=ci(a.zoom,_,Ue);g.zoom=this._map.transform.zoom+P.amount,ji(g,P)}if(a.bearing){var M=ci(a.bearing,_,Ze);g.bearing=this._map.transform.bearing+c.clamp(M.amount,-179,179),ji(g,M)}if(a.pitch){var j=ci(a.pitch,_,ni);g.pitch=this._map.transform.pitch+j.amount,ji(g,j)}if(g.zoom||g.bearing){var V=void 0===a.pinchAround?a.around:a.pinchAround;g.around=V?this._map.unproject(V):this._map.getCenter()}return this.clear(),c.extend(g,{noMoveStart:!0})}};var Ie=function(n){function a(l,d,_,g){void 0===g&&(g={});var w=Mt.mousePos(d.getCanvasContainer(),_),P=d.unproject(w);n.call(this,l,c.extend({point:w,lngLat:P,originalEvent:_},g)),this._defaultPrevented=!1,this.target=d}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(c.Event),Si=function(n){function a(l,d,_){var g="touchend"===l?_.changedTouches:_.touches,w=Mt.touchPos(d.getCanvasContainer(),g),P=w.map(function(V){return d.unproject(V)}),M=w.reduce(function(V,q,tt,Q){return V.add(q.div(Q.length))},new c.Point(0,0)),j=d.unproject(M);n.call(this,l,{points:w,point:M,lngLats:P,lngLat:j,originalEvent:_}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(c.Event),zi=function(n){function a(l,d,_){n.call(this,l,{originalEvent:_}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(c.Event),De=function(n,a){this._map=n,this._clickTolerance=a.clickTolerance};De.prototype.reset=function(){delete this._mousedownPos},De.prototype.wheel=function(n){return this._firePreventable(new zi(n.type,this._map,n))},De.prototype.mousedown=function(n,a){return this._mousedownPos=a,this._firePreventable(new Ie(n.type,this._map,n))},De.prototype.mouseup=function(n){this._map.fire(new Ie(n.type,this._map,n))},De.prototype.click=function(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Ie(n.type,this._map,n))},De.prototype.dblclick=function(n){return this._firePreventable(new Ie(n.type,this._map,n))},De.prototype.mouseover=function(n){this._map.fire(new Ie(n.type,this._map,n))},De.prototype.mouseout=function(n){this._map.fire(new Ie(n.type,this._map,n))},De.prototype.touchstart=function(n){return this._firePreventable(new Si(n.type,this._map,n))},De.prototype.touchmove=function(n){this._map.fire(new Si(n.type,this._map,n))},De.prototype.touchend=function(n){this._map.fire(new Si(n.type,this._map,n))},De.prototype.touchcancel=function(n){this._map.fire(new Si(n.type,this._map,n))},De.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},De.prototype.isEnabled=function(){return!0},De.prototype.isActive=function(){return!1},De.prototype.enable=function(){},De.prototype.disable=function(){};var qt=function(n){this._map=n};qt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},qt.prototype.mousemove=function(n){this._map.fire(new Ie(n.type,this._map,n))},qt.prototype.mousedown=function(){this._delayContextMenu=!0},qt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ie("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},qt.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ie(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},qt.prototype.isEnabled=function(){return!0},qt.prototype.isActive=function(){return!1},qt.prototype.enable=function(){},qt.prototype.disable=function(){};var li=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1};function $i(n,a){for(var o={},l=0;l<n.length;l++)o[n[l].identifier]=a[l];return o}li.prototype.isEnabled=function(){return!!this._enabled},li.prototype.isActive=function(){return!!this._active},li.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},li.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},li.prototype.mousedown=function(n,a){this.isEnabled()&&n.shiftKey&&0===n.button&&(Mt.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},li.prototype.mousemoveWindow=function(n,a){if(this._active){var o=a;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=o,this._box||(this._box=Mt.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var d=Math.min(l.x,o.x),_=Math.max(l.x,o.x),g=Math.min(l.y,o.y),w=Math.max(l.y,o.y);Mt.setTransform(this._box,"translate("+d+"px,"+g+"px)"),this._box.style.width=_-d+"px",this._box.style.height=w-g+"px"}}},li.prototype.mouseupWindow=function(n,a){var o=this;if(this._active&&0===n.button){var l=this._startPos,d=a;if(this.reset(),Mt.suppressClick(),l.x!==d.x||l.y!==d.y)return this._map.fire(new c.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(_){return _.fitScreenCoordinates(l,d,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},li.prototype.keydown=function(n){this._active&&27===n.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",n))},li.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(Mt.remove(this._box),this._box=null),Mt.enableDrag(),delete this._startPos,delete this._lastPos},li.prototype._fireEvent=function(n,a){return this._map.fire(new c.Event(n,{originalEvent:a}))};var Xn=function(n){this.reset(),this.numTouches=n.numTouches};Xn.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Xn.prototype.touchstart=function(n,a,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(l){for(var d=new c.Point(0,0),_=0,g=l;_<g.length;_+=1)d._add(g[_]);return d.div(l.length)}(a),this.touches=$i(o,a)))},Xn.prototype.touchmove=function(n,a,o){if(!this.aborted&&this.centroid){var l=$i(o,a);for(var d in this.touches){var _=l[d];(!_||_.dist(this.touches[d])>30)&&(this.aborted=!0)}}},Xn.prototype.touchend=function(n,a,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),0===o.length){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var cn=function(n){this.singleTap=new Xn(n),this.numTaps=n.numTaps,this.reset()};cn.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},cn.prototype.touchstart=function(n,a,o){this.singleTap.touchstart(n,a,o)},cn.prototype.touchmove=function(n,a,o){this.singleTap.touchmove(n,a,o)},cn.prototype.touchend=function(n,a,o){var l=this.singleTap.touchend(n,a,o);if(l){var d=n.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(l)<30;if(d&&_||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var pn=function(){this._zoomIn=new cn({numTouches:1,numTaps:2}),this._zoomOut=new cn({numTouches:2,numTaps:1}),this.reset()};pn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},pn.prototype.touchstart=function(n,a,o){this._zoomIn.touchstart(n,a,o),this._zoomOut.touchstart(n,a,o)},pn.prototype.touchmove=function(n,a,o){this._zoomIn.touchmove(n,a,o),this._zoomOut.touchmove(n,a,o)},pn.prototype.touchend=function(n,a,o){var l=this,d=this._zoomIn.touchend(n,a,o),_=this._zoomOut.touchend(n,a,o);return d?(this._active=!0,n.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(g){return g.easeTo({duration:300,zoom:g.getZoom()+1,around:g.unproject(d)},{originalEvent:n})}}):_?(this._active=!0,n.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(g){return g.easeTo({duration:300,zoom:g.getZoom()-1,around:g.unproject(_)},{originalEvent:n})}}):void 0},pn.prototype.touchcancel=function(){this.reset()},pn.prototype.enable=function(){this._enabled=!0},pn.prototype.disable=function(){this._enabled=!1,this.reset()},pn.prototype.isEnabled=function(){return this._enabled},pn.prototype.isActive=function(){return this._active};var Pn={0:1,2:2},$t=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};$t.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},$t.prototype._correctButton=function(n,a){return!1},$t.prototype._move=function(n,a){return{}},$t.prototype.mousedown=function(n,a){if(!this._lastPoint){var o=Mt.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=a,this._eventButton=o)}},$t.prototype.mousemoveWindow=function(n,a){var l,_,o=this._lastPoint;if(o)if(n.preventDefault(),_=Pn[this._eventButton],void 0===(l=n).buttons||(l.buttons&_)!==_)this.reset();else if(this._moved||!(a.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(o,a)},$t.prototype.mouseupWindow=function(n){this._lastPoint&&Mt.mouseButton(n)===this._eventButton&&(this._moved&&Mt.suppressClick(),this.reset())},$t.prototype.enable=function(){this._enabled=!0},$t.prototype.disable=function(){this._enabled=!1,this.reset()},$t.prototype.isEnabled=function(){return this._enabled},$t.prototype.isActive=function(){return this._active};var ea=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.mousedown=function(o,l){n.prototype.mousedown.call(this,o,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(o,l){return 0===l&&!o.ctrlKey},a.prototype._move=function(o,l){return{around:l,panDelta:l.sub(o)}},a}($t),Fo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,l){return 0===l&&o.ctrlKey||2===l},a.prototype._move=function(o,l){var d=.8*(l.x-o.x);if(d)return this._active=!0,{bearingDelta:d}},a.prototype.contextmenu=function(o){o.preventDefault()},a}($t),Tr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,l){return 0===l&&o.ctrlKey||2===l},a.prototype._move=function(o,l){var d=-.5*(l.y-o.y);if(d)return this._active=!0,{pitchDelta:d}},a.prototype.contextmenu=function(o){o.preventDefault()},a}($t),Ui=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};Ui.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new c.Point(0,0)},Ui.prototype.touchstart=function(n,a,o){return this._calculateTransform(n,a,o)},Ui.prototype.touchmove=function(n,a,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,a,o)},Ui.prototype.touchend=function(n,a,o){this._calculateTransform(n,a,o),this._active&&o.length<this._minTouches&&this.reset()},Ui.prototype.touchcancel=function(){this.reset()},Ui.prototype._calculateTransform=function(n,a,o){o.length>0&&(this._active=!0);var l=$i(o,a),d=new c.Point(0,0),_=new c.Point(0,0),g=0;for(var w in l){var P=l[w],M=this._touches[w];M&&(d._add(P),_._add(P.sub(M)),g++,l[w]=P)}if(this._touches=l,!(g<this._minTouches)&&_.mag()){var j=_.div(g);if(this._sum._add(j),!(this._sum.mag()<this._clickTolerance))return{around:d.div(g),panDelta:j}}},Ui.prototype.enable=function(){this._enabled=!0},Ui.prototype.disable=function(){this._enabled=!1,this.reset()},Ui.prototype.isEnabled=function(){return this._enabled},Ui.prototype.isActive=function(){return this._active};var nr=function(){this.reset()};function Br(n,a,o){for(var l=0;l<n.length;l++)if(n[l].identifier===o)return a[l]}function Sr(n,a){return Math.log(n/a)/Math.LN2}nr.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},nr.prototype._start=function(n){},nr.prototype._move=function(n,a,o){return{}},nr.prototype.touchstart=function(n,a,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([a[0],a[1]]))},nr.prototype.touchmove=function(n,a,o){if(this._firstTwoTouches){n.preventDefault();var l=this._firstTwoTouches,d=l[1],_=Br(o,a,l[0]),g=Br(o,a,d);if(_&&g){var w=this._aroundCenter?null:_.add(g).div(2);return this._move([_,g],w,n)}}},nr.prototype.touchend=function(n,a,o){if(this._firstTwoTouches){var l=this._firstTwoTouches,d=l[1],_=Br(o,a,l[0]),g=Br(o,a,d);_&&g||(this._active&&Mt.suppressClick(),this.reset())}},nr.prototype.touchcancel=function(){this.reset()},nr.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&"center"===n.around},nr.prototype.disable=function(){this._enabled=!1,this.reset()},nr.prototype.isEnabled=function(){return this._enabled},nr.prototype.isActive=function(){return this._active};var dn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},a.prototype._move=function(o,l){var d=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Sr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sr(this._distance,d),pinchAround:l}},a}(nr);function Uo(n,a){return 180*n.angleWith(a)/Math.PI}var hs=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},a.prototype._move=function(o,l){var d=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Uo(this._vector,d),pinchAround:l}},a.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var l=25/(Math.PI*this._minDiameter)*360,d=Uo(o,this._startVector);return Math.abs(d)<l},a}(nr);function _a(n){return Math.abs(n.y)>Math.abs(n.x)}var il=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(o){this._lastPoints=o,_a(o[0].sub(o[1]))&&(this._valid=!1)},a.prototype._move=function(o,l,d){var _=o[0].sub(this._lastPoints[0]),g=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(_,g,d.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(_.y+g.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(o,l,d){if(void 0!==this._valid)return this._valid;var _=o.mag()>=2,g=l.mag()>=2;if(_||g){if(!_||!g)return void 0===this._firstMove&&(this._firstMove=d),d-this._firstMove<100&&void 0;var w=o.y>0==l.y>0;return _a(o)&&_a(l)&&w}},a}(nr),nl={panStep:100,bearingStep:15,pitchStep:10},No=function(){var n=nl;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function Po(n){return n*(2-n)}No.prototype.reset=function(){this._active=!1},No.prototype.keydown=function(n){var a=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,l=0,d=0,_=0,g=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?l=-1:(n.preventDefault(),_=-1);break;case 39:n.shiftKey?l=1:(n.preventDefault(),_=1);break;case 38:n.shiftKey?d=1:(n.preventDefault(),g=-1);break;case 40:n.shiftKey?d=-1:(n.preventDefault(),g=1);break;default:return}return this._rotationDisabled&&(l=0,d=0),{cameraAnimation:function(w){var P=w.getZoom();w.easeTo({duration:300,easeId:"keyboardHandler",easing:Po,zoom:o?Math.round(P)+o*(n.shiftKey?2:1):P,bearing:w.getBearing()+l*a._bearingStep,pitch:w.getPitch()+d*a._pitchStep,offset:[-_*a._panStep,-g*a._panStep],center:w.getCenter()},{originalEvent:n})}}}},No.prototype.enable=function(){this._enabled=!0},No.prototype.disable=function(){this._enabled=!1,this.reset()},No.prototype.isEnabled=function(){return this._enabled},No.prototype.isActive=function(){return this._active},No.prototype.disableRotation=function(){this._rotationDisabled=!0},No.prototype.enableRotation=function(){this._rotationDisabled=!1};var ri=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,c.bindAll(["_onTimeout"],this)};ri.prototype.setZoomRate=function(n){this._defaultZoomRate=n},ri.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},ri.prototype.isEnabled=function(){return!!this._enabled},ri.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},ri.prototype.isZooming=function(){return!!this._zooming},ri.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&"center"===n.around)},ri.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ri.prototype.wheel=function(n){if(this.isEnabled()){var a=n.deltaMode===c.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=c.browser.now(),l=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,0!==a&&a%4.000244140625==0?this._type="wheel":0!==a&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}},ri.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},ri.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=Mt.mousePos(this._el,n);this._around=c.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ri.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(0!==this._delta){var o="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&0!==l&&(l=1/l);var d="number"==typeof this._targetZoom?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(d*l))),"wheel"===this._type&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var _,g="number"==typeof this._targetZoom?this._targetZoom:a.zoom,w=this._startZoom,P=this._easing,M=!1;if("wheel"===this._type&&w&&P){var j=Math.min((c.browser.now()-this._lastWheelEventTime)/200,1),V=P(j);_=c.number(w,g,V),j<1?this._frameId||(this._frameId=!0):M=!0}else _=g,M=!0;return this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!M,zoomDelta:_-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ri.prototype._smoothOutEasing=function(n){var a=c.ease;if(this._prevEase){var o=this._prevEase,l=(c.browser.now()-o.start)/o.duration,d=o.easing(l+.01)-o.easing(l),_=.27/Math.sqrt(d*d+1e-4)*.01,g=Math.sqrt(.0729-_*_);a=c.bezier(_,g,.25,1)}return this._prevEase={start:c.browser.now(),duration:n,easing:a},a},ri.prototype.reset=function(){this._active=!1};var ia=function(n,a){this._clickZoom=n,this._tapZoom=a};ia.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ia.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ia.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ia.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var jo=function(){this.reset()};jo.prototype.reset=function(){this._active=!1},jo.prototype.dblclick=function(n,a){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(a)},{originalEvent:n})}}},jo.prototype.enable=function(){this._enabled=!0},jo.prototype.disable=function(){this._enabled=!1,this.reset()},jo.prototype.isEnabled=function(){return this._enabled},jo.prototype.isActive=function(){return this._active};var hr=function(){this._tap=new cn({numTouches:1,numTaps:1}),this.reset()};hr.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},hr.prototype.touchstart=function(n,a,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=a[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,a,o))},hr.prototype.touchmove=function(n,a,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var l=a[0],d=l.y-this._swipePoint.y;return this._swipePoint=l,n.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(n,a,o)},hr.prototype.touchend=function(n,a,o){this._tapTime?this._swipePoint&&0===o.length&&this.reset():this._tap.touchend(n,a,o)&&(this._tapTime=n.timeStamp)},hr.prototype.touchcancel=function(){this.reset()},hr.prototype.enable=function(){this._enabled=!0},hr.prototype.disable=function(){this._enabled=!1,this.reset()},hr.prototype.isEnabled=function(){return this._enabled},hr.prototype.isActive=function(){return this._active};var Ja=function(n,a,o){this._el=n,this._mousePan=a,this._touchPan=o};Ja.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Ja.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Ja.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Ja.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Da=function(n,a,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=o};Da.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Da.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Da.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Da.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var go=function(n,a,o,l){this._el=n,this._touchZoom=a,this._touchRotate=o,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0};go.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},go.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},go.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},go.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},go.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},go.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Or=function(n){return n.zoom||n.drag||n.pitch||n.rotate},cs=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a}(c.Event);function ye(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var fe=function(n,a){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qe(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),c.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[c.window.document,"mousemove",{capture:!0}],[c.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[c.window,"blur",void 0]];for(var l=0,d=this._listeners;l<d.length;l+=1){var _=d[l],g=_[0];Mt.addEventListener(g,_[1],g===c.window.document?this.handleWindowEvent:this.handleEvent,_[2])}};fe.prototype.destroy=function(){for(var n=0,a=this._listeners;n<a.length;n+=1){var o=a[n],l=o[0];Mt.removeEventListener(l,o[1],l===c.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},fe.prototype._addDefaultHandlers=function(n){var a=this._map,o=a.getCanvasContainer();this._add("mapEvent",new De(a,n));var l=a.boxZoom=new li(a,n);this._add("boxZoom",l);var d=new pn,_=new jo;a.doubleClickZoom=new ia(_,d),this._add("tapZoom",d),this._add("clickZoom",_);var g=new hr;this._add("tapDragZoom",g);var w=a.touchPitch=new il;this._add("touchPitch",w);var P=new Fo(n),M=new Tr(n);a.dragRotate=new Da(n,P,M),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",M,["mouseRotate"]);var j=new ea(n),V=new Ui(n);a.dragPan=new Ja(o,j,V),this._add("mousePan",j),this._add("touchPan",V,["touchZoom","touchRotate"]);var q=new hs,tt=new dn;a.touchZoomRotate=new go(o,tt,q,g),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",tt,["touchPan","touchRotate"]);var Q=a.scrollZoom=new ri(a,this);this._add("scrollZoom",Q,["mousePan"]);var st=a.keyboard=new No;this._add("keyboard",st),this._add("blockableMapEvent",new qt(a));for(var X=0,at=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];X<at.length;X+=1){var ht=at[X];n.interactive&&n[ht]&&a[ht].enable(n[ht])}},fe.prototype._add=function(n,a,o){this._handlers.push({handlerName:n,handler:a,allowed:o}),this._handlersById[n]=a},fe.prototype.stop=function(n){if(!this._updatingCamera){for(var a=0,o=this._handlers;a<o.length;a+=1)o[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},fe.prototype.isActive=function(){for(var n=0,a=this._handlers;n<a.length;n+=1)if(a[n].handler.isActive())return!0;return!1},fe.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},fe.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},fe.prototype.isMoving=function(){return Boolean(Or(this._eventsInProgress))||this.isZooming()},fe.prototype._blockedByActive=function(n,a,o){for(var l in n)if(l!==o&&(!a||a.indexOf(l)<0))return!0;return!1},fe.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},fe.prototype._getMapTouches=function(n){for(var a=[],o=0,l=n;o<l.length;o+=1){var d=l[o];this._el.contains(d.target)&&a.push(d)}return a},fe.prototype.handleEvent=function(n,a){if("blur"!==n.type){this._updatingCamera=!0;for(var o="renderFrame"===n.type?void 0:n,l={needsRenderFrame:!1},d={},_={},g=n.touches?this._getMapTouches(n.touches):void 0,w=g?Mt.touchPos(this._el,g):Mt.mousePos(this._el,n),P=0,M=this._handlers;P<M.length;P+=1){var j=M[P],V=j.handlerName,q=j.handler,tt=j.allowed;if(q.isEnabled()){var Q=void 0;this._blockedByActive(_,tt,V)?q.reset():q[a||n.type]&&(Q=q[a||n.type](n,w,g),this.mergeHandlerResult(l,d,Q,V,o),Q&&Q.needsRenderFrame&&this._triggerRenderFrame()),(Q||q.isActive())&&(_[V]=q)}}var st={};for(var X in this._previousActiveHandlers)_[X]||(st[X]=o);this._previousActiveHandlers=_,(Object.keys(st).length||ye(l))&&(this._changes.push([l,d,st]),this._triggerRenderFrame()),(Object.keys(_).length||ye(l))&&this._map._stop(!0),this._updatingCamera=!1;var at=l.cameraAnimation;at&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],at(this._map))}else this.stop(!0)},fe.prototype.mergeHandlerResult=function(n,a,o,l,d){if(o){c.extend(n,o);var _={handlerName:l,originalEvent:o.originalEvent||d};void 0!==o.zoomDelta&&(a.zoom=_),void 0!==o.panDelta&&(a.drag=_),void 0!==o.pitchDelta&&(a.pitch=_),void 0!==o.bearingDelta&&(a.rotate=_)}},fe.prototype._applyChanges=function(){for(var n={},a={},o={},l=0,d=this._changes;l<d.length;l+=1){var _=d[l],g=_[0],w=_[1],P=_[2];g.panDelta&&(n.panDelta=(n.panDelta||new c.Point(0,0))._add(g.panDelta)),g.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+g.pitchDelta),void 0!==g.around&&(n.around=g.around),void 0!==g.pinchAround&&(n.pinchAround=g.pinchAround),g.noInertia&&(n.noInertia=g.noInertia),c.extend(a,w),c.extend(o,P)}this._updateMapTransform(n,a,o),this._changes=[]},fe.prototype._updateMapTransform=function(n,a,o){var l=this._map,d=l.transform;if(!ye(n))return this._fireEvents(a,o,!0);var _=n.panDelta,g=n.zoomDelta,w=n.bearingDelta,P=n.pitchDelta,M=n.around,j=n.pinchAround;void 0!==j&&(M=j),l._stop(!0),M=M||l.transform.centerPoint;var V=d.pointLocation(_?M.sub(_):M);w&&(d.bearing+=w),P&&(d.pitch+=P),g&&(d.zoom+=g),d.setLocationAtPoint(V,M),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,o,!0)},fe.prototype._fireEvents=function(n,a,o){var l=this,d=Or(this._eventsInProgress),_=Or(n),g={};for(var w in n)this._eventsInProgress[w]||(g[w+"start"]=n[w].originalEvent),this._eventsInProgress[w]=n[w];for(var P in!d&&_&&this._fireEvent("movestart",_.originalEvent),g)this._fireEvent(P,g[P]);for(var M in _&&this._fireEvent("move",_.originalEvent),n)this._fireEvent(M,n[M].originalEvent);var j,V={};for(var q in this._eventsInProgress){var tt=this._eventsInProgress[q],Q=tt.handlerName,st=tt.originalEvent;this._handlersById[Q].isActive()||(delete this._eventsInProgress[q],V[q+"end"]=j=a[Q]||st)}for(var X in V)this._fireEvent(X,V[X]);var at=Or(this._eventsInProgress);if(o&&(d||_)&&!at){this._updatingCamera=!0;var ht=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_t=function(Et){return 0!==Et&&-l._bearingSnap<Et&&Et<l._bearingSnap};ht?(_t(ht.bearing||this._map.getBearing())&&(ht.bearing=0),this._map.easeTo(ht,{originalEvent:j})):(this._map.fire(new c.Event("moveend",{originalEvent:j})),_t(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},fe.prototype._fireEvent=function(n,a){this._map.fire(new c.Event(n,a?{originalEvent:a}:{}))},fe.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete n._frameId,n.handleEvent(new cs("renderFrame",{timeStamp:a})),n._applyChanges()})},fe.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var yl=function(n){function a(o,l){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=l.bearingSnap,c.bindAll(["_renderFrameCallback"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getCenter=function(){return new c.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(o,l){return this.jumpTo({center:o},l)},a.prototype.panBy=function(o,l,d){return o=c.Point.convert(o).mult(-1),this.panTo(this.transform.center,c.extend({offset:o},l),d)},a.prototype.panTo=function(o,l,d){return this.easeTo(c.extend({center:o},l),d)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(o,l){return this.jumpTo({zoom:o},l),this},a.prototype.zoomTo=function(o,l,d){return this.easeTo(c.extend({zoom:o},l),d)},a.prototype.zoomIn=function(o,l){return this.zoomTo(this.getZoom()+1,o,l),this},a.prototype.zoomOut=function(o,l){return this.zoomTo(this.getZoom()-1,o,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(o,l){return this.jumpTo({bearing:o},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(o,l){return this.jumpTo({padding:o},l),this},a.prototype.rotateTo=function(o,l,d){return this.easeTo(c.extend({bearing:o},l),d)},a.prototype.resetNorth=function(o,l){return this.rotateTo(0,c.extend({duration:1e3},o),l),this},a.prototype.resetNorthPitch=function(o,l){return this.easeTo(c.extend({bearing:0,pitch:0,duration:1e3},o),l),this},a.prototype.snapToNorth=function(o,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(o,l){return this.jumpTo({pitch:o},l),this},a.prototype.cameraForBounds=function(o,l){o=c.LngLatBounds.convert(o);var d=l&&l.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),d,l)},a.prototype._cameraForBoxAndBearing=function(o,l,d,_){var g={top:0,bottom:0,right:0,left:0};if("number"==typeof(_=c.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding){var w=_.padding;_.padding={top:w,bottom:w,right:w,left:w}}_.padding=c.extend(g,_.padding);var P=this.transform,M=P.padding,j=P.project(c.LngLat.convert(o)),V=P.project(c.LngLat.convert(l)),q=j.rotate(-d*Math.PI/180),tt=V.rotate(-d*Math.PI/180),Q=new c.Point(Math.max(q.x,tt.x),Math.max(q.y,tt.y)),st=new c.Point(Math.min(q.x,tt.x),Math.min(q.y,tt.y)),X=Q.sub(st),at=(P.width-(M.left+M.right+_.padding.left+_.padding.right))/X.x,ht=(P.height-(M.top+M.bottom+_.padding.top+_.padding.bottom))/X.y;if(!(ht<0||at<0)){var _t=Math.min(P.scaleZoom(P.scale*Math.min(at,ht)),_.maxZoom),Et="number"==typeof _.offset.x?new c.Point(_.offset.x,_.offset.y):c.Point.convert(_.offset),wt=new c.Point((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(d*Math.PI/180),It=Et.add(wt).mult(P.scale/P.zoomScale(_t));return{center:P.unproject(j.add(V).div(2).sub(It)),zoom:_t,bearing:d}}c.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(o,l,d){return this._fitInternal(this.cameraForBounds(o,l),l,d)},a.prototype.fitScreenCoordinates=function(o,l,d,_,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.Point.convert(o)),this.transform.pointLocation(c.Point.convert(l)),d,_),_,g)},a.prototype._fitInternal=function(o,l,d){return o?(delete(l=c.extend(o,l)).padding,l.linear?this.easeTo(l,d):this.flyTo(l,d)):this},a.prototype.jumpTo=function(o,l){this.stop();var d=this.transform,_=!1,g=!1,w=!1;return"zoom"in o&&d.zoom!==+o.zoom&&(_=!0,d.zoom=+o.zoom),void 0!==o.center&&(d.center=c.LngLat.convert(o.center)),"bearing"in o&&d.bearing!==+o.bearing&&(g=!0,d.bearing=+o.bearing),"pitch"in o&&d.pitch!==+o.pitch&&(w=!0,d.pitch=+o.pitch),null==o.padding||d.isPaddingEqual(o.padding)||(d.padding=o.padding),this.fire(new c.Event("movestart",l)).fire(new c.Event("move",l)),_&&this.fire(new c.Event("zoomstart",l)).fire(new c.Event("zoom",l)).fire(new c.Event("zoomend",l)),g&&this.fire(new c.Event("rotatestart",l)).fire(new c.Event("rotate",l)).fire(new c.Event("rotateend",l)),w&&this.fire(new c.Event("pitchstart",l)).fire(new c.Event("pitch",l)).fire(new c.Event("pitchend",l)),this.fire(new c.Event("moveend",l))},a.prototype.easeTo=function(o,l){var d=this;this._stop(!1,o.easeId),(!1===(o=c.extend({offset:[0,0],duration:500,easing:c.ease},o)).animate||!o.essential&&c.browser.prefersReducedMotion)&&(o.duration=0);var _=this.transform,g=this.getZoom(),w=this.getBearing(),P=this.getPitch(),M=this.getPadding(),j="zoom"in o?+o.zoom:g,V="bearing"in o?this._normalizeBearing(o.bearing,w):w,q="pitch"in o?+o.pitch:P,tt="padding"in o?o.padding:_.padding,Q=c.Point.convert(o.offset),st=_.centerPoint.add(Q),X=_.pointLocation(st),at=c.LngLat.convert(o.center||X);this._normalizeCenter(at);var ht,_t,Et=_.project(X),wt=_.project(at).sub(Et),It=_.zoomScale(j-g);o.around&&(ht=c.LngLat.convert(o.around),_t=_.locationPoint(ht));var Rt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||j!==g,this._rotating=this._rotating||w!==V,this._pitching=this._pitching||q!==P,this._padding=!_.isPaddingEqual(tt),this._easeId=o.easeId,this._prepareEase(l,o.noMoveStart,Rt),this._ease(function(Yt){if(d._zooming&&(_.zoom=c.number(g,j,Yt)),d._rotating&&(_.bearing=c.number(w,V,Yt)),d._pitching&&(_.pitch=c.number(P,q,Yt)),d._padding&&(_.interpolatePadding(M,tt,Yt),st=_.centerPoint.add(Q)),ht)_.setLocationAtPoint(ht,_t);else{var Xt=_.zoomScale(_.zoom-g),ue=j>g?Math.min(2,It):Math.max(.5,It),ve=Math.pow(ue,1-Yt),Se=_.unproject(Et.add(wt.mult(Yt*ve)).mult(Xt));_.setLocationAtPoint(_.renderWorldCopies?Se.wrap():Se,st)}d._fireMoveEvents(l)},function(Yt){d._afterEase(l,Yt)},o),this},a.prototype._prepareEase=function(o,l,d){void 0===d&&(d={}),this._moving=!0,l||d.moving||this.fire(new c.Event("movestart",o)),this._zooming&&!d.zooming&&this.fire(new c.Event("zoomstart",o)),this._rotating&&!d.rotating&&this.fire(new c.Event("rotatestart",o)),this._pitching&&!d.pitching&&this.fire(new c.Event("pitchstart",o))},a.prototype._fireMoveEvents=function(o){this.fire(new c.Event("move",o)),this._zooming&&this.fire(new c.Event("zoom",o)),this._rotating&&this.fire(new c.Event("rotate",o)),this._pitching&&this.fire(new c.Event("pitch",o))},a.prototype._afterEase=function(o,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var d=this._zooming,_=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new c.Event("zoomend",o)),_&&this.fire(new c.Event("rotateend",o)),g&&this.fire(new c.Event("pitchend",o)),this.fire(new c.Event("moveend",o))}},a.prototype.flyTo=function(o,l){var d=this;if(!o.essential&&c.browser.prefersReducedMotion){var _=c.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_,l)}this.stop(),o=c.extend({offset:[0,0],speed:1.2,curve:1.42,easing:c.ease},o);var g=this.transform,w=this.getZoom(),P=this.getBearing(),M=this.getPitch(),j=this.getPadding(),V="zoom"in o?c.clamp(+o.zoom,g.minZoom,g.maxZoom):w,q="bearing"in o?this._normalizeBearing(o.bearing,P):P,tt="pitch"in o?+o.pitch:M,Q="padding"in o?o.padding:g.padding,st=g.zoomScale(V-w),X=c.Point.convert(o.offset),at=g.centerPoint.add(X),ht=g.pointLocation(at),_t=c.LngLat.convert(o.center||ht);this._normalizeCenter(_t);var Et=g.project(ht),wt=g.project(_t).sub(Et),It=o.curve,Rt=Math.max(g.width,g.height),Yt=Rt/st,Xt=wt.mag();if("minZoom"in o){var ue=c.clamp(Math.min(o.minZoom,w,V),g.minZoom,g.maxZoom),ve=Rt/g.zoomScale(ue-w);It=Math.sqrt(ve/Xt*2)}var Se=It*It;function we(ze){var Ce=(Yt*Yt-Rt*Rt+(ze?-1:1)*Se*Se*Xt*Xt)/(2*(ze?Yt:Rt)*Se*Xt);return Math.log(Math.sqrt(Ce*Ce+1)-Ce)}function Ei(ze){return(Math.exp(ze)-Math.exp(-ze))/2}function pe(ze){return(Math.exp(ze)+Math.exp(-ze))/2}var Re=we(0),Je=function(ze){return pe(Re)/pe(Re+It*ze)},Be=function(ze){return Rt*((pe(Re)*(Ei(Ce=Re+It*ze)/pe(Ce))-Ei(Re))/Se)/Xt;var Ce},ke=(we(1)-Re)/It;if(Math.abs(Xt)<1e-6||!isFinite(ke)){if(Math.abs(Rt-Yt)<1e-6)return this.easeTo(o,l);var Xe=Yt<Rt?-1:1;ke=Math.abs(Math.log(Yt/Rt))/It,Be=function(){return 0},Je=function(ze){return Math.exp(Xe*It*ze)}}return o.duration="duration"in o?+o.duration:1e3*ke/("screenSpeed"in o?+o.screenSpeed/It:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=P!==q,this._pitching=tt!==M,this._padding=!g.isPaddingEqual(Q),this._prepareEase(l,!1),this._ease(function(ze){var Ce=ze*ke,Er=1/Je(Ce);g.zoom=1===ze?V:w+g.scaleZoom(Er),d._rotating&&(g.bearing=c.number(P,q,ze)),d._pitching&&(g.pitch=c.number(M,tt,ze)),d._padding&&(g.interpolatePadding(j,Q,ze),at=g.centerPoint.add(X));var Fn=1===ze?_t:g.unproject(Et.add(wt.mult(Be(Ce))).mult(Er));g.setLocationAtPoint(g.renderWorldCopies?Fn.wrap():Fn,at),d._fireMoveEvents(l)},function(){return d._afterEase(l)},o),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(o,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,l)}if(!o){var _=this.handlers;_&&_.stop(!1)}return this},a.prototype._ease=function(o,l,d){!1===d.animate||0===d.duration?(o(1),l()):(this._easeStart=c.browser.now(),this._easeOptions=d,this._onEaseFrame=o,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var o=Math.min((c.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(o,l){o=c.wrap(o,-180,180);var d=Math.abs(o-l);return Math.abs(o-360-l)<d&&(o-=360),Math.abs(o+360-l)<d&&(o+=360),o},a.prototype._normalizeCenter=function(o){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var d=o.lng-l.center.lng;o.lng+=d>180?-360:d<-180?360:0}},a}(c.Evented),vo=function(n){void 0===n&&(n={}),this.options=n,c.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};vo.prototype.getDefaultPosition=function(){return"bottom-right"},vo.prototype.onAdd=function(n){var a=this.options&&this.options.compact;return this._map=n,this._container=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Mt.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Mt.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===a&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},vo.prototype.onRemove=function(){Mt.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},vo.prototype._setElementTitle=function(n,a){var o=this._map._getUIString("AttributionControl."+a);n.title=o,n.setAttribute("aria-label",o)},vo.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},vo.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||c.config.ACCESS_TOKEN}];if(n){var o=a.reduce(function(l,d,_){return d.value&&(l+=d.key+"="+d.value+(_<a.length-1?"&":"")),l},"?");n.href=c.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},vo.prototype._updateData=function(n){!n||"metadata"!==n.sourceDataType&&"visibility"!==n.sourceDataType&&"style"!==n.dataType||(this._updateAttributions(),this._updateEditLink())},vo.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(w){return"string"!=typeof w?"":w})):"string"==typeof this.options.customAttribution&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var o=this._map.style.sourceCaches;for(var l in o){var d=o[l];if(d.used){var _=d.getSource();_.attribution&&n.indexOf(_.attribution)<0&&n.push(_.attribution)}}n.sort(function(w,P){return w.length-P.length});var g=(n=n.filter(function(w,P){for(var M=P+1;M<n.length;M++)if(n[M].indexOf(w)>=0)return!1;return!0})).join(" | ");g!==this._attribHTML&&(this._attribHTML=g,n.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},vo.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Ia=function(){c.bindAll(["_updateLogo"],this),c.bindAll(["_updateCompact"],this)};Ia.prototype.onAdd=function(n){this._map=n,this._container=Mt.create("div","mapboxgl-ctrl");var a=Mt.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ia.prototype.onRemove=function(){Mt.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ia.prototype.getDefaultPosition=function(){return"bottom-left"},Ia.prototype._updateLogo=function(n){n&&"metadata"!==n.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Ia.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var a in n)if(n[a].getSource().mapbox_logo)return!0;return!1}},Ia.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var a=n[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var Kr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Kr.prototype.add=function(n){var a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a},Kr.prototype.remove=function(n){for(var a=this._currentlyRunning,o=0,l=a?this._queue.concat(a):this._queue;o<l.length;o+=1){var d=l[o];if(d.id===n)return void(d.cancelled=!0)}},Kr.prototype.run=function(n){void 0===n&&(n=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,l=a;o<l.length;o+=1){var d=l[o];if(!d.cancelled&&(d.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Kr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ba={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Jl=c.window.HTMLImageElement,gl=c.window.HTMLElement,Vi=c.window.ImageBitmap,Rr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Pu=function(n){function a(l){var d=this;if(null!=(l=c.extend({},Rr,l)).minZoom&&null!=l.maxZoom&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=l.minPitch&&null!=l.maxPitch&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=l.minPitch&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=l.maxPitch&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var _=new Ct(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(n.call(this,_,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new Kr,this._controls=[],this._mapId=c.uniqueId(),this._locale=c.extend({},Ba,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new c.RequestManager(l.transformRequest,l.accessToken),"string"==typeof l.container){if(this._container=c.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof gl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),c.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return d._update(!1)}),this.on("moveend",function(){return d._update(!1)}),this.on("zoom",function(){return d._update(!0)}),void 0!==c.window&&(c.window.addEventListener("online",this._onWindowOnline,!1),c.window.addEventListener("resize",this._onWindowResize,!1),c.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new fe(this,l),this._hash=l.hash&&new ce("string"==typeof l.hash&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new vo({customAttribution:l.customAttribution})),this.addControl(new Ia,l.logoPosition),this.on("style.load",function(){d.transform.unmodified&&d.jumpTo(d.style.stylesheet)}),this.on("data",function(g){d._update("style"===g.dataType),d.fire(new c.Event(g.dataType+"data",g))}),this.on("dataloading",function(g){d.fire(new c.Event(g.dataType+"dataloading",g))})}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,d){if(void 0===d&&(d=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var _=l.onAdd(this);this._controls.push(l);var g=this._controlPositions[d];return-1!==d.indexOf("bottom")?g.insertBefore(_,g.firstChild):g.appendChild(_),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var d=this._controls.indexOf(l);return d>-1&&this._controls.splice(d,1),l.onRemove(this),this},a.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},a.prototype.resize=function(l){var d=this._containerDimensions(),_=d[0],g=d[1];this._resizeCanvas(_,g),this.transform.resize(_,g),this.painter.resize(_,g);var w=!this._moving;return w&&(this.stop(),this.fire(new c.Event("movestart",l)).fire(new c.Event("move",l))),this.fire(new c.Event("resize",l)),w&&this.fire(new c.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(c.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l??-2)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l??22)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(c.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(c.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,d,_){var g,w=this;if("mouseenter"===l||"mouseover"===l){var P=!1;return{layer:d,listener:_,delegates:{mousemove:function(j){var V=w.getLayer(d)?w.queryRenderedFeatures(j.point,{layers:[d]}):[];V.length?P||(P=!0,_.call(w,new Ie(l,w,j.originalEvent,{features:V}))):P=!1},mouseout:function(){P=!1}}}}if("mouseleave"===l||"mouseout"===l){var M=!1;return{layer:d,listener:_,delegates:{mousemove:function(j){(w.getLayer(d)?w.queryRenderedFeatures(j.point,{layers:[d]}):[]).length?M=!0:M&&(M=!1,_.call(w,new Ie(l,w,j.originalEvent)))},mouseout:function(j){M&&(M=!1,_.call(w,new Ie(l,w,j.originalEvent)))}}}}return{layer:d,listener:_,delegates:(g={},g[l]=function(j){var V=w.getLayer(d)?w.queryRenderedFeatures(j.point,{layers:[d]}):[];V.length&&(j.features=V,_.call(w,j),delete j.features)},g)}},a.prototype.on=function(l,d,_){if(void 0===_)return n.prototype.on.call(this,l,d);var g=this._createDelegatedListener(l,d,_);for(var w in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(g),g.delegates)this.on(w,g.delegates[w]);return this},a.prototype.once=function(l,d,_){if(void 0===_)return n.prototype.once.call(this,l,d);var g=this._createDelegatedListener(l,d,_);for(var w in g.delegates)this.once(w,g.delegates[w]);return this},a.prototype.off=function(l,d,_){var g=this;return void 0===_?n.prototype.off.call(this,l,d):(this._delegatedListeners&&this._delegatedListeners[l]&&function(w){for(var P=w[l],M=0;M<P.length;M++){var j=P[M];if(j.layer===d&&j.listener===_){for(var V in j.delegates)g.off(V,j.delegates[V]);return P.splice(M,1),g}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,d){if(!this.style)return[];var _;if(void 0!==d||void 0===l||l instanceof c.Point||Array.isArray(l)||(d=l,l=void 0),d=d||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof c.Point||"number"==typeof l[0])_=[c.Point.convert(l)];else{var g=c.Point.convert(l[0]),w=c.Point.convert(l[1]);_=[g,new c.Point(w.x,g.y),w,new c.Point(g.x,w.y),g]}return this.style.queryRenderedFeatures(_,d,this.transform)},a.prototype.querySourceFeatures=function(l,d){return this.style.querySourceFeatures(l,d)},a.prototype.setStyle=function(l,d){return!1!==(d=c.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},d)).diff&&d.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._updateStyle(l,d))},a.prototype._getUIString=function(l){var d=this._locale[l];if(null==d)throw new Error("Missing UI string '"+l+"'");return d},a.prototype._updateStyle=function(l,d){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new In(this,d||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof l?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new In(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,d){var _=this;if("string"==typeof l){var g=this._requestManager.normalizeStyleURL(l),w=this._requestManager.transformRequest(g,c.ResourceType.Style);c.getJSON(w,function(P,M){P?_.fire(new c.ErrorEvent(P)):M&&_._updateDiff(M,d)})}else"object"==typeof l&&this._updateDiff(l,d)},a.prototype._updateDiff=function(l,d){try{this.style.setState(l)&&this._update(!0)}catch(_){c.warnOnce("Unable to perform style diff: "+(_.message||_.error||_)+".  Rebuilding the style from scratch."),this._updateStyle(l,d)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():c.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,d){return this._lazyInitEmptyStyle(),this.style.addSource(l,d),this._update(!0)},a.prototype.isSourceLoaded=function(l){var d=this.style&&this.style.sourceCaches[l];if(void 0!==d)return d.loaded();this.fire(new c.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var d in l){var _=l[d]._tiles;for(var g in _){var w=_[g];if("loaded"!==w.state&&"errored"!==w.state)return!1}}return!0},a.prototype.addSourceType=function(l,d,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,d,_)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,d,_){void 0===_&&(_={});var g=_.pixelRatio;void 0===g&&(g=1);var w=_.sdf;void 0===w&&(w=!1);var P=_.stretchX,M=_.stretchY,j=_.content;if(this._lazyInitEmptyStyle(),d instanceof Jl||Vi&&d instanceof Vi){var V=c.browser.getImageData(d);this.style.addImage(l,{data:new c.RGBAImage({width:V.width,height:V.height},V.data),pixelRatio:g,stretchX:P,stretchY:M,content:j,sdf:w,version:0})}else{if(void 0===d.width||void 0===d.height)return this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var q=d;this.style.addImage(l,{data:new c.RGBAImage({width:d.width,height:d.height},new Uint8Array(d.data)),pixelRatio:g,stretchX:P,stretchY:M,content:j,sdf:w,version:0,userImage:q}),q.onAdd&&q.onAdd(this,l)}},a.prototype.updateImage=function(l,d){var _=this.style.getImage(l);if(!_)return this.fire(new c.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var g=d instanceof Jl||Vi&&d instanceof Vi?c.browser.getImageData(d):d,w=g.width,P=g.height,M=g.data;return void 0===w||void 0===P?this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):w!==_.data.width||P!==_.data.height?this.fire(new c.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(_.data.replace(M,!(d instanceof Jl||Vi&&d instanceof Vi)),void this.style.updateImage(l,_))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new c.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,d){c.getImage(this._requestManager.transformRequest(l,c.ResourceType.Image),d)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,d){return this._lazyInitEmptyStyle(),this.style.addLayer(l,d),this._update(!0)},a.prototype.moveLayer=function(l,d){return this.style.moveLayer(l,d),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,d,_){return this.style.setLayerZoomRange(l,d,_),this._update(!0)},a.prototype.setFilter=function(l,d,_){return void 0===_&&(_={}),this.style.setFilter(l,d,_),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,d,_,g){return void 0===g&&(g={}),this.style.setPaintProperty(l,d,_,g),this._update(!0)},a.prototype.getPaintProperty=function(l,d){return this.style.getPaintProperty(l,d)},a.prototype.setLayoutProperty=function(l,d,_,g){return void 0===g&&(g={}),this.style.setLayoutProperty(l,d,_,g),this._update(!0)},a.prototype.getLayoutProperty=function(l,d){return this.style.getLayoutProperty(l,d)},a.prototype.setLight=function(l,d){return void 0===d&&(d={}),this._lazyInitEmptyStyle(),this.style.setLight(l,d),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,d){return this.style.setFeatureState(l,d),this._update()},a.prototype.removeFeatureState=function(l,d){return this.style.removeFeatureState(l,d),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,d=0;return this._container&&(l=this._container.clientWidth||400,d=this._container.clientHeight||300),[l,d]},a.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==c.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&c.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=Mt.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var d=this._canvasContainer=Mt.create("div","mapboxgl-canvas-container",l);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=Mt.create("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var _=this._containerDimensions();this._resizeCanvas(_[0],_[1]);var g=this._controlContainer=Mt.create("div","mapboxgl-control-container",l),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(P){w[P]=Mt.create("div","mapboxgl-ctrl-"+P,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(l,d){var _=c.browser.devicePixelRatio||1;this._canvas.width=_*l,this._canvas.height=_*d,this._canvas.style.width=l+"px",this._canvas.style.height=d+"px"},a.prototype._setupPainter=function(){var l=c.extend({},mi.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);d?(this.painter=new Y(d,this.transform),c.webpSupported.testSupport(d)):this.fire(new c.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new c.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new c.Event("webglcontextrestored",{originalEvent:l}))},a.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var d,_=this,g=0,w=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(d=w.createQueryEXT(),w.beginQueryEXT(w.TIME_ELAPSED_EXT,d),g=c.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var M=this.transform.zoom,j=c.browser.now();this.style.zoomHistory.update(M,j);var V=new c.EvaluationParameters(M,{now:j,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),q=V.crossFadingFactor();1===q&&q===this._crossFadingFactor||(P=!0,this._crossFadingFactor=q),this.style.update(V)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new c.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new c.Event("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var tt=c.browser.now()-g;w.endQueryEXT(w.TIME_ELAPSED_EXT,d),setTimeout(function(){var X=w.getQueryObjectEXT(d,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(d),_.fire(new c.Event("gpu-timing-frame",{cpuTime:tt,gpuTime:X}))},50)}if(this.listens("gpu-timing-layer")){var Q=this.painter.collectGpuTimers();setTimeout(function(){var X=_.painter.queryGpuTimers(Q);_.fire(new c.Event("gpu-timing-layer",{layerTimes:X}))},50)}var st=this._sourcesDirty||this._styleDirty||this._placementDirty;return st||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.Event("idle")),!this._loaded||this._fullyLoaded||st||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,d=this._controls;l<d.length;l+=1)d[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==c.window&&(c.window.removeEventListener("resize",this._onWindowResize,!1),c.window.removeEventListener("orientationchange",this._onWindowResize,!1),c.window.removeEventListener("online",this._onWindowOnline,!1));var _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),ks(this._canvasContainer),ks(this._controlContainer),ks(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new c.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=c.browser.frame(function(d){l._frame=null,l._render(d)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,d){c.setCacheLimits(l,d)},o.version.get=function(){return c.version},Object.defineProperties(a.prototype,o),a}(yl);function ks(n){n.parentNode&&n.parentNode.removeChild(n)}var Yl={showCompass:!0,showZoom:!0,visualizePitch:!1},Ya=function(n){var a=this;this.options=c.extend({},Yl,n),this._container=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(c.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return a._map.zoomIn({},{originalEvent:o})}),Mt.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return a._map.zoomOut({},{originalEvent:o})}),Mt.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(c.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){a.options.visualizePitch?a._map.resetNorthPitch({},{originalEvent:o}):a._map.resetNorth({},{originalEvent:o})}),this._compassIcon=Mt.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ya.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),a=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Ya.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Ya.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vo(this._map,this._compass,this.options.visualizePitch)),this._container},Ya.prototype.onRemove=function(){Mt.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ya.prototype._createButton=function(n,a){var o=Mt.create("button",n,this._container);return o.type="button",o.addEventListener("click",a),o},Ya.prototype._setButtonTitle=function(n,a){var o=this._map._getUIString("NavigationControl."+a);n.title=o,n.setAttribute("aria-label",o)};var Vo=function(n,a,o){void 0===o&&(o=!1),this._clickTolerance=10,this.element=a,this.mouseRotate=new Fo({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new Tr({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),c.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Mt.addEventListener(a,"mousedown",this.mousedown),Mt.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),Mt.addEventListener(a,"touchmove",this.touchmove),Mt.addEventListener(a,"touchend",this.touchend),Mt.addEventListener(a,"touchcancel",this.reset)};function Gs(n,a,o){if(n=new c.LngLat(n.lng,n.lat),a){var l=new c.LngLat(n.lng-360,n.lat),d=new c.LngLat(n.lng+360,n.lat),_=o.locationPoint(n).distSqr(a);o.locationPoint(l).distSqr(a)<_?n=l:o.locationPoint(d).distSqr(a)<_&&(n=d)}for(;Math.abs(n.lng-o.center.lng)>180;){var g=o.locationPoint(n);if(g.x>=0&&g.y>=0&&g.x<=o.width&&g.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Vo.prototype.down=function(n,a){this.mouseRotate.mousedown(n,a),this.mousePitch&&this.mousePitch.mousedown(n,a),Mt.disableDrag()},Vo.prototype.move=function(n,a){var o=this.map,l=this.mouseRotate.mousemoveWindow(n,a);if(l&&l.bearingDelta&&o.setBearing(o.getBearing()+l.bearingDelta),this.mousePitch){var d=this.mousePitch.mousemoveWindow(n,a);d&&d.pitchDelta&&o.setPitch(o.getPitch()+d.pitchDelta)}},Vo.prototype.off=function(){var n=this.element;Mt.removeEventListener(n,"mousedown",this.mousedown),Mt.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),Mt.removeEventListener(n,"touchmove",this.touchmove),Mt.removeEventListener(n,"touchend",this.touchend),Mt.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Vo.prototype.offTemp=function(){Mt.enableDrag(),Mt.removeEventListener(c.window,"mousemove",this.mousemove),Mt.removeEventListener(c.window,"mouseup",this.mouseup)},Vo.prototype.mousedown=function(n){this.down(c.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),Mt.mousePos(this.element,n)),Mt.addEventListener(c.window,"mousemove",this.mousemove),Mt.addEventListener(c.window,"mouseup",this.mouseup)},Vo.prototype.mousemove=function(n){this.move(n,Mt.mousePos(this.element,n))},Vo.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Vo.prototype.touchstart=function(n){1!==n.targetTouches.length?this.reset():(this._startPos=this._lastPos=Mt.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Vo.prototype.touchmove=function(n){1!==n.targetTouches.length?this.reset():(this._lastPos=Mt.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Vo.prototype.touchend=function(n){0===n.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Vo.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Oa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function vl(n,a,o){var l=n.classList;for(var d in Oa)l.remove("mapboxgl-"+o+"-anchor-"+d);l.add("mapboxgl-"+o+"-anchor-"+a)}var Ws,rl=function(n){function a(o,l){if(n.call(this),(o instanceof c.window.HTMLElement||l)&&(o=c.extend({element:o},l)),c.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=c.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=Mt.create("div"),this._element.setAttribute("aria-label","Map marker");var d=Mt.createNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height","41px"),d.setAttributeNS(null,"width","27px"),d.setAttributeNS(null,"viewBox","0 0 27 41");var _=Mt.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");var g=Mt.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"fill-rule","nonzero");var w=Mt.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");for(var P=0,M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];P<M.length;P+=1){var j=M[P],V=Mt.createNS("http://www.w3.org/2000/svg","ellipse");V.setAttributeNS(null,"opacity","0.04"),V.setAttributeNS(null,"cx","10.5"),V.setAttributeNS(null,"cy","5.80029008"),V.setAttributeNS(null,"rx",j.rx),V.setAttributeNS(null,"ry",j.ry),w.appendChild(V)}var q=Mt.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"fill",this._color);var tt=Mt.createNS("http://www.w3.org/2000/svg","path");tt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),q.appendChild(tt);var Q=Mt.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"fill","#000000");var st=Mt.createNS("http://www.w3.org/2000/svg","path");st.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Q.appendChild(st);var X=Mt.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");var at=Mt.createNS("http://www.w3.org/2000/svg","g");at.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ht=Mt.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#000000"),ht.setAttributeNS(null,"opacity","0.25"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962");var _t=Mt.createNS("http://www.w3.org/2000/svg","circle");_t.setAttributeNS(null,"fill","#FFFFFF"),_t.setAttributeNS(null,"cx","5.5"),_t.setAttributeNS(null,"cy","5.5"),_t.setAttributeNS(null,"r","5.4999962"),at.appendChild(ht),at.appendChild(_t),g.appendChild(w),g.appendChild(q),g.appendChild(Q),g.appendChild(X),g.appendChild(at),d.appendChild(g),d.setAttributeNS(null,"height",41*this._scale+"px"),d.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(d),this._offset=c.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Et){Et.preventDefault()}),this._element.addEventListener("mousedown",function(Et){Et.preventDefault()}),vl(this._element,this._anchor,"marker"),this._popup=null}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Mt.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=c.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(o){var l=o.code,d=o.charCode||o.keyCode;"Space"!==l&&"Enter"!==l&&32!==d&&13!==d||this.togglePopup()},a.prototype._onMapClick=function(o){var l=o.originalEvent.target,d=this._element;this._popup&&(l===d||d.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},a.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Gs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?l="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var d="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?d="rotateX(0deg)":"map"===this._pitchAlignment&&(d="rotateX("+this._map.getPitch()+"deg)"),o&&"moveend"!==o.type||(this._pos=this._pos.round()),Mt.setTransform(this._element,Oa[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+d+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(o){return this._offset=c.Point.convert(o),this._update(),this},a.prototype._onMove=function(o){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new c.Event("dragstart"))),this.fire(new c.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new c.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(c.Evented),$l={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Hs=0,Ms=!1,Ql=function(n){function a(o){n.call(this),this.options=c.extend({},$l,o),c.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){var l;return this._map=o,this._container=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,void 0!==Ws?l(Ws):void 0!==c.window.navigator.permissions?c.window.navigator.permissions.query({name:"geolocation"}).then(function(d){l(Ws="denied"!==d.state)}):l(Ws=!!c.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(c.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Mt.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Hs=0,Ms=!1},a.prototype._isOutOfMapMaxBounds=function(o){var l=this._map.getMaxBounds(),d=o.coords;return l&&(d.longitude<l.getWest()||d.longitude>l.getEast()||d.latitude<l.getSouth()||d.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new c.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("geolocate",o)),this._finish()}},a.prototype._updateCamera=function(o){var l=new c.LngLat(o.coords.longitude,o.coords.latitude),d=o.coords.accuracy,_=this._map.getBearing(),g=c.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(d),g,{geolocateSource:!0})},a.prototype._updateMarker=function(o){if(o){var l=new c.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,l=this._map.unproject([0,o]),d=this._map.unproject([1,o]),_=l.distanceTo(d),g=Math.ceil(2*this._accuracy/_);this._circleElement.style.width=g+"px",this._circleElement.style.height=g+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&Ms)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("error",o)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(o){var l=this;if(this._container.addEventListener("contextmenu",function(g){return g.preventDefault()}),this._geolocateButton=Mt.create("button","mapboxgl-ctrl-geolocate",this._container),Mt.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===o){c.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{var _=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Mt.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new rl(this._dotElement),this._circleElement=Mt.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new rl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(g){g.geolocateSource||"ACTIVE_LOCK"!==l._watchState||g.originalEvent&&"resize"===g.originalEvent.type||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new c.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return c.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Hs--,Ms=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new c.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Hs>1?(o={maximumAge:6e5,timeout:0},Ms=!0):(o=this.options.positionOptions,Ms=!1),this._geolocationWatchID=c.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else c.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){c.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(c.Evented),ps={maxWidth:100,unit:"metric"},ds=function(n){this.options=c.extend({},ps,n),c.bindAll(["_onMove","setUnit"],this)};function xl(n,a,o){var l=o&&o.maxWidth||100,d=n._container.clientHeight/2,_=n.unproject([0,d]),g=n.unproject([l,d]),w=_.distanceTo(g);if(o&&"imperial"===o.unit){var P=3.2808*w;P>5280?fs(a,l,P/5280,n._getUIString("ScaleControl.Miles")):fs(a,l,P,n._getUIString("ScaleControl.Feet"))}else o&&"nautical"===o.unit?fs(a,l,w/1852,n._getUIString("ScaleControl.NauticalMiles")):w>=1e3?fs(a,l,w/1e3,n._getUIString("ScaleControl.Kilometers")):fs(a,l,w,n._getUIString("ScaleControl.Meters"))}function fs(n,a,o,l){var d,_,g,P,M,w=(d=o,(_=Math.pow(10,(""+Math.floor(d)).length-1))*(g=(g=d/_)>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:(P=g,M=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10)),Math.round(P*M)/M)));n.style.width=a*(w/o)+"px",n.innerHTML=w+"&nbsp;"+l}ds.prototype.getDefaultPosition=function(){return"bottom-left"},ds.prototype._onMove=function(){xl(this._map,this._container,this.options)},ds.prototype.onAdd=function(n){return this._map=n,this._container=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ds.prototype.onRemove=function(){Mt.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ds.prototype.setUnit=function(n){this.options.unit=n,xl(this._map,this._container,this.options)};var ya=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof c.window.HTMLElement?this._container=n.container:c.warnOnce("Full screen control 'container' must be a DOM element.")),c.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in c.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in c.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in c.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in c.window.document&&(this._fullscreenchange="MSFullscreenChange")};ya.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",c.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ya.prototype.onRemove=function(){Mt.remove(this._controlContainer),this._map=null,c.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ya.prototype._checkFullscreenSupport=function(){return!!(c.window.document.fullscreenEnabled||c.window.document.mozFullScreenEnabled||c.window.document.msFullscreenEnabled||c.window.document.webkitFullscreenEnabled)},ya.prototype._setupUI=function(){var n=this._fullscreenButton=Mt.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Mt.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),c.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ya.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},ya.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ya.prototype._isFullscreen=function(){return this._fullscreen},ya.prototype._changeIcon=function(){(c.window.document.fullscreenElement||c.window.document.mozFullScreenElement||c.window.document.webkitFullscreenElement||c.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ya.prototype._onClickFullscreen=function(){this._isFullscreen()?c.window.document.exitFullscreen?c.window.document.exitFullscreen():c.window.document.mozCancelFullScreen?c.window.document.mozCancelFullScreen():c.window.document.msExitFullscreen?c.window.document.msExitFullscreen():c.window.document.webkitCancelFullScreen&&c.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var tu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ol=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),eu=function(n){function a(o){n.call(this),this.options=c.extend(Object.create(tu),o),c.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new c.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&Mt.remove(this._content),this._container&&(Mt.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new c.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=c.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(o){return this.setDOMContent(c.window.document.createTextNode(o))},a.prototype.setHTML=function(o){var l,d=c.window.document.createDocumentFragment(),_=c.window.document.createElement("body");for(_.innerHTML=o;l=_.firstChild;)d.appendChild(l);return this.setDOMContent(d)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},a.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Mt.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},a.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},a.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},a.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=Mt.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(o){this._update(o.point)},a.prototype._onMouseMove=function(o){this._update(o.point)},a.prototype._onDrag=function(o){this._update(o.point)},a.prototype._update=function(o){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=Mt.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=Mt.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(V){return l._container.classList.add(V)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Gs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var d=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),_=this.options.anchor,g=function V(q){if(q){if("number"==typeof q){var tt=Math.round(Math.sqrt(.5*Math.pow(q,2)));return{center:new c.Point(0,0),top:new c.Point(0,q),"top-left":new c.Point(tt,tt),"top-right":new c.Point(-tt,tt),bottom:new c.Point(0,-q),"bottom-left":new c.Point(tt,-tt),"bottom-right":new c.Point(-tt,-tt),left:new c.Point(q,0),right:new c.Point(-q,0)}}if(q instanceof c.Point||Array.isArray(q)){var Q=c.Point.convert(q);return{center:Q,top:Q,"top-left":Q,"top-right":Q,bottom:Q,"bottom-left":Q,"bottom-right":Q,left:Q,right:Q}}return{center:c.Point.convert(q.center||[0,0]),top:c.Point.convert(q.top||[0,0]),"top-left":c.Point.convert(q["top-left"]||[0,0]),"top-right":c.Point.convert(q["top-right"]||[0,0]),bottom:c.Point.convert(q.bottom||[0,0]),"bottom-left":c.Point.convert(q["bottom-left"]||[0,0]),"bottom-right":c.Point.convert(q["bottom-right"]||[0,0]),left:c.Point.convert(q.left||[0,0]),right:c.Point.convert(q.right||[0,0])}}return V(new c.Point(0,0))}(this.options.offset);if(!_){var w,P=this._container.offsetWidth,M=this._container.offsetHeight;w=d.y+g.bottom.y<M?["top"]:d.y>this._map.transform.height-M?["bottom"]:[],d.x<P/2?w.push("left"):d.x>this._map.transform.width-P/2&&w.push("right"),_=0===w.length?"bottom":w.join("-")}var j=d.add(g[_]).round();Mt.setTransform(this._container,Oa[_]+" translate("+j.x+"px,"+j.y+"px)"),vl(this._container,_,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(ol);o&&o.focus()}},a.prototype._onClose=function(){this.remove()},a}(c.Evented),bl={version:c.version,supported:mi,setRTLTextPlugin:c.setRTLTextPlugin,getRTLTextPluginStatus:c.getRTLTextPluginStatus,Map:Pu,NavigationControl:Ya,GeolocateControl:Ql,AttributionControl:vo,ScaleControl:ds,FullscreenControl:ya,Popup:eu,Marker:rl,Style:In,LngLat:c.LngLat,LngLatBounds:c.LngLatBounds,Point:c.Point,MercatorCoordinate:c.MercatorCoordinate,Evented:c.Evented,config:c.config,prewarm:function(){St().acquire(bt)},clearPrewarmedResources:function(){var n=jt;n&&(n.isPreloaded()&&1===n.numActive()?(n.release(bt),jt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return c.config.ACCESS_TOKEN},set accessToken(n){c.config.ACCESS_TOKEN=n},get baseApiUrl(){return c.config.API_URL},set baseApiUrl(n){c.config.API_URL=n},get workerCount(){return Bt.workerCount},set workerCount(n){Bt.workerCount=n},get maxParallelImageRequests(){return c.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){c.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){c.clearTileCache(n)},workerUrl:""};return bl}),Di}();var oa=Yr.exports,$r=ft.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,opacity:1},initialize:function(Ft){ft.setOptions(this,Ft),this._throttledUpdate=ft.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(Ft){this._container||this._initContainer(),this.getPane().appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),Ft.options.zoomAnimation&&ft.DomEvent.on(Ft._proxy,ft.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(Ft){this._map._proxy&&this._map.options.zoomAnimation&&ft.DomEvent.off(this._map._proxy,ft.DomUtil.TRANSITION_END,this._transitionEnd,this),this.getPane().removeChild(this._container),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd}},getMapboxMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+2*this.options.padding)},getOpacity:function(){return this.options.opacity},setOpacity:function(Ft){this.options.opacity=Ft,this._container.style.opacity=Ft},getBounds:function(){var Ft=this.getSize().multiplyBy(.5),ee=this._map.latLngToContainerPoint(this._map.getCenter());return ft.latLngBounds(this._map.containerPointToLatLng(ee.subtract(Ft)),this._map.containerPointToLatLng(ee.add(Ft)))},getContainer:function(){return this._container},_initContainer:function(){var Ft=this._container=ft.DomUtil.create("div","leaflet-gl-layer"),ee=this.getSize(),Fe=this._map.getSize().multiplyBy(this.options.padding);Ft.style.width=ee.x+"px",Ft.style.height=ee.y+"px",Ft.style.position="absolute",Ft.style.opacity=this.options.opacity;var Te=this._map.containerPointToLayerPoint([0,0]).subtract(Fe);ft.DomUtil.setPosition(Ft,Te)},_initGL:function(){var Ft=this._map.getCenter(),ee=ft.extend({},this.options,{container:this._container,center:[Ft.lng,Ft.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new oa.Map(ee),this._glMap.once("styledata",function(Te){this.fire("styleLoaded")}.bind(this)),this._glMap.transform.latRange=null,this._transformGL(this._glMap),this._glMap._actualCanvas=this._glMap._canvas.canvas?this._glMap._canvas.canvas:this._glMap._canvas;var Fe=this._glMap._actualCanvas;ft.DomUtil.addClass(Fe,"leaflet-image-layer"),ft.DomUtil.addClass(Fe,"leaflet-zoom-animated"),this.options.interactive&&ft.DomUtil.addClass(Fe,"leaflet-interactive"),this.options.className&&ft.DomUtil.addClass(Fe,this.options.className)},_update:function(Ft){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var ee=this.getSize(),Fe=this._container,Te=this._glMap,Di=this._map.getSize().multiplyBy(this.options.padding),gn=this._map.containerPointToLayerPoint([0,0]).subtract(Di);ft.DomUtil.setPosition(Fe,gn),this._transformGL(Te),Te.transform.width!==ee.x||Te.transform.height!==ee.y?(Fe.style.width=ee.x+"px",Fe.style.height=ee.y+"px",null!=Te._resize?Te._resize():Te.resize()):null!=Te._update?Te._update():Te.update()}},_transformGL:function(Ft){var ee=this._map.getCenter(),Fe=Ft.transform;Fe.center=oa.LngLat.convert([ee.lng,ee.lat]),Fe.zoom=this._map.getZoom()-1},_pinchZoom:function(Ft){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(Ft){var ee=this._map.getZoomScale(Ft.zoom),Fe=this._map.getSize().multiplyBy(this.options.padding*ee),Te=this.getSize()._divideBy(2),Di=this._map.project(Ft.center,Ft.zoom)._subtract(Te)._add(this._map._getMapPanePos().add(Fe))._round(),gn=this._map.project(this._map.getBounds().getNorthWest(),Ft.zoom)._subtract(Di);ft.DomUtil.setTransform(this._glMap._actualCanvas,gn.subtract(this._offset),ee)},_zoomStart:function(Ft){this._zooming=!0},_zoomEnd:function(){var Ft=this._map.getZoomScale(this._map.getZoom());ft.DomUtil.setTransform(this._glMap._actualCanvas,null,Ft),this._zooming=!1,this._update()},_transitionEnd:function(Ft){ft.Util.requestAnimFrame(function(){var ee=this._map.getZoom(),Fe=this._map.getCenter(),Te=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());ft.DomUtil.setTransform(this._glMap._actualCanvas,Te,1),this._glMap.once("moveend",ft.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:Fe,zoom:ee-1})},this)}});function Hi(Ft){return new $r(Ft)}var aa=ft.Layer.extend({options:{key:"ArcGIS:Streets"},initialize:function(Ft,ee){if(ee&&ft.setOptions(this,ee),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.token&&(this.options.apikey=this.options.token),!this.options.apikey&&!this.options.token)throw new Error("API Key or token is required for vectorBasemapLayer.");Ft&&(this.options.key=Ft),this._createLayer()},_createLayer:function(){var ee,Fe,Te=(Fe="https://basemaps-api.arcgis.com/arcgis/rest/services/styles/"+this.options.key+"?type=style",(ee=this.options.apikey)&&(Fe=Fe+"&apiKey="+ee),Fe);this._mapboxGL=Hi({style:Te,pane:this.options.pane,opacity:this.options.opacity}),this._ready=!0,this.fire("ready",{},!0),this._mapboxGL.on("styleLoaded",function(Di){this._setupAttribution()}.bind(this))},_setupAttribution:function(){var Ft=this._map;if(32===this.options.key.length){var ee=this._mapboxGL.getMapboxMap().style.stylesheet.sources,Fe=[];Object.keys(ee).forEach(function(Te){Fe.push(ee[Te].attribution),ee[Te].copyrightText&&ee[Te].copyrightText&&""!==ee[Te].copyrightText&&ee[Te].attribution!==ee[Te].copyrightText&&Fe.push(ee[Te].copyrightText)}),Ft.attributionControl.addAttribution('<span class="">'+Fe.join(", ")+"</span>")}else if(this.options.attributionUrls||(this.options.attributionUrls=this._getAttributionUrls(this.options.key)),this._map&&this.options.attributionUrls){if(Cr.Util.setEsriAttribution(Ft),this._map.attributionControl){for(let Te=0;Te<this.options.attributionUrls.length;Te++)co(this.options.attributionUrls[Te],Ft);Ft.attributionControl.addAttribution('<span class="esri-dynamic-attribution"></span>')}Cr.Util._updateMapAttribution({target:this._map})}},_getAttributionUrls:function(Ft){return 0===Ft.indexOf("OSM:")?["https://static.arcgis.com/attribution/Vector/OpenStreetMap_v2"]:0===Ft.indexOf("ArcGIS:Imagery")?["https://static.arcgis.com/attribution/World_Imagery","https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]:["https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]},onAdd:function(Ft){this._map=Ft,this._initPane(),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},_initPane:function(){if(this.options.pane||(this.options.pane=this.options.key.indexOf(":Labels")>-1?"esri-labels":"tilePane"),!this._map.getPane(this.options.pane)){var Ft=this._map.createPane(this.options.pane);Ft.style.pointerEvents="none",Ft.style.zIndex="esri-labels"===this.options.pane?550:500}},onRemove:function(Ft){if(Ft.off("moveend",Cr.Util._updateMapAttribution),Ft.removeLayer(this._mapboxGL),Ft.attributionControl){var ee=document.getElementsByClassName("esri-dynamic-attribution");ee&&ee.length>0&&Ft.attributionControl.removeAttribution(ee[0].outerHTML)}},_asyncAdd:function(){var Ft=this._map;Ft.on("moveend",Cr.Util._updateMapAttribution),this._mapboxGL.addTo(Ft,this)}}),yn=ft.Layer.extend({options:{pane:"overlayPane",portalUrl:"https://www.arcgis.com"},initialize:function(Ft,ee){if(ee&&ft.setOptions(this,ee),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.apikey&&(this.options.token=this.options.apikey),!Ft)throw new Error("An ITEM ID or SERVICE URL is required for vectorTileLayer.");Ft&&(this.options.key=Ft),this._createLayer()},_createLayer:function(){!function ho(Ft,ee,Fe){var Te,Di,gn,c;/^https?:\/\//.test(Ft)&&/\/VectorTileServer\/?$/.test(Ft)?ai(Ft,ee,Fe):(gn=Fe,Jr(c=(Di=ee).portalUrl+"/sharing/rest/content/items/"+(Te=Ft)+"/resources/styles/root.json",Di,function(mi,Mt){!function Lr(Ft,ee,Fe){Cr.request(ee.portalUrl+"/sharing/rest/content/items/"+Ft,ee.token?{token:ee.token}:{},Fe)}(Te,Di,mi?function(Me,le){Me&&console.error(Me),ai(le.url,Di,gn)}:function(Me,le){Me&&console.error(Me),xi(le.url,Di,function(Qi,Zt){gn(Qi,Mt,c,Zt,le.url)})})}))}(this.options.key,this.options,function(Ft,ee,Fe,Te){if(Ft)throw new Error(Ft);if(Gi.indexOf(Te.tileInfo.spatialReference.wkid)>=0||console.warn('This layer is not guaranteed to display properly because its service does not use the Web Mercator projection. The "tileInfo.spatialReference" property is:',Te.tileInfo.spatialReference,"\nMore information is available at https://docs.mapbox.com/help/glossary/projection/ and https://github.com/Esri/esri-leaflet-vector/issues/94."),ee=function(c,mi,Mt,Me){for(var le=Object.keys(c.sources),Qi=0;Qi<le.length;Qi++){var Zt=c.sources[le[Qi]];-1===Zt.url.indexOf("http")&&(Zt.url=mi.replace("/resources/styles/root.json","")),"/"===Zt.url.charAt(Zt.url.length-1)&&(Zt.url=Zt.url.slice(0,Zt.url.length-1)),Zt.tiles||(Mt.tiles&&"/"!==Mt.tiles[0].charAt(0)&&(Mt.tiles[0]="/"+Mt.tiles[0]),Zt.tiles=[Zt.url+Mt.tiles[0]]),Zt.url+="?f=json",Zt.url+=Me?"&token="+Me:"",Zt.tiles[0]+=Me?"?token="+Me:"",Zt.minzoom=Mt.tileInfo.lods[0].level,Zt.maxzoom=Mt.tileInfo.lods[Mt.tileInfo.lods.length-1].level}var ln=c.sources[le[le.length-1]];ln.attribution=Mt.copyrightText||"",ln.copyrightText=Mt.copyrightText||"";for(var tn=0;tn<c.layers.length;tn++){var Ee=c.layers[tn];Ee.layout&&Ee.layout["text-font"]&&Ee.layout["text-font"].length>1&&(Ee.layout["text-font"]=[Ee.layout["text-font"][0]])}return c.sprite&&-1===c.sprite.indexOf("http")&&(c.sprite=mi.replace("styles/root.json",c.sprite.replace("../","")),c.sprite+=Me?"?token="+Me:""),c.glyphs&&-1===c.glyphs.indexOf("http")&&(c.glyphs=mi.replace("styles/root.json",c.glyphs.replace("../","")),c.glyphs+=Me?"?token="+Me:""),c}(ee,Fe,Te,this.options.token),!this.getAttribution()){var gn=Object.keys(ee.sources);this.options.attribution=ee.sources[gn[gn.length-1]].attribution,this._map&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution())}this.options.style&&"function"==typeof this.options.style&&(ee=this.options.style(ee)),this._mapboxGL=Hi({style:ee,pane:this.options.pane,opacity:this.options.opacity}),this._ready=!0,this.fire("ready",{},!0)}.bind(this))},onAdd:function(Ft){this._map=Ft,this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(Ft){Ft.removeLayer(this._mapboxGL)},_asyncAdd:function(){this._mapboxGL.addTo(this._map,this)}});Pt.VERSION="3.1.3",Pt.VectorBasemapLayer=aa,Pt.VectorTileLayer=yn,Pt.vectorBasemapLayer=function(Ft,ee){return new aa(Ft,ee)},Pt.vectorTileLayer=function(Ft,ee){return new yn(Ft,ee)},Object.defineProperty(Pt,"__esModule",{value:!0})});