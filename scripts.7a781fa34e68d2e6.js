!function(At,dt){"object"==typeof exports&&typeof module<"u"?module.exports=dt():"function"==typeof define&&define.amd?define(dt):(At=typeof globalThis<"u"?globalThis:At||self).bootstrap=dt()}(this,function(){"use strict";const At="transitionend",dt=R=>{let y=R.getAttribute("data-bs-target");if(!y||"#"===y){let P=R.getAttribute("href");if(!P||!P.includes("#")&&!P.startsWith("."))return null;P.includes("#")&&!P.startsWith("#")&&(P=`#${P.split("#")[1]}`),y=P&&"#"!==P?P.trim():null}return y},qr=R=>{const y=dt(R);return y&&document.querySelector(y)?y:null},eo=R=>{const y=dt(R);return y?document.querySelector(y):null},Ei=R=>{R.dispatchEvent(new Event(At))},lr=R=>!(!R||"object"!=typeof R)&&(void 0!==R.jquery&&(R=R[0]),void 0!==R.nodeType),ni=R=>lr(R)?R.jquery?R[0]:R:"string"==typeof R&&R.length>0?document.querySelector(R):null,Go=R=>{if(!lr(R)||0===R.getClientRects().length)return!1;const y="visible"===getComputedStyle(R).getPropertyValue("visibility"),P=R.closest("details:not([open])");if(!P)return y;if(P!==R){const H=R.closest("summary");if(H&&H.parentNode!==P||null===H)return!1}return y},Lr=R=>!R||R.nodeType!==Node.ELEMENT_NODE||!!R.classList.contains("disabled")||(void 0!==R.disabled?R.disabled:R.hasAttribute("disabled")&&"false"!==R.getAttribute("disabled")),sn=R=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof R.getRootNode){const y=R.getRootNode();return y instanceof ShadowRoot?y:null}return R instanceof ShadowRoot?R:R.parentNode?sn(R.parentNode):null},zr=()=>{},Do=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Vi=[],ur=()=>"rtl"===document.documentElement.dir,Mn=R=>{var y;y=()=>{const P=Do();if(P){const H=R.NAME,mt=P.fn[H];P.fn[H]=R.jQueryInterface,P.fn[H].Constructor=R,P.fn[H].noConflict=()=>(P.fn[H]=mt,R.jQueryInterface)}},"loading"===document.readyState?(Vi.length||document.addEventListener("DOMContentLoaded",()=>{for(const P of Vi)P()}),Vi.push(y)):y()},Bt=R=>{"function"==typeof R&&R()},ee=(R,y,P=!0)=>{if(!P)return void Bt(R);const H=(wt=>{if(!wt)return 0;let{transitionDuration:Ut,transitionDelay:ie}=window.getComputedStyle(wt);const de=Number.parseFloat(Ut),Gt=Number.parseFloat(ie);return de||Gt?(Ut=Ut.split(",")[0],ie=ie.split(",")[0],1e3*(Number.parseFloat(Ut)+Number.parseFloat(ie))):0})(y)+5;let mt=!1;const _t=({target:wt})=>{wt===y&&(mt=!0,y.removeEventListener(At,_t),Bt(R))};y.addEventListener(At,_t),setTimeout(()=>{mt||Ei(y)},H)},Me=(R,y,P,H)=>{const mt=R.length;let _t=R.indexOf(y);return-1===_t?!P&&H?R[mt-1]:R[0]:(_t+=P?1:-1,H&&(_t=(_t+mt)%mt),R[Math.max(0,Math.min(_t,mt-1))])},Te=/[^.]*(?=\..*)\.|.*/,zi=/\..*/,wn=/::\d+$/,c={};let gi=1;const Mt={mouseenter:"mouseover",mouseleave:"mouseout"},Ue=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function le(R,y){return y&&`${y}::${gi++}`||R.uidEvent||gi++}function en(R){const y=le(R);return R.uidEvent=y,c[y]=c[y]||{},c[y]}function Nt(R,y,P=null){return Object.values(R).find(H=>H.callable===y&&H.delegationSelector===P)}function dn(R,y,P){const H="string"==typeof y,mt=H?P:y||P;let _t=Oe(R);return Ue.has(_t)||(_t=R),[H,mt,_t]}function nn(R,y,P,H,mt){if("string"!=typeof y||!R)return;let[_t,wt,Ut]=dn(y,P,H);var Ge;y in Mt&&(Ge=wt,wt=function(Ve){if(!Ve.relatedTarget||Ve.relatedTarget!==Ve.delegateTarget&&!Ve.delegateTarget.contains(Ve.relatedTarget))return Ge.call(this,Ve)});const ie=en(R),de=ie[Ut]||(ie[Ut]={}),Gt=Nt(de,wt,_t?P:null);if(Gt)return void(Gt.oneOff=Gt.oneOff&&mt);const Ht=le(wt,y.replace(Te,"")),Ne=_t?function(Re,Ge,Ve){return function ii(tn){const Xi=Re.querySelectorAll(Ge);for(let{target:ui}=tn;ui&&ui!==this;ui=ui.parentNode)for(const mi of Xi)if(mi===ui)return ln(tn,{delegateTarget:ui}),ii.oneOff&&Ct.off(Re,tn.type,Ge,Ve),Ve.apply(ui,[tn])}}(R,P,wt):function(Re,Ge){return function Ve(ii){return ln(ii,{delegateTarget:Re}),Ve.oneOff&&Ct.off(Re,ii.type,Ge),Ge.apply(Re,[ii])}}(R,wt);Ne.delegationSelector=_t?P:null,Ne.callable=wt,Ne.oneOff=mt,Ne.uidEvent=Ht,de[Ht]=Ne,R.addEventListener(Ut,Ne,_t)}function Se(R,y,P,H,mt){const _t=Nt(y[P],H,mt);_t&&(R.removeEventListener(P,_t,Boolean(mt)),delete y[P][_t.uidEvent])}function er(R,y,P,H){const mt=y[P]||{};for(const _t of Object.keys(mt))if(_t.includes(H)){const wt=mt[_t];Se(R,y,P,wt.callable,wt.delegationSelector)}}function Oe(R){return R=R.replace(zi,""),Mt[R]||R}const Ct={on(R,y,P,H){nn(R,y,P,H,!1)},one(R,y,P,H){nn(R,y,P,H,!0)},off(R,y,P,H){if("string"!=typeof y||!R)return;const[mt,_t,wt]=dn(y,P,H),Ut=wt!==y,ie=en(R),de=ie[wt]||{},Gt=y.startsWith(".");if(void 0===_t){if(Gt)for(const Ht of Object.keys(ie))er(R,ie,Ht,y.slice(1));for(const Ht of Object.keys(de)){const Ne=Ht.replace(wn,"");if(!Ut||y.includes(Ne)){const Re=de[Ht];Se(R,ie,wt,Re.callable,Re.delegationSelector)}}}else{if(!Object.keys(de).length)return;Se(R,ie,wt,_t,mt?P:null)}},trigger(R,y,P){if("string"!=typeof y||!R)return null;const H=Do();let mt=null,_t=!0,wt=!0,Ut=!1;y!==Oe(y)&&H&&(mt=H.Event(y,P),H(R).trigger(mt),_t=!mt.isPropagationStopped(),wt=!mt.isImmediatePropagationStopped(),Ut=mt.isDefaultPrevented());let ie=new Event(y,{bubbles:_t,cancelable:!0});return ie=ln(ie,P),Ut&&ie.preventDefault(),wt&&R.dispatchEvent(ie),ie.defaultPrevented&&mt&&mt.preventDefault(),ie}};function ln(R,y){for(const[P,H]of Object.entries(y||{}))try{R[P]=H}catch{Object.defineProperty(R,P,{configurable:!0,get:()=>H})}return R}const wi=new Map,Bi={set(R,y,P){wi.has(R)||wi.set(R,new Map);const H=wi.get(R);H.has(y)||0===H.size?H.set(y,P):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(H.keys())[0]}.`)},get:(R,y)=>wi.has(R)&&wi.get(R).get(y)||null,remove(R,y){if(!wi.has(R))return;const P=wi.get(R);P.delete(y),0===P.size&&wi.delete(R)}};function ci(R){if("true"===R)return!0;if("false"===R)return!1;if(R===Number(R).toString())return Number(R);if(""===R||"null"===R)return null;if("string"!=typeof R)return R;try{return JSON.parse(decodeURIComponent(R))}catch{return R}}function pi(R){return R.replace(/[A-Z]/g,y=>`-${y.toLowerCase()}`)}const qi={setDataAttribute(R,y,P){R.setAttribute(`data-bs-${pi(y)}`,P)},removeDataAttribute(R,y){R.removeAttribute(`data-bs-${pi(y)}`)},getDataAttributes(R){if(!R)return{};const y={},P=Object.keys(R.dataset).filter(H=>H.startsWith("bs")&&!H.startsWith("bsConfig"));for(const H of P){let mt=H.replace(/^bs/,"");mt=mt.charAt(0).toLowerCase()+mt.slice(1,mt.length),y[mt]=ci(R.dataset[H])}return y},getDataAttribute:(R,y)=>ci(R.getAttribute(`data-bs-${pi(y)}`))};class ki{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(y){return y=this._mergeConfigObj(y),y=this._configAfterMerge(y),this._typeCheckConfig(y),y}_configAfterMerge(y){return y}_mergeConfigObj(y,P){const H=lr(P)?qi.getDataAttribute(P,"config"):{};return{...this.constructor.Default,..."object"==typeof H?H:{},...lr(P)?qi.getDataAttributes(P):{},..."object"==typeof y?y:{}}}_typeCheckConfig(y,P=this.constructor.DefaultType){for(const mt of Object.keys(P)){const _t=P[mt],wt=y[mt],Ut=lr(wt)?"element":null==(H=wt)?`${H}`:Object.prototype.toString.call(H).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(_t).test(Ut))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${mt}" provided type "${Ut}" but expected type "${_t}".`)}var H}}class Mi extends ki{constructor(y,P){super(),(y=ni(y))&&(this._element=y,this._config=this._getConfig(P),Bi.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Bi.remove(this._element,this.constructor.DATA_KEY),Ct.off(this._element,this.constructor.EVENT_KEY);for(const y of Object.getOwnPropertyNames(this))this[y]=null}_queueCallback(y,P,H=!0){ee(y,P,H)}_getConfig(y){return y=this._mergeConfigObj(y,this._element),y=this._configAfterMerge(y),this._typeCheckConfig(y),y}static getInstance(y){return Bi.get(ni(y),this.DATA_KEY)}static getOrCreateInstance(y,P={}){return this.getInstance(y)||new this(y,"object"==typeof P?P:null)}static get VERSION(){return"5.2.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(y){return`${y}${this.EVENT_KEY}`}}const Gn=(R,y="hide")=>{const H=R.NAME;Ct.on(document,`click.dismiss${R.EVENT_KEY}`,`[data-bs-dismiss="${H}"]`,function(mt){if(["A","AREA"].includes(this.tagName)&&mt.preventDefault(),Lr(this))return;const _t=eo(this)||this.closest(`.${H}`);R.getOrCreateInstance(_t)[y]()})};class Wn extends Mi{static get NAME(){return"alert"}close(){if(Ct.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const y=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,y)}_destroyElement(){this._element.remove(),Ct.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(y){return this.each(function(){const P=Wn.getOrCreateInstance(this);if("string"==typeof y){if(void 0===P[y]||y.startsWith("_")||"constructor"===y)throw new TypeError(`No method named "${y}"`);P[y](this)}})}}Gn(Wn,"close"),Mn(Wn);const Ri='[data-bs-toggle="button"]';class un extends Mi{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(y){return this.each(function(){const P=un.getOrCreateInstance(this);"toggle"===y&&P[y]()})}}Ct.on(document,"click.bs.button.data-api",Ri,R=>{R.preventDefault();const y=R.target.closest(Ri);un.getOrCreateInstance(y).toggle()}),Mn(un);const qe={find:(R,y=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(y,R)),findOne:(R,y=document.documentElement)=>Element.prototype.querySelector.call(y,R),children:(R,y)=>[].concat(...R.children).filter(P=>P.matches(y)),parents(R,y){const P=[];let H=R.parentNode.closest(y);for(;H;)P.push(H),H=H.parentNode.closest(y);return P},prev(R,y){let P=R.previousElementSibling;for(;P;){if(P.matches(y))return[P];P=P.previousElementSibling}return[]},next(R,y){let P=R.nextElementSibling;for(;P;){if(P.matches(y))return[P];P=P.nextElementSibling}return[]},focusableChildren(R){const y=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(P=>`${P}:not([tabindex^="-"])`).join(",");return this.find(y,R).filter(P=>!Lr(P)&&Go(P))}},hr={endCallback:null,leftCallback:null,rightCallback:null},Gr={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class kr extends ki{constructor(y,P){super(),this._element=y,y&&kr.isSupported()&&(this._config=this._getConfig(P),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return hr}static get DefaultType(){return Gr}static get NAME(){return"swipe"}dispose(){Ct.off(this._element,".bs.swipe")}_start(y){this._supportPointerEvents?this._eventIsPointerPenTouch(y)&&(this._deltaX=y.clientX):this._deltaX=y.touches[0].clientX}_end(y){this._eventIsPointerPenTouch(y)&&(this._deltaX=y.clientX-this._deltaX),this._handleSwipe(),Bt(this._config.endCallback)}_move(y){this._deltaX=y.touches&&y.touches.length>1?0:y.touches[0].clientX-this._deltaX}_handleSwipe(){const y=Math.abs(this._deltaX);if(y<=40)return;const P=y/this._deltaX;this._deltaX=0,P&&Bt(P>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Ct.on(this._element,"pointerdown.bs.swipe",y=>this._start(y)),Ct.on(this._element,"pointerup.bs.swipe",y=>this._end(y)),this._element.classList.add("pointer-event")):(Ct.on(this._element,"touchstart.bs.swipe",y=>this._start(y)),Ct.on(this._element,"touchmove.bs.swipe",y=>this._move(y)),Ct.on(this._element,"touchend.bs.swipe",y=>this._end(y)))}_eventIsPointerPenTouch(y){return this._supportPointerEvents&&("pen"===y.pointerType||"touch"===y.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const vr="next",Dn="prev",On="left",xr="right",_o="slid.bs.carousel",Wr="carousel",Hr="active",_a={ArrowLeft:xr,ArrowRight:On},Hn={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Xr={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class ei extends Mi{constructor(y,P){super(y,P),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=qe.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Wr&&this.cycle()}static get Default(){return Hn}static get DefaultType(){return Xr}static get NAME(){return"carousel"}next(){this._slide(vr)}nextWhenVisible(){!document.hidden&&Go(this._element)&&this.next()}prev(){this._slide(Dn)}pause(){this._isSliding&&Ei(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?Ct.one(this._element,_o,()=>this.cycle()):this.cycle())}to(y){const P=this._getItems();if(y>P.length-1||y<0)return;if(this._isSliding)return void Ct.one(this._element,_o,()=>this.to(y));const H=this._getItemIndex(this._getActive());H!==y&&this._slide(y>H?vr:Dn,P[y])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(y){return y.defaultInterval=y.interval,y}_addEventListeners(){this._config.keyboard&&Ct.on(this._element,"keydown.bs.carousel",y=>this._keydown(y)),"hover"===this._config.pause&&(Ct.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),Ct.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle())),this._config.touch&&kr.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const P of qe.find(".carousel-item img",this._element))Ct.on(P,"dragstart.bs.carousel",H=>H.preventDefault());this._swipeHelper=new kr(this._element,{leftCallback:()=>this._slide(this._directionToOrder(On)),rightCallback:()=>this._slide(this._directionToOrder(xr)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}})}_keydown(y){if(/input|textarea/i.test(y.target.tagName))return;const P=_a[y.key];P&&(y.preventDefault(),this._slide(this._directionToOrder(P)))}_getItemIndex(y){return this._getItems().indexOf(y)}_setActiveIndicatorElement(y){if(!this._indicatorsElement)return;const P=qe.findOne(".active",this._indicatorsElement);P.classList.remove(Hr),P.removeAttribute("aria-current");const H=qe.findOne(`[data-bs-slide-to="${y}"]`,this._indicatorsElement);H&&(H.classList.add(Hr),H.setAttribute("aria-current","true"))}_updateInterval(){const y=this._activeElement||this._getActive();if(!y)return;const P=Number.parseInt(y.getAttribute("data-bs-interval"),10);this._config.interval=P||this._config.defaultInterval}_slide(y,P=null){if(this._isSliding)return;const H=this._getActive(),mt=y===vr,_t=P||Me(this._getItems(),H,mt,this._config.wrap);if(_t===H)return;const wt=this._getItemIndex(_t),Ut=Ht=>Ct.trigger(this._element,Ht,{relatedTarget:_t,direction:this._orderToDirection(y),from:this._getItemIndex(H),to:wt});if(Ut("slide.bs.carousel").defaultPrevented||!H||!_t)return;const ie=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(wt),this._activeElement=_t;const de=mt?"carousel-item-start":"carousel-item-end",Gt=mt?"carousel-item-next":"carousel-item-prev";_t.classList.add(Gt),H.classList.add(de),_t.classList.add(de),this._queueCallback(()=>{_t.classList.remove(de,Gt),_t.classList.add(Hr),H.classList.remove(Hr,Gt,de),this._isSliding=!1,Ut(_o)},H,this._isAnimated()),ie&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return qe.findOne(".active.carousel-item",this._element)}_getItems(){return qe.find(".carousel-item",this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(y){return ur()?y===On?Dn:vr:y===On?vr:Dn}_orderToDirection(y){return ur()?y===Dn?On:xr:y===Dn?xr:On}static jQueryInterface(y){return this.each(function(){const P=ei.getOrCreateInstance(this,y);if("number"!=typeof y){if("string"==typeof y){if(void 0===P[y]||y.startsWith("_")||"constructor"===y)throw new TypeError(`No method named "${y}"`);P[y]()}}else P.to(y)})}}Ct.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(R){const y=eo(this);if(!y||!y.classList.contains(Wr))return;R.preventDefault();const P=ei.getOrCreateInstance(y),H=this.getAttribute("data-bs-slide-to");return H?(P.to(H),void P._maybeEnableCycle()):"next"===qi.getDataAttribute(this,"slide")?(P.next(),void P._maybeEnableCycle()):(P.prev(),void P._maybeEnableCycle())}),Ct.on(window,"load.bs.carousel.data-api",()=>{const R=qe.find('[data-bs-ride="carousel"]');for(const y of R)ei.getOrCreateInstance(y)}),Mn(ei);const hn="show",re="collapse",Bn="collapsing",je='[data-bs-toggle="collapse"]',To={parent:null,toggle:!0},Rn={parent:"(null|element)",toggle:"boolean"};class Tn extends Mi{constructor(y,P){super(y,P),this._isTransitioning=!1,this._triggerArray=[];const H=qe.find(je);for(const mt of H){const _t=qr(mt),wt=qe.find(_t).filter(Ut=>Ut===this._element);null!==_t&&wt.length&&this._triggerArray.push(mt)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return To}static get DefaultType(){return Rn}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let y=[];if(this._config.parent&&(y=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(mt=>mt!==this._element).map(mt=>Tn.getOrCreateInstance(mt,{toggle:!1}))),y.length&&y[0]._isTransitioning||Ct.trigger(this._element,"show.bs.collapse").defaultPrevented)return;for(const mt of y)mt.hide();const P=this._getDimension();this._element.classList.remove(re),this._element.classList.add(Bn),this._element.style[P]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const H=`scroll${P[0].toUpperCase()+P.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Bn),this._element.classList.add(re,hn),this._element.style[P]="",Ct.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[P]=`${this._element[H]}px`}hide(){if(this._isTransitioning||!this._isShown()||Ct.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const y=this._getDimension();this._element.style[y]=`${this._element.getBoundingClientRect()[y]}px`,this._element.classList.add(Bn),this._element.classList.remove(re,hn);for(const P of this._triggerArray){const H=eo(P);H&&!this._isShown(H)&&this._addAriaAndCollapsedClass([P],!1)}this._isTransitioning=!0,this._element.style[y]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Bn),this._element.classList.add(re),Ct.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}_isShown(y=this._element){return y.classList.contains(hn)}_configAfterMerge(y){return y.toggle=Boolean(y.toggle),y.parent=ni(y.parent),y}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const y=this._getFirstLevelChildren(je);for(const P of y){const H=eo(P);H&&this._addAriaAndCollapsedClass([P],this._isShown(H))}}_getFirstLevelChildren(y){const P=qe.find(":scope .collapse .collapse",this._config.parent);return qe.find(y,this._config.parent).filter(H=>!P.includes(H))}_addAriaAndCollapsedClass(y,P){if(y.length)for(const H of y)H.classList.toggle("collapsed",!P),H.setAttribute("aria-expanded",P)}static jQueryInterface(y){const P={};return"string"==typeof y&&/show|hide/.test(y)&&(P.toggle=!1),this.each(function(){const H=Tn.getOrCreateInstance(this,P);if("string"==typeof y){if(void 0===H[y])throw new TypeError(`No method named "${y}"`);H[y]()}})}}Ct.on(document,"click.bs.collapse.data-api",je,function(R){("A"===R.target.tagName||R.delegateTarget&&"A"===R.delegateTarget.tagName)&&R.preventDefault();const y=qr(this),P=qe.find(y);for(const H of P)Tn.getOrCreateInstance(H,{toggle:!1}).toggle()}),Mn(Tn);var En="top",Pi="bottom",Hi="right",Fi="left",io="auto",no=[En,Pi,Hi,Fi],x="start",S="end",D="clippingParents",W="viewport",tt="popper",ht="reference",Lt=no.reduce(function(R,y){return R.concat([y+"-"+x,y+"-"+S])},[]),Jt=[].concat(no,[io]).reduce(function(R,y){return R.concat([y,y+"-"+x,y+"-"+S])},[]),ue="beforeRead",Di="afterRead",Qi="beforeMain",ir="afterMain",Pn="beforeWrite",Ti="afterWrite",Mr=[ue,"read",Di,Qi,"main",ir,Pn,"write",Ti];function fn(R){return R?(R.nodeName||"").toLowerCase():null}function mn(R){if(null==R)return window;if("[object Window]"!==R.toString()){var y=R.ownerDocument;return y&&y.defaultView||window}return R}function Kr(R){return R instanceof mn(R).Element||R instanceof Element}function Ce(R){return R instanceof mn(R).HTMLElement||R instanceof HTMLElement}function Ke(R){return typeof ShadowRoot<"u"&&(R instanceof mn(R).ShadowRoot||R instanceof ShadowRoot)}const z={name:"applyStyles",enabled:!0,phase:"write",fn:function(R){var y=R.state;Object.keys(y.elements).forEach(function(P){var H=y.styles[P]||{},mt=y.attributes[P]||{},_t=y.elements[P];Ce(_t)&&fn(_t)&&(Object.assign(_t.style,H),Object.keys(mt).forEach(function(wt){var Ut=mt[wt];!1===Ut?_t.removeAttribute(wt):_t.setAttribute(wt,!0===Ut?"":Ut)}))})},effect:function(R){var y=R.state,P={popper:{position:y.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(y.elements.popper.style,P.popper),y.styles=P,y.elements.arrow&&Object.assign(y.elements.arrow.style,P.arrow),function(){Object.keys(y.elements).forEach(function(H){var mt=y.elements[H],_t=y.attributes[H]||{},wt=Object.keys(y.styles.hasOwnProperty(H)?y.styles[H]:P[H]).reduce(function(Ut,ie){return Ut[ie]="",Ut},{});Ce(mt)&&fn(mt)&&(Object.assign(mt.style,wt),Object.keys(_t).forEach(function(Ut){mt.removeAttribute(Ut)}))})}},requires:["computeStyles"]};function O(R){return R.split("-")[0]}var F=Math.max,G=Math.min,X=Math.round;function nt(){var R=navigator.userAgentData;return null!=R&&R.brands?R.brands.map(function(y){return y.brand+"/"+y.version}).join(" "):navigator.userAgent}function st(){return!/^((?!chrome|android).)*safari/i.test(nt())}function j(R,y,P){void 0===y&&(y=!1),void 0===P&&(P=!1);var H=R.getBoundingClientRect(),mt=1,_t=1;y&&Ce(R)&&(mt=R.offsetWidth>0&&X(H.width)/R.offsetWidth||1,_t=R.offsetHeight>0&&X(H.height)/R.offsetHeight||1);var wt=(Kr(R)?mn(R):window).visualViewport,Ut=!st()&&P,ie=(H.left+(Ut&&wt?wt.offsetLeft:0))/mt,de=(H.top+(Ut&&wt?wt.offsetTop:0))/_t,Gt=H.width/mt,Ht=H.height/_t;return{width:Gt,height:Ht,top:de,right:ie+Gt,bottom:de+Ht,left:ie,x:ie,y:de}}function et(R){var y=j(R),P=R.offsetWidth,H=R.offsetHeight;return Math.abs(y.width-P)<=1&&(P=y.width),Math.abs(y.height-H)<=1&&(H=y.height),{x:R.offsetLeft,y:R.offsetTop,width:P,height:H}}function ft(R,y){var P=y.getRootNode&&y.getRootNode();if(R.contains(y))return!0;if(P&&Ke(P)){var H=y;do{if(H&&R.isSameNode(H))return!0;H=H.parentNode||H.host}while(H)}return!1}function kt(R){return mn(R).getComputedStyle(R)}function Rt(R){return["table","td","th"].indexOf(fn(R))>=0}function bt(R){return((Kr(R)?R.ownerDocument:R.document)||window.document).documentElement}function vt(R){return"html"===fn(R)?R:R.assignedSlot||R.parentNode||(Ke(R)?R.host:null)||bt(R)}function ne(R){return Ce(R)&&"fixed"!==kt(R).position?R.offsetParent:null}function Ft(R){for(var y=mn(R),P=ne(R);P&&Rt(P)&&"static"===kt(P).position;)P=ne(P);return P&&("html"===fn(P)||"body"===fn(P)&&"static"===kt(P).position)?y:P||function(H){var mt=/firefox/i.test(nt());if(/Trident/i.test(nt())&&Ce(H)&&"fixed"===kt(H).position)return null;var _t=vt(H);for(Ke(_t)&&(_t=_t.host);Ce(_t)&&["html","body"].indexOf(fn(_t))<0;){var wt=kt(_t);if("none"!==wt.transform||"none"!==wt.perspective||"paint"===wt.contain||-1!==["transform","perspective"].indexOf(wt.willChange)||mt&&"filter"===wt.willChange||mt&&wt.filter&&"none"!==wt.filter)return _t;_t=_t.parentNode}return null}(R)||y}function Pt(R){return["top","bottom"].indexOf(R)>=0?"x":"y"}function te(R,y,P){return F(R,G(y,P))}function Kt(R){return Object.assign({},{top:0,right:0,bottom:0,left:0},R)}function Yt(R,y){return y.reduce(function(P,H){return P[H]=R,P},{})}const ze={name:"arrow",enabled:!0,phase:"main",fn:function(R){var y,We,Zt,P=R.state,H=R.name,mt=R.options,_t=P.elements.arrow,wt=P.modifiersData.popperOffsets,Ut=O(P.placement),ie=Pt(Ut),de=[Fi,Hi].indexOf(Ut)>=0?"height":"width";if(_t&&wt){var Gt=(Zt=P,Kt("number"!=typeof(We="function"==typeof(We=mt.padding)?We(Object.assign({},Zt.rects,{placement:Zt.placement})):We)?We:Yt(We,no))),Ht=et(_t),Ne="y"===ie?En:Fi,Re="y"===ie?Pi:Hi,Ge=P.rects.reference[de]+P.rects.reference[ie]-wt[ie]-P.rects.popper[de],Ve=wt[ie]-P.rects.reference[ie],ii=Ft(_t),tn=ii?"y"===ie?ii.clientHeight||0:ii.clientWidth||0:0,Ee=tn/2-Ht[de]/2+(Ge/2-Ve/2),_i=te(Gt[Ne],Ee,tn-Ht[de]-Gt[Re]);P.modifiersData[H]=((y={})[ie]=_i,y.centerOffset=_i-Ee,y)}},effect:function(R){var y=R.state,P=R.options.element,H=void 0===P?"[data-popper-arrow]":P;null!=H&&("string"!=typeof H||(H=y.elements.popper.querySelector(H)))&&ft(y.elements.popper,H)&&(y.elements.arrow=H)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function $t(R){return R.split("-")[1]}var Je={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ze(R){var y,P=R.popper,H=R.popperRect,mt=R.placement,_t=R.variation,wt=R.offsets,Ut=R.position,ie=R.gpuAcceleration,de=R.adaptive,Gt=R.roundOffsets,Ht=R.isFixed,Ne=wt.x,Re=void 0===Ne?0:Ne,Ge=wt.y,Ve=void 0===Ge?0:Ge,ii="function"==typeof Gt?Gt({x:Re,y:Ve}):{x:Re,y:Ve};Re=ii.x,Ve=ii.y;var tn=wt.hasOwnProperty("x"),Xi=wt.hasOwnProperty("y"),ui=Fi,mi=En,Ee=window;if(de){var _i=Ft(P),Ki="clientHeight",We="clientWidth";_i===mn(P)&&"static"!==kt(_i=bt(P)).position&&"absolute"===Ut&&(Ki="scrollHeight",We="scrollWidth"),(mt===En||(mt===Fi||mt===Hi)&&_t===S)&&(mi=Pi,Ve-=(Ht&&_i===Ee&&Ee.visualViewport?Ee.visualViewport.height:_i[Ki])-H.height,Ve*=ie?1:-1),mt!==Fi&&(mt!==En&&mt!==Pi||_t!==S)||(ui=Hi,Re-=(Ht&&_i===Ee&&Ee.visualViewport?Ee.visualViewport.width:_i[We])-H.width,Re*=ie?1:-1)}var Zt,to,gn,Fr,Ni=Object.assign({position:Ut},de&&Je),Qr=!0===Gt?(gn=(to={x:Re,y:Ve}).y,Fr=window.devicePixelRatio||1,{x:X(to.x*Fr)/Fr||0,y:X(gn*Fr)/Fr||0}):{x:Re,y:Ve};return Re=Qr.x,Ve=Qr.y,Object.assign({},Ni,ie?((Zt={})[mi]=Xi?"0":"",Zt[ui]=tn?"0":"",Zt.transform=(Ee.devicePixelRatio||1)<=1?"translate("+Re+"px, "+Ve+"px)":"translate3d("+Re+"px, "+Ve+"px, 0)",Zt):((y={})[mi]=Xi?Ve+"px":"",y[ui]=tn?Re+"px":"",y.transform="",y))}const Be={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(R){var y=R.state,P=R.options,H=P.gpuAcceleration,mt=void 0===H||H,_t=P.adaptive,wt=void 0===_t||_t,Ut=P.roundOffsets,ie=void 0===Ut||Ut,de={placement:O(y.placement),variation:$t(y.placement),popper:y.elements.popper,popperRect:y.rects.popper,gpuAcceleration:mt,isFixed:"fixed"===y.options.strategy};null!=y.modifiersData.popperOffsets&&(y.styles.popper=Object.assign({},y.styles.popper,Ze(Object.assign({},de,{offsets:y.modifiersData.popperOffsets,position:y.options.strategy,adaptive:wt,roundOffsets:ie})))),null!=y.modifiersData.arrow&&(y.styles.arrow=Object.assign({},y.styles.arrow,Ze(Object.assign({},de,{offsets:y.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:ie})))),y.attributes.popper=Object.assign({},y.attributes.popper,{"data-popper-placement":y.placement})},data:{}};var si={passive:!0};const ti={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(R){var y=R.state,P=R.instance,H=R.options,mt=H.scroll,_t=void 0===mt||mt,wt=H.resize,Ut=void 0===wt||wt,ie=mn(y.elements.popper),de=[].concat(y.scrollParents.reference,y.scrollParents.popper);return _t&&de.forEach(function(Gt){Gt.addEventListener("scroll",P.update,si)}),Ut&&ie.addEventListener("resize",P.update,si),function(){_t&&de.forEach(function(Gt){Gt.removeEventListener("scroll",P.update,si)}),Ut&&ie.removeEventListener("resize",P.update,si)}},data:{}};var br={left:"right",right:"left",bottom:"top",top:"bottom"};function di(R){return R.replace(/left|right|bottom|top/g,function(y){return br[y]})}var rn={start:"end",end:"start"};function vi(R){return R.replace(/start|end/g,function(y){return rn[y]})}function Ye(R){var y=mn(R);return{scrollLeft:y.pageXOffset,scrollTop:y.pageYOffset}}function fe(R){return j(bt(R)).left+Ye(R).scrollLeft}function An(R){var y=kt(R);return/auto|scroll|overlay|hidden/.test(y.overflow+y.overflowY+y.overflowX)}function ya(R){return["html","body","#document"].indexOf(fn(R))>=0?R.ownerDocument.body:Ce(R)&&An(R)?R:ya(vt(R))}function Ai(R,y){var P;void 0===y&&(y=[]);var H=ya(R),mt=H===(null==(P=R.ownerDocument)?void 0:P.body),_t=mn(H),wt=mt?[_t].concat(_t.visualViewport||[],An(H)?H:[]):H,Ut=y.concat(wt);return mt?Ut:Ut.concat(Ai(vt(wt)))}function nr(R){return Object.assign({},R,{left:R.x,top:R.y,right:R.x+R.width,bottom:R.y+R.height})}function Ea(R,y,P){return y===W?nr(function(H,mt){var _t=mn(H),wt=bt(H),Ut=_t.visualViewport,ie=wt.clientWidth,de=wt.clientHeight,Gt=0,Ht=0;if(Ut){ie=Ut.width,de=Ut.height;var Ne=st();(Ne||!Ne&&"fixed"===mt)&&(Gt=Ut.offsetLeft,Ht=Ut.offsetTop)}return{width:ie,height:de,x:Gt+fe(H),y:Ht}}(R,P)):Kr(y)?((_t=j(H=y,!1,"fixed"===P)).top=_t.top+H.clientTop,_t.left=_t.left+H.clientLeft,_t.bottom=_t.top+H.clientHeight,_t.right=_t.left+H.clientWidth,_t.width=H.clientWidth,_t.height=H.clientHeight,_t.x=_t.left,_t.y=_t.top,_t):nr(function(H){var mt,_t=bt(H),wt=Ye(H),Ut=null==(mt=H.ownerDocument)?void 0:mt.body,ie=F(_t.scrollWidth,_t.clientWidth,Ut?Ut.scrollWidth:0,Ut?Ut.clientWidth:0),de=F(_t.scrollHeight,_t.clientHeight,Ut?Ut.scrollHeight:0,Ut?Ut.clientHeight:0),Gt=-wt.scrollLeft+fe(H),Ht=-wt.scrollTop;return"rtl"===kt(Ut||_t).direction&&(Gt+=F(_t.clientWidth,Ut?Ut.clientWidth:0)-ie),{width:ie,height:de,x:Gt,y:Ht}}(bt(R)));var H,_t}function ga(R){var y,P=R.reference,H=R.element,mt=R.placement,_t=mt?O(mt):null,wt=mt?$t(mt):null,Ut=P.x+P.width/2-H.width/2,ie=P.y+P.height/2-H.height/2;switch(_t){case En:y={x:Ut,y:P.y-H.height};break;case Pi:y={x:Ut,y:P.y+P.height};break;case Hi:y={x:P.x+P.width,y:ie};break;case Fi:y={x:P.x-H.width,y:ie};break;default:y={x:P.x,y:P.y}}var de=_t?Pt(_t):null;if(null!=de){var Gt="y"===de?"height":"width";switch(wt){case x:y[de]=y[de]-(P[Gt]/2-H[Gt]/2);break;case S:y[de]=y[de]+(P[Gt]/2-H[Gt]/2)}}return y}function Zi(R,y){void 0===y&&(y={});var yn,gn,Fr,Vt,fi,Er,ho,Uo,Co,Yi,H=y.placement,mt=void 0===H?R.placement:H,_t=y.strategy,wt=void 0===_t?R.strategy:_t,Ut=y.boundary,ie=void 0===Ut?D:Ut,de=y.rootBoundary,Gt=void 0===de?W:de,Ht=y.elementContext,Ne=void 0===Ht?tt:Ht,Re=y.altBoundary,Ge=void 0!==Re&&Re,Ve=y.padding,ii=void 0===Ve?0:Ve,tn=Kt("number"!=typeof ii?ii:Yt(ii,no)),ui=R.rects.popper,mi=R.elements[Ge?Ne===tt?ht:tt:Ne],Ee=(yn=Kr(mi)?mi:mi.contextElement||bt(R.elements.popper),Fr=Gt,Vt=wt,Uo="clippingParents"===(gn=ie)?(Er=Ai(vt(fi=yn)),Kr(ho=["absolute","fixed"].indexOf(kt(fi).position)>=0&&Ce(fi)?Ft(fi):fi)?Er.filter(function(Jn){return Kr(Jn)&&ft(Jn,ho)&&"body"!==fn(Jn)}):[]):[].concat(gn),Yi=(Co=[].concat(Uo,[Fr])).reduce(function(fi,Er){var ho=Ea(yn,Er,Vt);return fi.top=F(ho.top,fi.top),fi.right=G(ho.right,fi.right),fi.bottom=G(ho.bottom,fi.bottom),fi.left=F(ho.left,fi.left),fi},Ea(yn,Co[0],Vt)),Yi.width=Yi.right-Yi.left,Yi.height=Yi.bottom-Yi.top,Yi.x=Yi.left,Yi.y=Yi.top,Yi),_i=j(R.elements.reference),Ki=ga({reference:_i,element:ui,strategy:"absolute",placement:mt}),We=nr(Object.assign({},ui,Ki)),Zt=Ne===tt?We:_i,Ni={top:Ee.top-Zt.top+tn.top,bottom:Zt.bottom-Ee.bottom+tn.bottom,left:Ee.left-Zt.left+tn.left,right:Zt.right-Ee.right+tn.right},Qr=R.modifiersData.offset;if(Ne===tt&&Qr){var to=Qr[mt];Object.keys(Ni).forEach(function(yn){var gn=[Hi,Pi].indexOf(yn)>=0?1:-1,Fr=[En,Pi].indexOf(yn)>=0?"y":"x";Ni[yn]+=to[Fr]*gn})}return Ni}const In={name:"flip",enabled:!0,phase:"main",fn:function(R){var y=R.state,P=R.options,H=R.name;if(!y.modifiersData[H]._skip){for(var mt=P.mainAxis,_t=void 0===mt||mt,wt=P.altAxis,Ut=void 0===wt||wt,ie=P.fallbackPlacements,de=P.padding,Gt=P.boundary,Ht=P.rootBoundary,Ne=P.altBoundary,Re=P.flipVariations,Ge=void 0===Re||Re,Ve=P.allowedAutoPlacements,ii=y.options.placement,tn=O(ii),Xi=ie||(tn!==ii&&Ge?function(fi){if(O(fi)===io)return[];var Er=di(fi);return[vi(fi),Er,vi(Er)]}(ii):[di(ii)]),ui=[ii].concat(Xi).reduce(function(fi,Er){return fi.concat(O(Er)===io?function cr(R,y){void 0===y&&(y={});var mt=y.boundary,_t=y.rootBoundary,wt=y.padding,Ut=y.flipVariations,ie=y.allowedAutoPlacements,de=void 0===ie?Jt:ie,Gt=$t(y.placement),Ht=Gt?Ut?Lt:Lt.filter(function(Ge){return $t(Ge)===Gt}):no,Ne=Ht.filter(function(Ge){return de.indexOf(Ge)>=0});0===Ne.length&&(Ne=Ht);var Re=Ne.reduce(function(Ge,Ve){return Ge[Ve]=Zi(R,{placement:Ve,boundary:mt,rootBoundary:_t,padding:wt})[O(Ve)],Ge},{});return Object.keys(Re).sort(function(Ge,Ve){return Re[Ge]-Re[Ve]})}(y,{placement:Er,boundary:Gt,rootBoundary:Ht,padding:de,flipVariations:Ge,allowedAutoPlacements:Ve}):Er)},[]),mi=y.rects.reference,Ee=y.rects.popper,_i=new Map,Ki=!0,We=ui[0],Zt=0;Zt<ui.length;Zt++){var Ni=ui[Zt],Qr=O(Ni),to=$t(Ni)===x,yn=[En,Pi].indexOf(Qr)>=0,gn=yn?"width":"height",Fr=Zi(y,{placement:Ni,boundary:Gt,rootBoundary:Ht,altBoundary:Ne,padding:de}),Vt=yn?to?Hi:Fi:to?Pi:En;mi[gn]>Ee[gn]&&(Vt=di(Vt));var Uo=di(Vt),Co=[];if(_t&&Co.push(Fr[Qr]<=0),Ut&&Co.push(Fr[Vt]<=0,Fr[Uo]<=0),Co.every(function(fi){return fi})){We=Ni,Ki=!1;break}_i.set(Ni,Co)}if(Ki)for(var Ra=function(fi){var Er=ui.find(function(ho){var Jn=_i.get(ho);if(Jn)return Jn.slice(0,fi).every(function(No){return No})});if(Er)return We=Er,"break"},Yi=Ge?3:1;Yi>0&&"break"!==Ra(Yi);Yi--);y.placement!==We&&(y.modifiersData[H]._skip=!0,y.placement=We,y.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Cn(R,y,P){return void 0===P&&(P={x:0,y:0}),{top:R.top-y.height-P.y,right:R.right-y.width+P.x,bottom:R.bottom-y.height+P.y,left:R.left-y.width-P.x}}function Fn(R){return[En,Hi,Pi,Fi].some(function(y){return R[y]>=0})}const Gi={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(R){var y=R.state,P=R.name,H=y.rects.reference,mt=y.rects.popper,_t=y.modifiersData.preventOverflow,wt=Zi(y,{elementContext:"reference"}),Ut=Zi(y,{altBoundary:!0}),ie=Cn(wt,H),de=Cn(Ut,mt,_t),Gt=Fn(ie),Ht=Fn(de);y.modifiersData[P]={referenceClippingOffsets:ie,popperEscapeOffsets:de,isReferenceHidden:Gt,hasPopperEscaped:Ht},y.attributes.popper=Object.assign({},y.attributes.popper,{"data-popper-reference-hidden":Gt,"data-popper-escaped":Ht})}},ro={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(R){var y=R.state,H=R.name,mt=R.options.offset,_t=void 0===mt?[0,0]:mt,wt=Jt.reduce(function(Gt,Ht){return Gt[Ht]=(Re=y.rects,Ge=_t,Ve=O(Ne=Ht),ii=[Fi,En].indexOf(Ve)>=0?-1:1,Xi=(Xi=(tn="function"==typeof Ge?Ge(Object.assign({},Re,{placement:Ne})):Ge)[0])||0,ui=((ui=tn[1])||0)*ii,[Fi,Hi].indexOf(Ve)>=0?{x:ui,y:Xi}:{x:Xi,y:ui}),Gt;var Ne,Re,Ge,Ve,ii,tn,Xi,ui},{}),Ut=wt[y.placement],de=Ut.y;null!=y.modifiersData.popperOffsets&&(y.modifiersData.popperOffsets.x+=Ut.x,y.modifiersData.popperOffsets.y+=de),y.modifiersData[H]=wt}},wr={name:"popperOffsets",enabled:!0,phase:"read",fn:function(R){var y=R.state;y.modifiersData[R.name]=ga({reference:y.rects.reference,element:y.rects.popper,strategy:"absolute",placement:y.placement})},data:{}},Pa={name:"preventOverflow",enabled:!0,phase:"main",fn:function(R){var Si,ar,y=R.state,P=R.options,H=R.name,mt=P.mainAxis,_t=void 0===mt||mt,wt=P.altAxis,Ut=void 0!==wt&&wt,Ne=P.tether,Re=void 0===Ne||Ne,Ge=P.tetherOffset,Ve=void 0===Ge?0:Ge,ii=Zi(y,{boundary:P.boundary,rootBoundary:P.rootBoundary,padding:P.padding,altBoundary:P.altBoundary}),tn=O(y.placement),Xi=$t(y.placement),ui=!Xi,mi=Pt(tn),Ee="x"===mi?"y":"x",_i=y.modifiersData.popperOffsets,Ki=y.rects.reference,We=y.rects.popper,Zt="function"==typeof Ve?Ve(Object.assign({},y.rects,{placement:y.placement})):Ve,Ni="number"==typeof Zt?{mainAxis:Zt,altAxis:Zt}:Object.assign({mainAxis:0,altAxis:0},Zt),Qr=y.modifiersData.offset?y.modifiersData.offset[y.placement]:null,to={x:0,y:0};if(_i){if(_t){var yn,gn="y"===mi?En:Fi,Fr="y"===mi?Pi:Hi,Vt="y"===mi?"height":"width",Uo=_i[mi],Co=Uo+ii[gn],Ra=Uo-ii[Fr],Yi=Re?-We[Vt]/2:0,fi=Xi===x?Ki[Vt]:We[Vt],Er=Xi===x?-We[Vt]:-Ki[Vt],ho=y.elements.arrow,Jn=Re&&ho?et(ho):{width:0,height:0},No=y.modifiersData["arrow#persistent"]?y.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},tl=No[gn],cs=No[Fr],ps=te(0,Ki[Vt],Jn[Vt]),el=ui?Ki[Vt]/2-Yi-ps-tl-Ni.mainAxis:fi-ps-tl-Ni.mainAxis,ha=ui?-Ki[Vt]/2+Yi+ps+cs+Ni.mainAxis:Er+ps+cs+Ni.mainAxis,co=y.elements.arrow&&Ft(y.elements.arrow),Qo=null!=(yn=Qr?.[mi])?yn:0,ta=Uo+ha-Qo,fr=te(Re?G(Co,Uo+el-Qo-(co?"y"===mi?co.clientTop||0:co.clientLeft||0:0)):Co,Uo,Re?F(Ra,ta):Ra);_i[mi]=fr,to[mi]=fr-Uo}if(Ut){var Fa,jn=_i[Ee],Na="y"===Ee?"height":"width",me=jn+ii["x"===mi?En:Fi],ce=jn-ii["x"===mi?Pi:Hi],ds=-1!==[En,Fi].indexOf(tn),Ur=null!=(Fa=Qr?.[Ee])?Fa:0,jo=ds?me:jn-Ki[Na]-We[Na]-Ur+Ni.altAxis,mr=ds?jn+Ki[Na]+We[Na]-Ur-Ni.altAxis:ce,ia=Re&&ds?(ar=te(jo,jn,Si=mr))>Si?Si:ar:te(Re?jo:me,jn,Re?mr:ce);_i[Ee]=ia,to[Ee]=ia-jn}y.modifiersData[H]=to}},requiresIfExists:["offset"]};function rr(R,y,P){void 0===P&&(P=!1);var H,mt,Ht,Ne,Re,Ge,_t=Ce(y),wt=Ce(y)&&(Ne=(Ht=y).getBoundingClientRect(),Re=X(Ne.width)/Ht.offsetWidth||1,Ge=X(Ne.height)/Ht.offsetHeight||1,1!==Re||1!==Ge),Ut=bt(y),ie=j(R,wt,P),de={scrollLeft:0,scrollTop:0},Gt={x:0,y:0};return(_t||!_t&&!P)&&(("body"!==fn(y)||An(Ut))&&(de=(H=y)!==mn(H)&&Ce(H)?{scrollLeft:(mt=H).scrollLeft,scrollTop:mt.scrollTop}:Ye(H)),Ce(y)?((Gt=j(y,!0)).x+=y.clientLeft,Gt.y+=y.clientTop):Ut&&(Gt.x=fe(Ut))),{x:ie.left+de.scrollLeft-Gt.x,y:ie.top+de.scrollTop-Gt.y,width:ie.width,height:ie.height}}function Ga(R){var y=new Map,P=new Set,H=[];function mt(_t){P.add(_t.name),[].concat(_t.requires||[],_t.requiresIfExists||[]).forEach(function(wt){if(!P.has(wt)){var Ut=y.get(wt);Ut&&mt(Ut)}}),H.push(_t)}return R.forEach(function(_t){y.set(_t.name,_t)}),R.forEach(function(_t){P.has(_t.name)||mt(_t)}),H}var Ln={placement:"bottom",modifiers:[],strategy:"absolute"};function Un(){for(var R=arguments.length,y=new Array(R),P=0;P<R;P++)y[P]=arguments[P];return!y.some(function(H){return!(H&&"function"==typeof H.getBoundingClientRect)})}function Jr(R){void 0===R&&(R={});var P=R.defaultModifiers,H=void 0===P?[]:P,mt=R.defaultOptions,_t=void 0===mt?Ln:mt;return function(wt,Ut,ie){void 0===ie&&(ie=_t);var de,Gt,Ht={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ln,_t),modifiersData:{},elements:{reference:wt,popper:Ut},attributes:{},styles:{}},Ne=[],Re=!1,Ge={state:Ht,setOptions:function(ii){var tn="function"==typeof ii?ii(Ht.options):ii;Ve(),Ht.options=Object.assign({},_t,Ht.options,tn),Ht.scrollParents={reference:Kr(wt)?Ai(wt):wt.contextElement?Ai(wt.contextElement):[],popper:Ai(Ut)};var Xi,ui,Ee,_i,mi=(Xi=[].concat(H,Ht.options.modifiers),ui=Xi.reduce(function(Ee,_i){var Ki=Ee[_i.name];return Ee[_i.name]=Ki?Object.assign({},Ki,_i,{options:Object.assign({},Ki.options,_i.options),data:Object.assign({},Ki.data,_i.data)}):_i,Ee},{}),Ee=Object.keys(ui).map(function(Ee){return ui[Ee]}),_i=Ga(Ee),Mr.reduce(function(Ki,We){return Ki.concat(_i.filter(function(Zt){return Zt.phase===We}))},[]));return Ht.orderedModifiers=mi.filter(function(Ee){return Ee.enabled}),Ht.orderedModifiers.forEach(function(Ee){var Ki=Ee.options,Zt=Ee.effect;if("function"==typeof Zt){var Ni=Zt({state:Ht,name:Ee.name,instance:Ge,options:void 0===Ki?{}:Ki});Ne.push(Ni||function(){})}}),Ge.update()},forceUpdate:function(){if(!Re){var ii=Ht.elements,tn=ii.reference,Xi=ii.popper;if(Un(tn,Xi)){Ht.rects={reference:rr(tn,Ft(Xi),"fixed"===Ht.options.strategy),popper:et(Xi)},Ht.reset=!1,Ht.placement=Ht.options.placement,Ht.orderedModifiers.forEach(function(Zt){return Ht.modifiersData[Zt.name]=Object.assign({},Zt.data)});for(var ui=0;ui<Ht.orderedModifiers.length;ui++)if(!0!==Ht.reset){var mi=Ht.orderedModifiers[ui],Ee=mi.fn,_i=mi.options;"function"==typeof Ee&&(Ht=Ee({state:Ht,options:void 0===_i?{}:_i,name:mi.name,instance:Ge})||Ht)}else Ht.reset=!1,ui=-1}}},update:(de=function(){return new Promise(function(ii){Ge.forceUpdate(),ii(Ht)})},function(){return Gt||(Gt=new Promise(function(ii){Promise.resolve().then(function(){Gt=void 0,ii(de())})})),Gt}),destroy:function(){Ve(),Re=!0}};if(!Un(wt,Ut))return Ge;function Ve(){Ne.forEach(function(ii){return ii()}),Ne=[]}return Ge.setOptions(ie).then(function(ii){!Re&&ie.onFirstUpdate&&ie.onFirstUpdate(ii)}),Ge}}var pr=Jr(),oa=Jr({defaultModifiers:[ti,wr,Be,z]}),Aa=Jr({defaultModifiers:[ti,wr,Be,z,ro,In,Pa,ze,Gi]});const aa=Object.freeze(Object.defineProperty({__proto__:null,popperGenerator:Jr,detectOverflow:Zi,createPopperBase:pr,createPopper:Aa,createPopperLite:oa,top:En,bottom:Pi,right:Hi,left:Fi,auto:io,basePlacements:no,start:x,end:S,clippingParents:D,viewport:W,popper:tt,reference:ht,variationPlacements:Lt,placements:Jt,beforeRead:ue,read:"read",afterRead:Di,beforeMain:Qi,main:"main",afterMain:ir,beforeWrite:Pn,write:"write",afterWrite:Ti,modifierPhases:Mr,applyStyles:z,arrow:ze,computeStyles:Be,eventListeners:ti,flip:In,hide:Gi,offset:ro,popperOffsets:wr,preventOverflow:Pa},Symbol.toStringTag,{value:"Module"})),Oo="dropdown",as="ArrowUp",Wa="ArrowDown",Ps="click.bs.dropdown.data-api",Ia="keydown.bs.dropdown.data-api",Xn="show",dr='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',So=`${dr}.show`,oo=".dropdown-menu",Ca=ur()?"top-end":"top-start",Ha=ur()?"top-start":"top-end",Dr=ur()?"bottom-end":"bottom-start",Or=ur()?"bottom-start":"bottom-end",Eo=ur()?"left-start":"right-start",Ho=ur()?"right-start":"left-start",Tr={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},ao={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Sn extends Mi{constructor(y,P){super(y,P),this._popper=null,this._parent=this._element.parentNode,this._menu=qe.next(this._element,oo)[0]||qe.prev(this._element,oo)[0]||qe.findOne(oo,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Tr}static get DefaultType(){return ao}static get NAME(){return Oo}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Lr(this._element)||this._isShown())return;const y={relatedTarget:this._element};if(!Ct.trigger(this._element,"show.bs.dropdown",y).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const P of[].concat(...document.body.children))Ct.on(P,"mouseover",zr);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Xn),this._element.classList.add(Xn),Ct.trigger(this._element,"shown.bs.dropdown",y)}}hide(){!Lr(this._element)&&this._isShown()&&this._completeHide({relatedTarget:this._element})}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(y){if(!Ct.trigger(this._element,"hide.bs.dropdown",y).defaultPrevented){if("ontouchstart"in document.documentElement)for(const P of[].concat(...document.body.children))Ct.off(P,"mouseover",zr);this._popper&&this._popper.destroy(),this._menu.classList.remove(Xn),this._element.classList.remove(Xn),this._element.setAttribute("aria-expanded","false"),qi.removeDataAttribute(this._menu,"popper"),Ct.trigger(this._element,"hidden.bs.dropdown",y)}}_getConfig(y){if("object"==typeof(y=super._getConfig(y)).reference&&!lr(y.reference)&&"function"!=typeof y.reference.getBoundingClientRect)throw new TypeError(`${Oo.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return y}_createPopper(){if(void 0===aa)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let y=this._element;"parent"===this._config.reference?y=this._parent:lr(this._config.reference)?y=ni(this._config.reference):"object"==typeof this._config.reference&&(y=this._config.reference);const P=this._getPopperConfig();this._popper=Aa(y,this._menu,P)}_isShown(){return this._menu.classList.contains(Xn)}_getPlacement(){const y=this._parent;if(y.classList.contains("dropend"))return Eo;if(y.classList.contains("dropstart"))return Ho;if(y.classList.contains("dropup-center"))return"top";if(y.classList.contains("dropdown-center"))return"bottom";const P="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return y.classList.contains("dropup")?P?Ha:Ca:P?Or:Dr}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:y}=this._config;return"string"==typeof y?y.split(",").map(P=>Number.parseInt(P,10)):"function"==typeof y?P=>y(P,this._element):y}_getPopperConfig(){const y={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(qi.setDataAttribute(this._menu,"popper","static"),y.modifiers=[{name:"applyStyles",enabled:!1}]),{...y,..."function"==typeof this._config.popperConfig?this._config.popperConfig(y):this._config.popperConfig}}_selectMenuItem({key:y,target:P}){const H=qe.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(mt=>Go(mt));H.length&&Me(H,P,y===Wa,!H.includes(P)).focus()}static jQueryInterface(y){return this.each(function(){const P=Sn.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===P[y])throw new TypeError(`No method named "${y}"`);P[y]()}})}static clearMenus(y){if(2===y.button||"keyup"===y.type&&"Tab"!==y.key)return;const P=qe.find(So);for(const H of P){const mt=Sn.getInstance(H);if(!mt||!1===mt._config.autoClose)continue;const _t=y.composedPath(),wt=_t.includes(mt._menu);if(_t.includes(mt._element)||"inside"===mt._config.autoClose&&!wt||"outside"===mt._config.autoClose&&wt||mt._menu.contains(y.target)&&("keyup"===y.type&&"Tab"===y.key||/input|select|option|textarea|form/i.test(y.target.tagName)))continue;const Ut={relatedTarget:mt._element};"click"===y.type&&(Ut.clickEvent=y),mt._completeHide(Ut)}}static dataApiKeydownHandler(y){const P=/input|textarea/i.test(y.target.tagName),H="Escape"===y.key,mt=[as,Wa].includes(y.key);if(!mt&&!H||P&&!H)return;y.preventDefault();const _t=this.matches(dr)?this:qe.prev(this,dr)[0]||qe.next(this,dr)[0]||qe.findOne(dr,y.delegateTarget.parentNode),wt=Sn.getOrCreateInstance(_t);if(mt)return y.stopPropagation(),wt.show(),void wt._selectMenuItem(y);wt._isShown()&&(y.stopPropagation(),wt.hide(),_t.focus())}}Ct.on(document,Ia,dr,Sn.dataApiKeydownHandler),Ct.on(document,Ia,oo,Sn.dataApiKeydownHandler),Ct.on(document,Ps,Sn.clearMenus),Ct.on(document,"keyup.bs.dropdown.data-api",Sn.clearMenus),Ct.on(document,Ps,dr,function(R){R.preventDefault(),Sn.getOrCreateInstance(this).toggle()}),Mn(Sn);const or=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",cn=".sticky-top",Po="padding-right",La="margin-right";class Xa{constructor(){this._element=document.body}getWidth(){const y=document.documentElement.clientWidth;return Math.abs(window.innerWidth-y)}hide(){const y=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Po,P=>P+y),this._setElementAttributes(or,Po,P=>P+y),this._setElementAttributes(cn,La,P=>P-y)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Po),this._resetElementAttributes(or,Po),this._resetElementAttributes(cn,La)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(y,P,H){const mt=this.getWidth();this._applyManipulationCallback(y,_t=>{if(_t!==this._element&&window.innerWidth>_t.clientWidth+mt)return;this._saveInitialAttribute(_t,P);const wt=window.getComputedStyle(_t).getPropertyValue(P);_t.style.setProperty(P,`${H(Number.parseFloat(wt))}px`)})}_saveInitialAttribute(y,P){const H=y.style.getPropertyValue(P);H&&qi.setDataAttribute(y,P,H)}_resetElementAttributes(y,P){this._applyManipulationCallback(y,H=>{const mt=qi.getDataAttribute(H,P);null!==mt?(qi.removeDataAttribute(H,P),H.style.setProperty(P,mt)):H.style.removeProperty(P)})}_applyManipulationCallback(y,P){if(lr(y))P(y);else for(const H of qe.find(y,this._element))P(H)}}const Xo="mousedown.bs.backdrop",za={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},ss={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class va extends ki{constructor(y){super(),this._config=this._getConfig(y),this._isAppended=!1,this._element=null}static get Default(){return za}static get DefaultType(){return ss}static get NAME(){return"backdrop"}show(y){if(!this._config.isVisible)return void Bt(y);this._append();this._getElement().classList.add("show"),this._emulateAnimation(()=>{Bt(y)})}hide(y){this._config.isVisible?(this._getElement().classList.remove("show"),this._emulateAnimation(()=>{this.dispose(),Bt(y)})):Bt(y)}dispose(){this._isAppended&&(Ct.off(this._element,Xo),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const y=document.createElement("div");y.className=this._config.className,this._config.isAnimated&&y.classList.add("fade"),this._element=y}return this._element}_configAfterMerge(y){return y.rootElement=ni(y.rootElement),y}_append(){if(this._isAppended)return;const y=this._getElement();this._config.rootElement.append(y),Ct.on(y,Xo,()=>{Bt(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(y){ee(y,this._getElement(),this._config.isAnimated)}}const ka=".bs.focustrap",ls="backward",Ns={autofocus:!0,trapElement:null},Yr={autofocus:"boolean",trapElement:"element"};class Ko extends ki{constructor(y){super(),this._config=this._getConfig(y),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ns}static get DefaultType(){return Yr}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Ct.off(document,ka),Ct.on(document,"focusin.bs.focustrap",y=>this._handleFocusin(y)),Ct.on(document,"keydown.tab.bs.focustrap",y=>this._handleKeydown(y)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Ct.off(document,ka))}_handleFocusin(y){const{trapElement:P}=this._config;if(y.target===document||y.target===P||P.contains(y.target))return;const H=qe.focusableChildren(P);0===H.length?P.focus():this._lastTabNavDirection===ls?H[H.length-1].focus():H[0].focus()}_handleKeydown(y){"Tab"===y.key&&(this._lastTabNavDirection=y.shiftKey?ls:"forward")}}const Ma="hidden.bs.modal",Nn="show.bs.modal",sa="modal-open",Ao="modal-static",la={backdrop:!0,focus:!0,keyboard:!0},Br={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Rr extends Mi{constructor(y,P){super(y,P),this._dialog=qe.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Xa,this._addEventListeners()}static get Default(){return la}static get DefaultType(){return Br}static get NAME(){return"modal"}toggle(y){return this._isShown?this.hide():this.show(y)}show(y){this._isShown||this._isTransitioning||Ct.trigger(this._element,Nn,{relatedTarget:y}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(sa),this._adjustDialog(),this._backdrop.show(()=>this._showElement(y)))}hide(){this._isShown&&!this._isTransitioning&&(Ct.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove("show"),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){for(const y of[window,this._dialog])Ct.off(y,".bs.modal");this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new va({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Ko({trapElement:this._element})}_showElement(y){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const P=qe.findOne(".modal-body",this._dialog);P&&(P.scrollTop=0),this._element.classList.add("show"),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Ct.trigger(this._element,"shown.bs.modal",{relatedTarget:y})},this._dialog,this._isAnimated())}_addEventListeners(){Ct.on(this._element,"keydown.dismiss.bs.modal",y=>{if("Escape"===y.key)return this._config.keyboard?(y.preventDefault(),void this.hide()):void this._triggerBackdropTransition()}),Ct.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Ct.on(this._element,"mousedown.dismiss.bs.modal",y=>{Ct.one(this._element,"click.dismiss.bs.modal",P=>{this._element===y.target&&this._element===P.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(sa),this._resetAdjustments(),this._scrollBar.reset(),Ct.trigger(this._element,Ma)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(Ct.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const y=this._element.scrollHeight>document.documentElement.clientHeight,P=this._element.style.overflowY;"hidden"===P||this._element.classList.contains(Ao)||(y||(this._element.style.overflowY="hidden"),this._element.classList.add(Ao),this._queueCallback(()=>{this._element.classList.remove(Ao),this._queueCallback(()=>{this._element.style.overflowY=P},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const y=this._element.scrollHeight>document.documentElement.clientHeight,P=this._scrollBar.getWidth(),H=P>0;if(H&&!y){const mt=ur()?"paddingLeft":"paddingRight";this._element.style[mt]=`${P}px`}if(!H&&y){const mt=ur()?"paddingRight":"paddingLeft";this._element.style[mt]=`${P}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(y,P){return this.each(function(){const H=Rr.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===H[y])throw new TypeError(`No method named "${y}"`);H[y](P)}})}}Ct.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(R){const y=eo(this);["A","AREA"].includes(this.tagName)&&R.preventDefault(),Ct.one(y,Nn,H=>{H.defaultPrevented||Ct.one(y,Ma,()=>{Go(this)&&this.focus()})});const P=qe.findOne(".modal.show");P&&Rr.getInstance(P).hide(),Rr.getOrCreateInstance(y).toggle(this)}),Gn(Rr),Mn(Rr);const yo="showing",Da=".offcanvas.show",xa="hidePrevented.bs.offcanvas",Ii="hidden.bs.offcanvas",js={backdrop:!0,keyboard:!0,scroll:!1},go={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class lo extends Mi{constructor(y,P){super(y,P),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return js}static get DefaultType(){return go}static get NAME(){return"offcanvas"}toggle(y){return this._isShown?this.hide():this.show(y)}show(y){this._isShown||Ct.trigger(this._element,"show.bs.offcanvas",{relatedTarget:y}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new Xa).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(yo),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add("show"),this._element.classList.remove(yo),Ct.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:y})},this._element,!0))}hide(){this._isShown&&(Ct.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add("hiding"),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove("show","hiding"),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new Xa).reset(),Ct.trigger(this._element,Ii)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const y=Boolean(this._config.backdrop);return new va({className:"offcanvas-backdrop",isVisible:y,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:y?()=>{"static"!==this._config.backdrop?this.hide():Ct.trigger(this._element,xa)}:null})}_initializeFocusTrap(){return new Ko({trapElement:this._element})}_addEventListeners(){Ct.on(this._element,"keydown.dismiss.bs.offcanvas",y=>{"Escape"===y.key&&(this._config.keyboard?this.hide():Ct.trigger(this._element,xa))})}static jQueryInterface(y){return this.each(function(){const P=lo.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===P[y]||y.startsWith("_")||"constructor"===y)throw new TypeError(`No method named "${y}"`);P[y](this)}})}}Ct.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(R){const y=eo(this);if(["A","AREA"].includes(this.tagName)&&R.preventDefault(),Lr(this))return;Ct.one(y,Ii,()=>{Go(this)&&this.focus()});const P=qe.findOne(Da);P&&P!==y&&lo.getInstance(P).hide(),lo.getOrCreateInstance(y).toggle(this)}),Ct.on(window,"load.bs.offcanvas.data-api",()=>{for(const R of qe.find(Da))lo.getOrCreateInstance(R).show()}),Ct.on(window,"resize.bs.offcanvas",()=>{for(const R of qe.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(R).position&&lo.getOrCreateInstance(R).hide()}),Gn(lo),Mn(lo);const Yo=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Ja=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,Ya=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,Io=(R,y)=>{const P=R.nodeName.toLowerCase();return y.includes(P)?!Yo.has(P)||Boolean(Ja.test(R.nodeValue)||Ya.test(R.nodeValue)):y.filter(H=>H instanceof RegExp).some(H=>H.test(P))},uo={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},ba={allowList:uo,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},r={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},u={entry:"(string|element|function|null)",selector:"(string|element)"};class m extends ki{constructor(y){super(),this._config=this._getConfig(y)}static get Default(){return ba}static get DefaultType(){return r}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(y=>this._resolvePossibleFunction(y)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(y){return this._checkContent(y),this._config.content={...this._config.content,...y},this}toHtml(){const y=document.createElement("div");y.innerHTML=this._maybeSanitize(this._config.template);for(const[mt,_t]of Object.entries(this._config.content))this._setContent(y,_t,mt);const P=y.children[0],H=this._resolvePossibleFunction(this._config.extraClass);return H&&P.classList.add(...H.split(" ")),P}_typeCheckConfig(y){super._typeCheckConfig(y),this._checkContent(y.content)}_checkContent(y){for(const[P,H]of Object.entries(y))super._typeCheckConfig({selector:P,entry:H},u)}_setContent(y,P,H){const mt=qe.findOne(H,y);mt&&((P=this._resolvePossibleFunction(P))?lr(P)?this._putElementInTemplate(ni(P),mt):this._config.html?mt.innerHTML=this._maybeSanitize(P):mt.textContent=P:mt.remove())}_maybeSanitize(y){return this._config.sanitize?function(P,H,mt){if(!P.length)return P;if(mt&&"function"==typeof mt)return mt(P);const _t=(new window.DOMParser).parseFromString(P,"text/html"),wt=[].concat(..._t.body.querySelectorAll("*"));for(const Ut of wt){const ie=Ut.nodeName.toLowerCase();if(!Object.keys(H).includes(ie)){Ut.remove();continue}const de=[].concat(...Ut.attributes),Gt=[].concat(H["*"]||[],H[ie]||[]);for(const Ht of de)Io(Ht,Gt)||Ut.removeAttribute(Ht.nodeName)}return _t.body.innerHTML}(y,this._config.allowList,this._config.sanitizeFn):y}_resolvePossibleFunction(y){return"function"==typeof y?y(this):y}_putElementInTemplate(y,P){if(this._config.html)return P.innerHTML="",void P.append(y);P.textContent=y.textContent}}const b=new Set(["sanitize","allowList","sanitizeFn"]),A="fade",V="show",ut="hide.bs.modal",Dt="hover",ye={AUTO:"auto",TOP:"top",RIGHT:ur()?"left":"right",BOTTOM:"bottom",LEFT:ur()?"right":"left"},li={allowList:uo,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Ui={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class _n extends Mi{constructor(y,P){if(void 0===aa)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(y,P),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return li}static get DefaultType(){return Ui}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),Ct.off(this._element.closest(".modal"),ut,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const y=Ct.trigger(this._element,this.constructor.eventName("show")),P=(sn(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(y.defaultPrevented||!P)return;this._disposePopper();const H=this._getTipElement();this._element.setAttribute("aria-describedby",H.getAttribute("id"));const{container:mt}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(mt.append(H),Ct.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(H),H.classList.add(V),"ontouchstart"in document.documentElement)for(const _t of[].concat(...document.body.children))Ct.on(_t,"mouseover",zr);this._queueCallback(()=>{Ct.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!Ct.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(V),"ontouchstart"in document.documentElement)for(const y of[].concat(...document.body.children))Ct.off(y,"mouseover",zr);this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Ct.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(y){const P=this._getTemplateFactory(y).toHtml();if(!P)return null;P.classList.remove(A,V),P.classList.add(`bs-${this.constructor.NAME}-auto`);const H=(mt=>{do{mt+=Math.floor(1e6*Math.random())}while(document.getElementById(mt));return mt})(this.constructor.NAME).toString();return P.setAttribute("id",H),this._isAnimated()&&P.classList.add(A),P}setContent(y){this._newContent=y,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(y){return this._templateFactory?this._templateFactory.changeContent(y):this._templateFactory=new m({...this._config,content:y,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(y){return this.constructor.getOrCreateInstance(y.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(A)}_isShown(){return this.tip&&this.tip.classList.contains(V)}_createPopper(y){const P="function"==typeof this._config.placement?this._config.placement.call(this,y,this._element):this._config.placement,H=ye[P.toUpperCase()];return Aa(this._element,y,this._getPopperConfig(H))}_getOffset(){const{offset:y}=this._config;return"string"==typeof y?y.split(",").map(P=>Number.parseInt(P,10)):"function"==typeof y?P=>y(P,this._element):y}_resolvePossibleFunction(y){return"function"==typeof y?y.call(this._element):y}_getPopperConfig(y){const P={placement:y,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:H=>{this._getTipElement().setAttribute("data-popper-placement",H.state.placement)}}]};return{...P,..."function"==typeof this._config.popperConfig?this._config.popperConfig(P):this._config.popperConfig}}_setListeners(){const y=this._config.trigger.split(" ");for(const P of y)if("click"===P)Ct.on(this._element,this.constructor.eventName("click"),this._config.selector,H=>{this._initializeOnDelegatedTarget(H).toggle()});else if("manual"!==P){const H=this.constructor.eventName(P===Dt?"mouseenter":"focusin"),mt=this.constructor.eventName(P===Dt?"mouseleave":"focusout");Ct.on(this._element,H,this._config.selector,_t=>{const wt=this._initializeOnDelegatedTarget(_t);wt._activeTrigger["focusin"===_t.type?"focus":Dt]=!0,wt._enter()}),Ct.on(this._element,mt,this._config.selector,_t=>{const wt=this._initializeOnDelegatedTarget(_t);wt._activeTrigger["focusout"===_t.type?"focus":Dt]=wt._element.contains(_t.relatedTarget),wt._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Ct.on(this._element.closest(".modal"),ut,this._hideModalHandler)}_fixTitle(){const y=this._element.getAttribute("title");y&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",y),this._element.setAttribute("data-bs-original-title",y),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(y,P){clearTimeout(this._timeout),this._timeout=setTimeout(y,P)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(y){const P=qi.getDataAttributes(this._element);for(const H of Object.keys(P))b.has(H)&&delete P[H];return y={...P,..."object"==typeof y&&y?y:{}},y=this._mergeConfigObj(y),y=this._configAfterMerge(y),this._typeCheckConfig(y),y}_configAfterMerge(y){return y.container=!1===y.container?document.body:ni(y.container),"number"==typeof y.delay&&(y.delay={show:y.delay,hide:y.delay}),"number"==typeof y.title&&(y.title=y.title.toString()),"number"==typeof y.content&&(y.content=y.content.toString()),y}_getDelegateConfig(){const y={};for(const P in this._config)this.constructor.Default[P]!==this._config[P]&&(y[P]=this._config[P]);return y.selector=!1,y.trigger="manual",y}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(y){return this.each(function(){const P=_n.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===P[y])throw new TypeError(`No method named "${y}"`);P[y]()}})}}Mn(_n);const Bo={..._n.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Sr={..._n.DefaultType,content:"(null|string|element|function)"};class Kn extends _n{static get Default(){return Bo}static get DefaultType(){return Sr}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(y){return this.each(function(){const P=Kn.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===P[y])throw new TypeError(`No method named "${y}"`);P[y]()}})}}Mn(Kn);const wa="click.bs.scrollspy",Ro="active",on={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},$o={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Ta extends Mi{constructor(y,P){super(y,P),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return on}static get DefaultType(){return $o}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const y of this._observableSections.values())this._observer.observe(y)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(y){return y.target=ni(y.target)||document.body,y.rootMargin=y.offset?`${y.offset}px 0px -30%`:y.rootMargin,"string"==typeof y.threshold&&(y.threshold=y.threshold.split(",").map(P=>Number.parseFloat(P))),y}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Ct.off(this._config.target,wa),Ct.on(this._config.target,wa,"[href]",y=>{const P=this._observableSections.get(y.target.hash);if(P){y.preventDefault();const H=this._rootElement||window,mt=P.offsetTop-this._element.offsetTop;if(H.scrollTo)return void H.scrollTo({top:mt,behavior:"smooth"});H.scrollTop=mt}}))}_getNewObserver(){return new IntersectionObserver(P=>this._observerCallback(P),{root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin})}_observerCallback(y){const P=wt=>this._targetLinks.get(`#${wt.target.id}`),H=wt=>{this._previousScrollData.visibleEntryTop=wt.target.offsetTop,this._process(P(wt))},mt=(this._rootElement||document.documentElement).scrollTop,_t=mt>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=mt;for(const wt of y){if(!wt.isIntersecting){this._activeTarget=null,this._clearActiveClass(P(wt));continue}const Ut=wt.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(_t&&Ut){if(H(wt),!mt)return}else _t||Ut||H(wt)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const y=qe.find("[href]",this._config.target);for(const P of y){if(!P.hash||Lr(P))continue;const H=qe.findOne(P.hash,this._element);Go(H)&&(this._targetLinks.set(P.hash,P),this._observableSections.set(P.hash,H))}}_process(y){this._activeTarget!==y&&(this._clearActiveClass(this._config.target),this._activeTarget=y,y.classList.add(Ro),this._activateParents(y),Ct.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:y}))}_activateParents(y){if(y.classList.contains("dropdown-item"))qe.findOne(".dropdown-toggle",y.closest(".dropdown")).classList.add(Ro);else for(const P of qe.parents(y,".nav, .list-group"))for(const H of qe.prev(P,".nav-link, .nav-item > .nav-link, .list-group-item"))H.classList.add(Ro)}_clearActiveClass(y){y.classList.remove(Ro);const P=qe.find("[href].active",y);for(const H of P)H.classList.remove(Ro)}static jQueryInterface(y){return this.each(function(){const P=Ta.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===P[y]||y.startsWith("_")||"constructor"===y)throw new TypeError(`No method named "${y}"`);P[y]()}})}}Ct.on(window,"load.bs.scrollspy.data-api",()=>{for(const R of qe.find('[data-bs-spy="scroll"]'))Ta.getOrCreateInstance(R)}),Mn(Ta);const us="ArrowLeft",Fo="ArrowRight",_l="ArrowUp",Qs="ArrowDown",As="active",Qa="show",Is='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Cs=`.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), ${Is}`;class ua extends Mi{constructor(y){super(y),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Ct.on(this._element,"keydown.bs.tab",P=>this._keydown(P)))}static get NAME(){return"tab"}show(){const y=this._element;if(this._elemIsActive(y))return;const P=this._getActiveElem(),H=P?Ct.trigger(P,"hide.bs.tab",{relatedTarget:y}):null;Ct.trigger(y,"show.bs.tab",{relatedTarget:P}).defaultPrevented||H&&H.defaultPrevented||(this._deactivate(P,y),this._activate(y,P))}_activate(y,P){y&&(y.classList.add(As),this._activate(eo(y)),this._queueCallback(()=>{"tab"===y.getAttribute("role")?(y.removeAttribute("tabindex"),y.setAttribute("aria-selected",!0),this._toggleDropDown(y,!0),Ct.trigger(y,"shown.bs.tab",{relatedTarget:P})):y.classList.add(Qa)},y,y.classList.contains("fade")))}_deactivate(y,P){y&&(y.classList.remove(As),y.blur(),this._deactivate(eo(y)),this._queueCallback(()=>{"tab"===y.getAttribute("role")?(y.setAttribute("aria-selected",!1),y.setAttribute("tabindex","-1"),this._toggleDropDown(y,!1),Ct.trigger(y,"hidden.bs.tab",{relatedTarget:P})):y.classList.remove(Qa)},y,y.classList.contains("fade")))}_keydown(y){if(![us,Fo,_l,Qs].includes(y.key))return;y.stopPropagation(),y.preventDefault();const P=[Fo,Qs].includes(y.key),H=Me(this._getChildren().filter(mt=>!Lr(mt)),y.target,P,!0);H&&(H.focus({preventScroll:!0}),ua.getOrCreateInstance(H).show())}_getChildren(){return qe.find(Cs,this._parent)}_getActiveElem(){return this._getChildren().find(y=>this._elemIsActive(y))||null}_setInitialAttributes(y,P){this._setAttributeIfNotExists(y,"role","tablist");for(const H of P)this._setInitialAttributesOnChild(H)}_setInitialAttributesOnChild(y){y=this._getInnerElement(y);const P=this._elemIsActive(y),H=this._getOuterElement(y);y.setAttribute("aria-selected",P),H!==y&&this._setAttributeIfNotExists(H,"role","presentation"),P||y.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(y,"role","tab"),this._setInitialAttributesOnTargetPanel(y)}_setInitialAttributesOnTargetPanel(y){const P=eo(y);P&&(this._setAttributeIfNotExists(P,"role","tabpanel"),y.id&&this._setAttributeIfNotExists(P,"aria-labelledby",`#${y.id}`))}_toggleDropDown(y,P){const H=this._getOuterElement(y);if(!H.classList.contains("dropdown"))return;const mt=(_t,wt)=>{const Ut=qe.findOne(_t,H);Ut&&Ut.classList.toggle(wt,P)};mt(".dropdown-toggle",As),mt(".dropdown-menu",Qa),H.setAttribute("aria-expanded",P)}_setAttributeIfNotExists(y,P,H){y.hasAttribute(P)||y.setAttribute(P,H)}_elemIsActive(y){return y.classList.contains(As)}_getInnerElement(y){return y.matches(Cs)?y:qe.findOne(Cs,y)}_getOuterElement(y){return y.closest(".nav-item, .list-group-item")||y}static jQueryInterface(y){return this.each(function(){const P=ua.getOrCreateInstance(this);if("string"==typeof y){if(void 0===P[y]||y.startsWith("_")||"constructor"===y)throw new TypeError(`No method named "${y}"`);P[y]()}})}}Ct.on(document,"click.bs.tab",Is,function(R){["A","AREA"].includes(this.tagName)&&R.preventDefault(),Lr(this)||ua.getOrCreateInstance(this).show()}),Ct.on(window,"load.bs.tab",()=>{for(const R of qe.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))ua.getOrCreateInstance(R)}),Mn(ua);const ts="show",hs="showing",gl={animation:"boolean",autohide:"boolean",delay:"number"},vl={animation:!0,autohide:!0,delay:5e3};class Ba extends Mi{constructor(y,P){super(y,P),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return vl}static get DefaultType(){return gl}static get NAME(){return"toast"}show(){Ct.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),this._element.classList.add(ts,hs),this._queueCallback(()=>{this._element.classList.remove(hs),Ct.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(Ct.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(hs),this._queueCallback(()=>{this._element.classList.add("hide"),this._element.classList.remove(hs,ts),Ct.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ts),super.dispose()}isShown(){return this._element.classList.contains(ts)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(y,P){switch(y.type){case"mouseover":case"mouseout":this._hasMouseInteraction=P;break;case"focusin":case"focusout":this._hasKeyboardInteraction=P}if(P)return void this._clearTimeout();const H=y.relatedTarget;this._element===H||this._element.contains(H)||this._maybeScheduleHide()}_setListeners(){Ct.on(this._element,"mouseover.bs.toast",y=>this._onInteraction(y,!0)),Ct.on(this._element,"mouseout.bs.toast",y=>this._onInteraction(y,!1)),Ct.on(this._element,"focusin.bs.toast",y=>this._onInteraction(y,!0)),Ct.on(this._element,"focusout.bs.toast",y=>this._onInteraction(y,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(y){return this.each(function(){const P=Ba.getOrCreateInstance(this,y);if("string"==typeof y){if(void 0===P[y])throw new TypeError(`No method named "${y}"`);P[y](this)}})}}return Gn(Ba),Mn(Ba),{Alert:Wn,Button:un,Carousel:ei,Collapse:Tn,Dropdown:Sn,Modal:Rr,Offcanvas:lo,Popover:Kn,ScrollSpy:Ta,Tab:ua,Toast:Ba,Tooltip:_n}}),function(At,dt){"object"==typeof exports&&typeof module<"u"?dt(exports):"function"==typeof define&&define.amd?define(["exports"],dt):dt((At=typeof globalThis<"u"?globalThis:At||self).leaflet={})}(this,function(At){"use strict";function dt(r){for(var u,m,b=1,A=arguments.length;b<A;b++)for(u in m=arguments[b])r[u]=m[u];return r}var qr=Object.create||function(r){return eo.prototype=r,new eo};function eo(){}function Ei(r,u){var m,b=Array.prototype.slice;return r.bind?r.bind.apply(r,b.call(arguments,1)):(m=b.call(arguments,2),function(){return r.apply(u,m.length?m.concat(b.call(arguments)):arguments)})}var lr=0;function ni(r){return"_leaflet_id"in r||(r._leaflet_id=++lr),r._leaflet_id}function Go(r,u,m){var b,A,V=function(){b=!1,A&&(ct.apply(m,A),A=!1)},ct=function(){b?A=arguments:(r.apply(m,arguments),setTimeout(V,u),b=!0)};return ct}function Lr(r,A,m){var b=A[1],V=b-(A=A[0]);return r===b&&m?r:((r-A)%V+V)%V+A}function sn(){return!1}function zr(r,u){return!1===u?r:(u=Math.pow(10,void 0===u?6:u),Math.round(r*u)/u)}function Wo(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function Do(r){return Wo(r).split(/\s+/)}function Vi(r,u){for(var m in Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?qr(r.options):{}),u)r.options[m]=u[m];return r.options}function ur(r,u,m){var b,A=[];for(b in r)A.push(encodeURIComponent(m?b.toUpperCase():b)+"="+encodeURIComponent(r[b]));return(u&&-1!==u.indexOf("?")?"&":"?")+A.join("&")}var Mn=/\{ *([\w_ -]+) *\}/g;function Bt(r,u){return r.replace(Mn,function(m,b){if(void 0===(b=u[b]))throw new Error("No value provided for variable "+m);return"function"==typeof b?b(u):b})}var ee=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};function Me(r,u){for(var m=0;m<r.length;m++)if(r[m]===u)return m;return-1}var Te="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function zi(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var wn=0;function c(r){var u=+new Date,m=Math.max(0,16-(u-wn));return wn=u+m,window.setTimeout(r,m)}var gi=window.requestAnimationFrame||zi("RequestAnimationFrame")||c,Mt=window.cancelAnimationFrame||zi("CancelAnimationFrame")||zi("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function Ue(r,u,m){if(!m||gi!==c)return gi.call(window,Ei(r,u));r.call(u)}function le(r){r&&Mt.call(window,r)}var en={__proto__:null,extend:dt,create:qr,bind:Ei,get lastId(){return lr},stamp:ni,throttle:Go,wrapNum:Lr,falseFn:sn,formatNum:zr,trim:Wo,splitWords:Do,setOptions:Vi,getParamString:ur,template:Bt,isArray:ee,indexOf:Me,emptyImageUrl:Te,requestFn:gi,cancelFn:Mt,requestAnimFrame:Ue,cancelAnimFrame:le};function Nt(){}Nt.extend=function(r){function u(){Vi(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()}var m,b=u.__super__=this.prototype,A=qr(b);for(m in(A.constructor=u).prototype=A,this)Object.prototype.hasOwnProperty.call(this,m)&&"prototype"!==m&&"__super__"!==m&&(u[m]=this[m]);if(r.statics&&dt(u,r.statics),r.includes){var V=r.includes;if(typeof L<"u"&&L&&L.Mixin){V=ee(V)?V:[V];for(var ct=0;ct<V.length;ct++)V[ct]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}dt.apply(null,[A].concat(r.includes))}return dt(A,r),delete A.statics,delete A.includes,A.options&&(A.options=b.options?qr(b.options):{},dt(A.options,r.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){b.callInitHooks&&b.callInitHooks.call(this),this._initHooksCalled=!0;for(var ut=0,Dt=A._initHooks.length;ut<Dt;ut++)A._initHooks[ut].call(this)}},u},Nt.include=function(r){var u=this.prototype.options;return dt(this.prototype,r),r.options&&(this.prototype.options=u,this.mergeOptions(r.options)),this},Nt.mergeOptions=function(r){return dt(this.prototype.options,r),this},Nt.addInitHook=function(r){var u=Array.prototype.slice.call(arguments,1),m="function"==typeof r?r:function(){this[r].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(m),this};var dn={on:function(r,u,m){if("object"==typeof r)for(var b in r)this._on(b,r[b],u);else for(var A=0,V=(r=Do(r)).length;A<V;A++)this._on(r[A],u,m);return this},off:function(r,u,m){if(arguments.length)if("object"==typeof r)for(var b in r)this._off(b,r[b],u);else{r=Do(r);for(var A=1===arguments.length,V=0,ct=r.length;V<ct;V++)A?this._off(r[V]):this._off(r[V],u,m)}else delete this._events;return this},_on:function(r,u,m,b){"function"!=typeof u?console.warn("wrong listener type: "+typeof u):!1===this._listens(r,u,m)&&(u={fn:u,ctx:m=m===this?void 0:m},b&&(u.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(u))},_off:function(r,u,m){var b,A,V;if(this._events&&(b=this._events[r]))if(1===arguments.length){if(this._firingCount)for(A=0,V=b.length;A<V;A++)b[A].fn=sn;delete this._events[r]}else"function"!=typeof u?console.warn("wrong listener type: "+typeof u):!1!==(u=this._listens(r,u,m))&&(m=b[u],this._firingCount&&(m.fn=sn,this._events[r]=b=b.slice()),b.splice(u,1))},fire:function(r,u,m){if(this.listens(r,m)){var b=dt({},u,{type:r,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var A=this._events[r];if(A){this._firingCount=this._firingCount+1||1;for(var V=0,ct=A.length;V<ct;V++){var ut=A[V],Dt=ut.fn;ut.once&&this.off(r,Dt,ut.ctx),Dt.call(ut.ctx||this,b)}this._firingCount--}}m&&this._propagateEvent(b)}return this},listens:function(r,u,m,b){"string"!=typeof r&&console.warn('"string" type argument expected');var A=u,V=("function"!=typeof u&&(b=!!u,m=A=void 0),this._events&&this._events[r]);if(V&&V.length&&!1!==this._listens(r,A,m))return!0;if(b)for(var ct in this._eventParents)if(this._eventParents[ct].listens(r,u,m,b))return!0;return!1},_listens:function(r,u,m){if(this._events){var b=this._events[r]||[];if(!u)return!!b.length;m===this&&(m=void 0);for(var A=0,V=b.length;A<V;A++)if(b[A].fn===u&&b[A].ctx===m)return A}return!1},once:function(r,u,m){if("object"==typeof r)for(var b in r)this._on(b,r[b],u,!0);else for(var A=0,V=(r=Do(r)).length;A<V;A++)this._on(r[A],u,m,!0);return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[ni(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[ni(r)],this},_propagateEvent:function(r){for(var u in this._eventParents)this._eventParents[u].fire(r.type,dt({layer:r.target,propagatedFrom:r.target},r),!0)}},nn=(dn.addEventListener=dn.on,dn.removeEventListener=dn.clearAllEventListeners=dn.off,dn.addOneTimeEventListener=dn.once,dn.fireEvent=dn.fire,dn.hasEventListeners=dn.listens,Nt.extend(dn));function Se(r,u,m){this.x=m?Math.round(r):r,this.y=m?Math.round(u):u}var er=Math.trunc||function(r){return 0<r?Math.floor(r):Math.ceil(r)};function Oe(r,u,m){return r instanceof Se?r:ee(r)?new Se(r[0],r[1]):null==r?r:"object"==typeof r&&"x"in r&&"y"in r?new Se(r.x,r.y):new Se(r,u,m)}function Ct(r,u){if(r)for(var m=u?[r,u]:r,b=0,A=m.length;b<A;b++)this.extend(m[b])}function ln(r,u){return!r||r instanceof Ct?r:new Ct(r,u)}function wi(r,u){if(r)for(var m=u?[r,u]:r,b=0,A=m.length;b<A;b++)this.extend(m[b])}function Bi(r,u){return r instanceof wi?r:new wi(r,u)}function ci(r,u,m){if(isNaN(r)||isNaN(u))throw new Error("Invalid LatLng object: ("+r+", "+u+")");this.lat=+r,this.lng=+u,void 0!==m&&(this.alt=+m)}function pi(r,u,m){return r instanceof ci?r:ee(r)&&"object"!=typeof r[0]?3===r.length?new ci(r[0],r[1],r[2]):2===r.length?new ci(r[0],r[1]):null:null==r?r:"object"==typeof r&&"lat"in r?new ci(r.lat,"lng"in r?r.lng:r.lon,r.alt):void 0===u?null:new ci(r,u,m)}Se.prototype={clone:function(){return new Se(this.x,this.y)},add:function(r){return this.clone()._add(Oe(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(Oe(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new Se(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new Se(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=er(this.x),this.y=er(this.y),this},distanceTo:function(m){var u=(m=Oe(m)).x-this.x;return m=m.y-this.y,Math.sqrt(u*u+m*m)},equals:function(r){return(r=Oe(r)).x===this.x&&r.y===this.y},contains:function(r){return r=Oe(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+zr(this.x)+", "+zr(this.y)+")"}},Ct.prototype={extend:function(r){var u,m;if(r){if(r instanceof Se||"number"==typeof r[0]||"x"in r)u=m=Oe(r);else if(u=(r=ln(r)).min,m=r.max,!u||!m)return this;this.min||this.max?(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(m.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(m.y,this.max.y)):(this.min=u.clone(),this.max=m.clone())}return this},getCenter:function(r){return Oe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return Oe(this.min.x,this.max.y)},getTopRight:function(){return Oe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var u,m;return(r=("number"==typeof r[0]||r instanceof Se?Oe:ln)(r))instanceof Ct?(u=r.min,m=r.max):u=m=r,u.x>=this.min.x&&m.x<=this.max.x&&u.y>=this.min.y&&m.y<=this.max.y},intersects:function(V){V=ln(V);var u=this.min,m=this.max,b=V.min,A=(V=V.max).x>=u.x&&b.x<=m.x;return V=V.y>=u.y&&b.y<=m.y,A&&V},overlaps:function(V){V=ln(V);var u=this.min,m=this.max,b=V.min,A=(V=V.max).x>u.x&&b.x<m.x;return V=V.y>u.y&&b.y<m.y,A&&V},isValid:function(){return!(!this.min||!this.max)},pad:function(A){var u=this.min,m=this.max,b=Math.abs(u.x-m.x)*A;return A=Math.abs(u.y-m.y)*A,ln(Oe(u.x-b,u.y-A),Oe(m.x+b,m.y+A))},equals:function(r){return!!r&&(r=ln(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight()))}},wi.prototype={extend:function(r){var u,m,b=this._southWest,A=this._northEast;if(r instanceof ci)m=u=r;else{if(!(r instanceof wi))return r?this.extend(pi(r)||Bi(r)):this;if(m=r._northEast,!(u=r._southWest)||!m)return this}return b||A?(b.lat=Math.min(u.lat,b.lat),b.lng=Math.min(u.lng,b.lng),A.lat=Math.max(m.lat,A.lat),A.lng=Math.max(m.lng,A.lng)):(this._southWest=new ci(u.lat,u.lng),this._northEast=new ci(m.lat,m.lng)),this},pad:function(A){var u=this._southWest,m=this._northEast,b=Math.abs(u.lat-m.lat)*A;return A=Math.abs(u.lng-m.lng)*A,new wi(new ci(u.lat-b,u.lng-A),new ci(m.lat+b,m.lng+A))},getCenter:function(){return new ci((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ci(this.getNorth(),this.getWest())},getSouthEast:function(){return new ci(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){r=("number"==typeof r[0]||r instanceof ci||"lat"in r?pi:Bi)(r);var u,m,b=this._southWest,A=this._northEast;return r instanceof wi?(u=r.getSouthWest(),m=r.getNorthEast()):u=m=r,u.lat>=b.lat&&m.lat<=A.lat&&u.lng>=b.lng&&m.lng<=A.lng},intersects:function(V){V=Bi(V);var u=this._southWest,m=this._northEast,b=V.getSouthWest(),A=(V=V.getNorthEast()).lat>=u.lat&&b.lat<=m.lat;return V=V.lng>=u.lng&&b.lng<=m.lng,A&&V},overlaps:function(V){V=Bi(V);var u=this._southWest,m=this._northEast,b=V.getSouthWest(),A=(V=V.getNorthEast()).lat>u.lat&&b.lat<m.lat;return V=V.lng>u.lng&&b.lng<m.lng,A&&V},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,u){return!!r&&(r=Bi(r),this._southWest.equals(r.getSouthWest(),u)&&this._northEast.equals(r.getNorthEast(),u))},isValid:function(){return!(!this._southWest||!this._northEast)}};var qi={latLngToPoint:function(r,u){return r=this.projection.project(r),u=this.scale(u),this.transformation._transform(r,u)},pointToLatLng:function(r,u){return u=this.scale(u),r=this.transformation.untransform(r,u),this.projection.unproject(r)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){var u;return this.infinite?null:(u=this.projection.bounds,r=this.scale(r),new Ct(this.transformation.transform(u.min,r),this.transformation.transform(u.max,r)))},infinite:!(ci.prototype={equals:function(r,u){return!!r&&(r=pi(r),Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng))<=(void 0===u?1e-9:u))},toString:function(r){return"LatLng("+zr(this.lat,r)+", "+zr(this.lng,r)+")"},distanceTo:function(r){return ki.distance(this,pi(r))},wrap:function(){return ki.wrapLatLng(this)},toBounds:function(u){var m=(u=180*u/40075017)/Math.cos(Math.PI/180*this.lat);return Bi([this.lat-u,this.lng-m],[this.lat+u,this.lng+m])},clone:function(){return new ci(this.lat,this.lng,this.alt)}}),wrapLatLng:function(r){var u=this.wrapLng?Lr(r.lng,this.wrapLng,!0):r.lng;return new ci(this.wrapLat?Lr(r.lat,this.wrapLat,!0):r.lat,u,r.alt)},wrapLatLngBounds:function(r){var b=r.getCenter(),u=this.wrapLatLng(b),m=b.lat-u.lat;return b=b.lng-u.lng,0==m&&0==b?r:(u=r.getSouthWest(),r=r.getNorthEast(),new wi(new ci(u.lat-m,u.lng-b),new ci(r.lat-m,r.lng-b)))}},ki=dt({},qi,{wrapLng:[-180,180],R:6371e3,distance:function(ct,V){var ut=Math.PI/180,m=ct.lat*ut,b=V.lat*ut,A=Math.sin((V.lat-ct.lat)*ut/2);return V=Math.sin((V.lng-ct.lng)*ut/2),ct=A*A+Math.cos(m)*Math.cos(b)*V*V,ut=2*Math.atan2(Math.sqrt(ct),Math.sqrt(1-ct)),this.R*ut}}),Mi={R:Mi=6378137,MAX_LATITUDE:85.0511287798,project:function(r){var u=Math.PI/180,m=this.MAX_LATITUDE;return m=Math.max(Math.min(m,r.lat),-m),m=Math.sin(m*u),new Se(this.R*r.lng*u,this.R*Math.log((1+m)/(1-m))/2)},unproject:function(r){var u=180/Math.PI;return new ci((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*u,r.x*u/this.R)},bounds:new Ct([-(Mi*=Math.PI),-Mi],[Mi,Mi])};function Gn(r,u,m,b){ee(r)?(this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3]):(this._a=r,this._b=u,this._c=m,this._d=b)}function Wn(r,u,m,b){return new Gn(r,u,m,b)}Gn.prototype={transform:function(r,u){return this._transform(r.clone(),u)},_transform:function(r,u){return r.x=(u=u||1)*(this._a*r.x+this._b),r.y=u*(this._c*r.y+this._d),r},untransform:function(r,u){return new Se((r.x/(u=u||1)-this._b)/this._a,(r.y/u-this._d)/this._c)}};var Ri=dt({},ki,{code:"EPSG:3857",projection:Mi,transformation:Wn(Ri=.5/(Math.PI*Mi.R),.5,-Ri,.5)}),un=dt({},Ri,{code:"EPSG:900913"});function qe(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function hr(r,u){for(var m,b,A,V,ct="",ut=0,Dt=r.length;ut<Dt;ut++){for(m=0,b=(A=r[ut]).length;m<b;m++)ct+=(m?"L":"M")+(V=A[m]).x+" "+V.y;ct+=u?re.svg?"z":"x":""}return ct||"M0 0"}var go=document.documentElement.style,Gr="ActiveXObject"in window,vi=Gr&&!document.addEventListener,cr="msLaunchUri"in navigator&&!("documentMode"in document),In=hn("webkit"),kr=hn("android"),Aa=hn("android 2")||hn("android 3"),aa=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Oo=(aa=kr&&hn("Google")&&aa<537&&!("AudioNode"in window),!!window.opera),as=!cr&&hn("chrome"),vr=hn("gecko")&&!In&&!Oo&&!Gr,Wa=!as&&hn("safari"),Ia=hn("phantom"),Xn="OTransition"in go,Dn=0===navigator.platform.indexOf("Win"),va=Gr&&"transition"in go,so="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Aa,lo=(go="MozPerspective"in go,!window.L_DISABLE_3D&&(va||so||go)&&!Xn&&!Ia),Ja=(Yo=typeof orientation<"u"||hn("mobile"))&&In,Ya=Yo&&so,Io=!window.PointerEvent&&window.MSPointerEvent,uo=!(!window.PointerEvent&&!Io),On="ontouchstart"in window||!!window.TouchEvent,xr=!window.L_NO_TOUCH&&(On||uo),_o=Yo&&Oo,Wr=Yo&&vr,Hr=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),_a=function(){var r=!1;try{var u=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",sn,u),window.removeEventListener("testPassiveEventSupport",sn,u)}catch{}return r}(),Hn=!!document.createElement("canvas").getContext,Xr=!(!document.createElementNS||!qe("svg").createSVGRect),ei=!!Xr&&((ei=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(ei.firstChild&&ei.firstChild.namespaceURI));function hn(r){return 0<=navigator.userAgent.toLowerCase().indexOf(r)}var re={ie:Gr,ielt9:vi,edge:cr,webkit:In,android:kr,android23:Aa,androidStock:aa,opera:Oo,chrome:as,gecko:vr,safari:Wa,phantom:Ia,opera12:Xn,win:Dn,ie3d:va,webkit3d:so,gecko3d:go,any3d:lo,mobile:Yo,mobileWebkit:Ja,mobileWebkit3d:Ya,msPointer:Io,pointer:uo,touch:xr,touchNative:On,mobileOpera:_o,mobileGecko:Wr,retina:Hr,passiveEvents:_a,canvas:Hn,svg:Xr,vml:!Xr&&function(){try{var r=document.createElement("div"),u=(r.innerHTML='<v:shape adj="1"/>',r.firstChild);return u.style.behavior="url(#default#VML)",u&&"object"==typeof u.adj}catch{return!1}}(),inlineSvg:ei,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},Bn=re.msPointer?"MSPointerDown":"pointerdown",je=re.msPointer?"MSPointerMove":"pointermove",To=re.msPointer?"MSPointerUp":"pointerup",Rn=re.msPointer?"MSPointerCancel":"pointercancel",Tn={touchstart:Bn,touchmove:je,touchend:To,touchcancel:Rn},En={touchstart:function(r,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&Ze(u),S(r,u)},touchmove:S,touchend:S,touchcancel:S},Pi={},Hi=!1;function io(r){Pi[r.pointerId]=r}function no(r){Pi[r.pointerId]&&(Pi[r.pointerId]=r)}function x(r){delete Pi[r.pointerId]}function S(r,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){for(var m in u.touches=[],Pi)u.touches.push(Pi[m]);u.changedTouches=[u],r(u)}}var tt,ht,Lt,Jt,ue,Ae,Di=G(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Qi=G(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ji="webkitTransition"===Qi||"OTransition"===Qi?Qi+"End":"transitionend";function ir(r){return"string"==typeof r?document.getElementById(r):r}function Pn(r,u){var m=r.style[u]||r.currentStyle&&r.currentStyle[u];return"auto"===(m=m&&"auto"!==m||!document.defaultView?m:(r=document.defaultView.getComputedStyle(r,null))?r[u]:null)?null:m}function ri(r,u,m){return(r=document.createElement(r)).className=u||"",m&&m.appendChild(r),r}function Ti(r){var u=r.parentNode;u&&u.removeChild(r)}function Mr(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function fn(r){var u=r.parentNode;u&&u.lastChild!==r&&u.appendChild(r)}function mn(r){var u=r.parentNode;u&&u.firstChild!==r&&u.insertBefore(r,u.firstChild)}function Kr(r,u){return void 0!==r.classList?r.classList.contains(u):0<(r=O(r)).length&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(r)}function Ce(r,u){var m;if(void 0!==r.classList)for(var b=Do(u),A=0,V=b.length;A<V;A++)r.classList.add(b[A]);else Kr(r,u)||z(r,((m=O(r))?m+" ":"")+u)}function Ke(r,u){void 0!==r.classList?r.classList.remove(u):z(r,Wo((" "+O(r)+" ").replace(" "+u+" "," ")))}function z(r,u){void 0===r.className.baseVal?r.className=u:r.className.baseVal=u}function O(r){return void 0===(r=r.correspondingElement?r.correspondingElement:r).className.baseVal?r.className:r.className.baseVal}function F(r,u){if("opacity"in r.style)r.style.opacity=u;else if("filter"in r.style){var m=!1,b="DXImageTransform.Microsoft.Alpha";try{m=r.filters.item(b)}catch{if(1===u)return}u=Math.round(100*u),m?(m.Enabled=100!==u,m.Opacity=u):r.style.filter+=" progid:"+b+"(opacity="+u+")"}}function G(r){for(var u=document.documentElement.style,m=0;m<r.length;m++)if(r[m]in u)return r[m];return!1}function X(r,u,m){u=u||new Se(0,0),r.style[Di]=(re.ie3d?"translate("+u.x+"px,"+u.y+"px)":"translate3d("+u.x+"px,"+u.y+"px,0)")+(m?" scale("+m+")":"")}function nt(r,u){r._leaflet_pos=u,re.any3d?X(r,u):(r.style.left=u.x+"px",r.style.top=u.y+"px")}function st(r){return r._leaflet_pos||new Se(0,0)}function j(){vt(window,"dragstart",Ze)}function et(){Ft(window,"dragstart",Ze)}function ft(r){for(;-1===r.tabIndex;)r=r.parentNode;r.style&&(kt(),Ae=(ue=r).style.outline,r.style.outline="none",vt(window,"keydown",kt))}function kt(){ue&&(ue.style.outline=Ae,Ae=ue=void 0,Ft(window,"keydown",kt))}function Rt(r){for(;!((r=r.parentNode).offsetWidth&&r.offsetHeight||r===document.body););return r}function bt(r){var u=r.getBoundingClientRect();return{x:u.width/r.offsetWidth||1,y:u.height/r.offsetHeight||1,boundingClientRect:u}}function vt(r,u,m,b){if(u&&"object"==typeof u)for(var A in u)Kt(r,A,u[A],m);else for(var V=0,ct=(u=Do(u)).length;V<ct;V++)Kt(r,u[V],m,b);return this}Jt="onselectstart"in document?(Lt=function(){vt(window,"selectstart",Ze)},function(){Ft(window,"selectstart",Ze)}):(ht=G(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),Lt=function(){var r;ht&&(r=document.documentElement.style,tt=r[ht],r[ht]="none")},function(){ht&&(document.documentElement.style[ht]=tt,tt=void 0)}),Gr={__proto__:null,TRANSFORM:Di,TRANSITION:Qi,TRANSITION_END:ji,get:ir,getStyle:Pn,create:ri,remove:Ti,empty:Mr,toFront:fn,toBack:mn,hasClass:Kr,addClass:Ce,removeClass:Ke,setClass:z,getClass:O,setOpacity:F,testProp:G,setTransform:X,setPosition:nt,getPosition:st,get disableTextSelection(){return Lt},get enableTextSelection(){return Jt},disableImageDrag:j,enableImageDrag:et,preventOutline:ft,restoreOutline:kt,getSizedParentNode:Rt,getScale:bt};var ne="_leaflet_events";function Ft(r,u,m,b){if(1===arguments.length)Pt(r),delete r[ne];else if(u&&"object"==typeof u)for(var A in u)Yt(r,A,u[A],m);else if(u=Do(u),2===arguments.length)Pt(r,function(ut){return-1!==Me(u,ut)});else for(var V=0,ct=u.length;V<ct;V++)Yt(r,u[V],m,b);return this}function Pt(r,u){for(var m in r[ne]){var b=m.split(/\d/)[0];u&&!u(b)||Yt(r,b,null,null,m)}}var te={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Kt(r,u,m,b){var A,V,ct=u+ni(m)+(b?"_"+ni(b):"");r[ne]&&r[ne][ct]||(V=A=function(ut){return m.call(b||r,ut||window.event)},!re.touchNative&&re.pointer&&0===u.indexOf("touch")?A=function Fi(r,u,m){return"touchstart"!==u||Hi||(document.addEventListener(Bn,io,!0),document.addEventListener(je,no,!0),document.addEventListener(To,x,!0),document.addEventListener(Rn,x,!0),Hi=!0),En[u]?(m=En[u].bind(this,m),r.addEventListener(Tn[u],m,!1),m):(console.warn("wrong event specified:",u),sn)}(r,u,A):re.touch&&"dblclick"===u?A=function W(r,u){r.addEventListener("dblclick",u);var m,b=0;function A(V){var ct;1!==V.detail?m=V.detail:"mouse"===V.pointerType||V.sourceCapabilities&&!V.sourceCapabilities.firesTouchEvents||(ct=si(V)).some(function(ut){return ut instanceof HTMLLabelElement&&ut.attributes.for})&&!ct.some(function(ut){return ut instanceof HTMLInputElement||ut instanceof HTMLSelectElement})||((ct=Date.now())-b<=200?2==++m&&u(function(ut){var Dt,jt,ye={};for(jt in ut)ye[jt]=(Dt=ut[jt])&&Dt.bind?Dt.bind(ut):Dt;return(ut=ye).type="dblclick",ye.detail=2,ye.isTrusted=!1,ye._simulated=!0,ye}(V)):m=1,b=ct)}return r.addEventListener("click",A),{dblclick:u,simDblclick:A}}(r,A):"addEventListener"in r?"touchstart"===u||"touchmove"===u||"wheel"===u||"mousewheel"===u?r.addEventListener(te[u]||u,A,!!re.passiveEvents&&{passive:!1}):"mouseenter"===u||"mouseleave"===u?r.addEventListener(te[u],A=function(ut){ut=ut||window.event,rn(r,ut)&&V(ut)},!1):r.addEventListener(u,V,!1):r.attachEvent("on"+u,A),r[ne]=r[ne]||{},r[ne][ct]=A)}function Yt(r,u,ut,b,A){var V,ct;A=A||u+ni(ut)+(b?"_"+ni(b):""),(ut=r[ne]&&r[ne][A])&&(!re.touchNative&&re.pointer&&0===u.indexOf("touch")?(b=r,ct=ut,Tn[V=u]?b.removeEventListener(Tn[V],ct,!1):console.warn("wrong event specified:",V)):re.touch&&"dblclick"===u?((ct=r).removeEventListener("dblclick",(b=ut).dblclick),ct.removeEventListener("click",b.simDblclick)):"removeEventListener"in r?r.removeEventListener(te[u]||u,ut,!1):r.detachEvent("on"+u,ut),r[ne][A]=null)}function ze(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function $t(r){return Kt(r,"wheel",ze),this}function Je(r){return vt(r,"mousedown touchstart dblclick contextmenu",ze),r._leaflet_disable_click=!0,this}function Ze(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function Be(r){return Ze(r),ze(r),this}function si(r){if(r.composedPath)return r.composedPath();for(var u=[],m=r.target;m;)u.push(m),m=m.parentNode;return u}function ti(r,u){var m,b;return u?(b=(m=bt(u)).boundingClientRect,new Se((r.clientX-b.left)/m.x-u.clientLeft,(r.clientY-b.top)/m.y-u.clientTop)):new Se(r.clientX,r.clientY)}var br=re.linux&&re.chrome?window.devicePixelRatio:re.mac?3*window.devicePixelRatio:0<window.devicePixelRatio?2*window.devicePixelRatio:1;function di(r){return re.edge?r.wheelDeltaY/2:r.deltaY&&0===r.deltaMode?-r.deltaY/br:r.deltaY&&1===r.deltaMode?20*-r.deltaY:r.deltaY&&2===r.deltaMode?60*-r.deltaY:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?20*-r.detail:r.detail?r.detail/-32765*60:0}function rn(r,u){var m=u.relatedTarget;if(!m)return!0;try{for(;m&&m!==r;)m=m.parentNode}catch{return!1}return m!==r}vi={__proto__:null,on:vt,off:Ft,stopPropagation:ze,disableScrollPropagation:$t,disableClickPropagation:Je,preventDefault:Ze,stop:Be,getPropagationPath:si,getMousePosition:ti,getWheelDelta:di,isExternalTarget:rn,addListener:vt,removeListener:Ft};var Ye=nn.extend({run:function(r,u,m,b){this.stop(),this._el=r,this._inProgress=!0,this._duration=m||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=st(r),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Ue(this._animate,this),this._step()},_step:function(r){var u=+new Date-this._startTime,m=1e3*this._duration;u<m?this._runFrame(this._easeOut(u/m),r):(this._runFrame(1),this._complete())},_runFrame:function(r,u){r=this._startPos.add(this._offset.multiplyBy(r)),u&&r._round(),nt(this._el,r),this.fire("step")},_complete:function(){le(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),fe=nn.extend({options:{crs:Ri,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,u){u=Vi(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=Ei(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),void 0!==u.zoom&&(this._zoom=this._limitZoom(u.zoom)),u.center&&void 0!==u.zoom&&this.setView(pi(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Qi&&re.any3d&&!re.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),vt(this._proxy,ji,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,u,m){return u=void 0===u?this._zoom:this._limitZoom(u),r=this._limitCenter(pi(r),u,this.options.maxBounds),m=m||{},this._stop(),this._loaded&&!m.reset&&!0!==m&&(void 0!==m.animate&&(m.zoom=dt({animate:m.animate},m.zoom),m.pan=dt({animate:m.animate,duration:m.duration},m.pan)),this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,u,m.zoom):this._tryAnimatedPan(r,m.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(r,u,m.pan&&m.pan.noMoveStart),this)},setZoom:function(r,u){return this._loaded?this.setView(this.getCenter(),r,{zoom:u}):(this._zoom=r,this)},zoomIn:function(r,u){return this.setZoom(this._zoom+(r=r||(re.any3d?this.options.zoomDelta:1)),u)},zoomOut:function(r,u){return this.setZoom(this._zoom-(r=r||(re.any3d?this.options.zoomDelta:1)),u)},setZoomAround:function(A,u,m){var V=this.getZoomScale(u),b=this.getSize().divideBy(2);return A=(A instanceof Se?A:this.latLngToContainerPoint(A)).subtract(b).multiplyBy(1-1/V),V=this.containerPointToLatLng(b.add(A)),this.setView(V,u,{zoom:m})},_getBoundsCenterZoom:function(r,u){u=u||{},r=r.getBounds?r.getBounds():Bi(r);var m=Oe(u.paddingTopLeft||u.padding||[0,0]),b=Oe(u.paddingBottomRight||u.padding||[0,0]),A=this.getBoundsZoom(r,!1,m.add(b));return(A="number"==typeof u.maxZoom?Math.min(u.maxZoom,A):A)===1/0?{center:r.getCenter(),zoom:A}:(u=b.subtract(m).divideBy(2),b=this.project(r.getSouthWest(),A),m=this.project(r.getNorthEast(),A),{center:this.unproject(b.add(m).divideBy(2).add(u),A),zoom:A})},fitBounds:function(r,u){if((r=Bi(r)).isValid())return r=this._getBoundsCenterZoom(r,u),this.setView(r.center,r.zoom,u);throw new Error("Bounds are not valid.")},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,u){return this.setView(r,this._zoom,{pan:u})},panBy:function(r,u){var m;return u=u||{},(r=Oe(r).round()).x||r.y?(!0===u.animate||this.getSize().contains(r)?(this._panAnim||(this._panAnim=new Ye,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),!1!==u.animate?(Ce(this._mapPane,"leaflet-pan-anim"),m=this._getMapPanePos().subtract(r).round(),this._panAnim.run(this._mapPane,m,u.duration||.25,u.easeLinearity)):(this._rawPanBy(r),this.fire("move").fire("moveend"))):this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this):this.fire("moveend")},flyTo:function(r,u,m){if(!1===(m=m||{}).animate||!re.any3d)return this.setView(r,u,m);this._stop();var b=this.project(this.getCenter()),A=this.project(r),V=this.getSize(),ct=this._zoom,ut=(r=pi(r),u=void 0===u?ct:u,Math.max(V.x,V.y)),Dt=ut*this.getZoomScale(ct,u),jt=A.distanceTo(b)||1,ye=1.42,li=ye*ye;function Ui(on){return on=(Dt*Dt-ut*ut+(on?-1:1)*li*li*jt*jt)/(2*(on?Dt:ut)*li*jt),(on=Math.sqrt(on*on+1)-on)<1e-9?-18:Math.log(on)}function _n(on){return(Math.exp(on)-Math.exp(-on))/2}function Bo(on){return(Math.exp(on)+Math.exp(-on))/2}var Sr=Ui(0),wa=Date.now(),Ro=(Ui(1)-Sr)/ye,$a=m.duration?1e3*m.duration:1e3*Ro*.8;return this._moveStart(!0,m.noMoveStart),function on(){var $o=(Date.now()-wa)/$a,Ta=(1-Math.pow(1-$o,1.5))*Ro;$o<=1?(this._flyToFrame=Ue(on,this),this._move(this.unproject(b.add(A.subtract(b).multiplyBy(function Kn(on){return ut*(Bo(Sr)*(_n(on=Sr+ye*on)/Bo(on))-_n(Sr))/li}(Ta)/jt)),ct),this.getScaleZoom(ut/($o=Ta,ut*(Bo(Sr)/Bo(Sr+ye*$o))),ct),{flyTo:!0})):this._move(r,u)._moveEnd(!0)}.call(this),this},flyToBounds:function(r,u){return r=this._getBoundsCenterZoom(r,u),this.flyTo(r.center,r.zoom,u)},setMaxBounds:function(r){return r=Bi(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var u=this.options.minZoom;return this.options.minZoom=r,this._loaded&&u!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var u=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&u!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(b,u){this._enforcingBounds=!0;var m=this.getCenter();return b=this._limitCenter(m,this._zoom,Bi(b)),m.equals(b)||this.panTo(b,u),this._enforcingBounds=!1,this},panInside:function(A,u){var V=Oe((u=u||{}).paddingTopLeft||u.padding||[0,0]),m=Oe(u.paddingBottomRight||u.padding||[0,0]),b=this.project(this.getCenter()),ct=(A=this.project(A),(V=ln([(ct=this.getPixelBounds()).min.add(V),ct.max.subtract(m)])).getSize());return V.contains(A)||(this._enforcingBounds=!0,m=A.subtract(V.getCenter()),V=V.extend(A).getSize().subtract(ct),b.x+=m.x<0?-V.x:V.x,b.y+=m.y<0?-V.y:V.y,this.panTo(this.unproject(b),u),this._enforcingBounds=!1),this},invalidateSize:function(r){if(!this._loaded)return this;r=dt({animate:!1,pan:!0},!0===r?{animate:!0}:r);var u=this.getSize(),m=(this._sizeChanged=!0,this._lastCenter=null,this.getSize()),A=u.divideBy(2).round(),b=m.divideBy(2).round();return(A=A.subtract(b)).x||A.y?(r.animate&&r.pan?this.panBy(A):(r.pan&&this._rawPanBy(A),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(Ei(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:m})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){var u,m;return r=this._locateOptions=dt({timeout:1e4,watch:!1},r),"geolocation"in navigator?(u=Ei(this._handleGeolocationResponse,this),m=Ei(this._handleGeolocationError,this),r.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,m,r):navigator.geolocation.getCurrentPosition(u,m,r)):this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){var u;this._container._leaflet_id&&(u=r.code,r=r.message||(1===u?"permission denied":2===u?"position unavailable":"timeout"),this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+r+"."}))},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var u,m,b=new ci(r.coords.latitude,r.coords.longitude),A=b.toBounds(2*r.coords.accuracy),V=this._locateOptions,ct=(V.setView&&(u=this.getBoundsZoom(A),this.setView(b,V.maxZoom?Math.min(u,V.maxZoom):u)),{latlng:b,bounds:A,timestamp:r.timestamp});for(m in r.coords)"number"==typeof r.coords[m]&&(ct[m]=r.coords[m]);this.fire("locationfound",ct)}},addHandler:function(r,u){return u&&(u=this[r]=new u(this),this._handlers.push(u),this.options[r]&&u.enable()),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}for(var r in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),Ti(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(le(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[r].remove();for(r in this._panes)Ti(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,u){return u=ri("div","leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),u||this._mapPane),r&&(this._panes[r]=u),u},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds();return new wi(this.unproject(r.getBottomLeft()),this.unproject(r.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(Dt,u,ut){Dt=Bi(Dt),ut=Oe(ut||[0,0]);var jt=this.getZoom()||0,b=this.getMinZoom(),A=this.getMaxZoom(),V=Dt.getNorthWest(),ct=(Dt=Dt.getSouthEast(),ut=this.getSize().subtract(ut),Dt=ln(this.project(Dt,jt),this.project(V,jt)).getSize(),V=re.any3d?this.options.zoomSnap:1,ut.x/Dt.x);return ut=ut.y/Dt.y,Dt=u?Math.max(ct,ut):Math.min(ct,ut),jt=this.getScaleZoom(Dt,jt),V&&(jt=Math.round(jt/(V/100))*(V/100),jt=u?Math.ceil(jt/V)*V:Math.floor(jt/V)*V),Math.max(b,Math.min(A,jt))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new Se(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,u){return new Ct(r=this._getTopLeftPoint(r,u),r.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(void 0===r?this.getZoom():r)},getPane:function(r){return"string"==typeof r?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,u){var m=this.options.crs;return u=void 0===u?this._zoom:u,m.scale(r)/m.scale(u)},getScaleZoom:function(b,u){var m=this.options.crs;return b=m.zoom(b*m.scale(u=void 0===u?this._zoom:u)),isNaN(b)?1/0:b},project:function(r,u){return u=void 0===u?this._zoom:u,this.options.crs.latLngToPoint(pi(r),u)},unproject:function(r,u){return u=void 0===u?this._zoom:u,this.options.crs.pointToLatLng(Oe(r),u)},layerPointToLatLng:function(r){return r=Oe(r).add(this.getPixelOrigin()),this.unproject(r)},latLngToLayerPoint:function(r){return this.project(pi(r))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(pi(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(Bi(r))},distance:function(r,u){return this.options.crs.distance(pi(r),pi(u))},containerPointToLayerPoint:function(r){return Oe(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return Oe(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){return r=this.containerPointToLayerPoint(Oe(r)),this.layerPointToLatLng(r)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(pi(r)))},mouseEventToContainerPoint:function(r){return ti(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){if(!(r=this._container=ir(r)))throw new Error("Map container not found.");if(r._leaflet_id)throw new Error("Map container is already initialized.");vt(r,"scroll",this._onScroll,this),this._containerId=ni(r)},_initLayout:function(){var r=this._container,u=(this._fadeAnimated=this.options.fadeAnimation&&re.any3d,Ce(r,"leaflet-container"+(re.touch?" leaflet-touch":"")+(re.retina?" leaflet-retina":"")+(re.ielt9?" leaflet-oldie":"")+(re.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":"")),Pn(r,"position"));"absolute"!==u&&"relative"!==u&&"fixed"!==u&&"sticky"!==u&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),nt(this._mapPane,new Se(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ce(r.markerPane,"leaflet-zoom-hide"),Ce(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,u,m){nt(this._mapPane,new Se(0,0));var b=!this._loaded,A=(this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset"),this._zoom!==u);this._moveStart(A,m)._move(r,u)._moveEnd(A),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(r,u){return r&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(r,u,m,b){void 0===u&&(u=this._zoom);var A=this._zoom!==u;return this._zoom=u,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),b?m&&m.pinch&&this.fire("zoom",m):((A||m&&m.pinch)&&this.fire("zoom",m),this.fire("move",m)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return le(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){nt(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={};var u=r?Ft:vt;u((this._targets[ni(this._container)]=this)._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),re.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){le(this._resizeRequest),this._resizeRequest=Ue(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,u){for(var m,b=[],A="mouseout"===u||"mouseover"===u,V=r.target||r.srcElement,ct=!1;V;){if((m=this._targets[ni(V)])&&("click"===u||"preclick"===u)&&this._draggableMoved(m)){ct=!0;break}if(m&&m.listens(u,!0)&&(A&&!rn(V,r)||(b.push(m),A))||V===this._container)break;V=V.parentNode}return b.length||ct||A||!this.listens(u,!0)?b:[this]},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var u,m=r.target||r.srcElement;!this._loaded||m._leaflet_disable_events||"click"===r.type&&this._isClickDisabled(m)||("mousedown"===(u=r.type)&&ft(m),this._fireDOMEvent(r,u))},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,u,m){"click"===r.type&&((ut=dt({},r)).type="preclick",this._fireDOMEvent(ut,ut.type,m));var b=this._findEventTargets(r,u);if(m){for(var A=[],V=0;V<m.length;V++)m[V].listens(u,!0)&&A.push(m[V]);b=A.concat(b)}if(b.length){"contextmenu"===u&&Ze(r);var ct,ut=b[0],Dt={originalEvent:r};for("keypress"!==r.type&&"keydown"!==r.type&&"keyup"!==r.type&&(Dt.containerPoint=(ct=ut.getLatLng&&(!ut._radius||ut._radius<=10))?this.latLngToContainerPoint(ut.getLatLng()):this.mouseEventToContainerPoint(r),Dt.layerPoint=this.containerPointToLayerPoint(Dt.containerPoint),Dt.latlng=ct?ut.getLatLng():this.layerPointToLatLng(Dt.layerPoint)),V=0;V<b.length;V++)if(b[V].fire(u,Dt,!0),Dt.originalEvent._stopped||!1===b[V].options.bubblingMouseEvents&&-1!==Me(this._mouseEvents,u))return}},_draggableMoved:function(r){return(r=r.dragging&&r.dragging.enabled()?r:this).dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,u=this._handlers.length;r<u;r++)this._handlers[r].disable()},whenReady:function(r,u){return this._loaded?r.call(u||this,{target:this}):this.on("load",r,u),this},_getMapPanePos:function(){return st(this._mapPane)||new Se(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,u){return(r&&void 0!==u?this._getNewPixelOrigin(r,u):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,u){var m=this.getSize()._divideBy(2);return this.project(r,u)._subtract(m)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,u,m){return m=this._getNewPixelOrigin(m,u),this.project(r,u)._subtract(m)},_latLngBoundsToNewLayerBounds:function(r,u,m){return m=this._getNewPixelOrigin(m,u),ln([this.project(r.getSouthWest(),u)._subtract(m),this.project(r.getNorthWest(),u)._subtract(m),this.project(r.getSouthEast(),u)._subtract(m),this.project(r.getNorthEast(),u)._subtract(m)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,u,m){var b,A;return!m||(b=this.project(r,u),A=this.getSize().divideBy(2),A=new Ct(b.subtract(A),b.add(A)),A=this._getBoundsOffset(A,m,u),Math.abs(A.x)<=1&&Math.abs(A.y)<=1)?r:this.unproject(b.add(A),u)},_limitOffset:function(r,u){var m;return u?(m=new Ct((m=this.getPixelBounds()).min.add(r),m.max.add(r)),r.add(this._getBoundsOffset(m,u))):r},_getBoundsOffset:function(r,u,m){return m=(u=ln(this.project(u.getNorthEast(),m),this.project(u.getSouthWest(),m))).min.subtract(r.min),u=u.max.subtract(r.max),new Se(this._rebound(m.x,-u.x),this._rebound(m.y,-u.y))},_rebound:function(r,u){return 0<r+u?Math.round(r-u)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(u))},_limitZoom:function(r){var u=this.getMinZoom(),m=this.getMaxZoom(),b=re.any3d?this.options.zoomSnap:1;return b&&(r=Math.round(r/b)*b),Math.max(u,Math.min(m,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ke(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,u){return r=this._getCenterOffset(r)._trunc(),!(!0!==(u&&u.animate)&&!this.getSize().contains(r)||(this.panBy(r,u),0))},_createAnimProxy:function(){var r=this._proxy=ri("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(u){var m=Di,b=this._proxy.style[m];X(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),b===this._proxy.style[m]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ti(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),u=this.getZoom();X(this._proxy,this.project(r,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(r){this._animatingZoom&&0<=r.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,u,m){if(!this._animatingZoom){if(m=m||{},!this._zoomAnimated||!1===m.animate||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(u);if(b=this._getCenterOffset(r)._divideBy(1-1/b),!0!==m.animate&&!this.getSize().contains(b))return!1;Ue(function(){this._moveStart(!0,!1)._animateZoom(r,u,!0)},this)}return!0},_animateZoom:function(r,u,m,b){this._mapPane&&(m&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=u,Ce(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:u,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(Ei(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ke(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function An(r){return new Ai(r)}var ya,Ai=Nt.extend({options:{position:"topright"},initialize:function(r){Vi(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var u=this._map;return u&&u.removeControl(this),this.options.position=r,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(b){this.remove(),this._map=b;var u=this._container=this.onAdd(b),m=this.getPosition();return b=b._controlCorners[m],Ce(u,"leaflet-control"),-1!==m.indexOf("bottom")?b.insertBefore(u,b.firstChild):b.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map&&(Ti(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null),this},_refocusOnMap:function(r){this._map&&r&&0<r.screenX&&0<r.screenY&&this._map.getContainer().focus()}}),nr=(fe.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},u="leaflet-",m=this._controlContainer=ri("div",u+"control-container",this._container);function b(A,V){r[A+V]=ri("div",u+A+" "+u+V,m)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)Ti(this._controlCorners[r]);Ti(this._controlContainer),delete this._controlCorners,delete this._controlContainer}}),Ai.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,u,m,b){return m<b?-1:b<m?1:0}},initialize:function(r,u,m){for(var b in Vi(this,m),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,r)this._addLayer(r[b],b);for(b in u)this._addLayer(u[b],b,!0)},onAdd:function(r){this._initLayout(),this._update(),(this._map=r).on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return Ai.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,u){return this._addLayer(r,u),this._map?this._update():this},addOverlay:function(r,u){return this._addLayer(r,u,!0),this._map?this._update():this},removeLayer:function(r){return r.off("add remove",this._onLayerChange,this),(r=this._getLayer(ni(r)))&&this._layers.splice(this._layers.indexOf(r),1),this._map?this._update():this},expand:function(){Ce(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(Ce(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):Ke(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ke(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",u=this._container=ri("div",r),m=this.options.collapsed,b=(u.setAttribute("aria-haspopup",!0),Je(u),$t(u),this._section=ri("section",r+"-list")),A=(m&&(this._map.on("click",this.collapse,this),vt(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this)),this._layersLink=ri("a",r+"-toggle",u));A.href="#",A.title="Layers",A.setAttribute("role","button"),vt(A,{keydown:function(V){13===V.keyCode&&this._expandSafely()},click:function(V){Ze(V),this._expandSafely()}},this),m||this.expand(),this._baseLayersList=ri("div",r+"-base",b),this._separator=ri("div",r+"-separator",b),this._overlaysList=ri("div",r+"-overlays",b),u.appendChild(b)},_getLayer:function(r){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&ni(this._layers[u].layer)===r)return this._layers[u]},_addLayer:function(r,u,m){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:u,overlay:m}),this.options.sortLayers&&this._layers.sort(Ei(function(b,A){return this.options.sortFunction(b.layer,A.layer,b.name,A.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(this._container){Mr(this._baseLayersList),Mr(this._overlaysList),this._layerControlInputs=[];for(var r,u,m,b=0,A=0;A<this._layers.length;A++)this._addItem(m=this._layers[A]),u=u||m.overlay,r=r||!m.overlay,b+=m.overlay?0:1;this.options.hideSingleBase&&(this._baseLayersList.style.display=(r=r&&1<b)?"":"none"),this._separator.style.display=u&&r?"":"none"}return this},_onLayerChange:function(m){this._handlingClick||this._update();var u=this._getLayer(ni(m.target));(m=u.overlay?"add"===m.type?"overlayadd":"overlayremove":"add"===m.type?"baselayerchange":null)&&this._map.fire(m,u)},_createRadioElement:function(r,u){return r='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(u?' checked="checked"':"")+"/>",(u=document.createElement("div")).innerHTML=r,u.firstChild},_addItem:function(r){var u,m=document.createElement("label"),b=this._map.hasLayer(r.layer),A=((r.overlay?((u=document.createElement("input")).type="checkbox",u.className="leaflet-control-layers-selector",u.defaultChecked=b):u=this._createRadioElement("leaflet-base-layers_"+ni(this),b),this._layerControlInputs.push(u),u.layerId=ni(r.layer),vt(u,"click",this._onInputClick,this),b=document.createElement("span")).innerHTML=" "+r.name,document.createElement("span"));return m.appendChild(A),A.appendChild(u),A.appendChild(b),(r.overlay?this._overlaysList:this._baseLayersList).appendChild(m),this._checkDisabledLayers(),m},_onInputClick:function(){var r,u,m=this._layerControlInputs,b=[],A=[];this._handlingClick=!0;for(var V=m.length-1;0<=V;V--)u=this._getLayer((r=m[V]).layerId).layer,r.checked?b.push(u):r.checked||A.push(u);for(V=0;V<A.length;V++)this._map.hasLayer(A[V])&&this._map.removeLayer(A[V]);for(V=0;V<b.length;V++)this._map.hasLayer(b[V])||this._map.addLayer(b[V]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var r,u,m=this._layerControlInputs,b=this._map.getZoom(),A=m.length-1;0<=A;A--)u=this._getLayer((r=m[A]).layerId).layer,r.disabled=void 0!==u.options.minZoom&&b<u.options.minZoom||void 0!==u.options.maxZoom&&b>u.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;vt(r,"click",Ze),this.expand(),setTimeout(function(){Ft(r,"click",Ze)})}})),Ea=Ai.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var u="leaflet-control-zoom",m=ri("div",u+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,u+"-in",m,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,u+"-out",m,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),m},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,u,m,b,A){return(m=ri("a",m,b)).innerHTML=r,m.href="#",m.title=u,m.setAttribute("role","button"),m.setAttribute("aria-label",u),Je(m),vt(m,"click",Be),vt(m,"click",A,this),vt(m,"click",this._refocusOnMap,this),m},_updateDisabled:function(){var r=this._map,u="leaflet-disabled";Ke(this._zoomInButton,u),Ke(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),!this._disabled&&r._zoom!==r.getMinZoom()||(Ce(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),!this._disabled&&r._zoom!==r.getMaxZoom()||(Ce(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}}),ga=(fe.mergeOptions({zoomControl:!0}),fe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ea,this.addControl(this.zoomControl))}),Ai.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var u="leaflet-control-scale",m=ri("div",u),b=this.options;return this._addScales(b,u+"-line",m),r.on(b.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),m},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,u,m){r.metric&&(this._mScale=ri("div",u,m)),r.imperial&&(this._iScale=ri("div",u,m))},_update:function(){var r=(u=this._map).getSize().y/2,u=u.distance(u.containerPointToLatLng([0,r]),u.containerPointToLatLng([this.options.maxWidth,r]));this._updateScales(u)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var u=this._getRoundNum(r);this._updateScale(this._mScale,u<1e3?u+" m":u/1e3+" km",u/r)},_updateImperial:function(b){var u,m;5280<(b*=3.2808399)?(m=this._getRoundNum(u=b/5280),this._updateScale(this._iScale,m+" mi",m/u)):(m=this._getRoundNum(b),this._updateScale(this._iScale,m+" ft",m/b))},_updateScale:function(r,u,m){r.style.width=Math.round(this.options.maxWidth*m)+"px",r.innerHTML=u},_getRoundNum:function(m){var u=Math.pow(10,(Math.floor(m)+"").length-1);return u*(10<=(m/=u)?10:5<=m?5:3<=m?3:2<=m?2:1)}})),Zi=Ai.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(re.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(r){Vi(this,r),this._attributions={}},onAdd:function(r){for(var u in(r.attributionControl=this)._container=ri("div","leaflet-control-attribution"),Je(this._container),r._layers)r._layers[u].getAttribution&&this.addAttribution(r._layers[u].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r&&(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update()),this},removeAttribution:function(r){return r&&this._attributions[r]&&(this._attributions[r]--,this._update()),this},_update:function(){if(this._map){var r,u=[];for(r in this._attributions)this._attributions[r]&&u.push(r);var m=[];this.options.prefix&&m.push(this.options.prefix),u.length&&m.push(u.join(", ")),this._container.innerHTML=m.join(' <span aria-hidden="true">|</span> ')}}}),Cn=((fe.mergeOptions({attributionControl:!0}),fe.addInitHook(function(){this.options.attributionControl&&(new Zi).addTo(this)}),Ai.Layers=nr,Ai.Zoom=Ea,Ai.Scale=ga,Ai.Attribution=Zi,An.layers=function(r,u,m){return new nr(r,u,m)},An.zoom=function(r){return new Ea(r)},An.scale=function(r){return new ga(r)},An.attribution=function(r){return new Zi(r)},cr=Nt.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled&&(this._enabled=!1,this.removeHooks()),this},enabled:function(){return!!this._enabled}})).addTo=function(r,u){return r.addHandler(u,this),this},In={Events:dn},re.touch?"touchstart mousedown":"mousedown"),Fn=nn.extend({options:{clickTolerance:3},initialize:function(r,u,m,b){Vi(this,b),this._element=r,this._dragStartTarget=u||r,this._preventOutline=m},enable:function(){this._enabled||(vt(this._dragStartTarget,Cn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Fn._dragging===this&&this.finishDrag(!0),Ft(this._dragStartTarget,Cn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){var u,m;this._enabled&&(this._moved=!1,Kr(this._element,"leaflet-zoom-anim")||(r.touches&&1!==r.touches.length?Fn._dragging===this&&this.finishDrag():Fn._dragging||r.shiftKey||1!==r.which&&1!==r.button&&!r.touches||((Fn._dragging=this)._preventOutline&&ft(this._element),j(),Lt(),this._moving||(this.fire("down"),m=r.touches?r.touches[0]:r,u=Rt(this._element),this._startPoint=new Se(m.clientX,m.clientY),this._startPos=st(this._element),this._parentScale=bt(u),m="mousedown"===r.type,vt(document,m?"mousemove":"touchmove",this._onMove,this),vt(document,m?"mouseup":"touchend touchcancel",this._onUp,this)))))},_onMove:function(r){var u;this._enabled&&(r.touches&&1<r.touches.length?this._moved=!0:!(u=new Se((u=r.touches&&1===r.touches.length?r.touches[0]:r).clientX,u.clientY)._subtract(this._startPoint)).x&&!u.y||Math.abs(u.x)+Math.abs(u.y)<this.options.clickTolerance||(u.x/=this._parentScale.x,u.y/=this._parentScale.y,Ze(r),this._moved||(this.fire("dragstart"),this._moved=!0,Ce(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ce(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(u),this._moving=!0,this._lastEvent=r,this._updatePosition()))},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),nt(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){Ke(document.body,"leaflet-dragging"),this._lastTarget&&(Ke(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ft(document,"mousemove touchmove",this._onMove,this),Ft(document,"mouseup touchend touchcancel",this._onUp,this),et(),Jt(),this._moved&&this._moving&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,Fn._dragging=!1}});function Gi(r,u){if(u&&r.length){var m=r=function(ut,Dt){for(var jt=[ut[0]],ye=1,li=0,Ui=ut.length;ye<Ui;ye++)void 0,(Sr=(Kn=ut[li]).x-(_n=ut[ye]).x)*Sr+(Kn=Kn.y-_n.y)*Kn>Dt&&(jt.push(ut[ye]),li=ye);var _n,Kn,Sr;return li<Ui-1&&jt.push(ut[Ui-1]),jt}(r,u*=u),b=m.length,A=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(b);A[0]=A[b-1]=1,function ut(Dt,jt,ye,li,Ui){var _n,Bo,Sr,Kn=0;for(Bo=li+1;Bo<=Ui-1;Bo++)Kn<(Sr=Ga(Dt[Bo],Dt[li],Dt[Ui],!0))&&(_n=Bo,Kn=Sr);ye<Kn&&(jt[_n]=1,ut(Dt,jt,ye,li,_n),ut(Dt,jt,ye,_n,Ui))}(m,A,u,0,b-1);var V,ct=[];for(V=0;V<b;V++)A[V]&&ct.push(m[V]);return ct}return r.slice()}function ro(r,u,m){return Math.sqrt(Ga(r,u,m,!0))}function wr(r,u,m,b,A){var V,ct,ut,Dt=b?ya:rr(r,m),jt=rr(u,m);for(ya=jt;;){if(!(Dt|jt))return[r,u];if(Dt&jt)return!1;ut=rr(ct=Pa(r,u,V=Dt||jt,m,A),m),V===Dt?(r=ct,Dt=ut):(u=ct,jt=ut)}}function Pa(r,Dt,m,ye,A){var V,ct,ut=Dt.x-r.x,jt=(Dt=Dt.y-r.y,ye.min);return ye=ye.max,8&m?(V=r.x+ut*(ye.y-r.y)/Dt,ct=ye.y):4&m?(V=r.x+ut*(jt.y-r.y)/Dt,ct=jt.y):2&m?(V=ye.x,ct=r.y+Dt*(ye.x-r.x)/ut):1&m&&(V=jt.x,ct=r.y+Dt*(jt.x-r.x)/ut),new Se(V,ct,A)}function rr(r,u){var m=0;return r.x<u.min.x?m|=1:r.x>u.max.x&&(m|=2),r.y<u.min.y?m|=4:r.y>u.max.y&&(m|=8),m}function Ga(r,V,m,b){var A=V.x,ct=m.x-A,ut=m.y-(V=V.y),Dt=ct*ct+ut*ut;return 0<Dt&&(1<(Dt=((r.x-A)*ct+(r.y-V)*ut)/Dt)?(A=m.x,V=m.y):0<Dt&&(A+=ct*Dt,V+=ut*Dt)),ct=r.x-A,ut=r.y-V,b?ct*ct+ut*ut:new Se(A,V)}function Ln(r){return!ee(r[0])||"object"!=typeof r[0][0]&&void 0!==r[0][0]}function Un(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ln(r)}function Jr(r,u){var m,b,A,V,ct;if(!r||0===r.length)throw new Error("latlngs not passed");Ln(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var ut,Dt=[];for(ut in r)Dt.push(u.project(pi(r[ut])));for(var jt=Dt.length,ye=0,li=0;ye<jt-1;ye++)li+=Dt[ye].distanceTo(Dt[ye+1])/2;if(0===li)ct=Dt[0];else for(m=ye=0;ye<jt-1;ye++)if(li<(m+=V=(b=Dt[ye]).distanceTo(A=Dt[ye+1]))){ct=[A.x-(V=(m-li)/V)*(A.x-b.x),A.y-V*(A.y-b.y)];break}return u.unproject(Oe(ct))}function pr(r,u,m){for(var b,A,V,ct,ut,Dt,jt,ye=[1,4,2,8],li=0,Ui=r.length;li<Ui;li++)r[li]._code=rr(r[li],u);for(V=0;V<4;V++){for(Dt=ye[V],b=[],li=0,A=(Ui=r.length)-1;li<Ui;A=li++)ut=r[A],(ct=r[li])._code&Dt?ut._code&Dt||((jt=Pa(ut,ct,Dt,u,m))._code=rr(jt,u),b.push(jt)):(ut._code&Dt&&((jt=Pa(ut,ct,Dt,u,m))._code=rr(jt,u),b.push(jt)),b.push(ct));r=b}return r}function oa(r,u){var m,b,A,V,ct;if(!r||0===r.length)throw new Error("latlngs not passed");Ln(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Dt,jt=[];for(Dt in r)jt.push(u.project(pi(r[Dt])));for(var ye=jt.length,li=V=ct=0,Ui=0,_n=ye-1;Ui<ye;_n=Ui++)V+=((m=jt[Ui]).x+(b=jt[_n]).x)*(A=m.y*b.x-b.y*m.x),ct+=(m.y+b.y)*A,li+=3*A;return u.unproject(Oe(0===li?jt[0]:[V/li,ct/li]))}kr={__proto__:null,simplify:Gi,pointToSegmentDistance:ro,closestPointOnSegment:function(r,u,m){return Ga(r,u,m)},clipSegment:wr,_getEdgeIntersection:Pa,_getBitCode:rr,_sqClosestPointOnSegment:Ga,isFlat:Ln,_flat:Un,polylineCenter:Jr},Aa={__proto__:null,clipPolygon:pr,polygonCenter:oa},as={__proto__:null,LonLat:aa={project:function(r){return new Se(r.lng,r.lat)},unproject:function(r){return new ci(r.y,r.x)},bounds:new Ct([-180,-90],[180,90])},Mercator:Oo={R:6378137,R_MINOR:6356752.314245179,bounds:new Ct([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(r){var u=Math.PI/180,m=this.R,V=r.lat*u,b=this.R_MINOR/m,A=(b=Math.sqrt(1-b*b))*Math.sin(V);return A=Math.tan(Math.PI/4-V/2)/Math.pow((1-A)/(1+A),b/2),V=-m*Math.log(Math.max(A,1e-10)),new Se(r.lng*u*m,V)},unproject:function(r){for(var u,m=180/Math.PI,b=this.R,A=this.R_MINOR/b,V=Math.sqrt(1-A*A),ct=Math.exp(-r.y/b),ut=Math.PI/2-2*Math.atan(ct),Dt=0,jt=.1;Dt<15&&1e-7<Math.abs(jt);Dt++)u=V*Math.sin(ut),u=Math.pow((1-u)/(1+u),V/2),ut+=jt=Math.PI/2-2*Math.atan(ct*u)-ut;return new ci(ut*m,r.x*m/b)}},SphericalMercator:Mi},Wa=dt({},ki,{code:"EPSG:3395",projection:Oo,transformation:Wn(vr=.5/(Math.PI*Oo.R),.5,-vr,.5)});var Ps=dt({},ki,{code:"EPSG:4326",projection:aa,transformation:Wn(1/180,1,-1/180,.5)}),dr=(Ia=dt({},qi,{projection:aa,transformation:Wn(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,b){var m=b.lng-r.lng;return b=b.lat-r.lat,Math.sqrt(m*m+b*b)},infinite:!0}),qi.Earth=ki,qi.EPSG3395=Wa,qi.EPSG3857=Ri,qi.EPSG900913=un,qi.EPSG4326=Ps,qi.Simple=Ia,Xn=nn.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[ni(r)]=this},removeInteractiveTarget:function(r){return delete this._map._targets[ni(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var u,m=r.target;m.hasLayer(this)&&(this._map=m,this._zoomAnimated=m._zoomAnimated,this.getEvents&&(u=this.getEvents(),m.on(u,this),this.once("remove",function(){m.off(u,this)},this)),this.onAdd(m),this.fire("add"),m.fire("layeradd",{layer:this}))}}),fe.include({addLayer:function(r){var u;if(r._layerAdd)return u=ni(r),this._layers[u]||((this._layers[u]=r)._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r)),this;throw new Error("The provided object is not a Layer.")},removeLayer:function(r){var u=ni(r);return this._layers[u]&&(this._loaded&&r.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null),this},hasLayer:function(r){return ni(r)in this._layers},eachLayer:function(r,u){for(var m in this._layers)r.call(u,this._layers[m]);return this},_addLayers:function(r){for(var u=0,m=(r=r?ee(r)?r:[r]:[]).length;u<m;u++)this.addLayer(r[u])},_addZoomLimit:function(r){isNaN(r.options.maxZoom)&&isNaN(r.options.minZoom)||(this._zoomBoundLayers[ni(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){r=ni(r),this._zoomBoundLayers[r]&&(delete this._zoomBoundLayers[r],this._updateZoomLevels())},_updateZoomLevels:function(){var r,u=1/0,m=-1/0,b=this._getZoomSpan();for(r in this._zoomBoundLayers){var A=this._zoomBoundLayers[r].options;u=void 0===A.minZoom?u:Math.min(u,A.minZoom),m=void 0===A.maxZoom?m:Math.max(m,A.maxZoom)}this._layersMaxZoom=m===-1/0?void 0:m,this._layersMinZoom=u===1/0?void 0:u,b!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}}),Xn.extend({initialize:function(r,u){var m,b;if(Vi(this,u),this._layers={},r)for(m=0,b=r.length;m<b;m++)this.addLayer(r[m])},addLayer:function(r){var u=this.getLayerId(r);return this._layers[u]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){return r=r in this._layers?r:this.getLayerId(r),this._map&&this._layers[r]&&this._map.removeLayer(this._layers[r]),delete this._layers[r],this},hasLayer:function(r){return("number"==typeof r?r:this.getLayerId(r))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var u,m,b=Array.prototype.slice.call(arguments,1);for(u in this._layers)(m=this._layers[u])[r]&&m[r].apply(m,b);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,u){for(var m in this._layers)r.call(u,this._layers[m]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:ni})),So=dr.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),dr.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?((r=r in this._layers?this._layers[r]:r).removeEventParent(this),dr.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r,u=new wi;for(r in this._layers){var m=this._layers[r];u.extend(m.getBounds?m.getBounds():m.getLatLng())}return u}}),oo=Nt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){Vi(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,u){var m=this._getIconUrl(r);if(m)return m=this._createImg(m,u&&"IMG"===u.tagName?u:null),this._setIconStyles(m,r),!this.options.crossOrigin&&""!==this.options.crossOrigin||(m.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),m;if("icon"===r)throw new Error("iconUrl not set in Icon options (see the docs).");return null},_setIconStyles:function(r,u){var m=this.options,b=Oe(b="number"==typeof(b=m[u+"Size"])?[b,b]:b),A=Oe("shadow"===u&&m.shadowAnchor||m.iconAnchor||b&&b.divideBy(2,!0));r.className="leaflet-marker-"+u+" "+(m.className||""),A&&(r.style.marginLeft=-A.x+"px",r.style.marginTop=-A.y+"px"),b&&(r.style.width=b.x+"px",r.style.height=b.y+"px")},_createImg:function(r,u){return(u=u||document.createElement("img")).src=r,u},_getIconUrl:function(r){return re.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}}),Ca=oo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return"string"!=typeof Ca.imagePath&&(Ca.imagePath=this._detectIconPath()),(this.options.imagePath||Ca.imagePath)+oo.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){function u(m,b,A){return(b=b.exec(m))&&b[A]}return(r=u(r,/^url\((['"])?(.+)\1\)$/,2))&&u(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=ri("div","leaflet-default-icon-path",document.body),u=Pn(r,"background-image")||Pn(r,"backgroundImage");return document.body.removeChild(r),(u=this._stripUrl(u))?u:(r=document.querySelector('link[href$="leaflet.css"]'))?r.href.substring(0,r.href.length-11-1):""}}),Ha=cr.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new Fn(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ce(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ke(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var u=this._marker,m=u._map,b=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,V=st(u._icon),ct=m.getPixelBounds(),ut=m.getPixelOrigin();(ut=ln(ct.min._subtract(ut).add(A),ct.max._subtract(ut).subtract(A))).contains(V)||(A=Oe((Math.max(ut.max.x,V.x)-ut.max.x)/(ct.max.x-ut.max.x)-(Math.min(ut.min.x,V.x)-ut.min.x)/(ct.min.x-ut.min.x),(Math.max(ut.max.y,V.y)-ut.max.y)/(ct.max.y-ut.max.y)-(Math.min(ut.min.y,V.y)-ut.min.y)/(ct.min.y-ut.min.y)).multiplyBy(b),m.panBy(A,{animate:!1}),this._draggable._newPos._add(A),this._draggable._startPos._add(A),nt(u._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=Ue(this._adjustPan.bind(this,r)))},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(le(this._panRequest),this._panRequest=Ue(this._adjustPan.bind(this,r)))},_onDrag:function(r){var u=this._marker,m=u._shadow,b=st(u._icon),A=u._map.layerPointToLatLng(b);m&&nt(m,b),u._latlng=A,r.latlng=A,r.oldLatLng=this._oldLatLng,u.fire("move",r).fire("drag",r)},_onDragEnd:function(r){le(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),Dr=Xn.extend({options:{icon:new Ca,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,u){Vi(this,u),this._latlng=pi(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var u=this._latlng;return this._latlng=pi(r),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){var r;return this._icon&&this._map&&(r=this._map.latLngToLayerPoint(this._latlng).round(),this._setPos(r)),this},_initIcon:function(){var b,r=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),m=!1,A=!1;(b=r.icon.createIcon(this._icon))!==this._icon&&(this._icon&&this._removeIcon(),m=!0,r.title&&(b.title=r.title),"IMG"===b.tagName&&(b.alt=r.alt||"")),Ce(b,u),r.keyboard&&(b.tabIndex="0",b.setAttribute("role","button")),this._icon=b,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&vt(b,"focus",this._panOnFocus,this),(b=r.icon.createShadow(this._shadow))!==this._shadow&&(this._removeShadow(),A=!0),b&&(Ce(b,u),b.alt=""),this._shadow=b,r.opacity<1&&this._updateOpacity(),m&&this.getPane().appendChild(this._icon),this._initInteraction(),b&&A&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ft(this._icon,"focus",this._panOnFocus,this),Ti(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ti(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&nt(this._icon,r),this._shadow&&nt(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){r=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round(),this._setPos(r)},_initInteraction:function(){var r;this.options.interactive&&(Ce(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ha&&(r=this.options.draggable,this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ha(this),r&&this.dragging.enable()))},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&F(this._icon,r),this._shadow&&F(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r,u,m=this._map;m&&(r=(u=this.options.icon.options).iconSize?Oe(u.iconSize):Oe(0,0),u=u.iconAnchor?Oe(u.iconAnchor):Oe(0,0),m.panInside(this._latlng,{paddingTopLeft:u,paddingBottomRight:r.subtract(u)}))},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),Or=Xn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return Vi(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Eo=Or.extend({options:{fill:!0,radius:10},initialize:function(r,u){Vi(this,u),this._latlng=pi(r),this._radius=this.options.radius},setLatLng:function(r){var u=this._latlng;return this._latlng=pi(r),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var u=r&&r.radius||this._radius;return Or.prototype.setStyle.call(this,r),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var m=this._radius,r=this._radiusY||m,u=this._clickTolerance();this._pxBounds=new Ct(this._point.subtract(m=[m+u,r+u]),this._point.add(m))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Ho=Eo.extend({initialize:function(r,u,m){if(Vi(this,u="number"==typeof u?dt({},m,{radius:u}):u),this._latlng=pi(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new wi(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:Or.prototype.setStyle,_project:function(){var r,u,m,b,A,V=this._latlng.lng,ct=this._latlng.lat,ut=this._map,Dt=ut.options.crs;Dt.distance===ki.distance?(b=Math.PI/180,r=ut.project([ct+(A=this._mRadius/ki.R/b),V]),u=ut.project([ct-A,V]),u=r.add(u).divideBy(2),m=ut.unproject(u).lat,b=Math.acos((Math.cos(A*b)-Math.sin(ct*b)*Math.sin(m*b))/(Math.cos(ct*b)*Math.cos(m*b)))/b,!isNaN(b)&&0!==b||(b=A/Math.cos(Math.PI/180*ct)),this._point=u.subtract(ut.getPixelOrigin()),this._radius=isNaN(b)?0:u.x-ut.project([m,V-b]).x,this._radiusY=u.y-r.y):(A=Dt.unproject(Dt.project(this._latlng).subtract([this._mRadius,0])),this._point=ut.latLngToLayerPoint(this._latlng),this._radius=this._point.x-ut.latLngToLayerPoint(A).x),this._updateBounds()}}),Tr=Or.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,u){Vi(this,u),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var u=1/0,m=null,b=Ga,A=0,V=this._parts.length;A<V;A++)for(var ct=this._parts[A],ut=1,Dt=ct.length;ut<Dt;ut++){var jt,ye,li=b(r,jt=ct[ut-1],ye=ct[ut],!0);li<u&&(u=li,m=b(r,jt,ye))}return m&&(m.distance=Math.sqrt(u)),m},getCenter:function(){if(this._map)return Jr(this._defaultShape(),this._map.options.crs);throw new Error("Must add layer to map before using getCenter()")},getBounds:function(){return this._bounds},addLatLng:function(r,u){return u=u||this._defaultShape(),r=pi(r),u.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new wi,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return Ln(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var u=[],m=Ln(r),b=0,A=r.length;b<A;b++)m?(u[b]=pi(r[b]),this._bounds.extend(u[b])):u[b]=this._convertLatLngs(r[b]);return u},_project:function(){var r=new Ct;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=new Se(r=this._clickTolerance(),r);this._rawPxBounds&&(this._pxBounds=new Ct([this._rawPxBounds.min.subtract(r),this._rawPxBounds.max.add(r)]))},_projectLatlngs:function(r,u,m){var b,A,ct=r.length;if(r[0]instanceof ci){for(A=[],b=0;b<ct;b++)A[b]=this._map.latLngToLayerPoint(r[b]),m.extend(A[b]);u.push(A)}else for(b=0;b<ct;b++)this._projectLatlngs(r[b],u,m)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(r))if(this.options.noClip)this._parts=this._rings;else for(var u,m,b,A,V=this._parts,ct=0,ut=0,Dt=this._rings.length;ct<Dt;ct++)for(u=0,m=(A=this._rings[ct]).length;u<m-1;u++)(b=wr(A[u],A[u+1],r,u,!0))&&(V[ut]=V[ut]||[],V[ut].push(b[0]),b[1]===A[u+1]&&u!==m-2||(V[ut].push(b[1]),ut++))},_simplifyPoints:function(){for(var r=this._parts,u=this.options.smoothFactor,m=0,b=r.length;m<b;m++)r[m]=Gi(r[m],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,u){var m,b,A,V,ct,ut,Dt=this._clickTolerance();if(this._pxBounds&&this._pxBounds.contains(r))for(m=0,V=this._parts.length;m<V;m++)for(b=0,A=(ct=(ut=this._parts[m]).length)-1;b<ct;A=b++)if((u||0!==b)&&ro(r,ut[A],ut[b])<=Dt)return!0;return!1}});Tr._flat=Un;var ao=Tr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(this._map)return oa(this._defaultShape(),this._map.options.crs);throw new Error("Must add layer to map before using getCenter()")},_convertLatLngs:function(u){var m=(u=Tr.prototype._convertLatLngs.call(this,u)).length;return 2<=m&&u[0]instanceof ci&&u[0].equals(u[m-1])&&u.pop(),u},_setLatLngs:function(r){Tr.prototype._setLatLngs.call(this,r),Ln(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return(Ln(this._latlngs[0])?this._latlngs:this._latlngs[0])[0]},_clipPoints:function(){var u=this._renderer._bounds,r=new Se(r=this.options.weight,r);if(u=new Ct(u.min.subtract(r),u.max.add(r)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(u))if(this.options.noClip)this._parts=this._rings;else for(var m,b=0,A=this._rings.length;b<A;b++)(m=pr(this._rings[b],u,!0)).length&&this._parts.push(m)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var u,m,b,A,V,ct,ut,Dt,jt=!1;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(A=0,ut=this._parts.length;A<ut;A++)for(V=0,ct=(Dt=(u=this._parts[A]).length)-1;V<Dt;ct=V++)(m=u[V]).y>r.y!=(b=u[ct]).y>r.y&&r.x<(b.x-m.x)*(r.y-m.y)/(b.y-m.y)+m.x&&(jt=!jt);return jt||Tr.prototype._containsPoint.call(this,r,!0)}}),Sn=So.extend({initialize:function(r,u){Vi(this,u),this._layers={},r&&this.addData(r)},addData:function(r){var u,m,b,A=ee(r)?r:r.features;if(A){for(u=0,m=A.length;u<m;u++)((b=A[u]).geometries||b.geometry||b.features||b.coordinates)&&this.addData(b);return this}var V,ct=this.options;return ct.filter&&!ct.filter(r)||!(V=or(r,ct))?this:(V.feature=za(r),V.defaultOptions=V.options,this.resetStyle(V),ct.onEachFeature&&ct.onEachFeature(r,V),this.addLayer(V))},resetStyle:function(r){return void 0===r?this.eachLayer(this.resetStyle,this):(r.options=dt({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(u){this._setLayerStyle(u,r)},this)},_setLayerStyle:function(r,u){r.setStyle&&("function"==typeof u&&(u=u(r.feature)),r.setStyle(u))}});function or(r,u){var m,b,A,V,ct="Feature"===r.type?r.geometry:r,ut=ct?ct.coordinates:null,Dt=[],jt=u&&u.pointToLayer,ye=u&&u.coordsToLatLng||Po;if(!ut&&!ct)return null;switch(ct.type){case"Point":return cn(jt,r,m=ye(ut),u);case"MultiPoint":for(A=0,V=ut.length;A<V;A++)m=ye(ut[A]),Dt.push(cn(jt,r,m,u));return new So(Dt);case"LineString":case"MultiLineString":return b=La(ut,"LineString"===ct.type?0:1,ye),new Tr(b,u);case"Polygon":case"MultiPolygon":return b=La(ut,"Polygon"===ct.type?1:2,ye),new ao(b,u);case"GeometryCollection":for(A=0,V=ct.geometries.length;A<V;A++){var li=or({geometry:ct.geometries[A],type:"Feature",properties:r.properties},u);li&&Dt.push(li)}return new So(Dt);case"FeatureCollection":for(A=0,V=ct.features.length;A<V;A++){var Ui=or(ct.features[A],u);Ui&&Dt.push(Ui)}return new So(Dt);default:throw new Error("Invalid GeoJSON object.")}}function cn(r,u,m,b){return r?r(u,m):new Dr(m,b&&b.markersInheritOptions&&b)}function Po(r){return new ci(r[1],r[0],r[2])}function La(r,u,m){for(var b,A=[],V=0,ct=r.length;V<ct;V++)b=u?La(r[V],u-1,m):(m||Po)(r[V]),A.push(b);return A}function Xa(r,u){return void 0!==(r=pi(r)).alt?[zr(r.lng,u),zr(r.lat,u),zr(r.alt,u)]:[zr(r.lng,u),zr(r.lat,u)]}function Ka(r,u,m,b){for(var A=[],V=0,ct=r.length;V<ct;V++)A.push(u?Ka(r[V],Ln(r[V])?0:u-1,m,b):Xa(r[V],b));return!u&&m&&A.push(A[0].slice()),A}function Xo(r,u){return r.feature?dt({},r.feature,{geometry:u}):za(u)}function za(r){return"Feature"===r.type||"FeatureCollection"===r.type?r:{type:"Feature",properties:{},geometry:r}}function ss(r,u){return new Sn(r,u)}Dr.include(Dn={toGeoJSON:function(r){return Xo(this,{type:"Point",coordinates:Xa(this.getLatLng(),r)})}}),Ho.include(Dn),Eo.include(Dn),Tr.include({toGeoJSON:function(r){var u=!Ln(this._latlngs);return Xo(this,{type:(u?"Multi":"")+"LineString",coordinates:Ka(this._latlngs,u?1:0,!1,r)})}}),ao.include({toGeoJSON:function(b){var u=!Ln(this._latlngs),m=u&&!Ln(this._latlngs[0]);return b=Ka(this._latlngs,m?2:u?1:0,!0,b),Xo(this,{type:(m?"Multi":"")+"Polygon",coordinates:b=u?b:[b]})}}),dr.include({toMultiPoint:function(r){var u=[];return this.eachLayer(function(m){u.push(m.toGeoJSON(r).geometry.coordinates)}),Xo(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(r){var u,m,b=this.feature&&this.feature.geometry&&this.feature.geometry.type;return"MultiPoint"===b?this.toMultiPoint(r):(u="GeometryCollection"===b,m=[],this.eachLayer(function(A){A.toGeoJSON&&(A=A.toGeoJSON(r),u?m.push(A.geometry):"FeatureCollection"===(A=za(A)).type?m.push.apply(m,A.features):m.push(A))}),u?Xo(this,{geometries:m,type:"GeometryCollection"}):{type:"FeatureCollection",features:m})}}),va=ss;var ka=Xn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,u,m){this._url=r,this._bounds=Bi(u),Vi(this,m)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ce(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ti(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&fn(this._image),this},bringToBack:function(){return this._map&&mn(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=Bi(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r="IMG"===this._url.tagName,u=this._image=r?this._url:ri("img");Ce(u,"leaflet-image-layer"),this._zoomAnimated&&Ce(u,"leaflet-zoom-animated"),this.options.className&&Ce(u,this.options.className),u.onselectstart=sn,u.onmousemove=sn,u.onload=Ei(this.fire,this,"load"),u.onerror=Ei(this._overlayOnError,this,"error"),!this.options.crossOrigin&&""!==this.options.crossOrigin||(u.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r?this._url=u.src:(u.src=this._url,u.alt=this.options.alt)},_animateZoom:function(m){var u=this._map.getZoomScale(m.zoom);m=this._map._latLngBoundsToNewLayerBounds(this._bounds,m.zoom,m.center).min,X(this._image,m,u)},_reset:function(){var r=this._image,u=new Ct(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),m=u.getSize();nt(r,u.min),r.style.width=m.x+"px",r.style.height=m.y+"px"},_updateOpacity:function(){F(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),ls=ka.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r="VIDEO"===this._url.tagName,u=this._image=r?this._url:ri("video");if(Ce(u,"leaflet-image-layer"),this._zoomAnimated&&Ce(u,"leaflet-zoom-animated"),this.options.className&&Ce(u,this.options.className),u.onselectstart=sn,u.onmousemove=sn,u.onloadeddata=Ei(this.fire,this,"load"),r){for(var m=u.getElementsByTagName("source"),b=[],A=0;A<m.length;A++)b.push(m[A].src);this._url=0<m.length?b:[u.src]}else{ee(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var V=0;V<this._url.length;V++){var ct=ri("source");ct.src=this._url[V],u.appendChild(ct)}}}}),Ns=ka.extend({_initImage:function(){var r=this._image=this._url;Ce(r,"leaflet-image-layer"),this._zoomAnimated&&Ce(r,"leaflet-zoom-animated"),this.options.className&&Ce(r,this.options.className),r.onselectstart=sn,r.onmousemove=sn}}),Yr=Xn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,u){r&&(r instanceof ci||ee(r))?(this._latlng=pi(r),Vi(this,u)):(Vi(this,r),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(r){return(r=arguments.length?r:this._source._map).hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&F(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&F(this._container,1),this.bringToFront(),this.options.interactive&&(Ce(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(F(this._container,0),this._removeTimeout=setTimeout(Ei(Ti,void 0,this._container),200)):Ti(this._container),this.options.interactive&&(Ke(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=pi(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&fn(this._container),this},bringToBack:function(){return this._map&&mn(this._container),this},_prepareOpen:function(r){if(!(m=this._source)._map)return!1;if(m instanceof So){var u,m=null,b=this._source._layers;for(u in b)if(b[u]._map){m=b[u];break}if(!m)return!1;this._source=m}if(!r)if(m.getCenter)r=m.getCenter();else if(m.getLatLng)r=m.getLatLng();else{if(!m.getBounds)throw new Error("Unable to get source layer LatLng.");r=m.getBounds().getCenter()}return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,u="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof u)r.innerHTML=u;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){var r,u,m;this._map&&(u=this._map.latLngToLayerPoint(this._latlng),r=Oe(this.options.offset),m=this._getAnchor(),this._zoomAnimated?nt(this._container,u.add(m)):r=r.add(u).add(m),u=this._containerBottom=-r.y,m=this._containerLeft=-Math.round(this._containerWidth/2)+r.x,this._container.style.bottom=u+"px",this._container.style.left=m+"px")},_getAnchor:function(){return[0,0]}}),Ko=(fe.include({_initOverlay:function(r,u,m,b){var A=u;return A instanceof r||(A=new r(b).setContent(u)),m&&A.setLatLng(m),A}}),Xn.include({_initOverlay:function(r,u,m,b){var A=m;return A instanceof r?(Vi(A,b),A._source=this):(A=u&&!b?u:new r(b,this)).setContent(m),A}}),Yr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return!(r=arguments.length?r:this._source._map).hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,Yr.prototype.openOn.call(this,r)},onAdd:function(r){Yr.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Or||this._source.on("preclick",ze))},onRemove:function(r){Yr.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Or||this._source.off("preclick",ze))},getEvents:function(){var r=Yr.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",u=this._container=ri("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),m=this._wrapper=ri("div",r+"-content-wrapper",u);this._contentNode=ri("div",r+"-content",m),Je(u),$t(this._contentNode),vt(u,"contextmenu",ze),this._tipContainer=ri("div",r+"-tip-container",u),this._tip=ri("div",r+"-tip",this._tipContainer),this.options.closeButton&&((m=this._closeButton=ri("a",r+"-close-button",u)).setAttribute("role","button"),m.setAttribute("aria-label","Close popup"),m.href="#close",m.innerHTML='<span aria-hidden="true">&#215;</span>',vt(m,"click",function(b){Ze(b),this.close()},this))},_updateLayout:function(){var r=this._contentNode,u=r.style,m=(u.width="",u.whiteSpace="nowrap",r.offsetWidth),b=(m=Math.min(m,this.options.maxWidth),m=Math.max(m,this.options.minWidth),u.width=m+1+"px",u.whiteSpace="",u.height="",m=r.offsetHeight,this.options.maxHeight);(b&&b<m?(u.height=b+"px",Ce):Ke)(r,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(u){u=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center);var m=this._getAnchor();nt(this._container,u.add(m))},_adjustPan:function(){var r,u,m,b,A,V,ct,ut;this.options.autoPan&&(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning?this._autopanning=!1:(r=this._map,u=parseInt(Pn(this._container,"marginBottom"),10)||0,ut=this._containerWidth,(m=new Se(this._containerLeft,-(u=this._container.offsetHeight+u)-this._containerBottom))._add(st(this._container)),m=r.layerPointToContainerPoint(m),A=Oe(this.options.autoPanPadding),b=Oe(this.options.autoPanPaddingTopLeft||A),A=Oe(this.options.autoPanPaddingBottomRight||A),V=r.getSize(),ct=0,m.x+ut+A.x>V.x&&(ct=m.x+ut-V.x+A.x),m.x-ct-b.x<(ut=0)&&(ct=m.x-b.x),m.y+u+A.y>V.y&&(ut=m.y+u-V.y+A.y),m.y-ut-b.y<0&&(ut=m.y-b.y),(ct||ut)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([ct,ut]))))},_getAnchor:function(){return Oe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}})),Ma=(fe.mergeOptions({closePopupOnClick:!0}),fe.include({openPopup:function(r,u,m){return this._initOverlay(Ko,r,u,m).openOn(this),this},closePopup:function(r){return(r=arguments.length?r:this._popup)&&r.close(),this}}),Xn.include({bindPopup:function(r,u){return this._popup=this._initOverlay(Ko,this._popup,r,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof So||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){var u;this._popup&&this._map&&(Be(r),this._popup._source!==(u=r.layer||r.target)||u instanceof Or?(this._popup._source=u,this.openPopup(r.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng))},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){13===r.originalEvent.keyCode&&this._openPopup(r)}}),Yr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){Yr.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){Yr.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=Yr.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){this._contentNode=this._container=ri("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide")),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+ni(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var u,m=this._container,b=(jt=this._map).latLngToContainerPoint(jt.getCenter()),jt=jt.layerPointToContainerPoint(r),A=this.options.direction,V=m.offsetWidth,ct=m.offsetHeight,ut=Oe(this.options.offset),Dt=this._getAnchor();jt="top"===A?(u=V/2,ct):"bottom"===A?(u=V/2,0):(u="center"===A?V/2:"right"===A?0:"left"===A?V:jt.x<b.x?(A="right",0):(A="left",V+2*(ut.x+Dt.x)),ct/2),r=r.subtract(Oe(u,jt,!0)).add(ut).add(Dt),Ke(m,"leaflet-tooltip-right"),Ke(m,"leaflet-tooltip-left"),Ke(m,"leaflet-tooltip-top"),Ke(m,"leaflet-tooltip-bottom"),Ce(m,"leaflet-tooltip-"+A),nt(m,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&F(this._container,r)},_animateZoom:function(r){r=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),this._setPosition(r)},_getAnchor:function(){return Oe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}})),Nn=(fe.include({openTooltip:function(r,u,m){return this._initOverlay(Ma,r,u,m).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),Xn.include({bindTooltip:function(r,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ma,this._tooltip,r,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){var u,m;!r&&this._tooltipHandlersAdded||(u=r?"off":"on",m={remove:this.closeTooltip,move:this._moveTooltip},this._tooltip.options.permanent?m.add=this._openTooltip:(m.mouseover=this._openTooltip,m.mouseout=this.closeTooltip,m.click=this._openTooltip,this._map?this._addFocusListeners():m.add=this._addFocusListeners),this._tooltip.options.sticky&&(m.mousemove=this._moveTooltip),this[u](m),this._tooltipHandlersAdded=!r)},openTooltip:function(r){return this._tooltip&&(this instanceof So||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var u=r.getElement();u&&(vt(u,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),vt(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){(r=r.getElement())&&r.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0))},_moveTooltip:function(r){var u=r.latlng;this._tooltip.options.sticky&&r.originalEvent&&(r=this._map.mouseEventToContainerPoint(r.originalEvent),r=this._map.containerPointToLayerPoint(r),u=this._map.layerPointToLatLng(r)),this._tooltip.setLatLng(u)}}),oo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(u){u=u&&"DIV"===u.tagName?u:document.createElement("div");var m=this.options;return m.html instanceof Element?(Mr(u),u.appendChild(m.html)):u.innerHTML=!1!==m.html?m.html:"",m.bgPos&&(m=Oe(m.bgPos),u.style.backgroundPosition=-m.x+"px "+-m.y+"px"),this._setIconStyles(u,"icon"),u},createShadow:function(){return null}}));oo.Default=Ca;var sa=Xn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:re.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){Vi(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),Ti(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(fn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(mn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){var r;return this._map&&(this._removeAllTiles(),(r=this._clampZoom(this._map.getZoom()))!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()),this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Go(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof Se?r:new Se(r,r)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var u,m=this.getPane().children,b=-r(-1/0,1/0),A=0,V=m.length;A<V;A++)u=m[A].style.zIndex,m[A]!==this._container&&u&&(b=r(b,+u));isFinite(b)&&(this.options.zIndex=b+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!re.ielt9){F(this._container,this.options.opacity);var r,u=+new Date,m=!1,b=!1;for(r in this._tiles){var A,V=this._tiles[r];V.current&&V.loaded&&(A=Math.min(1,(u-V.loaded)/200),F(V.el,A),A<1?m=!0:(V.active?b=!0:this._onOpaqueTile(V),V.active=!0))}b&&!this._noPrune&&this._pruneTiles(),m&&(le(this._fadeFrame),this._fadeFrame=Ue(this._updateOpacity,this))}},_onOpaqueTile:sn,_initContainer:function(){this._container||(this._container=ri("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,u=this.options.maxZoom;if(void 0!==r){for(var m in this._levels)m=Number(m),this._levels[m].el.children.length||m===r?(this._levels[m].el.style.zIndex=u-Math.abs(r-m),this._onUpdateLevel(m)):(Ti(this._levels[m].el),this._removeTilesAtZoom(m),this._onRemoveLevel(m),delete this._levels[m]);var b=this._levels[r],A=this._map;return b||((b=this._levels[r]={}).el=ri("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=u,b.origin=A.project(A.unproject(A.getPixelOrigin()),r).round(),b.zoom=r,this._setZoomTransform(b,A.getCenter(),A.getZoom()),this._onCreateLevel(b)),this._level=b}},_onUpdateLevel:sn,_onRemoveLevel:sn,_onCreateLevel:sn,_pruneTiles:function(){if(this._map){var r,u,m,b=this._map.getZoom();if(b>this.options.maxZoom||b<this.options.minZoom)this._removeAllTiles();else{for(r in this._tiles)(m=this._tiles[r]).retain=m.current;for(r in this._tiles)(m=this._tiles[r]).current&&!m.active&&(this._retainParent((u=m.coords).x,u.y,u.z,u.z-5)||this._retainChildren(u.x,u.y,u.z,u.z+2));for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}}},_removeTilesAtZoom:function(r){for(var u in this._tiles)this._tiles[u].coords.z===r&&this._removeTile(u)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)Ti(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(A,V,ct,b){ct-=1;var ut=((ut=new Se(+(A=Math.floor(A/2)),+(V=Math.floor(V/2)))).z=ct,this._tileCoordsToKey(ut));return(ut=this._tiles[ut])&&ut.active?ut.retain=!0:(ut&&ut.loaded&&(ut.retain=!0),b<ct&&this._retainParent(A,V,ct,b))},_retainChildren:function(r,u,m,b){for(var A=2*r;A<2*r+2;A++)for(var V=2*u;V<2*u+2;V++){var ct=((ct=new Se(A,V)).z=m+1,this._tileCoordsToKey(ct));(ct=this._tiles[ct])&&ct.active?ct.retain=!0:(ct&&ct.loaded&&(ct.retain=!0),m+1<b&&this._retainChildren(A,V,m+1,b))}},_resetView:function(r){r=r&&(r.pinch||r.flyTo),this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var u=this.options;return void 0!==u.minNativeZoom&&r<u.minNativeZoom?u.minNativeZoom:void 0!==u.maxNativeZoom&&u.maxNativeZoom<r?u.maxNativeZoom:r},_setView:function(r,u,m,b){var A=Math.round(u);A=void 0!==this.options.maxZoom&&A>this.options.maxZoom||void 0!==this.options.minZoom&&A<this.options.minZoom?void 0:this._clampZoom(A),b&&!(this.options.updateWhenZooming&&A!==this._tileZoom)||(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==A&&this._update(r),m||this._pruneTiles(),this._noPrune=!!m),this._setZoomTransforms(r,u)},_setZoomTransforms:function(r,u){for(var m in this._levels)this._setZoomTransform(this._levels[m],r,u)},_setZoomTransform:function(r,A,m){var b=this._map.getZoomScale(m,r.zoom);A=r.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(A,m)).round(),re.any3d?X(r.el,A,b):nt(r.el,A)},_resetGrid:function(){var r=this._map,u=r.options.crs,m=this._tileSize=this.getTileSize(),b=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,u.wrapLng[0]],b).x/m.x),Math.ceil(r.project([0,u.wrapLng[1]],b).x/m.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([u.wrapLat[0],0],b).y/m.x),Math.ceil(r.project([u.wrapLat[1],0],b).y/m.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(m){var u=(b=this._map)._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),b=(u=b.getZoomScale(u,this._tileZoom),m=b.project(m,this._tileZoom).floor(),b.getSize().divideBy(2*u));return new Ct(m.subtract(b),m.add(b))},_update:function(r){if(u=this._map){var m=this._clampZoom(u.getZoom());if(void 0===r&&(r=u.getCenter()),void 0!==this._tileZoom){var b,u=this._getTiledPixelBounds(r),A=this._pxBoundsToTileRange(u),V=A.getCenter(),ct=[],ut=(u=this.options.keepBuffer,new Ct(A.getBottomLeft().subtract([u,-u]),A.getTopRight().add([u,-u])));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(b in this._tiles){var Dt=this._tiles[b].coords;Dt.z===this._tileZoom&&ut.contains(new Se(Dt.x,Dt.y))||(this._tiles[b].current=!1)}if(1<Math.abs(m-this._tileZoom))this._setView(r,m);else{for(var jt=A.min.y;jt<=A.max.y;jt++)for(var ye=A.min.x;ye<=A.max.x;ye++){var li,Ui=new Se(ye,jt);Ui.z=this._tileZoom,this._isValidTile(Ui)&&((li=this._tiles[this._tileCoordsToKey(Ui)])?li.current=!0:ct.push(Ui))}if(ct.sort(function(Sr,Kn){return Sr.distanceTo(V)-Kn.distanceTo(V)}),0!==ct.length){this._loading||(this._loading=!0,this.fire("loading"));var _n=document.createDocumentFragment();for(ye=0;ye<ct.length;ye++)this._addTile(ct[ye],_n);this._level.el.appendChild(_n)}}}}},_isValidTile:function(r){var u=this._map.options.crs;if(!u.infinite){var m=this._globalTileRange;if(!u.wrapLng&&(r.x<m.min.x||r.x>m.max.x)||!u.wrapLat&&(r.y<m.min.y||r.y>m.max.y))return!1}return!this.options.bounds||(u=this._tileCoordsToBounds(r),Bi(this.options.bounds).overlaps(u))},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var u=this._map,b=this.getTileSize(),m=r.scaleBy(b);return b=m.add(b),[u.unproject(m,r.z),u.unproject(b,r.z)]},_tileCoordsToBounds:function(r){return r=new wi((r=this._tileCoordsToNwSe(r))[0],r[1]),this.options.noWrap?r:this._map.wrapLatLngBounds(r)},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(u){var m=new Se(+(u=u.split(":"))[0],+u[1]);return m.z=+u[2],m},_removeTile:function(r){var u=this._tiles[r];u&&(Ti(u.el),delete this._tiles[r],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){Ce(r,"leaflet-tile");var u=this.getTileSize();r.style.width=u.x+"px",r.style.height=u.y+"px",r.onselectstart=sn,r.onmousemove=sn,re.ielt9&&this.options.opacity<1&&F(r,this.options.opacity)},_addTile:function(r,u){var m=this._getTilePos(r),b=this._tileCoordsToKey(r),A=this.createTile(this._wrapCoords(r),Ei(this._tileReady,this,r));this._initTile(A),this.createTile.length<2&&Ue(Ei(this._tileReady,this,r,null,A)),nt(A,m),this._tiles[b]={el:A,coords:r,current:!0},u.appendChild(A),this.fire("tileloadstart",{tile:A,coords:r})},_tileReady:function(r,u,m){u&&this.fire("tileerror",{error:u,tile:m,coords:r});var b=this._tileCoordsToKey(r);(m=this._tiles[b])&&(m.loaded=+new Date,this._map._fadeAnimated?(F(m.el,0),le(this._fadeFrame),this._fadeFrame=Ue(this._updateOpacity,this)):(m.active=!0,this._pruneTiles()),u||(Ce(m.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:m.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),re.ielt9||!this._map._fadeAnimated?Ue(this._pruneTiles,this):setTimeout(Ei(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var u=new Se(this._wrapX?Lr(r.x,this._wrapX):r.x,this._wrapY?Lr(r.y,this._wrapY):r.y);return u.z=r.z,u},_pxBoundsToTileRange:function(r){var u=this.getTileSize();return new Ct(r.min.unscaleBy(u).floor(),r.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}}),$r=sa.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,u){this._url=r,(u=Vi(this,u)).detectRetina&&re.retina&&0<u.maxZoom?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),"string"==typeof u.subdomains&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,u){return this._url===r&&void 0===u&&(u=!0),this._url=r,u||this.redraw(),this},createTile:function(r,u){var m=document.createElement("img");return vt(m,"load",Ei(this._tileOnLoad,this,u,m)),vt(m,"error",Ei(this._tileOnError,this,u,m)),!this.options.crossOrigin&&""!==this.options.crossOrigin||(m.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(m.referrerPolicy=this.options.referrerPolicy),m.alt="",m.src=this.getTileUrl(r),m},getTileUrl:function(r){var u={r:re.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};return this._map&&!this._map.options.crs.infinite&&(r=this._globalTileRange.max.y-r.y,this.options.tms&&(u.y=r),u["-y"]=r),Bt(this._url,dt(u,this.options))},_tileOnLoad:function(r,u){re.ielt9?setTimeout(Ei(r,this,null,u),0):r(null,u)},_tileOnError:function(r,u,m){var b=this.options.errorTileUrl;b&&u.getAttribute("src")!==b&&(u.src=b),r(m,u)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom;return(r=this.options.zoomReverse?this.options.maxZoom-r:r)+this.options.zoomOffset},_getSubdomain:function(r){return r=Math.abs(r.x+r.y)%this.options.subdomains.length,this.options.subdomains[r]},_abortLoading:function(){var r,u,m;for(r in this._tiles)this._tiles[r].coords.z!==this._tileZoom&&((m=this._tiles[r].el).onload=sn,m.onerror=sn,m.complete||(m.src=Te,u=this._tiles[r].coords,Ti(m),delete this._tiles[r],this.fire("tileabort",{tile:m,coords:u})))},_removeTile:function(r){var u=this._tiles[r];if(u)return u.el.setAttribute("src",Te),sa.prototype._removeTile.call(this,r)},_tileReady:function(r,u,m){if(this._map&&(!m||m.getAttribute("src")!==Te))return sa.prototype._tileReady.call(this,r,u,m)}});function Ao(r,u){return new $r(r,u)}var la=$r.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(A,u){this._url=A;var m,b=dt({},this.defaultWmsParams);for(m in u)m in this.options||(b[m]=u[m]);A=(u=Vi(this,u)).detectRetina&&re.retina?2:1;var V=this.getTileSize();b.width=V.x*A,b.height=V.y*A,this.wmsParams=b},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code,$r.prototype.onAdd.call(this,r)},getTileUrl:function(r){var u=this._tileCoordsToNwSe(r),m=(u=(m=ln((m=this._crs).project(u[0]),m.project(u[1]))).min,m.max);return u=(1.3<=this._wmsVersion&&this._crs===Ps?[u.y,u.x,m.y,m.x]:[u.x,u.y,m.x,m.y]).join(","),(m=$r.prototype.getTileUrl.call(this,r))+ur(this.wmsParams,m,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+u},setParams:function(r,u){return dt(this.wmsParams,r),u||this.redraw(),this}});$r.WMS=la,Ao.wms=function(r,u){return new la(r,u)};var Br=Xn.extend({options:{padding:.1},initialize:function(r){Vi(this,r),ni(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Ce(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,u){var m=this._map.getZoomScale(u,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),b=this._map.project(this._center,u);A=A.multiplyBy(-m).add(b).subtract(this._map._getNewPixelOrigin(r,u)),re.any3d?X(this._container,A,m):nt(this._container,A)},_reset:function(){for(var r in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,u=this._map.getSize(),m=this._map.containerPointToLayerPoint(u.multiplyBy(-r)).round();this._bounds=new Ct(m,m.add(u.multiplyBy(1+2*r)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Rr=Br.extend({options:{tolerance:0},getEvents:function(){var r=Br.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Br.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");vt(r,"mousemove",this._onMouseMove,this),vt(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),vt(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){le(this._redrawRequest),delete this._ctx,Ti(this._container),Ft(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var r in this._redrawBounds=null,this._layers)this._layers[r]._update();this._redraw()}},_update:function(){var r,u,m,b;this._map._animatingZoom&&this._bounds||(Br.prototype._update.call(this),u=this._container,m=(r=this._bounds).getSize(),b=re.retina?2:1,nt(u,r.min),u.width=b*m.x,u.height=b*m.y,u.style.width=m.x+"px",u.style.height=m.y+"px",re.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update"))},_reset:function(){Br.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),r=(this._layers[ni(r)]=r)._order={layer:r,prev:this._drawLast,next:null},this._drawLast&&(this._drawLast.next=r),this._drawLast=r,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var u=(m=r._order).next,m=m.prev;u?u.prev=m:this._drawLast=m,m?m.next=u:this._drawFirst=u,delete r._order,delete this._layers[ni(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if("string"==typeof r.options.dashArray){for(var u,m=r.options.dashArray.split(/[, ]+/),b=[],A=0;A<m.length;A++){if(u=Number(m[A]),isNaN(u))return;b.push(u)}r.options._dashArray=b}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||Ue(this._redraw,this))},_extendRedrawBounds:function(r){var u;r._pxBounds&&(u=(r.options.weight||0)+1,this._redrawBounds=this._redrawBounds||new Ct,this._redrawBounds.extend(r._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(r._pxBounds.max.add([u,u])))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r,u=this._redrawBounds;u?(r=u.getSize(),this._ctx.clearRect(u.min.x,u.min.y,r.x,r.y)):(this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore())},_draw:function(){var r,u,m=this._redrawBounds;this._ctx.save(),m&&(u=m.getSize(),this._ctx.beginPath(),this._ctx.rect(m.min.x,m.min.y,u.x,u.y),this._ctx.clip()),this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)r=b.layer,(!m||r._pxBounds&&r._pxBounds.intersects(m))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,u){if(this._drawing){var m,b,A,V,ct=r._parts,ut=ct.length,Dt=this._ctx;if(ut){for(Dt.beginPath(),m=0;m<ut;m++){for(b=0,A=ct[m].length;b<A;b++)Dt[b?"lineTo":"moveTo"]((V=ct[m][b]).x,V.y);u&&Dt.closePath()}this._fillStroke(Dt,r)}}},_updateCircle:function(r){var u,m,b,A;this._drawing&&!r._empty()&&(u=r._point,m=this._ctx,b=Math.max(Math.round(r._radius),1),1!=(A=(Math.max(Math.round(r._radiusY),1)||b)/b)&&(m.save(),m.scale(1,A)),m.beginPath(),m.arc(u.x,u.y/A,b,0,2*Math.PI,!1),1!=A&&m.restore(),this._fillStroke(m,r))},_fillStroke:function(r,u){var m=u.options;m.fill&&(r.globalAlpha=m.fillOpacity,r.fillStyle=m.fillColor||m.color,r.fill(m.fillRule||"evenodd")),m.stroke&&0!==m.weight&&(r.setLineDash&&r.setLineDash(u.options&&u.options._dashArray||[]),r.globalAlpha=m.opacity,r.lineWidth=m.weight,r.strokeStyle=m.color,r.lineCap=m.lineCap,r.lineJoin=m.lineJoin,r.stroke())},_onClick:function(r){for(var u,m,b=this._map.mouseEventToLayerPoint(r),A=this._drawFirst;A;A=A.next)(u=A.layer).options.interactive&&u._containsPoint(b)&&(("click"===r.type||"preclick"===r.type)&&this._map._draggableMoved(u)||(m=u));this._fireEvent(!!m&&[m],r)},_onMouseMove:function(r){var u;!this._map||this._map.dragging.moving()||this._map._animatingZoom||(u=this._map.mouseEventToLayerPoint(r),this._handleMouseHover(r,u))},_handleMouseOut:function(r){var u=this._hoveredLayer;u&&(Ke(this._container,"leaflet-interactive"),this._fireEvent([u],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,u){if(!this._mouseHoverThrottled){for(var m,b,A=this._drawFirst;A;A=A.next)(m=A.layer).options.interactive&&m._containsPoint(u)&&(b=m);b!==this._hoveredLayer&&(this._handleMouseOut(r),b&&(Ce(this._container,"leaflet-interactive"),this._fireEvent([b],r,"mouseover"),this._hoveredLayer=b)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],r),this._mouseHoverThrottled=!0,setTimeout(Ei(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,u,m){this._map._fireDOMEvent(u,m||u.type,r)},_bringToFront:function(r){var u,m,b=r._order;b&&(m=b.prev,(u=b.next)&&((u.prev=m)?m.next=u:u&&(this._drawFirst=u),b.prev=this._drawLast,(this._drawLast.next=b).next=null,this._drawLast=b,this._requestRedraw(r)))},_bringToBack:function(r){var u,m,b=r._order;b&&(u=b.next,(m=b.prev)&&((m.next=u)?u.prev=m:m&&(this._drawLast=m),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(r)))}});function Jo(r){return re.canvas?new Rr(r):null}var yo=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Da=(so={_initContainer:function(){this._container=ri("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Br.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var u=r._container=yo("shape");Ce(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",r._path=yo("path"),u.appendChild(r._path),this._updateStyle(r),this._layers[ni(r)]=r},_addPath:function(r){var u=r._container;this._container.appendChild(u),r.options.interactive&&r.addInteractiveTarget(u)},_removePath:function(r){var u=r._container;Ti(u),r.removeInteractiveTarget(u),delete this._layers[ni(r)]},_updateStyle:function(r){var u=r._stroke,m=r._fill,b=r.options,A=r._container;A.stroked=!!b.stroke,A.filled=!!b.fill,b.stroke?(u=u||(r._stroke=yo("stroke")),A.appendChild(u),u.weight=b.weight+"px",u.color=b.color,u.opacity=b.opacity,u.dashStyle=b.dashArray?ee(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):"",u.endcap=b.lineCap.replace("butt","flat"),u.joinstyle=b.lineJoin):u&&(A.removeChild(u),r._stroke=null),b.fill?(m=m||(r._fill=yo("fill")),A.appendChild(m),m.color=b.fillColor||b.color,m.opacity=b.fillOpacity):m&&(A.removeChild(m),r._fill=null)},_updateCircle:function(r){var u=r._point.round(),m=Math.round(r._radius),b=Math.round(r._radiusY||m);this._setPath(r,r._empty()?"M0 0":"AL "+u.x+","+u.y+" "+m+","+b+" 0,23592600")},_setPath:function(r,u){r._path.v=u},_bringToFront:function(r){fn(r._container)},_bringToBack:function(r){mn(r._container)}},re.vml?yo:qe),xa=Br.extend({_initContainer:function(){this._container=Da("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Da("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ti(this._container),Ft(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){var r,u,m;this._map._animatingZoom&&this._bounds||(Br.prototype._update.call(this),u=(r=this._bounds).getSize(),m=this._container,this._svgSize&&this._svgSize.equals(u)||(this._svgSize=u,m.setAttribute("width",u.x),m.setAttribute("height",u.y)),nt(m,r.min),m.setAttribute("viewBox",[r.min.x,r.min.y,u.x,u.y].join(" ")),this.fire("update"))},_initPath:function(r){var u=r._path=Da("path");r.options.className&&Ce(u,r.options.className),r.options.interactive&&Ce(u,"leaflet-interactive"),this._updateStyle(r),this._layers[ni(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){Ti(r._path),r.removeInteractiveTarget(r._path),delete this._layers[ni(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(m){var u=m._path;m=m.options,u&&(m.stroke?(u.setAttribute("stroke",m.color),u.setAttribute("stroke-opacity",m.opacity),u.setAttribute("stroke-width",m.weight),u.setAttribute("stroke-linecap",m.lineCap),u.setAttribute("stroke-linejoin",m.lineJoin),m.dashArray?u.setAttribute("stroke-dasharray",m.dashArray):u.removeAttribute("stroke-dasharray"),m.dashOffset?u.setAttribute("stroke-dashoffset",m.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),m.fill?(u.setAttribute("fill",m.fillColor||m.color),u.setAttribute("fill-opacity",m.fillOpacity),u.setAttribute("fill-rule",m.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(r,u){this._setPath(r,hr(r._parts,u))},_updateCircle:function(r){var b=r._point,u=Math.max(Math.round(r._radius),1),m="a"+u+","+(Math.max(Math.round(r._radiusY),1)||u)+" 0 1,0 ";b=r._empty()?"M0 0":"M"+(b.x-u)+","+b.y+m+2*u+",0 "+m+2*-u+",0 ",this._setPath(r,b)},_setPath:function(r,u){r._path.setAttribute("d",u)},_bringToFront:function(r){fn(r._path)},_bringToBack:function(r){mn(r._path)}});function Ii(r){return re.svg||re.vml?new xa(r):null}re.vml&&xa.include(so),fe.include({getRenderer:function(r){return r=(r=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer)||(this._renderer=this._createRenderer()),this.hasLayer(r)||this.addLayer(r),r},_getPaneRenderer:function(r){var u;return"overlayPane"!==r&&void 0!==r&&(void 0===(u=this._paneRenderers[r])&&(u=this._createRenderer({pane:r}),this._paneRenderers[r]=u),u)},_createRenderer:function(r){return this.options.preferCanvas&&Jo(r)||Ii(r)}});var js=ao.extend({initialize:function(r,u){ao.prototype.initialize.call(this,this._boundsToLatLngs(r),u)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return[(r=Bi(r)).getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});xa.create=Da,xa.pointsToPath=hr,Sn.geometryToLayer=or,Sn.coordsToLatLng=Po,Sn.coordsToLatLngs=La,Sn.latLngToCoords=Xa,Sn.latLngsToCoords=Ka,Sn.getFeature=Xo,Sn.asFeature=za,fe.mergeOptions({boxZoom:!0}),go=cr.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){vt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ft(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ti(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||1!==r.which&&1!==r.button)return!1;this._clearDeferredResetState(),this._resetState(),Lt(),j(),this._startPoint=this._map.mouseEventToContainerPoint(r),vt(document,{contextmenu:Be,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(u){this._moved||(this._moved=!0,this._box=ri("div","leaflet-zoom-box",this._container),Ce(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(u);var m=(u=new Ct(this._point,this._startPoint)).getSize();nt(this._box,u.min),this._box.style.width=m.x+"px",this._box.style.height=m.y+"px"},_finish:function(){this._moved&&(Ti(this._box),Ke(this._container,"leaflet-crosshair")),Jt(),et(),Ft(document,{contextmenu:Be,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){1!==r.which&&1!==r.button||(this._finish(),this._moved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(Ei(this._resetState,this),0),r=new wi(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(r).fire("boxzoomend",{boxZoomBounds:r})))},_onKeyDown:function(r){27===r.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}}),fe.addInitHook("addHandler","boxZoom",go),fe.mergeOptions({doubleClickZoom:!0}),lo=cr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var u=this._map,b=u.getZoom(),m=u.options.zoomDelta;b=r.originalEvent.shiftKey?b-m:b+m,"center"===u.options.doubleClickZoom?u.setZoom(b):u.setZoomAround(r.containerPoint,b)}});var Yo=(fe.addInitHook("addHandler","doubleClickZoom",lo),fe.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),cr.extend({addHooks:function(){var r;this._draggable||(this._draggable=new Fn((r=this._map)._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))),Ce(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ke(this._map._container,"leaflet-grab"),Ke(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r,u=this._map;u._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity?(r=Bi(this._map.options.maxBounds),this._offsetLimit=ln(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))):this._offsetLimit=null,u.fire("movestart").fire("dragstart"),u.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){var u,m;this._map.options.inertia&&(u=this._lastTime=+new Date,m=this._lastPos=this._draggable._absPos||this._draggable._newPos,this._positions.push(m),this._times.push(u),this._prunePositions(u)),this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;1<this._positions.length&&50<r-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,u){return r-(r-u)*this._viscosity},_onPreDragLimit:function(){var r,u;this._viscosity&&this._offsetLimit&&((r=this._draggable._newPos.subtract(this._draggable._startPos)).x<(u=this._offsetLimit).min.x&&(r.x=this._viscousLimit(r.x,u.min.x)),r.y<u.min.y&&(r.y=this._viscousLimit(r.y,u.min.y)),r.x>u.max.x&&(r.x=this._viscousLimit(r.x,u.max.x)),r.y>u.max.y&&(r.y=this._viscousLimit(r.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(r))},_onPreDragWrap:function(){var A=this._worldWidth,r=Math.round(A/2),u=this._initialWorldOffset,m=((b=this._draggable._newPos.x)-r+u)%A+r-u,b=(b+r+u)%A-r-u;A=Math.abs(m+u)<Math.abs(b+u)?m:b,this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=A},_onDragEnd:function(r){var u,m,b,A,V=this._map,ct=V.options,ut=!ct.inertia||r.noInertia||this._times.length<2;V.fire("dragend",r),!ut&&(this._prunePositions(+new Date),ut=(r=(r=this._lastPos.subtract(this._positions[0])).multiplyBy((u=ct.easeLinearity)/(ut=(this._lastTime-this._times[0])/1e3))).distanceTo([0,0]),m=Math.min(ct.inertiaMaxSpeed,ut),r=r.multiplyBy(m/ut),(A=r.multiplyBy(-(b=m/(ct.inertiaDeceleration*u))/2).round()).x||A.y)?(A=V._limitOffset(A,V.options.maxBounds),Ue(function(){V.panBy(A,{duration:b,easeLinearity:u,noMoveStart:!0,animate:!0})})):V.fire("moveend")}})),ba=(fe.addInitHook("addHandler","dragging",Yo),fe.mergeOptions({keyboard:!0,keyboardPanDelta:80}),Ja=cr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),vt(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ft(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){var r,u,m;this._focused||(m=document.body,r=document.documentElement,u=m.scrollTop||r.scrollTop,m=m.scrollLeft||r.scrollLeft,this._map._container.focus(),window.scrollTo(m,u))},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){for(var u=this._panKeys={},m=this.keyCodes,b=0,A=m.left.length;b<A;b++)u[m.left[b]]=[-1*r,0];for(b=0,A=m.right.length;b<A;b++)u[m.right[b]]=[r,0];for(b=0,A=m.down.length;b<A;b++)u[m.down[b]]=[0,r];for(b=0,A=m.up.length;b<A;b++)u[m.up[b]]=[0,-1*r]},_setZoomDelta:function(r){for(var u=this._zoomKeys={},m=this.keyCodes,b=0,A=m.zoomIn.length;b<A;b++)u[m.zoomIn[b]]=r;for(b=0,A=m.zoomOut.length;b<A;b++)u[m.zoomOut[b]]=-r},_addHooks:function(){vt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ft(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var u,m,b=r.keyCode,A=this._map;if(b in this._panKeys)A._panAnim&&A._panAnim._inProgress||(m=this._panKeys[b],r.shiftKey&&(m=Oe(m).multiplyBy(3)),A.options.maxBounds&&(m=A._limitOffset(Oe(m),A.options.maxBounds)),A.options.worldCopyJump?(u=A.wrapLatLng(A.unproject(A.project(A.getCenter()).add(m))),A.panTo(u)):A.panBy(m));else if(b in this._zoomKeys)A.setZoom(A.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[b]);else{if(27!==b||!A._popup||!A._popup.options.closeOnEscapeKey)return;A.closePopup()}Be(r)}}}),fe.addInitHook("addHandler","keyboard",Ja),fe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),Ya=cr.extend({addHooks:function(){vt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ft(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var m=di(r),u=this._map.options.wheelDebounceTime;this._delta+=m,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date),m=Math.max(u-(+new Date-this._startTime),0),clearTimeout(this._timer),this._timer=setTimeout(Ei(this._performZoom,this),m),Be(r)},_performZoom:function(){var r=this._map,u=r.getZoom(),m=this._map.options.zoomSnap||0,b=(r._stop(),this._delta/(4*this._map.options.wheelPxPerZoomLevel));b=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,m=m?Math.ceil(b/m)*m:b,b=r._limitZoom(u+(0<this._delta?m:-m))-u,this._delta=0,this._startTime=null,b&&("center"===r.options.scrollWheelZoom?r.setZoom(u+b):r.setZoomAround(this._lastMousePos,u+b))}}),fe.addInitHook("addHandler","scrollWheelZoom",Ya),fe.mergeOptions({tapHold:re.touchNative&&re.safari&&re.mobile,tapTolerance:15}),Io=cr.extend({addHooks:function(){vt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ft(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){var u;clearTimeout(this._holdTimeout),1===r.touches.length&&(this._startPos=this._newPos=new Se((u=r.touches[0]).clientX,u.clientY),this._holdTimeout=setTimeout(Ei(function(){this._cancel(),this._isTapValid()&&(vt(document,"touchend",Ze),vt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),600),vt(document,"touchend touchcancel contextmenu",this._cancel,this),vt(document,"touchmove",this._onMove,this))},_cancelClickPrevent:function r(){Ft(document,"touchend",Ze),Ft(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),Ft(document,"touchend touchcancel contextmenu",this._cancel,this),Ft(document,"touchmove",this._onMove,this)},_onMove:function(r){this._newPos=new Se((r=r.touches[0]).clientX,r.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,u){(r=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY}))._simulated=!0,u.target.dispatchEvent(r)}}),fe.addInitHook("addHandler","tapHold",Io),fe.mergeOptions({touchZoom:re.touch,bounceAtZoomLimits:!0}),uo=cr.extend({addHooks:function(){Ce(this._map._container,"leaflet-touch-zoom"),vt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ke(this._map._container,"leaflet-touch-zoom"),Ft(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var u,m,b=this._map;!r.touches||2!==r.touches.length||b._animatingZoom||this._zooming||(u=b.mouseEventToContainerPoint(r.touches[0]),m=b.mouseEventToContainerPoint(r.touches[1]),this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),"center"!==b.options.touchZoom&&(this._pinchStartLatLng=b.containerPointToLatLng(u.add(m)._divideBy(2))),this._startDist=u.distanceTo(m),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),vt(document,"touchmove",this._onTouchMove,this),vt(document,"touchend touchcancel",this._onTouchEnd,this),Ze(r))},_onTouchMove:function(r){if(r.touches&&2===r.touches.length&&this._zooming){var u=this._map,m=u.mouseEventToContainerPoint(r.touches[0]),b=u.mouseEventToContainerPoint(r.touches[1]),A=m.distanceTo(b)/this._startDist;if(this._zoom=u.getScaleZoom(A,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&A<1||this._zoom>u.getMaxZoom()&&1<A)&&(this._zoom=u._limitZoom(this._zoom)),"center"===u.options.touchZoom){if(this._center=this._startLatLng,1==A)return}else{if(m=m._add(b)._divideBy(2)._subtract(this._centerPoint),1==A&&0===m.x&&0===m.y)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(m),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),le(this._animRequest),b=Ei(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0),this._animRequest=Ue(b,this,!0),Ze(r)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,le(this._animRequest),Ft(document,"touchmove",this._onTouchMove,this),Ft(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}}),fe.addInitHook("addHandler","touchZoom",uo),fe.BoxZoom=go,fe.DoubleClickZoom=lo,fe.Drag=Yo,fe.Keyboard=Ja,fe.ScrollWheelZoom=Ya,fe.TapHold=Io,fe.TouchZoom=uo,At.Bounds=Ct,At.Browser=re,At.CRS=qi,At.Canvas=Rr,At.Circle=Ho,At.CircleMarker=Eo,At.Class=Nt,At.Control=Ai,At.DivIcon=Nn,At.DivOverlay=Yr,At.DomEvent=vi,At.DomUtil=Gr,At.Draggable=Fn,At.Evented=nn,At.FeatureGroup=So,At.GeoJSON=Sn,At.GridLayer=sa,At.Handler=cr,At.Icon=oo,At.ImageOverlay=ka,At.LatLng=ci,At.LatLngBounds=wi,At.Layer=Xn,At.LayerGroup=dr,At.LineUtil=kr,At.Map=fe,At.Marker=Dr,At.Mixin=In,At.Path=Or,At.Point=Se,At.PolyUtil=Aa,At.Polygon=ao,At.Polyline=Tr,At.Popup=Ko,At.PosAnimation=Ye,At.Projection=as,At.Rectangle=js,At.Renderer=Br,At.SVG=xa,At.SVGOverlay=Ns,At.TileLayer=$r,At.Tooltip=Ma,At.Transformation=Gn,At.Util=en,At.VideoOverlay=ls,At.bind=Ei,At.bounds=ln,At.canvas=Jo,At.circle=function(r,u,m){return new Ho(r,u,m)},At.circleMarker=function(r,u){return new Eo(r,u)},At.control=An,At.divIcon=function(r){return new Nn(r)},At.extend=dt,At.featureGroup=function(r,u){return new So(r,u)},At.geoJSON=ss,At.geoJson=va,At.gridLayer=function(r){return new sa(r)},At.icon=function(r){return new oo(r)},At.imageOverlay=function(r,u,m){return new ka(r,u,m)},At.latLng=pi,At.latLngBounds=Bi,At.layerGroup=function(r,u){return new dr(r,u)},At.map=function(r,u){return new fe(r,u)},At.marker=function(r,u){return new Dr(r,u)},At.point=Oe,At.polygon=function(r,u){return new ao(r,u)},At.polyline=function(r,u){return new Tr(r,u)},At.popup=function(r,u){return new Ko(r,u)},At.rectangle=function(r,u){return new js(r,u)},At.setOptions=Vi,At.stamp=ni,At.svg=Ii,At.svgOverlay=function(r,u,m){return new Ns(r,u,m)},At.tileLayer=Ao,At.tooltip=function(r,u){return new Ma(r,u)},At.transformation=Wn,At.version="1.9.3",At.videoOverlay=function(r,u,m){return new ls(r,u,m)},window.L);At.noConflict=function(){return window.L=ba,this},window.L=At}),function(At,dt){"object"==typeof exports&&typeof module<"u"?dt(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],dt):dt(((At=typeof globalThis<"u"?globalThis:At||self).L=At.L||{},At.L.esri={}),At.L)}(this,function(At,dt){"use strict";var eo=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,Ei=""===document.documentElement.style.pointerEvents,lr={cors:eo,pointerEvents:Ei},ni={attributionWidthOffset:55},Go=0;function Lr(x){var S="";for(var D in x.f=x.f||"json",x)if(Object.prototype.hasOwnProperty.call(x,D)){var W,tt=x[D],ht=Object.prototype.toString.call(tt);S.length&&(S+="&"),W="[object Array]"===ht?"[object Object]"===Object.prototype.toString.call(tt[0])?JSON.stringify(tt):tt.join(","):"[object Object]"===ht?JSON.stringify(tt):"[object Date]"===ht?tt.valueOf():tt,S+=encodeURIComponent(D)+"="+encodeURIComponent(W)}return S}function sn(x,S){var D=new window.XMLHttpRequest;return D.onerror=function(W){D.onreadystatechange=dt.Util.falseFn,x.call(S,{error:{code:500,message:"XMLHttpRequest error"}},null)},D.onreadystatechange=function(){var W,tt;if(4===D.readyState){try{W=JSON.parse(D.responseText)}catch{W=null,tt={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!tt&&W.error&&(tt=W.error,W=null),D.onerror=dt.Util.falseFn,x.call(S,tt,W)}},D.ontimeout=function(){this.onerror()},D}function zr(x,S,D,W){var tt=sn(D,W);return tt.open("POST",x),null!=W&&void 0!==W.options&&(tt.timeout=W.options.timeout),tt.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),tt.send(Lr(S)),tt}function Wo(x,S,D,W){var tt=sn(D,W);return tt.open("GET",x+"?"+Lr(S),!0),null!=W&&void 0!==W.options&&(tt.timeout=W.options.timeout,W.options.withCredentials&&(tt.withCredentials=!0)),tt.send(null),tt}function Do(x,S,D,W){var tt=Lr(S),ht=sn(D,W),Lt=(x+"?"+tt).length;if(Lt<=2e3&&lr.cors?ht.open("GET",x+"?"+tt):Lt>2e3&&lr.cors&&(ht.open("POST",x),ht.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),null!=W&&void 0!==W.options&&(ht.timeout=W.options.timeout,W.options.withCredentials&&(ht.withCredentials=!0)),Lt<=2e3&&lr.cors)ht.send(null);else{if(!(Lt>2e3&&lr.cors))return Lt<=2e3&&!lr.cors?Vi(x,S,D,W):void Mn("a request to "+x+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy https://developers.arcgis.com/esri-leaflet/api-reference/request/");ht.send(tt)}return ht}function Vi(x,S,D,W){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var tt="c"+Go;S.callback="window._EsriLeafletCallbacks."+tt,window._EsriLeafletCallbacks[tt]=function(Lt){if(!0!==window._EsriLeafletCallbacks[tt]){var Jt,ue=Object.prototype.toString.call(Lt);"[object Object]"!==ue&&"[object Array]"!==ue&&(Jt={error:{code:500,message:"Expected array or object as JSONP response"}},Lt=null),!Jt&&Lt.error&&(Jt=Lt,Lt=null),D.call(W,Jt,Lt),window._EsriLeafletCallbacks[tt]=!0}};var ht=dt.DomUtil.create("script",null,document.body);return ht.type="text/javascript",ht.src=x+"?"+Lr(S),ht.id=tt,ht.onerror=function(Lt){Lt&&!0!==window._EsriLeafletCallbacks[tt]&&(D.call(W,{error:{code:500,message:"An unknown error occurred"}}),window._EsriLeafletCallbacks[tt]=!0)},dt.DomUtil.addClass(ht,"esri-leaflet-jsonp"),Go++,{id:tt,url:ht.src,abort:function(){window._EsriLeafletCallbacks._callback[tt]({code:0,message:"Request aborted."})}}}var ur=lr.cors?Wo:Vi;function Mn(){console&&console.warn&&console.warn.apply(console,arguments)}ur.CORS=Wo,ur.JSONP=Vi;var Bt={request:Do,get:ur,post:zr},ee=function(x,S,D,W){var Lt=(W[1]-D[1])*(S[0]-x[0])-(W[0]-D[0])*(S[1]-x[1]);if(0!==Lt){var Jt=((W[0]-D[0])*(x[1]-D[1])-(W[1]-D[1])*(x[0]-D[0]))/Lt,ue=((S[0]-x[0])*(x[1]-D[1])-(S[1]-x[1])*(x[0]-D[0]))/Lt;if(Jt>=0&&Jt<=1&&ue>=0&&ue<=1)return!0}return!1},Me=function(x,S){for(var D=0;D<x.length-1;D++)for(var W=0;W<S.length-1;W++)if(ee(x[D],x[D+1],S[W],S[W+1]))return!0;return!1},Te=function(x){return function(S,D){for(var W=0;W<S.length;W++)if(S[W]!==D[W])return!1;return!0}(x[0],x[x.length-1])||x.push(x[0]),x},zi=function(x){for(var S,D=0,W=0,tt=x.length,ht=x[W];W<tt-1;W++)D+=((S=x[W+1])[0]-ht[0])*(S[1]+ht[1]),ht=S;return D>=0},wn=function(x){var S={};for(var D in x)x.hasOwnProperty(D)&&(S[D]=x[D]);return S},c=function(x,S){var D=Me(x,S),W=function(tt,ht){for(var Lt=!1,Jt=-1,ue=tt.length,Ae=ue-1;++Jt<ue;Ae=Jt)(tt[Jt][1]<=ht[1]&&ht[1]<tt[Ae][1]||tt[Ae][1]<=ht[1]&&ht[1]<tt[Jt][1])&&ht[0]<(tt[Ae][0]-tt[Jt][0])*(ht[1]-tt[Jt][1])/(tt[Ae][1]-tt[Jt][1])+tt[Jt][0]&&(Lt=!Lt);return Lt}(x,S[0]);return!(D||!W)},gi=function x(S,D){var W={};if(S.features){W.type="FeatureCollection",W.features=[];for(var tt=0;tt<S.features.length;tt++)W.features.push(x(S.features[tt],D))}if("number"==typeof S.x&&"number"==typeof S.y&&(W.type="Point",W.coordinates=[S.x,S.y],"number"==typeof S.z&&W.coordinates.push(S.z)),S.points&&(W.type="MultiPoint",W.coordinates=S.points.slice(0)),S.paths&&(1===S.paths.length?(W.type="LineString",W.coordinates=S.paths[0].slice(0)):(W.type="MultiLineString",W.coordinates=S.paths.slice(0))),S.rings&&(W=function(ht){for(var Lt,ue,Ae=[],Di=[],Qi=0;Qi<ht.length;Qi++){var ji=Te(ht[Qi].slice(0));if(!(ji.length<4))if(zi(ji)){var ir=[ji.slice().reverse()];Ae.push(ir)}else Di.push(ji.slice().reverse())}for(var Pn=[];Di.length;){ue=Di.pop();var ri=!1;for(Lt=Ae.length-1;Lt>=0;Lt--)if(c(Ae[Lt][0],ue)){Ae[Lt].push(ue),ri=!0;break}ri||Pn.push(ue)}for(;Pn.length;){ue=Pn.pop();var Ti=!1;for(Lt=Ae.length-1;Lt>=0;Lt--)if(Me(Ae[Lt][0],ue)){Ae[Lt].push(ue),Ti=!0;break}Ti||Ae.push([ue.reverse()])}return 1===Ae.length?{type:"Polygon",coordinates:Ae[0]}:{type:"MultiPolygon",coordinates:Ae}}(S.rings.slice(0))),"number"==typeof S.xmin&&"number"==typeof S.ymin&&"number"==typeof S.xmax&&"number"==typeof S.ymax&&(W.type="Polygon",W.coordinates=[[[S.xmax,S.ymax],[S.xmin,S.ymax],[S.xmin,S.ymin],[S.xmax,S.ymin],[S.xmax,S.ymax]]]),(S.geometry||S.attributes)&&(W.type="Feature",W.geometry=S.geometry?x(S.geometry):null,W.properties=S.attributes?wn(S.attributes):null,S.attributes))try{W.id=function(ht,Lt){for(var Jt=Lt?[Lt,"OBJECTID","FID"]:["OBJECTID","FID"],ue=0;ue<Jt.length;ue++){var Ae=Jt[ue];if(Ae in ht&&("string"==typeof ht[Ae]||"number"==typeof ht[Ae]))return ht[Ae]}throw Error("No valid id attribute found")}(S.attributes,D)}catch{}return JSON.stringify(W.geometry)===JSON.stringify({})&&(W.geometry=null),S.spatialReference&&S.spatialReference.wkid&&4326!==S.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(S.spatialReference)),W},Mt=function(x){var S=[],D=x.slice(0),W=Te(D.shift().slice(0));if(W.length>=4){zi(W)||W.reverse(),S.push(W);for(var tt=0;tt<D.length;tt++){var ht=Te(D[tt].slice(0));ht.length>=4&&(zi(ht)&&ht.reverse(),S.push(ht))}}return S},Ue=function x(S,D){D=D||"OBJECTID";var W,tt={wkid:4326},ht={};switch(S.type){case"Point":ht.x=S.coordinates[0],ht.y=S.coordinates[1],S.coordinates[2]&&(ht.z=S.coordinates[2]),ht.spatialReference=tt;break;case"MultiPoint":ht.points=S.coordinates.slice(0),S.coordinates[0][2]&&(ht.hasZ=!0),ht.spatialReference=tt;break;case"LineString":ht.paths=[S.coordinates.slice(0)],S.coordinates[0][2]&&(ht.hasZ=!0),ht.spatialReference=tt;break;case"MultiLineString":ht.paths=S.coordinates.slice(0),S.coordinates[0][0][2]&&(ht.hasZ=!0),ht.spatialReference=tt;break;case"Polygon":ht.rings=Mt(S.coordinates.slice(0)),S.coordinates[0][0][2]&&(ht.hasZ=!0),ht.spatialReference=tt;break;case"MultiPolygon":ht.rings=function(Lt){for(var Jt=[],ue=0;ue<Lt.length;ue++)for(var Ae=Mt(Lt[ue]),Di=Ae.length-1;Di>=0;Di--){var Qi=Ae[Di].slice(0);Jt.push(Qi)}return Jt}(S.coordinates.slice(0)),S.coordinates[0][0][0][2]&&(ht.hasZ=!0),ht.spatialReference=tt;break;case"Feature":S.geometry&&(ht.geometry=x(S.geometry,D)),ht.attributes=S.properties?wn(S.properties):{},S.id&&(ht.attributes[D]=S.id);break;case"FeatureCollection":for(ht=[],W=0;W<S.features.length;W++)ht.push(x(S.features[W],D));break;case"GeometryCollection":for(ht=[],W=0;W<S.geometries.length;W++)ht.push(x(S.geometries[W],D))}return ht},le='<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>';function en(x,S){return Ue(x,S)}function Nt(x,S){return gi(x,S)}function dn(x){if("NaN"!==x.xmin&&"NaN"!==x.ymin&&"NaN"!==x.xmax&&"NaN"!==x.ymax){var S=dt.latLng(x.ymin,x.xmin),D=dt.latLng(x.ymax,x.xmax);return dt.latLngBounds(S,D)}return null}function nn(x){return{xmin:(x=dt.latLngBounds(x)).getSouthWest().lng,ymin:x.getSouthWest().lat,xmax:x.getNorthEast().lng,ymax:x.getNorthEast().lat,spatialReference:{wkid:4326}}}var Se=/^(OBJECTID|FID|OID|ID)$/i;function er(x){var S;if(x.objectIdFieldName)S=x.objectIdFieldName;else if(x.fields){for(var D=0;D<=x.fields.length-1;D++)if("esriFieldTypeOID"===x.fields[D].type){S=x.fields[D].name;break}if(!S)for(D=0;D<=x.fields.length-1;D++)if(x.fields[D].name.match(Se)){S=x.fields[D].name;break}}return S}function Oe(x){for(var S in x.attributes)if(S.match(Se))return S}function Ct(x,S){var D,W=x.features||x.results,tt=W&&W.length;D=S||er(x);var ht={type:"FeatureCollection",features:[]};if(tt)for(var Lt=W.length-1;Lt>=0;Lt--){var Jt=Nt(W[Lt],D||Oe(W[Lt]));ht.features.push(Jt)}return ht}function ln(x){return"/"!==(x=dt.Util.trim(x))[x.length-1]&&(x+="/"),x}function wi(x){if(-1!==x.url.indexOf("?")){x.requestParams=x.requestParams||{};var S=x.url.substring(x.url.indexOf("?")+1);x.url=x.url.split("?")[0],x.requestParams=JSON.parse('{"'+decodeURI(S).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return x.url=ln(x.url.split("?")[0]),x}function Bi(x){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(x)}function ci(x){var S;switch(x){case"Point":S="esriGeometryPoint";break;case"MultiPoint":S="esriGeometryMultipoint";break;case"LineString":case"MultiLineString":S="esriGeometryPolyline";break;case"Polygon":case"MultiPolygon":S="esriGeometryPolygon"}return S}function pi(x){return x.getSize().x-ni.attributionWidthOffset+"px"}function qi(x){if(x.attributionControl){if(x.attributionControl._esriAttributionLayerCount||(x.attributionControl._esriAttributionLayerCount=0),0===x.attributionControl._esriAttributionLayerCount){if(!x.attributionControl._esriAttributionAddedOnce){var S=document.createElement("style");S.type="text/css",S.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(S);var D=document.createElement("style");D.type="text/css",D.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+pi(x)+";}",document.getElementsByTagName("head")[0].appendChild(D),x.on("resize",function(W){x.attributionControl&&(x.attributionControl._container.style.maxWidth=pi(W.target))}),x.attributionControl._esriAttributionAddedOnce=!0}x.attributionControl.setPrefix(le+' | Powered by <a href="https://www.esri.com">Esri</a>'),dt.DomUtil.addClass(x.attributionControl._container,"esri-truncated-attribution:hover"),dt.DomUtil.addClass(x.attributionControl._container,"esri-truncated-attribution")}x.attributionControl._esriAttributionLayerCount=x.attributionControl._esriAttributionLayerCount+1}}function ki(x){x.attributionControl&&(x.attributionControl._esriAttributionLayerCount&&1===x.attributionControl._esriAttributionLayerCount&&(x.attributionControl.setPrefix(le),dt.DomUtil.removeClass(x.attributionControl._container,"esri-truncated-attribution:hover"),dt.DomUtil.removeClass(x.attributionControl._container,"esri-truncated-attribution")),x.attributionControl._esriAttributionLayerCount=x.attributionControl._esriAttributionLayerCount-1)}function Mi(x){var S={geometry:null,geometryType:null};return x instanceof dt.LatLngBounds?(S.geometry=nn(x),S.geometryType="esriGeometryEnvelope",S):(x.getLatLng&&(x=x.getLatLng()),x instanceof dt.LatLng&&(x={type:"Point",coordinates:[x.lng,x.lat]}),x instanceof dt.GeoJSON&&(x=x.getLayers()[0].feature.geometry,S.geometry=en(x),S.geometryType=ci(x.type)),x.toGeoJSON&&(x=x.toGeoJSON()),"Feature"===x.type&&(x=x.geometry),"Point"===x.type||"LineString"===x.type||"Polygon"===x.type||"MultiPolygon"===x.type?(S.geometry=en(x),S.geometryType=ci(x.type),S):void Mn("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}function Gn(x,S){lr.cors&&Do(x,{},dt.Util.bind(function(D,W){if(!D){S._esriAttributions=[];for(var tt=0;tt<W.contributors.length;tt++)for(var ht=W.contributors[tt],Lt=0;Lt<ht.coverageAreas.length;Lt++){var Jt=ht.coverageAreas[Lt],ue=dt.latLng(Jt.bbox[0],Jt.bbox[1]),Ae=dt.latLng(Jt.bbox[2],Jt.bbox[3]);S._esriAttributions.push({attribution:ht.attribution,score:Jt.score,bounds:dt.latLngBounds(ue,Ae),minZoom:Jt.zoomMin,maxZoom:Jt.zoomMax})}S._esriAttributions.sort(function(Di,Qi){return Qi.score-Di.score}),Wn({target:S})}},this))}function Wn(x){var S=x.target,D=S._esriAttributions;if(S&&S.attributionControl){var W=S.attributionControl._container.querySelector(".esri-dynamic-attribution");if(W&&D){for(var tt="",ht=S.getBounds(),Lt=dt.latLngBounds(ht.getSouthWest().wrap(),ht.getNorthEast().wrap()),Jt=S.getZoom(),ue=0;ue<D.length;ue++){var Ae=D[ue],Di=Ae.attribution;!tt.match(Di)&&Ae.bounds.intersects(Lt)&&Jt>=Ae.minZoom&&Jt<=Ae.maxZoom&&(tt+=", "+Di)}tt=tt.substr(2),W.innerHTML=tt,W.style.maxWidth=pi(S),S.fire("attributionupdated",{attribution:tt})}}}var Ri={warn:Mn,cleanUrl:ln,getUrlParams:wi,isArcgisOnline:Bi,geojsonTypeToArcGIS:ci,responseToFeatureCollection:Ct,geojsonToArcGIS:en,arcgisToGeoJSON:Nt,boundsToExtent:nn,extentToBounds:dn,calcAttributionWidth:pi,setEsriAttribution:qi,_setGeometry:Mi,_getAttributionData:Gn,_updateMapAttribution:Wn,_findIdAttributeFromFeature:Oe,_findIdAttributeFromResponse:er},un=dt.Class.extend({options:{proxy:!1,useCors:eo},generateSetter:function(x,S){return dt.Util.bind(function(D){return this.params[x]=D,this},S)},initialize:function(x){if(x.request&&x.options?(this._service=x,dt.Util.setOptions(this,x.options)):(dt.Util.setOptions(this,x),this.options.url=ln(x.url)),this.params=dt.Util.extend({},this.params||{}),this.setters)for(var S in this.setters)this[S]=this.generateSetter(this.setters[S],this)},token:function(x){return this._service?this._service.authenticate(x):this.params.token=x,this},apikey:function(x){return this.token(x)},format:function(x){return this.params.returnUnformattedValues=!x,this},request:function(x,S){return this.options.requestParams&&dt.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,x,S):this._request("request",this.path,this.params,x,S)},_request:function(x,S,D,W,tt){var ht=this.options.proxy?this.options.proxy+"?"+this.options.url+S:this.options.url+S;return"get"!==x&&"request"!==x||this.options.useCors?Bt[x](ht,D,W,tt):Bt.get.JSONP(ht,D,W,tt)}}),qe=un.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(x,S){return x=dt.latLng(x),this.params.geometry=[x.lng,x.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=S,this.params.inSR=4326,this},where:function(x){return this.params.where=x,this},between:function(x,S){return this.params.time=[x.valueOf(),S.valueOf()],this},simplify:function(x,S){var D=Math.abs(x.getBounds().getWest()-x.getBounds().getEast());return this.params.maxAllowableOffset=D/x.getSize().y*S,this},orderBy:function(x,S){return S=S||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[x,S].join(" "),this},run:function(x,S){return this._cleanParams(),this.options.isModern||Bi(this.options.url)&&void 0===this.options.isModern?(this.params.f="geojson",this.request(function(D,W){this._trapSQLerrors(D),x.call(S,D,W,W)},this)):this.request(function(D,W){this._trapSQLerrors(D),x.call(S,D,W&&Ct(W),W)},this)},count:function(x,S){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(D,W){x.call(this,D,W&&W.count,W)},S)},ids:function(x,S){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(D,W){x.call(this,D,W&&W.objectIds,W)},S)},bounds:function(x,S){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(D,W){W&&W.extent&&dn(W.extent)?x.call(S,D,dn(W.extent),W):x.call(S,D={message:"Invalid Bounds"},null,W)},S)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(x){var S=dt.point(x);return this.params.pixelSize=[S.x,S.y],this},layer:function(x){return this.path=x+"/query",this},_trapSQLerrors:function(x){x&&"400"===x.code&&Mn("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(x){this.params.inSR=4326;var S=Mi(x);this.params.geometry=S.geometry,this.params.geometryType=S.geometryType}});function hr(x){return new qe(x)}var Gr=un.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(x,S){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[x,S].join(":"),this},simplify:function(x,S){var D=Math.abs(x.getBounds().getWest()-x.getBounds().getEast());return this.params.maxAllowableOffset=D/x.getSize().y*S,this},run:function(x,S){return this.request(function(D,W){x.call(S,D,W&&Ct(W),W)},S)}});function kr(x){return new Gr(x)}var vr=un.extend({path:"identify",between:function(x,S){return this.params.time=[x.valueOf(),S.valueOf()],this}}),Dn=vr.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(x){var S=nn(x.getBounds()),D=x.getSize();return this.params.imageDisplay=[D.x,D.y,96],this.params.mapExtent=[S.xmin,S.ymin,S.xmax,S.ymax],this},at:function(x){return 2===x.length&&(x=dt.latLng(x)),this._setGeometryParams(x),this},layerDef:function(x,S){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[x,S].join(":"),this},simplify:function(x,S){var D=Math.abs(x.getBounds().getWest()-x.getBounds().getEast());return this.params.maxAllowableOffset=D/x.getSize().y*S,this},run:function(x,S){return this.request(function(D,W){if(D)x.call(S,D,void 0,W);else{var tt=Ct(W);W.results=W.results.reverse();for(var ht=0;ht<tt.features.length;ht++)tt.features[ht].layerId=W.results[ht].layerId;x.call(S,void 0,tt,W)}})},_setGeometryParams:function(x){var S=Mi(x);this.params.geometry=S.geometry,this.params.geometryType=S.geometryType}});function On(x){return new Dn(x)}var xr=vr.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(x){return x=dt.latLng(x),this.params.geometry=JSON.stringify({x:x.lng,y:x.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(x,S){return this.request(function(D,W){x.call(S,D,W&&this._responseToGeoJSON(W),W)},this)},_responseToGeoJSON:function(x){var S=x.location,D=x.catalogItems,W=x.catalogItemVisibilities,tt={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[S.x,S.y]},crs:{type:"EPSG",properties:{code:S.spatialReference.wkid}},properties:{OBJECTID:x.objectId,name:x.name,value:x.value},id:x.objectId}};if(x.properties&&x.properties.Values&&(tt.pixel.properties.values=x.properties.Values),D&&D.features&&(tt.catalogItems=Ct(D),W&&W.length===tt.catalogItems.features.length))for(var ht=W.length-1;ht>=0;ht--)tt.catalogItems.features[ht].properties.catalogItemVisibility=W[ht];return tt}});function _o(x){return new xr(x)}var Wr=dt.Evented.extend({options:{proxy:!1,useCors:eo,timeout:0},initialize:function(x){x=x||{},this._requestQueue=[],this._authenticating=!1,dt.Util.setOptions(this,x),this.options.url=ln(this.options.url)},get:function(x,S,D,W){return this._request("get",x,S,D,W)},post:function(x,S,D,W){return this._request("post",x,S,D,W)},request:function(x,S,D,W){return this._request("request",x,S,D,W)},metadata:function(x,S){return this._request("get","",{},x,S)},authenticate:function(x){return this._authenticating=!1,this.options.token=x,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(x){this.options.timeout=x},_request:function(x,S,D,W,tt){this.fire("requeststart",{url:this.options.url+S,params:D,method:x},!0);var ht=this._createServiceCallback(x,S,D,W,tt);if(this.options.token&&(D.token=this.options.token),this.options.requestParams&&dt.Util.extend(D,this.options.requestParams),!this._authenticating){var Lt=this.options.proxy?this.options.proxy+"?"+this.options.url+S:this.options.url+S;return"get"!==x&&"request"!==x||this.options.useCors?Bt[x](Lt,D,ht,tt):Bt.get.JSONP(Lt,D,ht,tt)}this._requestQueue.push([x,S,D,W,tt])},_createServiceCallback:function(x,S,D,W,tt){return dt.Util.bind(function(ht,Lt){!ht||499!==ht.code&&498!==ht.code||(this._authenticating=!0,this._requestQueue.push([x,S,D,W,tt]),this.fire("authenticationrequired",{authenticate:dt.Util.bind(this.authenticate,this)},!0),ht.authenticate=dt.Util.bind(this.authenticate,this)),W.call(tt,ht,Lt),ht?this.fire("requesterror",{url:this.options.url+S,params:D,message:ht.message,code:ht.code,method:x},!0):this.fire("requestsuccess",{url:this.options.url+S,params:D,response:Lt,method:x},!0),this.fire("requestend",{url:this.options.url+S,params:D,method:x},!0)},this)},_runQueue:function(){for(var x=this._requestQueue.length-1;x>=0;x--){var S=this._requestQueue[x];this[S.shift()].apply(this,S)}this._requestQueue=[]}}),Hr=Wr.extend({identify:function(){return On(this)},find:function(){return kr(this)},query:function(){return hr(this)}});function _a(x){return new Hr(x)}var Hn=Wr.extend({query:function(){return hr(this)},identify:function(){return _o(this)}});function Xr(x){return new Hn(x)}var ei=Wr.extend({options:{idAttribute:"OBJECTID"},query:function(){return hr(this)},addFeature:function(x,S,D){this.addFeatures(x,S,D)},addFeatures:function(x,S,D){for(var W=x.features?x.features:[x],tt=W.length-1;tt>=0;tt--)delete W[tt].id;return x=en(x),this.post("addFeatures",{features:x=W.length>1?x:[x]},function(ht,Lt){S&&S.call(D,ht||Lt.addResults[0].error,Lt&&Lt.addResults?Lt.addResults.length>1?Lt.addResults:Lt.addResults[0]:void 0)},D)},updateFeature:function(x,S,D){this.updateFeatures(x,S,D)},updateFeatures:function(x,S,D){var W=x.features?x.features:[x];return x=en(x,this.options.idAttribute),this.post("updateFeatures",{features:x=W.length>1?x:[x]},function(tt,ht){S&&S.call(D,tt||ht.updateResults[0].error,ht&&ht.updateResults?ht.updateResults.length>1?ht.updateResults:ht.updateResults[0]:void 0)},D)},deleteFeature:function(x,S,D){this.deleteFeatures(x,S,D)},deleteFeatures:function(x,S,D){return this.post("deleteFeatures",{objectIds:x},function(W,tt){S&&S.call(D,W||tt.deleteResults[0].error,tt&&tt.deleteResults?tt.deleteResults.length>1?tt.deleteResults:tt.deleteResults[0]:void 0)},D)}});function hn(x){return new ei(x)}var re="https:"!==window.location.protocol?"http:":"https:",Bn=dt.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:re+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:re+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Ei?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Ei?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Ei?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Ei?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Ei?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:Ei?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:Ei?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:re+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:re+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:re+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:re+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(x,S){var D;if("object"==typeof x&&x.urlTemplate&&x.options)D=x;else{if("string"!=typeof x||!Bn.TILES[x])throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');D=Bn.TILES[x]}var W=dt.Util.extend(D.options,S);dt.Util.setOptions(this,W),this.options.ignoreDeprecationWarning||console.warn("WARNING: L.esri.BasemapLayer uses data services that are in mature support and are not being updated. Please use L.esri.Vector.vectorBasemapLayer instead. More info: https://esriurl.com/esri-leaflet-basemap"),this.options.token&&-1===D.urlTemplate.indexOf("token=")&&(D.urlTemplate+="?token="+this.options.token),this.options.proxy&&(D.urlTemplate=this.options.proxy+"?"+D.urlTemplate),dt.TileLayer.prototype.initialize.call(this,D.urlTemplate,W)},onAdd:function(x){qi(x),"esri-labels"===this.options.pane&&this._initPane(),this.options.attributionUrl&&Gn((this.options.proxy?this.options.proxy+"?":"")+this.options.attributionUrl,x),x.on("moveend",Wn),dt.TileLayer.prototype.onAdd.call(this,x)},onRemove:function(x){ki(x),x.off("moveend",Wn),dt.TileLayer.prototype.onRemove.call(this,x)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var x=this._map.createPane(this.options.pane);x.style.pointerEvents="none",x.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var x='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return x}}),je=dt.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(x){x=wi(x=dt.Util.setOptions(this,x)),this.tileUrl=(x.proxy?x.proxy+"?":"")+x.url+"tile/{z}/{y}/{x}"+(x.requestParams&&Object.keys(x.requestParams).length>0?dt.Util.getParamString(x.requestParams):""),-1!==x.url.indexOf("{s}")&&x.subdomains&&(x.url=x.url.replace("{s}",x.subdomains[0])),this.service=_a(x),this.service.addEventParent(this),new RegExp(/tiles.arcgis(online)?\.com/g).test(x.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),x.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),dt.TileLayer.prototype.initialize.call(this,this.tileUrl,x)},getTileUrl:function(x){var S=this._getZoomForUrl();return dt.Util.template(this.tileUrl,dt.Util.extend({s:this._getSubdomain(x),x:x.x,y:x.y,z:this._lodMap&&this._lodMap[S]?this._lodMap[S]:S},this.options))},createTile:function(x,S){var D=document.createElement("img");return dt.DomEvent.on(D,"load",dt.Util.bind(this._tileOnLoad,this,S,D)),dt.DomEvent.on(D,"error",dt.Util.bind(this._tileOnError,this,S,D)),this.options.crossOrigin&&(D.crossOrigin=""),D.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?D.src=this.getTileUrl(x):this.once("lodmap",function(){D.src=this.getTileUrl(x)},this),D},onAdd:function(x){qi(x),this._lodMap||this.metadata(function(S,D){if(!S&&D.spatialReference){var W=D.spatialReference.latestWkid||D.spatialReference.wkid;if(!this.options.attribution&&x.attributionControl&&D.copyrightText&&(this.options.attribution=D.copyrightText,x.attributionControl.addAttribution(this.getAttribution())),x.options.crs!==dt.CRS.EPSG3857||102100!==W&&3857!==W)x.options.crs&&x.options.crs.code&&x.options.crs.code.indexOf(W)>-1||Mn("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet https://developers.arcgis.com/esri-leaflet/samples/non-mercator-projection/");else{this._lodMap={};for(var tt=D.tileInfo.lods,ht=je.MercatorZoomLevels,Lt=0;Lt<tt.length;Lt++){var Jt=tt[Lt];for(var ue in ht)if(this._withinPercentage(Jt.resolution,ht[ue],this.options.zoomOffsetAllowance)){this._lodMap[ue]=Jt.level;break}}this.fire("lodmap")}}},this),dt.TileLayer.prototype.onAdd.call(this,x)},onRemove:function(x){ki(x),dt.TileLayer.prototype.onRemove.call(this,x)},metadata:function(x,S){return this.service.metadata(x,S),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(x){var S="?token="+x;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,S):this.tileUrl+S,this.options.token=x,this.service.authenticate(x),this},_withinPercentage:function(x,S,D){return Math.abs(x/S-1)<D}}),To=dt.ImageOverlay.extend({onAdd:function(x){this._topLeft=x.getPixelBounds().min,dt.ImageOverlay.prototype.onAdd.call(this,x)},_reset:function(){this._map.options.crs===dt.CRS.EPSG3857?dt.ImageOverlay.prototype._reset.call(this):dt.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),Rn=dt.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:eo,attribution:null,interactive:!1,alt:""},onAdd:function(x){qi(x),this.options.zIndex&&(this.options.position=null),this._update=dt.Util.throttle(this._update,this.options.updateInterval,this),x.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?x.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(S,D){!S&&!this.options.attribution&&x.attributionControl&&D.copyrightText&&(this.options.attribution=D.copyrightText,x.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(x){ki(x),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(x,S){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=dt.popup(S),this._popupFunction=x,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(x){return this.options.zIndex=x,this._currentImage&&this._currentImage.setZIndex(x),this},_setAutoZIndex:function(x){if(this._currentImage){for(var S,D=this._currentImage.getPane().children,W=-x(-1/0,1/0),tt=0,ht=D.length;tt<ht;tt++)S=D[tt].style.zIndex,D[tt]!==this._currentImage._image&&S&&(W=x(W,+S));isFinite(W)&&(this.options.zIndex=W+x(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(x){return this.options.opacity=x,this._currentImage&&this._currentImage.setOpacity(x),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(x,S){return this.options.from=x,this.options.to=S,this._update(),this},metadata:function(x,S){return this.service.metadata(x,S),this},authenticate:function(x){return this.service.authenticate(x),this},redraw:function(){this._update()},_renderImage:function(x,S,D){if(this._map){if(D&&(x="data:"+D+";base64,"+x),!x)return;var W=new To(x,S,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),tt=function(){this._map.removeLayer(W),this.fire("error"),W.off("load",ht,this)},ht=function(Lt){if(W.off("error",tt,this),this._map){var Jt=Lt.target,ue=this._currentImage;Jt._bounds.equals(S)&&Jt._bounds.equals(this._map.getBounds())?(this._currentImage=Jt,"front"===this.options.position?this.bringToFront():"back"===this.options.position&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),ue&&this._map&&this._map.removeLayer(ue),ue&&ue._map&&ue._map.removeLayer(ue)):this._map.removeLayer(Jt)}this.fire("load",{bounds:S})};W.once("error",tt,this),W.once("load",ht,this)}},_update:function(){if(this._map){var x=this._map.getZoom(),S=this._map.getBounds();if(!(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress))if(x>this.options.maxZoom||x<this.options.minZoom)this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);else{var D=this._buildExportParams();dt.Util.extend(D,this.options.requestParams),D?(this._requestExport(D,S),this.fire("loading",{bounds:S})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(x,S,D,W){if(x=dt.latLng(x),this._shouldRenderPopup&&this._lastClick.equals(x)){var tt=this._popupFunction(S,D,W);tt&&this._popup.setLatLng(x).setContent(tt).openOn(this._map)}},_resetPopupState:function(x){this._shouldRenderPopup=!1,this._lastClick=x.latlng},_calculateBbox:function(){var x=this._map.getPixelBounds(),S=this._map.unproject(x.getBottomLeft()),D=this._map.unproject(x.getTopRight()),W=this._map.options.crs.project(D),tt=this._map.options.crs.project(S),ht=dt.bounds(W,tt);return[ht.getBottomLeft().x,ht.getBottomLeft().y,ht.getTopRight().x,ht.getTopRight().y].join(",")},_calculateImageSize:function(){var x=this._map.getPixelBounds(),S=this._map.getSize(),D=this._map.unproject(x.getBottomLeft()),W=this._map.unproject(x.getTopRight()),tt=this._map.latLngToLayerPoint(W).y,ht=this._map.latLngToLayerPoint(D).y;return(tt>0||ht<S.y)&&(S.y=ht-tt),S.x+","+S.y}}),Tn=Rn.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(x){x=wi(x),this.service=Xr(x),this.service.addEventParent(this),dt.Util.setOptions(this,x)},setPixelType:function(x){return this.options.pixelType=x,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(x){return this.options.bandIds=dt.Util.isArray(x)?x.join(","):x.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(x,S){return this.options.noData=dt.Util.isArray(x)?x.join(","):x.toString(),S&&(this.options.noDataInterpretation=S),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(x){this.options.renderingRule=x,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(x){this.options.mosaicRule=x,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(x){var S=dt.Util.bind(function(W,tt,ht){W||setTimeout(dt.Util.bind(function(){this._renderPopup(x.latlng,W,tt,ht)},this),300)},this),D=this.identify().at(x.latlng);this.options.mosaicRule&&D.setMosaicRule(this.options.mosaicRule),D.run(S),this._shouldRenderPopup=!0,this._lastClick=x.latlng},_buildExportParams:function(){var x=parseInt(this._map.options.crs.code.split(":")[1],10),S={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:x,imageSR:x};return this.options.from&&this.options.to&&(S.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(S.pixelType=this.options.pixelType),this.options.interpolation&&(S.interpolation=this.options.interpolation),this.options.compressionQuality&&(S.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(S.bandIds=this.options.bandIds),(0===this.options.noData||this.options.noData)&&(S.noData=this.options.noData),this.options.noDataInterpretation&&(S.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(S.token=this.service.options.token),this.options.renderingRule&&(S.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(S.mosaicRule=JSON.stringify(this.options.mosaicRule)),S},_requestExport:function(x,S){if("json"===this.options.f)this.service.request("exportImage",x,function(W,tt){W||(this.options.token&&(tt.href+="?token="+this.options.token),this.options.proxy&&(tt.href=this.options.proxy+"?"+tt.href),this._renderImage(tt.href,S))},this);else{x.f="image";var D=this.options.url+"exportImage"+dt.Util.getParamString(x);this.options.proxy&&(D=this.options.proxy+"?"+D),this._renderImage(D,S)}}}),En=Rn.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(x){x=wi(x),this.service=_a(x),this.service.addEventParent(this),dt.Util.setOptions(this,x)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(x){return this.options.dynamicLayers=x,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(x){return this.options.layers=x,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(x){return this.options.layerDefs=x,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(x){return this.options.timeOptions=x,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(x){var S,D=dt.Util.bind(function(tt,ht,Lt){tt||setTimeout(dt.Util.bind(function(){this._renderPopup(x.latlng,tt,ht,Lt)},this),300)},this);if((S=this.options.popup?this.options.popup.on(this._map).at(x.latlng):this.identify().on(this._map).at(x.latlng)).params.maxAllowableOffset||S.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||S.layers(this.options.layers?"visible:"+this.options.layers.join(","):"visible"),this.options.layerDefs&&"string"!=typeof this.options.layerDefs&&!S.params.layerDefs)for(var W in this.options.layerDefs)Object.prototype.hasOwnProperty.call(this.options.layerDefs,W)&&S.layerDef(W,this.options.layerDefs[W]);S.run(D),this._shouldRenderPopup=!0,this._lastClick=x.latlng},_buildExportParams:function(){var x=parseInt(this._map.options.crs.code.split(":")[1],10),S={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:x,imageSR:x};if(this.options.dynamicLayers&&(S.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(0===this.options.layers.length)return;S.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(S.layerDefs="string"==typeof this.options.layerDefs?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(S.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(S.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(S.token=this.service.options.token),this.options.proxy&&(S.proxy=this.options.proxy),this.options.disableCache&&(S._ts=Date.now()),S},_requestExport:function(x,S){if("json"===this.options.f)this.service.request("export",x,function(W,tt){W||(this.options.token&&tt.href&&(tt.href+="?token="+this.options.token),this.options.proxy&&tt.href&&(tt.href=this.options.proxy+"?"+tt.href),tt.href?this._renderImage(tt.href,S):this._renderImage(tt.imageData,S,tt.contentType))},this);else{x.f="image";var D=this.options.url+"export"+dt.Util.getParamString(x);this.options.proxy&&(D=this.options.proxy+"?"+D),this._renderImage(D,S)}}}),Pi=dt.Layer.extend({options:{cellSize:512,updateWhenIdle:dt.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize:function(x){dt.Util.setOptions(this,x)},onAdd:function(x){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove:function(x){this._removeAllCells(),this._cellZoom=void 0},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents:function(){var x={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=dt.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),x.move=this._onMove),x},createCell:function(){return document.createElement("div")},removeCell:function(){},reuseCell:function(){},cellLeave:function(){},cellEnter:function(){},getCellSize:function(){var x=this.options.cellSize;return x instanceof dt.Point?x:new dt.Point(x,x)},_pruneCells:function(){if(this._map){var x,S;for(x in this._cells)(S=this._cells[x]).retain=S.current;for(x in this._cells)if((S=this._cells[x]).current&&!S.active){var D=S.coords;this._retainParent(D.x,D.y,D.z,D.z-5)||this._retainChildren(D.x,D.y,D.z,D.z+2)}for(x in this._cells)this._cells[x].retain||this._removeCell(x)}},_removeAllCells:function(){for(var x in this._cells)this._removeCell(x)},_invalidateAll:function(){this._removeAllCells(),this._cellZoom=void 0},_retainParent:function(x,S,D,W){var tt=Math.floor(x/2),ht=Math.floor(S/2),Lt=D-1,Jt=new dt.Point(+tt,+ht);Jt.z=+Lt;var ue=this._cellCoordsToKey(Jt),Ae=this._cells[ue];return Ae&&Ae.active?(Ae.retain=!0,!0):(Ae&&Ae.loaded&&(Ae.retain=!0),Lt>W&&this._retainParent(tt,ht,Lt,W))},_retainChildren:function(x,S,D,W){for(var tt=2*x;tt<2*x+2;tt++)for(var ht=2*S;ht<2*S+2;ht++){var Lt=new dt.Point(tt,ht);Lt.z=D+1;var Jt=this._cellCoordsToKey(Lt),ue=this._cells[Jt];ue&&ue.active?ue.retain=!0:(ue&&ue.loaded&&(ue.retain=!0),D+1<W&&this._retainChildren(tt,ht,D+1,W))}},_resetView:function(x){var S=x&&(x.pinch||x.flyTo);S||this._setView(this._map.getCenter(),this._map.getZoom(),S,S)},_setView:function(x,S,D,W){var tt=Math.round(S);W||(this._cellZoom=tt,this._abortLoading&&this._abortLoading(),this._resetGrid(),void 0!==tt&&this._update(x),D||this._pruneCells(),this._noPrune=!!D)},_resetGrid:function(){var x=this._map,S=x.options.crs,D=this._cellSize=this.getCellSize(),W=this._cellZoom,tt=this._map.getPixelWorldBounds(this._cellZoom);tt&&(this._globalCellRange=this._pxBoundsToCellRange(tt)),this._wrapX=S.wrapLng&&!this.options.noWrap&&[Math.floor(x.project([0,S.wrapLng[0]],W).x/D.x),Math.ceil(x.project([0,S.wrapLng[1]],W).x/D.y)],this._wrapY=S.wrapLat&&!this.options.noWrap&&[Math.floor(x.project([S.wrapLat[0],0],W).y/D.x),Math.ceil(x.project([S.wrapLat[1],0],W).y/D.y)]},_onMoveEnd:function(x){x&&(x.pinch||x.flyTo)||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds:function(x){var S=this._map,D=S._animatingZoom?Math.max(S._animateToZoom,S.getZoom()):S.getZoom(),W=S.getZoomScale(D,this._cellZoom),tt=S.project(x,this._cellZoom).floor(),ht=S.getSize().divideBy(2*W);return new dt.Bounds(tt.subtract(ht),tt.add(ht))},_update:function(x){var S=this._map;if(S){var D=Math.round(S.getZoom());void 0===x&&(x=S.getCenter());var W=this._getCelldPixelBounds(x),tt=this._pxBoundsToCellRange(W),ht=tt.getCenter(),Lt=[],Jt=this.options.keepBuffer,ue=new dt.Bounds(tt.getBottomLeft().subtract([Jt,-Jt]),tt.getTopRight().add([Jt,-Jt]));if(!(isFinite(tt.min.x)&&isFinite(tt.min.y)&&isFinite(tt.max.x)&&isFinite(tt.max.y)))throw new Error("Attempted to load an infinite number of cells");for(var Ae in this._cells){var Di=this._cells[Ae].coords;Di.z===this._cellZoom&&ue.contains(new dt.Point(Di.x,Di.y))||(this._cells[Ae].current=!1)}if(Math.abs(D-this._cellZoom)>1)this._setView(x,D);else{for(var Qi=tt.min.y;Qi<=tt.max.y;Qi++)for(var ji=tt.min.x;ji<=tt.max.x;ji++){var ir=new dt.Point(ji,Qi);if(ir.z=this._cellZoom,this._isValidCell(ir)){var Pn=this._cells[this._cellCoordsToKey(ir)];Pn?Pn.current=!0:Lt.push(ir)}}if(Lt.sort(function(Mr,fn){return Mr.distanceTo(ht)-fn.distanceTo(ht)}),0!==Lt.length)for(this._loading||(this._loading=!0),ji=0;ji<Lt.length;ji++){var ri=this._cellCoordsToKey(Lt[ji]),Ti=this._keyToCellCoords(ri);this._activeCells[Ti]?this._reuseCell(Lt[ji]):this._createCell(Lt[ji])}}}},_isValidCell:function(x){var S=this._map.options.crs;if(!S.infinite){var D=this._globalCellRange;if(!S.wrapLng&&(x.x<D.min.x||x.x>D.max.x)||!S.wrapLat&&(x.y<D.min.y||x.y>D.max.y))return!1}if(!this.options.bounds)return!0;var W=this._cellCoordsToBounds(x);return dt.toLatLngBounds(this.options.bounds).overlaps(W)},_keyToBounds:function(x){return this._cellCoordsToBounds(this._keyToCellCoords(x))},_cellCoordsToNwSe:function(x){var S=this._map,D=this.getCellSize(),W=x.scaleBy(D),tt=W.add(D);return[S.unproject(W,x.z),S.unproject(tt,x.z)]},_cellCoordsToBounds:function(x){var S=this._cellCoordsToNwSe(x),D=new dt.LatLngBounds(S[0],S[1]);return this.options.noWrap||(D=this._map.wrapLatLngBounds(D)),D},_cellCoordsToKey:function(x){return x.x+":"+x.y+":"+x.z},_keyToCellCoords:function(x){var S=x.split(":"),D=new dt.Point(+S[0],+S[1]);return D.z=+S[2],D},_removeCell:function(x){var S=this._cells[x];if(S){var D=this._keyToCellCoords(x),W=this._wrapCoords(D),tt=this._cellCoordsToBounds(this._wrapCoords(D));S.current=!1,delete this._cells[x],this._activeCells[x]=S,this.cellLeave(tt,W,x),this.fire("cellleave",{key:x,coords:W,bounds:tt})}},_reuseCell:function(x){var S=this._cellCoordsToKey(x);this._cells[S]=this._activeCells[S],this._cells[S].current=!0;var D=this._wrapCoords(x),W=this._cellCoordsToBounds(this._wrapCoords(x));this.cellEnter(W,D,S),this.fire("cellenter",{key:S,coords:D,bounds:W})},_createCell:function(x){var S=this._cellCoordsToKey(x),D=this._wrapCoords(x),W=this._cellCoordsToBounds(this._wrapCoords(x));this.createCell(W,D,S),this.fire("cellcreate",{key:S,coords:D,bounds:W}),this._cells[S]={coords:x,current:!0},dt.Util.requestAnimFrame(this._pruneCells,this)},_cellReady:function(x,S,D){var W=this._cellCoordsToKey(x);(D=this._cells[W])&&(D.loaded=+new Date,D.active=!0)},_getCellPos:function(x){return x.scaleBy(this.getCellSize())},_wrapCoords:function(x){var S=new dt.Point(this._wrapX?dt.Util.wrapNum(x.x,this._wrapX):x.x,this._wrapY?dt.Util.wrapNum(x.y,this._wrapY):x.y);return S.z=x.z,S},_pxBoundsToCellRange:function(x){var S=this.getCellSize();return new dt.Bounds(x.min.unscaleBy(S).floor(),x.max.unscaleBy(S).ceil().subtract([1,1]))}});function Hi(x){this.values=[].concat(x||[])}Hi.prototype.query=function(x){var S=this.getIndex(x);return this.values[S]},Hi.prototype.getIndex=function(x){this.dirty&&this.sort();for(var S,D,W=0,tt=this.values.length-1;W<=tt;)if(S=(W+tt)/2|0,+(D=this.values[Math.round(S)]).value<+x)W=S+1;else{if(!(+D.value>+x))return S;tt=S-1}return Math.abs(~tt)},Hi.prototype.between=function(x,S){var D=this.getIndex(x),W=this.getIndex(S);if(0===D&&0===W)return[];for(;this.values[D-1]&&this.values[D-1].value===x;)D--;for(;this.values[W+1]&&this.values[W+1].value===S;)W++;return this.values[W]&&this.values[W].value===S&&this.values[W+1]&&W++,this.values.slice(D,W)},Hi.prototype.insert=function(x){return this.values.splice(this.getIndex(x.value),0,x),this},Hi.prototype.bulkAdd=function(x,S){return this.values=this.values.concat([].concat(x||[])),S?this.sort():this.dirty=!0,this},Hi.prototype.sort=function(){return this.values.sort(function(x,S){return+S.value-+x.value}).reverse(),this.dirty=!1,this};var Fi=Pi.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize:function(x){if(Pi.prototype.initialize.call(this,x),x=wi(x),x=dt.Util.setOptions(this,x),this.service=hn(x),this.service.addEventParent(this),"*"!==this.options.fields[0]){for(var S=!1,D=0;D<this.options.fields.length;D++)this.options.fields[D].match(/^(OBJECTID|FID|OID|ID)$/i)&&(S=!0);!1===S&&Mn("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new Hi,this._endTimeIndex=new Hi):this.options.timeField&&(this._timeIndex=new Hi),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(x){return qi(x),this.service.metadata(function(S,D){if(!S){var W=D.supportedQueryFormats,tt=!1;(!1===this.service.options.isModern||this.options.fetchAllFeatures)&&(tt=!0),!tt&&W&&-1!==W.indexOf("geoJSON")&&(this.service.options.isModern=!0),D.objectIdField&&(this.service.options.idAttribute=D.objectIdField),!this.options.attribution&&x.attributionControl&&D.copyrightText&&(this.options.attribution=D.copyrightText,x.attributionControl.addAttribution(this.getAttribution()))}},this),x.on("zoomend",this._handleZoomChange,this),Pi.prototype.onAdd.call(this,x)},onRemove:function(x){return ki(x),x.off("zoomend",this._handleZoomChange,this),Pi.prototype.onRemove.call(this,x)},getAttribution:function(){return this.options.attribution},createCell:function(x,S){this._visibleZoom()&&this._requestFeatures(x,S)},_requestFeatures:function(x,S,D,W){this._activeRequests++,W=W||0;var tt=this.options.where;return 1===this._activeRequests&&this.fire("loading",{bounds:x},!0),this._buildQuery(x,W).run(function(ht,Lt,Jt){Jt&&Jt.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===tt&&(!ht&&Lt&&Lt.features.length&&dt.Util.requestAnimFrame(dt.Util.bind(function(){this._addFeatures(Lt.features,S),this._postProcessFeatures(x)},this)),ht||!Lt||Lt.features.length||this._postProcessFeatures(x),ht&&this._postProcessFeatures(x),D&&D.call(this,ht,Lt),Jt&&(Jt.exceededTransferLimit||Jt.properties&&Jt.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(x,S,D,W+Lt.features.length))},this)},_postProcessFeatures:function(x){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:x})},_cacheKey:function(x){return x.z+":"+x.x+":"+x.y},_addFeatures:function(x,S){if(S){var D=this._cacheKey(S);this._cache[D]=this._cache[D]||[]}for(var W=x.length-1;W>=0;W--){var tt=x[W].id;-1===this._currentSnapshot.indexOf(tt)&&this._currentSnapshot.push(tt),void 0!==D&&-1===this._cache[D].indexOf(tt)&&this._cache[D].push(tt)}this.options.timeField&&this._buildTimeIndexes(x),this.createLayers(x)},_buildQuery:function(x,S){var D=this.service.query().intersects(x).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(S))&&(D=D.offset(S)),D.params.resultType="tile",this.options.requestParams&&dt.Util.extend(D.params,this.options.requestParams),this.options.simplifyFactor&&D.simplify(this._map,this.options.simplifyFactor),"server"===this.options.timeFilterMode&&this.options.from&&this.options.to&&D.between(this.options.from,this.options.to),D},setWhere:function(x,S,D){this.options.where=x&&x.length?x:"1=1";for(var W=[],tt=[],ht=0,Lt=null,Jt=dt.Util.bind(function(ji,ir){if(ji&&(Lt=ji),ir)for(var Pn=ir.features.length-1;Pn>=0;Pn--)tt.push(ir.features[Pn].id);--ht<=0&&this._visibleZoom()&&x===this.options.where&&(this._currentSnapshot=tt,dt.Util.requestAnimFrame(dt.Util.bind(function(){this.removeLayers(W),this.addLayers(tt),S&&S.call(D,Lt)},this)))},this),ue=this._currentSnapshot.length-1;ue>=0;ue--)W.push(this._currentSnapshot[ue]);for(var Ae in this._cache={},this._cells){ht++;var Di=this._keyToCellCoords(Ae),Qi=this._cellCoordsToBounds(Di);this._requestFeatures(Qi,Di,Jt)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(x,S,D,W){var tt=this.options.from,ht=this.options.to,Lt=0,Jt=null,ue=dt.Util.bind(function(ji){ji&&(Jt=ji),this._filterExistingFeatures(tt,ht,x,S),Lt--,D&&Lt<=0&&D.call(W,Jt)},this);if(this.options.from=x,this.options.to=S,this._filterExistingFeatures(tt,ht,x,S),"server"===this.options.timeFilterMode)for(var Ae in this._cells){Lt++;var Di=this._keyToCellCoords(Ae),Qi=this._cellCoordsToBounds(Di);this._requestFeatures(Qi,Di,ue)}return this},refresh:function(){this.setWhere(this.options.where)},_filterExistingFeatures:function(x,S,D,W){var tt=x&&S?this._getFeaturesInTimeRange(x,S):this._currentSnapshot,ht=this._getFeaturesInTimeRange(D,W);if(ht.indexOf)for(var Lt=0;Lt<ht.length;Lt++){var Jt=tt.indexOf(ht[Lt]);Jt>=0&&tt.splice(Jt,1)}dt.Util.requestAnimFrame(dt.Util.bind(function(){this.removeLayers(tt),this.addLayers(ht)},this))},_getFeaturesInTimeRange:function(x,S){var D,W=[];if(this.options.timeField.start&&this.options.timeField.end){var tt=this._startTimeIndex.between(x,S),ht=this._endTimeIndex.between(x,S);D=tt.concat(ht)}else{if(!this._timeIndex)return Mn("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];D=this._timeIndex.between(x,S)}for(var Lt=D.length-1;Lt>=0;Lt--)W.push(D[Lt].id);return W},_buildTimeIndexes:function(x){var S,D;if(this.options.timeField.start&&this.options.timeField.end){var W=[],tt=[];for(S=x.length-1;S>=0;S--)W.push({id:(D=x[S]).id,value:new Date(D.properties[this.options.timeField.start])}),tt.push({id:D.id,value:new Date(D.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(W),this._endTimeIndex.bulkAdd(tt)}else{var ht=[];for(S=x.length-1;S>=0;S--)ht.push({id:(D=x[S]).id,value:new Date(D.properties[this.options.timeField])});this._timeIndex.bulkAdd(ht)}},_featureWithinTimeRange:function(x){if(!this.options.from||!this.options.to)return!0;var S=+this.options.from.valueOf(),D=+this.options.to.valueOf();if("string"==typeof this.options.timeField){var W=+x.properties[this.options.timeField];return W>=S&&W<=D}if(this.options.timeField.start&&this.options.timeField.end){var tt=+x.properties[this.options.timeField.start],ht=+x.properties[this.options.timeField.end];return tt>=S&&tt<=D||ht>=S&&ht<=D||tt<=S&&ht>=D}},_visibleZoom:function(){if(!this._map)return!1;var x=this._map.getZoom();return!(x>this.options.maxZoom||x<this.options.minZoom)},_handleZoomChange:function(){if(this._visibleZoom())for(var x in this._cells){var D=this._cacheKey(this._cells[x].coords);this._cache[D]&&this.addLayers(this._cache[D])}else this.removeLayers(this._currentSnapshot),this._currentSnapshot=[]},authenticate:function(x){return this.service.authenticate(x),this},metadata:function(x,S){return this.service.metadata(x,S),this},query:function(){return this.service.query()},_getMetadata:function(x){this._metadata?x(void 0,this._metadata):this.metadata(dt.Util.bind(function(S,D){this._metadata=D,x(S,this._metadata)},this))},addFeature:function(x,S,D){this.addFeatures(x,S,D)},addFeatures:function(x,S,D){this._getMetadata(dt.Util.bind(function(W,tt){if(W)S&&S.call(this,W,null);else{var ht=x.features?x.features:[x];this.service.addFeatures(x,dt.Util.bind(function(Lt,Jt){if(!Lt){for(var ue=ht.length-1;ue>=0;ue--)ht[ue].properties[tt.objectIdField]=ht.length>1?Jt[ue].objectId:Jt.objectId,ht[ue].id=ht.length>1?Jt[ue].objectId:Jt.objectId;this._addFeatures(ht)}S&&S.call(D,Lt,Jt)},this))}},this))},updateFeature:function(x,S,D){this.updateFeatures(x,S,D)},updateFeatures:function(x,S,D){var W=x.features?x.features:[x];this.service.updateFeatures(x,function(tt,ht){if(!tt){for(var Lt=W.length-1;Lt>=0;Lt--)this.removeLayers([W[Lt].id],!0);this._addFeatures(W)}S&&S.call(D,tt,ht)},this)},deleteFeature:function(x,S,D){this.deleteFeatures(x,S,D)},deleteFeatures:function(x,S,D){return this.service.deleteFeatures(x,function(W,tt){var ht=tt.length?tt:[tt];if(!W&&ht.length>0)for(var Lt=ht.length-1;Lt>=0;Lt--)this.removeLayers([ht[Lt].objectId],!0);S&&S.call(D,W,tt)},this)}}),io=Fi.extend({options:{cacheLayers:!0},initialize:function(x){x.apikey&&(x.token=x.apikey),Fi.prototype.initialize.call(this,x),this._originalStyle=this.options.style,this._layers={}},onRemove:function(x){for(var S in this._layers)x.removeLayer(this._layers[S]),this.fire("removefeature",{feature:this._layers[S].feature,permanent:!1},!0);return Fi.prototype.onRemove.call(this,x)},createNewLayer:function(x){var S=dt.GeoJSON.geometryToLayer(x,this.options);return S&&(S.defaultOptions=S.options),S},_updateLayer:function(x,S){var D=[],W=this.options.coordsToLatLng||dt.GeoJSON.coordsToLatLng;switch(S.properties&&(x.feature.properties=S.properties),S.geometry.type){case"Point":D=dt.GeoJSON.coordsToLatLng(S.geometry.coordinates),x.setLatLng(D);break;case"LineString":D=dt.GeoJSON.coordsToLatLngs(S.geometry.coordinates,0,W),x.setLatLngs(D);break;case"MultiLineString":case"Polygon":D=dt.GeoJSON.coordsToLatLngs(S.geometry.coordinates,1,W),x.setLatLngs(D);break;case"MultiPolygon":D=dt.GeoJSON.coordsToLatLngs(S.geometry.coordinates,2,W),x.setLatLngs(D)}this.redraw(x.feature.id)},createLayers:function(x){for(var S=x.length-1;S>=0;S--){var D,W=x[S],tt=this._layers[W.id];!this._visibleZoom()||!tt||this._map.hasLayer(tt)||this.options.timeField&&!this._featureWithinTimeRange(W)||(this._map.addLayer(tt),this.fire("addfeature",{feature:tt.feature},!0)),tt&&(tt.setLatLngs||tt.setLatLng)&&this._updateLayer(tt,W),tt||((D=this.createNewLayer(W))?(D.feature=W,D.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(D.feature,D),this._layers[D.feature.id]=D,this.setFeatureStyle(D.feature.id,this.options.style),this.fire("createfeature",{feature:D.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(W))&&this._map.addLayer(D)):Mn("invalid GeoJSON encountered"))}},addLayers:function(x){for(var S=x.length-1;S>=0;S--){var D=this._layers[x[S]];!D||this.options.timeField&&!this._featureWithinTimeRange(D.feature)||(this._map.addLayer(D),this.fire("addfeature",{feature:D.feature},!0))}},removeLayers:function(x,S){for(var D=x.length-1;D>=0;D--){var W=x[D],tt=this._layers[W];tt&&(this.fire("removefeature",{feature:tt.feature,permanent:S},!0),this._map.removeLayer(tt)),tt&&S&&delete this._layers[W]}},cellEnter:function(x,S){this._visibleZoom()&&!this._zooming&&this._map&&dt.Util.requestAnimFrame(dt.Util.bind(function(){var D=this._cacheKey(S),W=this._cellCoordsToKey(S),tt=this._cache[D];this._activeCells[W]&&tt&&this.addLayers(tt)},this))},cellLeave:function(x,S){this._zooming||dt.Util.requestAnimFrame(dt.Util.bind(function(){if(this._map){var D=this._cacheKey(S),W=this._cellCoordsToKey(S),tt=this._cache[D],ht=this._map.getBounds();if(!this._activeCells[W]&&tt){for(var Lt=!0,Jt=0;Jt<tt.length;Jt++){var ue=this._layers[tt[Jt]];ue&&ue.getBounds&&ht.intersects(ue.getBounds())&&(Lt=!1)}Lt&&this.removeLayers(tt,!this.options.cacheLayers),!this.options.cacheLayers&&Lt&&(delete this._cache[D],delete this._cells[W],delete this._activeCells[W])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(x){this.resetFeatureStyle(x.feature.id)},this),this},setStyle:function(x){return this.options.style=x,this.eachFeature(function(S){this.setFeatureStyle(S.feature.id,x)},this),this},resetFeatureStyle:function(x){var S=this._layers[x],D=this._originalStyle||dt.Path.prototype.options;return S&&(dt.Util.extend(S.options,S.defaultOptions),this.setFeatureStyle(x,D)),this},setFeatureStyle:function(x,S){var D=this._layers[x];return"function"==typeof S&&(S=S(D.feature)),D.setStyle&&D.setStyle(S),this},eachActiveFeature:function(x,S){if(this._map){var D=this._map.getBounds();for(var W in this._layers)-1!==this._currentSnapshot.indexOf(this._layers[W].feature.id)&&("function"==typeof this._layers[W].getLatLng&&D.contains(this._layers[W].getLatLng())||"function"==typeof this._layers[W].getBounds&&D.intersects(this._layers[W].getBounds()))&&x.call(S,this._layers[W])}return this},eachFeature:function(x,S){for(var D in this._layers)x.call(S,this._layers[D]);return this},getFeature:function(x){return this._layers[x]},bringToBack:function(){this.eachFeature(function(x){x.bringToBack&&x.bringToBack()})},bringToFront:function(){this.eachFeature(function(x){x.bringToFront&&x.bringToFront()})},redraw:function(x){return x&&this._redraw(x),this},_redraw:function(x){var S=this._layers[x],D=S.feature;if(S&&S.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var W=this.options.pointToLayer(D,dt.latLng(D.geometry.coordinates[1],D.geometry.coordinates[0])).options.icon;S.setIcon(W)}if(S&&S.setStyle&&this.options.pointToLayer){var tt=this.options.pointToLayer(D,dt.latLng(D.geometry.coordinates[1],D.geometry.coordinates[0])).options;this.setFeatureStyle(D.id,tt)}S&&S.setStyle&&this.options.style&&this.resetStyle(D.id)}});At.BasemapLayer=Bn,At.DynamicMapLayer=En,At.FeatureLayer=io,At.FeatureLayerService=ei,At.FeatureManager=Fi,At.Find=Gr,At.Identify=vr,At.IdentifyFeatures=Dn,At.IdentifyImage=xr,At.ImageMapLayer=Tn,At.ImageService=Hn,At.MapService=Hr,At.Query=qe,At.RasterLayer=Rn,At.Service=Wr,At.Support=lr,At.Task=un,At.TiledMapLayer=je,At.Util=Ri,At.VERSION="3.0.8",At.basemapLayer=function(x,S){return new Bn(x,S)},At.dynamicMapLayer=function(x,S){return new En(x,S)},At.featureLayer=function(x){return new io(x)},At.featureLayerService=hn,At.find=kr,At.get=ur,At.identify=function(x){return new vr(x)},At.identifyFeatures=On,At.identifyImage=_o,At.imageMapLayer=function(x,S){return new Tn(x,S)},At.imageService=Xr,At.mapService=_a,At.options=ni,At.post=zr,At.query=hr,At.request=Do,At.service=function(x){return x=wi(x),new Wr(x)},At.task=function(x){return x=wi(x),new un(x)},At.tiledMapLayer=function(x,S){return new je(x,S)},Object.defineProperty(At,"__esModule",{value:!0})}),function(At,dt){"object"==typeof exports&&typeof module<"u"?dt(exports,require("leaflet"),require("esri-leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet","esri-leaflet"],dt):dt(((At=typeof globalThis<"u"?globalThis:At||self).L=At.L||{},At.L.esri=At.L.esri||{},At.L.esri.Vector={}),At.L,At.L.esri)}(this,function(At,dt,qr){"use strict";function Ei(Bt,ee,Me){qr.request(Bt,ee.token?{token:ee.token}:{},Me)}function ni(Bt,ee,Me){Ei(Bt,ee,function(Te,zi){Te&&console.error(Te);var wn,c=Bt;"/"===Bt.charAt(Bt.length-1)&&(c=Bt.slice(0,Bt.length-1)),Go(wn="/"===zi.defaultStyles.charAt(0)?c+zi.defaultStyles+"/root.json":c+"/"+zi.defaultStyles+"/root.json",ee,function(gi,Mt){gi&&console.error(gi),Me(null,Mt,wn,zi,Bt)})})}function Go(Bt,ee,Me){qr.request(Bt,ee.token?{token:ee.token}:{},Me)}function Lr(Bt,ee){qr.Support.cors&&qr.request(Bt,{},function(Me,Te){if(!Me){ee._esriAttributions=ee._esriAttributions||[];for(var zi=0;zi<Te.contributors.length;zi++)for(var wn=Te.contributors[zi],c=0;c<wn.coverageAreas.length;c++){var gi=wn.coverageAreas[c],Mt=dt.latLng(gi.bbox[0],gi.bbox[1]),Ue=dt.latLng(gi.bbox[2],gi.bbox[3]);ee._esriAttributions.push({attribution:wn.attribution,score:gi.score,bounds:dt.latLngBounds(Mt,Ue),minZoom:gi.zoomMin,maxZoom:gi.zoomMax})}ee._esriAttributions.sort(function(en,Nt){return Nt.score-en.score}),qr.Util._updateMapAttribution({target:ee})}})}const sn=[3857,102100,102113];typeof globalThis<"u"||typeof window<"u"||typeof global<"u"&&global;var zr={exports:{}};zr.exports=function(){var Me,Te,zi;function wn(c,gi){if(Me)if(Te){var Mt="var sharedChunk = {}; ("+Me+")(sharedChunk); ("+Te+")(sharedChunk);",Ue={};Me(Ue),zi=gi(Ue),typeof window<"u"&&(zi.workerUrl=window.URL.createObjectURL(new Blob([Mt],{type:"text/javascript"})))}else Te=gi;else Me=gi}return wn(0,function(c){function gi(t,e){return t(e={exports:{}},e.exports),e.exports}var Mt=Ue;function Ue(t,e,i,s){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=i,this.p2y=s}Ue.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Ue.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Ue.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Ue.prototype.solveCurveX=function(t,e){var i,s,h,p,f;for(void 0===e&&(e=1e-6),h=t,f=0;f<8;f++){if(p=this.sampleCurveX(h)-t,Math.abs(p)<e)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=p/v}if((h=t)<(i=0))return i;if(h>(s=1))return s;for(;i<s;){if(p=this.sampleCurveX(h),Math.abs(p-t)<e)return h;t>p?i=h:s=h,h=.5*(s-i)+i}return h},Ue.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var le=en;function en(t,e){this.x=t,this.y=e}en.prototype={clone:function(){return new en(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),s=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=s,this},_rotateAround:function(t,e){var i=Math.cos(t),s=Math.sin(t),h=e.y+s*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-s*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},en.convert=function(t){return t instanceof en?t:Array.isArray(t)?new en(t[0],t[1]):t};var Nt=typeof self<"u"?self:{},dn=Math.pow(2,53)-1;function nn(t,e,i,s){var h=new Mt(t,e,i,s);return function(p){return h.solve(p)}}var Se=nn(.25,.1,.25,1);function er(t,e,i){return Math.min(i,Math.max(e,t))}function Oe(t,e,i){var s=i-e,h=((t-e)%s+s)%s+e;return h===e?i:h}function Ct(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var s=0,h=e;s<h.length;s+=1){var p=h[s];for(var f in p)t[f]=p[f]}return t}var ln=1;function wi(){return ln++}function Bi(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function ci(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function pi(t,e){t.forEach(function(i){e[i]&&(e[i]=e[i].bind(e))})}function qi(t,e){return-1!==t.indexOf(e,t.length-e.length)}function ki(t,e,i){var s={};for(var h in t)s[h]=e.call(i||this,t[h],h,t);return s}function Mi(t,e,i){var s={};for(var h in t)e.call(i||this,t[h],h,t)&&(s[h]=t[h]);return s}function Gn(t){return Array.isArray(t)?t.map(Gn):"object"==typeof t&&t?ki(t,Gn):t}var Wn={};function Ri(t){Wn[t]||(typeof console<"u"&&console.warn(t),Wn[t]=!0)}function un(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function qe(t){for(var e=0,i=0,s=t.length,h=s-1,p=void 0,f=void 0;i<s;h=i++)e+=((f=t[h]).x-(p=t[i]).x)*(p.y+f.y);return e}function hr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Gr(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(s,h,p,f){var v=p||f;return e[h]=!v||v.toLowerCase(),""}),e["max-age"]){var i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}var kr=null;function vr(t){if(null==kr){var e=t.navigator?t.navigator.userAgent:null;kr=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return kr}function Dn(t){try{var e=Nt[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}var On,xr,_o,Wr,Hr=Nt.performance&&Nt.performance.now?Nt.performance.now.bind(Nt.performance):Date.now.bind(Date),_a=Nt.requestAnimationFrame||Nt.mozRequestAnimationFrame||Nt.webkitRequestAnimationFrame||Nt.msRequestAnimationFrame,Hn=Nt.cancelAnimationFrame||Nt.mozCancelAnimationFrame||Nt.webkitCancelAnimationFrame||Nt.msCancelAnimationFrame,Xr={now:Hr,frame:function(t){var e=_a(t);return{cancel:function(){return Hn(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var i=Nt.document.createElement("canvas"),s=i.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return i.width=t.width,i.height=t.height,s.drawImage(t,0,0,t.width,t.height),s.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return On||(On=Nt.document.createElement("a")),On.href=t,On.href},hardwareConcurrency:Nt.navigator&&Nt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Nt.devicePixelRatio},get prefersReducedMotion(){return!!Nt.matchMedia&&(null==xr&&(xr=Nt.matchMedia("(prefers-reduced-motion: reduce)")),xr.matches)}},ei={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},hn={supported:!1,testSupport:function(t){!re&&Wr&&(Bn?je(t):_o=t)}},re=!1,Bn=!1;function je(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Wr),t.isContextLost())return;hn.supported=!0}catch{}t.deleteTexture(e),re=!0}Nt.document&&((Wr=Nt.document.createElement("img")).onload=function(){_o&&je(_o),_o=null,Bn=!0},Wr.onerror=function(){re=!0,_o=null},Wr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var To="01",Rn=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function Tn(t){return 0===t.indexOf("mapbox:")}Rn.prototype._createSkuToken=function(){var t=function(){for(var e="",i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",To,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},Rn.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Rn.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},Rn.prototype.normalizeStyleURL=function(t,e){if(!Tn(t))return t;var i=Fi(t);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},Rn.prototype.normalizeGlyphsURL=function(t,e){if(!Tn(t))return t;var i=Fi(t);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},Rn.prototype.normalizeSourceURL=function(t,e){if(!Tn(t))return t;var i=Fi(t);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||e)},Rn.prototype.normalizeSpriteURL=function(t,e,i,s){var h=Fi(t);return Tn(t)?(h.path="/styles/v1"+h.path+"/sprite"+e+i,this._makeAPIURL(h,this._customAccessToken||s)):(h.path+=""+e+i,io(h))},Rn.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Tn(t))return t;var i=Fi(t);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Xr.devicePixelRatio>=2||512===e?"@2x":"")+(hn.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var s=this._customAccessToken||function(h){for(var p=0,f=h;p<f.length;p+=1){var v=f[p].match(/^access_token=(.*)$/);if(v)return v[1]}return null}(i.params)||ei.ACCESS_TOKEN;return ei.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,s)},Rn.prototype.canonicalizeTileURL=function(t,e){var i=Fi(t);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return t;var s="mapbox://tiles/";s+=i.path.replace("/v4/","");var h=i.params;return e&&(h=h.filter(function(p){return!p.match(/^access_token=/)})),h.length&&(s+="?"+h.join("&")),s},Rn.prototype.canonicalizeTileset=function(t,e){for(var i=!!e&&Tn(e),s=[],h=0,p=t.tiles||[];h<p.length;h+=1){var f=p[h];Pi(f)?s.push(this.canonicalizeTileURL(f,i)):s.push(f)}return s},Rn.prototype._makeAPIURL=function(t,e){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=Fi(ei.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,"http"===t.protocol){var h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if("/"!==s.path&&(t.path=""+s.path+t.path),!ei.REQUIRE_ACCESS_TOKEN)return io(t);if(!(e=e||ei.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return t.params=t.params.filter(function(p){return-1===p.indexOf("access_token")}),t.params.push("access_token="+e),io(t)};var En=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Pi(t){return En.test(t)}var Hi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Fi(t){var e=t.match(Hi);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function io(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function no(t){if(!t)return null;var e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(Nt.atob(e[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var x=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};x.prototype.getStorageKey=function(t){var e,i=no(ei.ACCESS_TOKEN);return e=i&&i.u?Nt.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(s,h){return String.fromCharCode(Number("0x"+h))})):ei.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},x.prototype.fetchEventData=function(){var t=Dn("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{var s=Nt.localStorage.getItem(e);s&&(this.eventData=JSON.parse(s));var h=Nt.localStorage.getItem(i);h&&(this.anonId=h)}catch{Ri("Unable to read from LocalStorage")}},x.prototype.saveEventData=function(){var t=Dn("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{Nt.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&Nt.localStorage.setItem(e,JSON.stringify(this.eventData))}catch{Ri("Unable to write to LocalStorage")}},x.prototype.processRequests=function(t){},x.prototype.postEvent=function(t,e,i,s){var h=this;if(ei.EVENTS_URL){var p=Fi(ei.EVENTS_URL);p.params.push("access_token="+(s||ei.ACCESS_TOKEN||""));var f={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.1",skuId:To,userId:this.anonId},v=e?Ct(f,e):f,T={url:io(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=Ke(T,function(E){h.pendingRequest=null,i(E),h.saveEventData(),h.processRequests(s)})}},x.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var S,D,W=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(i,s,h,p){this.skuToken=h,(ei.EVENTS_URL&&p||ei.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(f){return Tn(f)||Pi(f)}))&&this.queueRequest({id:s,timestamp:Date.now()},p)},e.prototype.processRequests=function(i){var s=this;if(!this.pendingRequest&&0!==this.queue.length){var h=this.queue.shift(),p=h.id,f=h.timestamp;p&&this.success[p]||(this.anonId||this.fetchEventData(),ci(this.anonId)||(this.anonId=Bi()),this.postEvent(f,{skuToken:this.skuToken},function(v){v||p&&(s.success[p]=!0)},i))}},e}(x),tt=new(function(t){function e(i){t.call(this,"appUserTurnstile"),this._customAccessToken=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(i,s){ei.EVENTS_URL&&ei.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(h){return Tn(h)||Pi(h)})&&this.queueRequest(Date.now(),s)},e.prototype.processRequests=function(i){var s=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var h=no(ei.ACCESS_TOKEN),p=h?h.u:ei.ACCESS_TOKEN,f=p!==this.eventData.tokenU;ci(this.anonId)||(this.anonId=Bi(),f=!0);var v=this.queue.shift();if(this.eventData.lastSuccess){var T=new Date(this.eventData.lastSuccess),E=new Date(v),C=(v-this.eventData.lastSuccess)/864e5;f=f||C>=1||C<-1||T.getDate()!==E.getDate()}else f=!0;if(!f)return this.processRequests();this.postEvent(v,{"enabled.telemetry":!1},function(k){k||(s.eventData.lastSuccess=v,s.eventData.tokenU=p)},i)}},e}(x)),ht=tt.postTurnstileEvent.bind(tt),Lt=new W,Jt=Lt.postMapLoadEvent.bind(Lt),ue=500,Ae=50;function Di(){Nt.caches&&!S&&(S=Nt.caches.open("mapbox-tiles"))}function Qi(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var ji,ir=1/0;function Pn(){return null==ji&&(ji=Nt.OffscreenCanvas&&new Nt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof Nt.createImageBitmap),ji}var ri={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ri);var Ti,Mr,fn=function(t){function e(i,s,h){401===s&&Pi(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,i),this.status=s,this.url=h,this.name=this.constructor.name,this.message=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),mn=hr()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===Nt.location.protocol?Nt.parent:Nt).location.href},Kr=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(mn())&&!/^\w+:/.test(i))){if(Nt.fetch&&Nt.Request&&Nt.AbortController&&Nt.Request.prototype.hasOwnProperty("signal"))return function(s,h){var p,f=new Nt.AbortController,v=new Nt.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:mn(),signal:f.signal}),T=!1,E=!1,C=(p=v.url).indexOf("sku=")>0&&Pi(p);"json"===s.type&&v.headers.set("Accept","application/json");var k=function(U,J,Y){if(!E){if(U&&"SecurityError"!==U.message&&Ri(U),J&&Y)return B(J);var at=Date.now();Nt.fetch(v).then(function(it){if(it.ok){var pt=C?it.clone():null;return B(it,pt,at)}return h(new fn(it.statusText,it.status,s.url))}).catch(function(it){20!==it.code&&h(new Error(it.message))})}},B=function(U,J,Y){("arrayBuffer"===s.type?U.arrayBuffer():"json"===s.type?U.json():U.text()).then(function(at){E||(J&&Y&&function(it,pt,gt){if(Di(),S){var xt={status:pt.status,statusText:pt.statusText,headers:new Nt.Headers};pt.headers.forEach(function(zt,qt){return xt.headers.set(qt,zt)});var St=Gr(pt.headers.get("Cache-Control")||"");St["no-store"]||(St["max-age"]&&xt.headers.set("Expires",new Date(gt+1e3*St["max-age"]).toUTCString()),new Date(xt.headers.get("Expires")).getTime()-gt<42e4||function(zt,qt){if(void 0===D)try{new Response(new ReadableStream),D=!0}catch{D=!1}D?qt(zt.body):zt.blob().then(qt)}(pt,function(zt){var qt=new Nt.Response(zt,xt);Di(),S&&S.then(function(Qt){return Qt.put(Qi(it.url),qt)}).catch(function(Qt){return Ri(Qt.message)})}))}}(v,J,Y),T=!0,h(null,at,U.headers.get("Cache-Control"),U.headers.get("Expires")))}).catch(function(at){E||h(new Error(at.message))})};return C?function(U,J){if(Di(),!S)return J(null);var Y=Qi(U.url);S.then(function(at){at.match(Y).then(function(it){var pt=function(gt){if(!gt)return!1;var xt=new Date(gt.headers.get("Expires")||0),St=Gr(gt.headers.get("Cache-Control")||"");return xt>Date.now()&&!St["no-cache"]}(it);at.delete(Y),pt&&at.put(Y,it.clone()),J(null,it,pt)}).catch(J)}).catch(J)}(v,k):k(null,null),{cancel:function(){E=!0,T||f.abort()}}}(t,e);if(hr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(s,h){var p=new Nt.XMLHttpRequest;for(var f in p.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(p.responseType="arraybuffer"),s.headers)p.setRequestHeader(f,s.headers[f]);return"json"===s.type&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials="include"===s.credentials,p.onerror=function(){h(new Error(p.statusText))},p.onload=function(){if((p.status>=200&&p.status<300||0===p.status)&&null!==p.response){var v=p.response;if("json"===s.type)try{v=JSON.parse(p.response)}catch(T){return h(T)}h(null,v,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else h(new fn(p.statusText,p.status,s.url))},p.send(s.body),{cancel:function(){return p.abort()}}}(t,e)},Ce=function(t,e){return Kr(Ct(t,{type:"arrayBuffer"}),e)},Ke=function(t,e){return Kr(Ct(t,{method:"POST"}),e)},z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Ti=[],Mr=0;var O=function(t,e){if(hn.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Mr>=ei.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return Ti.push(i),i}Mr++;var s=!1,h=function(){if(!s)for(s=!0,Mr--;Ti.length&&Mr<ei.MAX_PARALLEL_IMAGE_REQUESTS;){var f=Ti.shift();f.cancelled||(f.cancel=O(f.requestParameters,f.callback).cancel)}},p=Ce(t,function(f,v,T,E){var k,B;h(),f?e(f):v&&(Pn()?(k=e,B=new Nt.Blob([new Uint8Array(v)],{type:"image/png"}),Nt.createImageBitmap(B).then(function(U){k(null,U)}).catch(function(U){k(new Error("Could not load image because of "+U.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(C,k,B,U){var J=new Nt.Image,Y=Nt.URL;J.onload=function(){k(null,J),Y.revokeObjectURL(J.src),J.onload=null,Nt.requestAnimationFrame(function(){J.src=z})},J.onerror=function(){return k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var at=new Nt.Blob([new Uint8Array(C)],{type:"image/png"});J.cacheControl=B,J.expires=U,J.src=C.byteLength?Y.createObjectURL(at):z}(v,e,T,E))});return{cancel:function(){p.cancel(),h()}}};function F(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function G(t,e,i){if(i&&i[t]){var s=i[t].indexOf(e);-1!==s&&i[t].splice(s,1)}}var X=function(t,e){void 0===e&&(e={}),Ct(this,e),this.type=t},nt=function(t){function e(i,s){void 0===s&&(s={}),t.call(this,"error",Ct({error:i},s))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(X),st=function(){};st.prototype.on=function(t,e){return this._listeners=this._listeners||{},F(t,e,this._listeners),this},st.prototype.off=function(t,e){return G(t,e,this._listeners),G(t,e,this._oneTimeListeners),this},st.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},F(t,e,this._oneTimeListeners),this},st.prototype.fire=function(t,e){"string"==typeof t&&(t=new X(t,e||{}));var i=t.type;if(this.listens(i)){t.target=this;for(var s=0,h=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];s<h.length;s+=1)h[s].call(this,t);for(var p=0,f=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];p<f.length;p+=1){var v=f[p];G(i,v,this._oneTimeListeners),v.call(this,t)}var T=this._eventedParent;T&&(Ct(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),T.fire(t))}else t instanceof nt&&console.error(t.error);return this},st.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},st.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var j={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},et=function(t,e,i,s){this.message=(t?t+": ":"")+i,s&&(this.identifier=s),null!=e&&e.__line__&&(this.line=e.__line__)};function ft(t){var e=t.value;return e?[new et(t.key,e,"constants have been deprecated as of v8")]:[]}function kt(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var s=0,h=e;s<h.length;s+=1){var p=h[s];for(var f in p)t[f]=p[f]}return t}function Rt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function bt(t){if(Array.isArray(t))return t.map(bt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var i in t)e[i]=bt(t[i]);return e}return Rt(t)}var vt=function(t){function e(i,s){t.call(this,s),this.message=s,this.key=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),ne=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var i=0,s=e;i<s.length;i+=1){var h=s[i];this.bindings[h[0]]=h[1]}};ne.prototype.concat=function(t){return new ne(this,t)},ne.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},ne.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Ft={kind:"null"},Pt={kind:"number"},te={kind:"string"},Kt={kind:"boolean"},Yt={kind:"color"},ze={kind:"object"},$t={kind:"value"},Je={kind:"collator"},Ze={kind:"formatted"},Be={kind:"resolvedImage"};function si(t,e){return{kind:"array",itemType:t,N:e}}function ti(t){if("array"===t.kind){var e=ti(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var br=[Ft,Pt,te,Kt,Yt,Ze,ze,si($t),Be];function di(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!di(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var i=0,s=br;i<s.length;i+=1)if(!di(s[i],e))return null}return"Expected "+ti(t)+" but found "+ti(e)+" instead."}function rn(t,e){return e.some(function(i){return i.kind===t.kind})}function vi(t,e){return e.some(function(i){return"null"===i?null===t:"array"===i?Array.isArray(t):"object"===i?t&&!Array.isArray(t)&&"object"==typeof t:i===typeof t})}var Ye=gi(function(t,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(v){return(v=Math.round(v))<0?0:v>255?255:v}function h(v){return s("%"===v[v.length-1]?parseFloat(v)/100*255:parseInt(v))}function p(v){return(T="%"===v[v.length-1]?parseFloat(v)/100:parseFloat(v))<0?0:T>1?1:T;var T}function f(v,T,E){return E<0?E+=1:E>1&&(E-=1),6*E<1?v+(T-v)*E*6:2*E<1?T:3*E<2?v+(T-v)*(2/3-E)*6:v}try{e.parseCSSColor=function(v){var T,E=v.replace(/ /g,"").toLowerCase();if(E in i)return i[E].slice();if("#"===E[0])return 4===E.length?(T=parseInt(E.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:7===E.length&&(T=parseInt(E.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var C=E.indexOf("("),k=E.indexOf(")");if(-1!==C&&k+1===E.length){var B=E.substr(0,C),U=E.substr(C+1,k-(C+1)).split(","),J=1;switch(B){case"rgba":if(4!==U.length)return null;J=p(U.pop());case"rgb":return 3!==U.length?null:[h(U[0]),h(U[1]),h(U[2]),J];case"hsla":if(4!==U.length)return null;J=p(U.pop());case"hsl":if(3!==U.length)return null;var Y=(parseFloat(U[0])%360+360)%360/360,at=p(U[1]),it=p(U[2]),pt=it<=.5?it*(at+1):it+at-it*at,gt=2*it-pt;return[s(255*f(gt,pt,Y+1/3)),s(255*f(gt,pt,Y)),s(255*f(gt,pt,Y-1/3)),J];default:return null}}return null}}catch{}}).parseCSSColor,fe=function(t,e,i,s){void 0===s&&(s=1),this.r=t,this.g=e,this.b=i,this.a=s};fe.parse=function(t){if(t){if(t instanceof fe)return t;if("string"==typeof t){var e=Ye(t);if(e)return new fe(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},fe.prototype.toString=function(){var t=this.toArray(),e=t[1],i=t[2],s=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(i)+","+s+")"},fe.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},fe.black=new fe(0,0,0,1),fe.white=new fe(1,1,1,1),fe.transparent=new fe(0,0,0,0),fe.red=new fe(1,0,0,1);var An=function(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};An.prototype.compare=function(t,e){return this.collator.compare(t,e)},An.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ya=function(t,e,i,s,h){this.text=t,this.image=e,this.scale=i,this.fontStack=s,this.textColor=h},Ai=function(t){this.sections=t};Ai.fromString=function(t){return new Ai([new ya(t,null,null,null,null)])},Ai.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},Ai.factory=function(t){return t instanceof Ai?t:Ai.fromString(t)},Ai.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},Ai.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var s=i[e];if(s.image)t.push(["image",s.image.name]);else{t.push(s.text);var h={};s.fontStack&&(h["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(h["font-scale"]=s.scale),s.textColor&&(h["text-color"]=["rgba"].concat(s.textColor.toArray())),t.push(h)}}return t};var nr=function(t){this.name=t.name,this.available=t.available};function Ea(t,e,i,s){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:"Invalid rgba value ["+[t,e,i,s].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof s?[t,e,i,s]:[t,e,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ga(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof fe||t instanceof An||t instanceof Ai||t instanceof nr)return!0;if(Array.isArray(t)){for(var e=0,i=t;e<i.length;e+=1)if(!ga(i[e]))return!1;return!0}if("object"==typeof t){for(var s in t)if(!ga(t[s]))return!1;return!0}return!1}function Zi(t){if(null===t)return Ft;if("string"==typeof t)return te;if("boolean"==typeof t)return Kt;if("number"==typeof t)return Pt;if(t instanceof fe)return Yt;if(t instanceof An)return Je;if(t instanceof Ai)return Ze;if(t instanceof nr)return Be;if(Array.isArray(t)){for(var e,i=t.length,s=0,h=t;s<h.length;s+=1){var p=Zi(h[s]);if(e){if(e===p)continue;e=$t;break}e=p}return si(e||$t,i)}return ze}function cr(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof fe||t instanceof Ai||t instanceof nr?t.toString():JSON.stringify(t)}nr.prototype.toString=function(){return this.name},nr.fromString=function(t){return t?new nr({name:t,available:!1}):null},nr.prototype.serialize=function(){return["image",this.name]};var In=function(t,e){this.type=t,this.value=e};In.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!ga(t[1]))return e.error("invalid value");var i=t[1],s=Zi(i),h=e.expectedType;return"array"!==s.kind||0!==s.N||!h||"array"!==h.kind||"number"==typeof h.N&&0!==h.N||(s=h),new In(s,i)},In.prototype.evaluate=function(){return this.value},In.prototype.eachChild=function(){},In.prototype.outputDefined=function(){return!0},In.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof fe?["rgba"].concat(this.value.toArray()):this.value instanceof Ai?this.value.serialize():this.value};var Cn=function(t){this.name="ExpressionEvaluationError",this.message=t};Cn.prototype.toJSON=function(){return this.message};var Fn={string:te,number:Pt,boolean:Kt,object:ze},Gi=function(t,e){this.type=t,this.args=e};Gi.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i,s=1,h=t[0];if("array"===h){var p,f;if(t.length>2){var v=t[1];if("string"!=typeof v||!(v in Fn)||"object"===v)return e.error('The item type argument of "array" must be one of string, number, boolean',1);p=Fn[v],s++}else p=$t;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);f=t[2],s++}i=si(p,f)}else i=Fn[h];for(var T=[];s<t.length;s++){var E=e.parse(t[s],s,$t);if(!E)return null;T.push(E)}return new Gi(i,T)},Gi.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var i=this.args[e].evaluate(t);if(!di(this.type,Zi(i)))return i;if(e===this.args.length-1)throw new Cn("Expected value to be of type "+ti(this.type)+", but found "+ti(Zi(i))+" instead.")}return null},Gi.prototype.eachChild=function(t){this.args.forEach(t)},Gi.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Gi.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var i=t.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){e.push(i.kind);var s=t.N;("number"==typeof s||this.args.length>1)&&e.push(s)}}return e.concat(this.args.map(function(h){return h.serialize()}))};var ro=function(t){this.type=Ze,this.sections=t};ro.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return e.error("First argument must be an image or text section.");for(var s=[],h=!1,p=1;p<=t.length-1;++p){var f=t[p];if(h&&"object"==typeof f&&!Array.isArray(f)){h=!1;var v=null;if(f["font-scale"]&&!(v=e.parse(f["font-scale"],1,Pt)))return null;var T=null;if(f["text-font"]&&!(T=e.parse(f["text-font"],1,si(te))))return null;var E=null;if(f["text-color"]&&!(E=e.parse(f["text-color"],1,Yt)))return null;var C=s[s.length-1];C.scale=v,C.font=T,C.textColor=E}else{var k=e.parse(t[p],1,$t);if(!k)return null;var B=k.type.kind;if("string"!==B&&"value"!==B&&"null"!==B&&"resolvedImage"!==B)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,s.push({content:k,scale:null,font:null,textColor:null})}}return new ro(s)},ro.prototype.evaluate=function(t){return new Ai(this.sections.map(function(e){var i=e.content.evaluate(t);return Zi(i)===Be?new ya("",i,null,null,null):new ya(cr(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))},ro.prototype.eachChild=function(t){for(var e=0,i=this.sections;e<i.length;e+=1){var s=i[e];t(s.content),s.scale&&t(s.scale),s.font&&t(s.font),s.textColor&&t(s.textColor)}},ro.prototype.outputDefined=function(){return!1},ro.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var s=i[e];t.push(s.content.serialize());var h={};s.scale&&(h["font-scale"]=s.scale.serialize()),s.font&&(h["text-font"]=s.font.serialize()),s.textColor&&(h["text-color"]=s.textColor.serialize()),t.push(h)}return t};var wr=function(t){this.type=Be,this.input=t};wr.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var i=e.parse(t[1],1,te);return i?new wr(i):e.error("No image name provided.")},wr.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=nr.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i},wr.prototype.eachChild=function(t){t(this.input)},wr.prototype.outputDefined=function(){return!1},wr.prototype.serialize=function(){return["image",this.input.serialize()]};var Pa={"to-boolean":Kt,"to-color":Yt,"to-number":Pt,"to-string":te},rr=function(t,e){this.type=t,this.args=e};rr.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[0];if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return e.error("Expected one argument.");for(var s=Pa[i],h=[],p=1;p<t.length;p++){var f=e.parse(t[p],p,$t);if(!f)return null;h.push(f)}return new rr(s,h)},rr.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,i,s=0,h=this.args;s<h.length;s+=1){if(i=null,(e=h[s].evaluate(t))instanceof fe)return e;if("string"==typeof e){var p=t.parseColor(e);if(p)return p}else if(Array.isArray(e)&&!(i=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":Ea(e[0],e[1],e[2],e[3])))return new fe(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Cn(i||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var f=null,v=0,T=this.args;v<T.length;v+=1){if(null===(f=T[v].evaluate(t)))return 0;var E=Number(f);if(!isNaN(E))return E}throw new Cn("Could not convert "+JSON.stringify(f)+" to number.")}return"formatted"===this.type.kind?Ai.fromString(cr(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?nr.fromString(cr(this.args[0].evaluate(t))):cr(this.args[0].evaluate(t))},rr.prototype.eachChild=function(t){this.args.forEach(t)},rr.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},rr.prototype.serialize=function(){if("formatted"===this.type.kind)return new ro([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new wr(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var Ga=["Unknown","Point","LineString","Polygon"],Ln=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ln.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ln.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Ga[this.feature.type]:this.feature.type:null},Ln.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ln.prototype.canonicalID=function(){return this.canonical},Ln.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ln.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=fe.parse(t)),e};var Un=function(t,e,i,s){this.name=t,this.type=e,this._evaluate=i,this.args=s};Un.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Un.prototype.eachChild=function(t){this.args.forEach(t)},Un.prototype.outputDefined=function(){return!1},Un.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Un.parse=function(t,e){var i,s=t[0],h=Un.definitions[s];if(!h)return e.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0);for(var p=Array.isArray(h)?h[0]:h.type,f=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=f.filter(function(ve){var ae=ve[0];return!Array.isArray(ae)||ae.length===t.length-1}),T=null,E=0,C=v;E<C.length;E+=1){var k=C[E],B=k[0],U=k[1];T=new ao(e.registry,e.path,null,e.scope);for(var J=[],Y=!1,at=1;at<t.length;at++){var it=t[at],pt=Array.isArray(B)?B[at-1]:B.type,gt=T.parse(it,1+J.length,pt);if(!gt){Y=!0;break}J.push(gt)}if(!Y)if(Array.isArray(B)&&B.length!==J.length)T.error("Expected "+B.length+" arguments, but found "+J.length+" instead.");else{for(var xt=0;xt<J.length;xt++){var St=Array.isArray(B)?B[xt]:B.type,zt=J[xt];T.concat(xt+1).checkSubtype(St,zt.type)}if(0===T.errors.length)return new Un(s,p,U,J)}}if(1===v.length)(i=e.errors).push.apply(i,T.errors);else{for(var qt=(v.length?v:f).map(function(ve){var ae;return ae=ve[0],Array.isArray(ae)?"("+ae.map(ti).join(", ")+")":"("+ti(ae.type)+"...)"}).join(" | "),Qt=[],_e=1;_e<t.length;_e++){var oe=e.parse(t[_e],1+Qt.length);if(!oe)return null;Qt.push(ti(oe.type))}e.error("Expected arguments of type "+qt+", but found ("+Qt.join(", ")+") instead.")}return null},Un.register=function(t,e){for(var i in Un.definitions=e,e)t[i]=Un};var Jr=function(t,e,i){this.type=Je,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e};function pr(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function oa(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Aa(t,e){var i=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(i*h*8192),Math.round(s*h*8192)]}function aa(t,e,i){return e[1]>t[1]!=i[1]>t[1]&&t[0]<(i[0]-e[0])*(t[1]-e[1])/(i[1]-e[1])+e[0]}function Oo(t,e){for(var i,s,h,p,f,v,T,E=!1,C=0,k=e.length;C<k;C++)for(var B=e[C],U=0,J=B.length;U<J-1;U++){if((p=(i=t)[0]-(s=B[U])[0])*(T=i[1]-(h=B[U+1])[1])-(v=i[0]-h[0])*(f=i[1]-s[1])==0&&p*v<=0&&f*T<=0)return!1;aa(t,B[U],B[U+1])&&(E=!E)}return E}function as(t,e){for(var i=0;i<e.length;i++)if(Oo(t,e[i]))return!0;return!1}function Wa(t,e,i,s){var h=s[0]-i[0],p=s[1]-i[1],f=(t[0]-i[0])*p-h*(t[1]-i[1]),v=(e[0]-i[0])*p-h*(e[1]-i[1]);return f>0&&v<0||f<0&&v>0}function Ps(t,e,i){for(var s=0,h=i;s<h.length;s+=1)for(var p=h[s],f=0;f<p.length-1;++f)if((k=[(C=p[f+1])[0]-(E=p[f])[0],C[1]-E[1]])[0]*(B=[(T=e)[0]-(v=t)[0],T[1]-v[1]])[1]-k[1]*B[0]!=0&&Wa(v,T,E,C)&&Wa(E,C,v,T))return!0;var v,T,E,C,k,B;return!1}function Ia(t,e){for(var i=0;i<t.length;++i)if(!Oo(t[i],e))return!1;for(var s=0;s<t.length-1;++s)if(Ps(t[s],t[s+1],e))return!1;return!0}function Xn(t,e){for(var i=0;i<e.length;i++)if(Ia(t,e[i]))return!0;return!1}function dr(t,e,i){for(var s=[],h=0;h<t.length;h++){for(var p=[],f=0;f<t[h].length;f++){var v=Aa(t[h][f],i);pr(e,v),p.push(v)}s.push(p)}return s}function So(t,e,i){for(var s=[],h=0;h<t.length;h++){var p=dr(t[h],e,i);s.push(p)}return s}function oo(t,e,i,s){if(t[0]<i[0]||t[0]>i[2]){var h=.5*s,p=t[0]-i[0]>h?-s:i[0]-t[0]>h?s:0;0===p&&(p=t[0]-i[2]>h?-s:i[2]-t[0]>h?s:0),t[0]+=p}pr(e,t)}function Ca(t,e,i,s){for(var h=8192*Math.pow(2,s.z),p=[8192*s.x,8192*s.y],f=[],v=0,T=t;v<T.length;v+=1)for(var E=0,C=T[v];E<C.length;E+=1){var k=C[E],B=[k.x+p[0],k.y+p[1]];oo(B,e,i,h),f.push(B)}return f}function Ha(t,e,i,s){for(var h,p=8192*Math.pow(2,s.z),f=[8192*s.x,8192*s.y],v=[],T=0,E=t;T<E.length;T+=1){for(var C=[],k=0,B=E[T];k<B.length;k+=1){var U=B[k],J=[U.x+f[0],U.y+f[1]];pr(e,J),C.push(J)}v.push(C)}if(e[2]-e[0]<=p/2){(h=e)[0]=h[1]=1/0,h[2]=h[3]=-1/0;for(var Y=0,at=v;Y<at.length;Y+=1)for(var it=0,pt=at[Y];it<pt.length;it+=1)oo(pt[it],e,i,p)}return v}Jr.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");var s=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,Kt);if(!s)return null;var h=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,Kt);if(!h)return null;var p=null;return i.locale&&!(p=e.parse(i.locale,1,te))?null:new Jr(s,h,p)},Jr.prototype.evaluate=function(t){return new An(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Jr.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Jr.prototype.outputDefined=function(){return!1},Jr.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Dr=function(t,e){this.type=Kt,this.geojson=t,this.geometries=e};function Or(t){if(t instanceof Un&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Dr)return!1;var e=!0;return t.eachChild(function(i){e&&!Or(i)&&(e=!1)}),e}function Eo(t){if(t instanceof Un&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild(function(i){e&&!Eo(i)&&(e=!1)}),e}function Ho(t,e){if(t instanceof Un&&e.indexOf(t.name)>=0)return!1;var i=!0;return t.eachChild(function(s){i&&!Ho(s,e)&&(i=!1)}),i}Dr.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(ga(t[1])){var i=t[1];if("FeatureCollection"===i.type)for(var s=0;s<i.features.length;++s){var h=i.features[s].geometry.type;if("Polygon"===h||"MultiPolygon"===h)return new Dr(i,i.features[s].geometry)}else if("Feature"===i.type){var p=i.geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new Dr(i,i.geometry)}else if("Polygon"===i.type||"MultiPolygon"===i.type)return new Dr(i,i)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Dr.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(e,i){var s=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],p=e.canonicalID();if("Polygon"===i.type){var f=dr(i.coordinates,h,p),v=Ca(e.geometry(),s,h,p);if(!oa(s,h))return!1;for(var T=0,E=v;T<E.length;T+=1)if(!Oo(E[T],f))return!1}if("MultiPolygon"===i.type){var C=So(i.coordinates,h,p),k=Ca(e.geometry(),s,h,p);if(!oa(s,h))return!1;for(var B=0,U=k;B<U.length;B+=1)if(!as(U[B],C))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(e,i){var s=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],p=e.canonicalID();if("Polygon"===i.type){var f=dr(i.coordinates,h,p),v=Ha(e.geometry(),s,h,p);if(!oa(s,h))return!1;for(var T=0,E=v;T<E.length;T+=1)if(!Ia(E[T],f))return!1}if("MultiPolygon"===i.type){var C=So(i.coordinates,h,p),k=Ha(e.geometry(),s,h,p);if(!oa(s,h))return!1;for(var B=0,U=k;B<U.length;B+=1)if(!Xn(U[B],C))return!1}return!0}(t,this.geometries)}return!1},Dr.prototype.eachChild=function(){},Dr.prototype.outputDefined=function(){return!0},Dr.prototype.serialize=function(){return["within",this.geojson]};var Tr=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Tr.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var i=t[1];return e.scope.has(i)?new Tr(i,e.scope.get(i)):e.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Tr.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Tr.prototype.eachChild=function(){},Tr.prototype.outputDefined=function(){return!1},Tr.prototype.serialize=function(){return["var",this.name]};var ao=function(t,e,i,s,h){void 0===e&&(e=[]),void 0===s&&(s=new ne),void 0===h&&(h=[]),this.registry=t,this.path=e,this.key=e.map(function(p){return"["+p+"]"}).join(""),this.scope=s,this.errors=h,this.expectedType=i};function Sn(t,e){for(var i,s=t.length-1,h=0,p=s,f=0;h<=p;)if((i=t[f=Math.floor((h+p)/2)])<=e){if(f===s||e<t[f+1])return f;h=f+1}else{if(!(i>e))throw new Cn("Input is not a number.");p=f-1}return 0}ao.prototype.parse=function(t,e,i,s,h){return void 0===h&&(h={}),e?this.concat(e,i,s)._parse(t,h):this._parse(t,h)},ao.prototype._parse=function(t,e){function i(E,C,k){return"assert"===k?new Gi(C,[E]):"coerce"===k?new rr(C,[E]):E}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var s=t[0];if("string"!=typeof s)return this.error("Expression name must be a string, but found "+typeof s+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var h=this.registry[s];if(h){var p=h.parse(t,this);if(!p)return null;if(this.expectedType){var f=this.expectedType,v=p.type;if("string"!==f.kind&&"number"!==f.kind&&"boolean"!==f.kind&&"object"!==f.kind&&"array"!==f.kind||"value"!==v.kind)if("color"!==f.kind&&"formatted"!==f.kind&&"resolvedImage"!==f.kind||"value"!==v.kind&&"string"!==v.kind){if(this.checkSubtype(f,v))return null}else p=i(p,f,e.typeAnnotation||"coerce");else p=i(p,f,e.typeAnnotation||"assert")}if(!(p instanceof In)&&"resolvedImage"!==p.type.kind&&function E(C){if(C instanceof Tr)return E(C.boundExpression);if(C instanceof Un&&"error"===C.name||C instanceof Jr||C instanceof Dr)return!1;var k=C instanceof rr||C instanceof Gi,B=!0;return C.eachChild(function(U){B=k?B&&E(U):B&&U instanceof In}),!!B&&Or(C)&&Ho(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(p)){var T=new Ln;try{p=new In(p.type,p.evaluate(T))}catch(E){return this.error(E.message),null}}return p}return this.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},ao.prototype.concat=function(t,e,i){var s="number"==typeof t?this.path.concat(t):this.path,h=i?this.scope.concat(i):this.scope;return new ao(this.registry,s,e||null,h,this.errors)},ao.prototype.error=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var s=""+this.key+e.map(function(h){return"["+h+"]"}).join("");this.errors.push(new vt(s,t))},ao.prototype.checkSubtype=function(t,e){var i=di(t,e);return i&&this.error(i),i};var or=function(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var s=0,h=i;s<h.length;s+=1){var p=h[s],f=p[1];this.labels.push(p[0]),this.outputs.push(f)}};function cn(t,e,i){return t*(1-i)+e*i}or.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var i=e.parse(t[1],1,Pt);if(!i)return null;var s=[],h=null;e.expectedType&&"value"!==e.expectedType.kind&&(h=e.expectedType);for(var p=1;p<t.length;p+=2){var f=1===p?-1/0:t[p],v=t[p+1],T=p,E=p+1;if("number"!=typeof f)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(s.length&&s[s.length-1][0]>=f)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);var C=e.parse(v,E,h);if(!C)return null;h=h||C.type,s.push([f,C])}return new or(h,i,s)},or.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);var s=this.input.evaluate(t);if(s<=e[0])return i[0].evaluate(t);var h=e.length;return s>=e[h-1]?i[h-1].evaluate(t):i[Sn(e,s)].evaluate(t)},or.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},or.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},or.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Po=Object.freeze({__proto__:null,number:cn,color:function(t,e,i){return new fe(cn(t.r,e.r,i),cn(t.g,e.g,i),cn(t.b,e.b,i),cn(t.a,e.a,i))},array:function(t,e,i){return t.map(function(s,h){return cn(s,e[h],i)})}}),La=6/29*3*(6/29),Xa=Math.PI/180,Ka=180/Math.PI;function Xo(t){return t>.008856451679035631?Math.pow(t,1/3):t/La+4/29}function za(t){return t>6/29?t*t*t:La*(t-4/29)}function ss(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function va(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ka(t){var e=va(t.r),i=va(t.g),s=va(t.b),h=Xo((.4124564*e+.3575761*i+.1804375*s)/.95047),p=Xo((.2126729*e+.7151522*i+.072175*s)/1);return{l:116*p-16,a:500*(h-p),b:200*(p-Xo((.0193339*e+.119192*i+.9503041*s)/1.08883)),alpha:t.a}}function ls(t){var e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*za(e),i=.95047*za(i),s=1.08883*za(s),new fe(ss(3.2404542*i-1.5371385*e-.4985314*s),ss(-.969266*i+1.8760108*e+.041556*s),ss(.0556434*i-.2040259*e+1.0572252*s),t.alpha)}function Ns(t,e,i){var s=e-t;return t+i*(s>180||s<-180?s-360*Math.round(s/360):s)}var Yr={forward:ka,reverse:ls,interpolate:function(t,e,i){return{l:cn(t.l,e.l,i),a:cn(t.a,e.a,i),b:cn(t.b,e.b,i),alpha:cn(t.alpha,e.alpha,i)}}},Ko={forward:function(t){var e=ka(t),i=e.l,s=e.a,h=e.b,p=Math.atan2(h,s)*Ka;return{h:p<0?p+360:p,c:Math.sqrt(s*s+h*h),l:i,alpha:t.a}},reverse:function(t){var e=t.h*Xa,i=t.c;return ls({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:Ns(t.h,e.h,i),c:cn(t.c,e.c,i),l:cn(t.l,e.l,i),alpha:cn(t.alpha,e.alpha,i)}}},Ma=Object.freeze({__proto__:null,lab:Yr,hcl:Ko}),Nn=function(t,e,i,s,h){this.type=t,this.operator=e,this.interpolation=i,this.input=s,this.labels=[],this.outputs=[];for(var p=0,f=h;p<f.length;p+=1){var v=f[p],T=v[1];this.labels.push(v[0]),this.outputs.push(T)}};function sa(t,e,i,s){var h=s-i,p=t-i;return 0===h?0:1===e?p/h:(Math.pow(e,p)-1)/(Math.pow(e,h)-1)}Nn.interpolationFactor=function(t,e,i,s){var h=0;if("exponential"===t.name)h=sa(e,t.base,i,s);else if("linear"===t.name)h=sa(e,1,i,s);else if("cubic-bezier"===t.name){var p=t.controlPoints;h=new Mt(p[0],p[1],p[2],p[3]).solve(sa(e,1,i,s))}return h},Nn.parse=function(t,e){var i=t[0],s=t[1],h=t[2],p=t.slice(3);if(!Array.isArray(s)||0===s.length)return e.error("Expected an interpolation type expression.",1);if("linear"===s[0])s={name:"linear"};else if("exponential"===s[0]){var f=s[1];if("number"!=typeof f)return e.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:f}}else{if("cubic-bezier"!==s[0])return e.error("Unknown interpolation type "+String(s[0]),1,0);var v=s.slice(1);if(4!==v.length||v.some(function(at){return"number"!=typeof at||at<0||at>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:v}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(h=e.parse(h,2,Pt)))return null;var T=[],E=null;"interpolate-hcl"===i||"interpolate-lab"===i?E=Yt:e.expectedType&&"value"!==e.expectedType.kind&&(E=e.expectedType);for(var C=0;C<p.length;C+=2){var k=p[C],B=p[C+1],U=C+3,J=C+4;if("number"!=typeof k)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(T.length&&T[T.length-1][0]>=k)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);var Y=e.parse(B,J,E);if(!Y)return null;E=E||Y.type,T.push([k,Y])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new Nn(E,i,s,h,T):e.error("Type "+ti(E)+" is not interpolatable.")},Nn.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);var s=this.input.evaluate(t);if(s<=e[0])return i[0].evaluate(t);var h=e.length;if(s>=e[h-1])return i[h-1].evaluate(t);var p=Sn(e,s),f=Nn.interpolationFactor(this.interpolation,s,e[p],e[p+1]),v=i[p].evaluate(t),T=i[p+1].evaluate(t);return"interpolate"===this.operator?Po[this.type.kind.toLowerCase()](v,T,f):"interpolate-hcl"===this.operator?Ko.reverse(Ko.interpolate(Ko.forward(v),Ko.forward(T),f)):Yr.reverse(Yr.interpolate(Yr.forward(v),Yr.forward(T),f))},Nn.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},Nn.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Nn.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],i=0;i<this.labels.length;i++)e.push(this.labels[i],this.outputs[i].serialize());return e};var $r=function(t,e){this.type=t,this.args=e};$r.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var i=null,s=e.expectedType;s&&"value"!==s.kind&&(i=s);for(var h=[],p=0,f=t.slice(1);p<f.length;p+=1){var v=e.parse(f[p],1+h.length,i,void 0,{typeAnnotation:"omit"});if(!v)return null;i=i||v.type,h.push(v)}var T=s&&h.some(function(E){return di(s,E.type)});return new $r(T?$t:i,h)},$r.prototype.evaluate=function(t){for(var e,i=null,s=0,h=0,p=this.args;h<p.length&&(s++,(i=p[h].evaluate(t))&&i instanceof nr&&!i.available&&(e||(e=i.name),i=null,s===this.args.length&&(i=e)),null===i);h+=1);return i},$r.prototype.eachChild=function(t){this.args.forEach(t)},$r.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},$r.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Ao=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Ao.prototype.evaluate=function(t){return this.result.evaluate(t)},Ao.prototype.eachChild=function(t){for(var e=0,i=this.bindings;e<i.length;e+=1)t(i[e][1]);t(this.result)},Ao.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var i=[],s=1;s<t.length-1;s+=2){var h=t[s];if("string"!=typeof h)return e.error("Expected string, but found "+typeof h+" instead.",s);if(/[^a-zA-Z0-9_]/.test(h))return e.error("Variable names must contain only alphanumeric characters or '_'.",s);var p=e.parse(t[s+1],s+1);if(!p)return null;i.push([h,p])}var f=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return f?new Ao(i,f):null},Ao.prototype.outputDefined=function(){return this.result.outputDefined()},Ao.prototype.serialize=function(){for(var t=["let"],e=0,i=this.bindings;e<i.length;e+=1){var s=i[e];t.push(s[0],s[1].serialize())}return t.push(this.result.serialize()),t};var la=function(t,e,i){this.type=t,this.index=e,this.input=i};la.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Pt),s=e.parse(t[2],2,si(e.expectedType||$t));return i&&s?new la(s.type.itemType,i,s):null},la.prototype.evaluate=function(t){var e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new Cn("Array index out of bounds: "+e+" < 0.");if(e>=i.length)throw new Cn("Array index out of bounds: "+e+" > "+(i.length-1)+".");if(e!==Math.floor(e))throw new Cn("Array index must be an integer, but found "+e+" instead.");return i[e]},la.prototype.eachChild=function(t){t(this.index),t(this.input)},la.prototype.outputDefined=function(){return!1},la.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Br=function(t,e){this.type=Kt,this.needle=t,this.haystack=e};Br.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,$t),s=e.parse(t[2],2,$t);return i&&s?rn(i.type,[Kt,te,Pt,Ft,$t])?new Br(i,s):e.error("Expected first argument to be of type boolean, string, number or null, but found "+ti(i.type)+" instead"):null},Br.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!vi(e,["boolean","string","number","null"]))throw new Cn("Expected first argument to be of type boolean, string, number or null, but found "+ti(Zi(e))+" instead.");if(!vi(i,["string","array"]))throw new Cn("Expected second argument to be of type array or string, but found "+ti(Zi(i))+" instead.");return i.indexOf(e)>=0},Br.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},Br.prototype.outputDefined=function(){return!0},Br.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Rr=function(t,e,i){this.type=Pt,this.needle=t,this.haystack=e,this.fromIndex=i};Rr.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,$t),s=e.parse(t[2],2,$t);if(!i||!s)return null;if(!rn(i.type,[Kt,te,Pt,Ft,$t]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+ti(i.type)+" instead");if(4===t.length){var h=e.parse(t[3],3,Pt);return h?new Rr(i,s,h):null}return new Rr(i,s)},Rr.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!vi(e,["boolean","string","number","null"]))throw new Cn("Expected first argument to be of type boolean, string, number or null, but found "+ti(Zi(e))+" instead.");if(!vi(i,["string","array"]))throw new Cn("Expected second argument to be of type array or string, but found "+ti(Zi(i))+" instead.");if(this.fromIndex){var s=this.fromIndex.evaluate(t);return i.indexOf(e,s)}return i.indexOf(e)},Rr.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},Rr.prototype.outputDefined=function(){return!1},Rr.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Jo=function(t,e,i,s,h,p){this.inputType=t,this.type=e,this.input=i,this.cases=s,this.outputs=h,this.otherwise=p};Jo.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var i,s;e.expectedType&&"value"!==e.expectedType.kind&&(s=e.expectedType);for(var h={},p=[],f=2;f<t.length-1;f+=2){var v=t[f],T=t[f+1];Array.isArray(v)||(v=[v]);var E=e.concat(f);if(0===v.length)return E.error("Expected at least one branch label.");for(var C=0,k=v;C<k.length;C+=1){var B=k[C];if("number"!=typeof B&&"string"!=typeof B)return E.error("Branch labels must be numbers or strings.");if("number"==typeof B&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return E.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof B&&Math.floor(B)!==B)return E.error("Numeric branch labels must be integer values.");if(i){if(E.checkSubtype(i,Zi(B)))return null}else i=Zi(B);if(void 0!==h[String(B)])return E.error("Branch labels must be unique.");h[String(B)]=p.length}var U=e.parse(T,f,s);if(!U)return null;s=s||U.type,p.push(U)}var J=e.parse(t[1],1,$t);if(!J)return null;var Y=e.parse(t[t.length-1],t.length-1,s);return Y?"value"!==J.type.kind&&e.concat(1).checkSubtype(i,J.type)?null:new Jo(i,s,J,h,p,Y):null},Jo.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(Zi(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Jo.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Jo.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},Jo.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],i=[],s={},h=0,p=Object.keys(this.cases).sort();h<p.length;h+=1){var f=p[h];void 0===(k=s[this.cases[f]])?(s[this.cases[f]]=i.length,i.push([this.cases[f],[f]])):i[k][1].push(f)}for(var v=function(U){return"number"===t.inputType.kind?Number(U):U},T=0,E=i;T<E.length;T+=1){var C=E[T],k=C[0],B=C[1];e.push(1===B.length?v(B[0]):B.map(v)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var yo=function(t,e,i){this.type=t,this.branches=e,this.otherwise=i};yo.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var s=[],h=1;h<t.length-1;h+=2){var p=e.parse(t[h],h,Kt);if(!p)return null;var f=e.parse(t[h+1],h+1,i);if(!f)return null;s.push([p,f]),i=i||f.type}var v=e.parse(t[t.length-1],t.length-1,i);return v?new yo(i,s,v):null},yo.prototype.evaluate=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var s=i[e],h=s[1];if(s[0].evaluate(t))return h.evaluate(t)}return this.otherwise.evaluate(t)},yo.prototype.eachChild=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var s=i[e],h=s[1];t(s[0]),t(h)}t(this.otherwise)},yo.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},yo.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var so=function(t,e,i,s){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=s};function Da(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function xa(t,e,i,s){return 0===s.compare(e,i)}function Ii(t,e,i){var s="=="!==t&&"!="!==t;return function(){function h(p,f,v){this.type=Kt,this.lhs=p,this.rhs=f,this.collator=v,this.hasUntypedArgument="value"===p.type.kind||"value"===f.type.kind}return h.parse=function(p,f){if(3!==p.length&&4!==p.length)return f.error("Expected two or three arguments.");var v=p[0],T=f.parse(p[1],1,$t);if(!T)return null;if(!Da(v,T.type))return f.concat(1).error('"'+v+"\" comparisons are not supported for type '"+ti(T.type)+"'.");var E=f.parse(p[2],2,$t);if(!E)return null;if(!Da(v,E.type))return f.concat(2).error('"'+v+"\" comparisons are not supported for type '"+ti(E.type)+"'.");if(T.type.kind!==E.type.kind&&"value"!==T.type.kind&&"value"!==E.type.kind)return f.error("Cannot compare types '"+ti(T.type)+"' and '"+ti(E.type)+"'.");s&&("value"===T.type.kind&&"value"!==E.type.kind?T=new Gi(E.type,[T]):"value"!==T.type.kind&&"value"===E.type.kind&&(E=new Gi(T.type,[E])));var C=null;if(4===p.length){if("string"!==T.type.kind&&"string"!==E.type.kind&&"value"!==T.type.kind&&"value"!==E.type.kind)return f.error("Cannot use collator to compare non-string types.");if(!(C=f.parse(p[3],3,Je)))return null}return new h(T,E,C)},h.prototype.evaluate=function(p){var f=this.lhs.evaluate(p),v=this.rhs.evaluate(p);if(s&&this.hasUntypedArgument){var T=Zi(f),E=Zi(v);if(T.kind!==E.kind||"string"!==T.kind&&"number"!==T.kind)throw new Cn('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+T.kind+", "+E.kind+") instead.")}if(this.collator&&!s&&this.hasUntypedArgument){var C=Zi(f),k=Zi(v);if("string"!==C.kind||"string"!==k.kind)return e(p,f,v)}return this.collator?i(p,f,v,this.collator.evaluate(p)):e(p,f,v)},h.prototype.eachChild=function(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)},h.prototype.outputDefined=function(){return!0},h.prototype.serialize=function(){var p=[t];return this.eachChild(function(f){p.push(f.serialize())}),p},h}()}so.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,$t),s=e.parse(t[2],2,Pt);if(!i||!s)return null;if(!rn(i.type,[si($t),te,$t]))return e.error("Expected first argument to be of type array or string, but found "+ti(i.type)+" instead");if(4===t.length){var h=e.parse(t[3],3,Pt);return h?new so(i.type,i,s,h):null}return new so(i.type,i,s)},so.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!vi(e,["string","array"]))throw new Cn("Expected first argument to be of type array or string, but found "+ti(Zi(e))+" instead.");if(this.endIndex){var s=this.endIndex.evaluate(t);return e.slice(i,s)}return e.slice(i)},so.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var js=Ii("==",function(t,e,i){return e===i},xa),go=Ii("!=",function(t,e,i){return e!==i},function(t,e,i,s){return!xa(0,e,i,s)}),lo=Ii("<",function(t,e,i){return e<i},function(t,e,i,s){return s.compare(e,i)<0}),Yo=Ii(">",function(t,e,i){return e>i},function(t,e,i,s){return s.compare(e,i)>0}),Ja=Ii("<=",function(t,e,i){return e<=i},function(t,e,i,s){return s.compare(e,i)<=0}),Ya=Ii(">=",function(t,e,i){return e>=i},function(t,e,i,s){return s.compare(e,i)>=0}),Io=function(t,e,i,s,h){this.type=te,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=s,this.maxFractionDigits=h};Io.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var i=e.parse(t[1],1,Pt);if(!i)return null;var s=t[2];if("object"!=typeof s||Array.isArray(s))return e.error("NumberFormat options argument must be an object.");var h=null;if(s.locale&&!(h=e.parse(s.locale,1,te)))return null;var p=null;if(s.currency&&!(p=e.parse(s.currency,1,te)))return null;var f=null;if(s["min-fraction-digits"]&&!(f=e.parse(s["min-fraction-digits"],1,Pt)))return null;var v=null;return s["max-fraction-digits"]&&!(v=e.parse(s["max-fraction-digits"],1,Pt))?null:new Io(i,h,p,f,v)},Io.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Io.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Io.prototype.outputDefined=function(){return!1},Io.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var uo=function(t){this.type=Pt,this.input=t};uo.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?e.error("Expected argument of type string or array, but found "+ti(i.type)+" instead."):new uo(i):null},uo.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e||Array.isArray(e))return e.length;throw new Cn("Expected value to be of type string or array, but found "+ti(Zi(e))+" instead.")},uo.prototype.eachChild=function(t){t(this.input)},uo.prototype.outputDefined=function(){return!1},uo.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var ba={"==":js,"!=":go,">":Yo,"<":lo,">=":Ya,"<=":Ja,array:Gi,at:la,boolean:Gi,case:yo,coalesce:$r,collator:Jr,format:ro,image:wr,in:Br,"index-of":Rr,interpolate:Nn,"interpolate-hcl":Nn,"interpolate-lab":Nn,length:uo,let:Ao,literal:In,match:Jo,number:Gi,"number-format":Io,object:Gi,slice:so,step:or,string:Gi,"to-boolean":rr,"to-color":rr,"to-number":rr,"to-string":rr,var:Tr,within:Dr};function r(t,e){var i=e[0],s=e[1],h=e[2],p=e[3];i=i.evaluate(t),s=s.evaluate(t),h=h.evaluate(t);var f=p?p.evaluate(t):1,v=Ea(i,s,h,f);if(v)throw new Cn(v);return new fe(i/255*f,s/255*f,h/255*f,f)}function u(t,e){return t in e}function m(t,e){var i=e[t];return void 0===i?null:i}function b(t){return{type:t}}function A(t){return{result:"success",value:t}}function V(t){return{result:"error",value:t}}function ct(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function ut(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Dt(t){return!!t.expression&&t.expression.interpolated}function jt(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function ye(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function li(t){return t}function Ui(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function _n(t,e,i,s,h){return Ui(typeof i===h?s[i]:void 0,t.default,e.default)}function Bo(t,e,i){if("number"!==jt(i))return Ui(t.default,e.default);var s=t.stops.length;if(1===s||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[s-1][0])return t.stops[s-1][1];var h=Sn(t.stops.map(function(p){return p[0]}),i);return t.stops[h][1]}function Sr(t,e,i){var s=void 0!==t.base?t.base:1;if("number"!==jt(i))return Ui(t.default,e.default);var h=t.stops.length;if(1===h||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[h-1][0])return t.stops[h-1][1];var B,U,Y,at,p=Sn(t.stops.map(function(k){return k[0]}),i),f=(B=s,at=i-(U=t.stops[p][0]),0==(Y=t.stops[p+1][0]-U)?0:1===B?at/Y:(Math.pow(B,at)-1)/(Math.pow(B,Y)-1)),v=t.stops[p][1],T=t.stops[p+1][1],E=Po[e.type]||li;if(t.colorSpace&&"rgb"!==t.colorSpace){var C=Ma[t.colorSpace];E=function(k,B){return C.reverse(C.interpolate(C.forward(k),C.forward(B),f))}}return"function"==typeof v.evaluate?{evaluate:function(){for(var k=[],B=arguments.length;B--;)k[B]=arguments[B];var U=v.evaluate.apply(void 0,k),J=T.evaluate.apply(void 0,k);if(void 0!==U&&void 0!==J)return E(U,J,f)}}:E(v,T,f)}function Kn(t,e,i){return"color"===e.type?i=fe.parse(i):"formatted"===e.type?i=Ai.fromString(i.toString()):"resolvedImage"===e.type?i=nr.fromString(i.toString()):jt(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),Ui(i,t.default,e.default)}Un.register(ba,{error:[{kind:"error"},[te],function(t,e){throw new Cn(e[0].evaluate(t))}],typeof:[te,[$t],function(t,e){return ti(Zi(e[0].evaluate(t)))}],"to-rgba":[si(Pt,4),[Yt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Yt,[Pt,Pt,Pt],r],rgba:[Yt,[Pt,Pt,Pt,Pt],r],has:{type:Kt,overloads:[[[te],function(t,e){return u(e[0].evaluate(t),t.properties())}],[[te,ze],function(t,e){var i=e[1];return u(e[0].evaluate(t),i.evaluate(t))}]]},get:{type:$t,overloads:[[[te],function(t,e){return m(e[0].evaluate(t),t.properties())}],[[te,ze],function(t,e){var i=e[1];return m(e[0].evaluate(t),i.evaluate(t))}]]},"feature-state":[$t,[te],function(t,e){return m(e[0].evaluate(t),t.featureState||{})}],properties:[ze,[],function(t){return t.properties()}],"geometry-type":[te,[],function(t){return t.geometryType()}],id:[$t,[],function(t){return t.id()}],zoom:[Pt,[],function(t){return t.globals.zoom}],"heatmap-density":[Pt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Pt,[],function(t){return t.globals.lineProgress||0}],accumulated:[$t,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Pt,b(Pt),function(t,e){for(var i=0,s=0,h=e;s<h.length;s+=1)i+=h[s].evaluate(t);return i}],"*":[Pt,b(Pt),function(t,e){for(var i=1,s=0,h=e;s<h.length;s+=1)i*=h[s].evaluate(t);return i}],"-":{type:Pt,overloads:[[[Pt,Pt],function(t,e){var i=e[1];return e[0].evaluate(t)-i.evaluate(t)}],[[Pt],function(t,e){return-e[0].evaluate(t)}]]},"/":[Pt,[Pt,Pt],function(t,e){var i=e[1];return e[0].evaluate(t)/i.evaluate(t)}],"%":[Pt,[Pt,Pt],function(t,e){var i=e[1];return e[0].evaluate(t)%i.evaluate(t)}],ln2:[Pt,[],function(){return Math.LN2}],pi:[Pt,[],function(){return Math.PI}],e:[Pt,[],function(){return Math.E}],"^":[Pt,[Pt,Pt],function(t,e){var i=e[1];return Math.pow(e[0].evaluate(t),i.evaluate(t))}],sqrt:[Pt,[Pt],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[Pt,[Pt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[Pt,[Pt],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[Pt,[Pt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[Pt,[Pt],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[Pt,[Pt],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[Pt,[Pt],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[Pt,[Pt],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[Pt,[Pt],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[Pt,[Pt],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[Pt,b(Pt),function(t,e){return Math.min.apply(Math,e.map(function(i){return i.evaluate(t)}))}],max:[Pt,b(Pt),function(t,e){return Math.max.apply(Math,e.map(function(i){return i.evaluate(t)}))}],abs:[Pt,[Pt],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[Pt,[Pt],function(t,e){var i=e[0].evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[Pt,[Pt],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[Pt,[Pt],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Kt,[te,$t],function(t,e){var i=e[0],s=e[1];return t.properties()[i.value]===s.value}],"filter-id-==":[Kt,[$t],function(t,e){var i=e[0];return t.id()===i.value}],"filter-type-==":[Kt,[te],function(t,e){var i=e[0];return t.geometryType()===i.value}],"filter-<":[Kt,[te,$t],function(t,e){var i=e[0],s=e[1],h=t.properties()[i.value],p=s.value;return typeof h==typeof p&&h<p}],"filter-id-<":[Kt,[$t],function(t,e){var i=e[0],s=t.id(),h=i.value;return typeof s==typeof h&&s<h}],"filter->":[Kt,[te,$t],function(t,e){var i=e[0],s=e[1],h=t.properties()[i.value],p=s.value;return typeof h==typeof p&&h>p}],"filter-id->":[Kt,[$t],function(t,e){var i=e[0],s=t.id(),h=i.value;return typeof s==typeof h&&s>h}],"filter-<=":[Kt,[te,$t],function(t,e){var i=e[0],s=e[1],h=t.properties()[i.value],p=s.value;return typeof h==typeof p&&h<=p}],"filter-id-<=":[Kt,[$t],function(t,e){var i=e[0],s=t.id(),h=i.value;return typeof s==typeof h&&s<=h}],"filter->=":[Kt,[te,$t],function(t,e){var i=e[0],s=e[1],h=t.properties()[i.value],p=s.value;return typeof h==typeof p&&h>=p}],"filter-id->=":[Kt,[$t],function(t,e){var i=e[0],s=t.id(),h=i.value;return typeof s==typeof h&&s>=h}],"filter-has":[Kt,[$t],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Kt,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Kt,[si(te)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Kt,[si($t)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Kt,[te,si($t)],function(t,e){var i=e[0];return e[1].value.indexOf(t.properties()[i.value])>=0}],"filter-in-large":[Kt,[te,si($t)],function(t,e){var i=e[0],s=e[1];return function(h,p,f,v){for(;f<=v;){var T=f+v>>1;if(p[T]===h)return!0;p[T]>h?v=T-1:f=T+1}return!1}(t.properties()[i.value],s.value,0,s.value.length-1)}],all:{type:Kt,overloads:[[[Kt,Kt],function(t,e){var i=e[1];return e[0].evaluate(t)&&i.evaluate(t)}],[b(Kt),function(t,e){for(var i=0,s=e;i<s.length;i+=1)if(!s[i].evaluate(t))return!1;return!0}]]},any:{type:Kt,overloads:[[[Kt,Kt],function(t,e){var i=e[1];return e[0].evaluate(t)||i.evaluate(t)}],[b(Kt),function(t,e){for(var i=0,s=e;i<s.length;i+=1)if(s[i].evaluate(t))return!0;return!1}]]},"!":[Kt,[Kt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Kt,[te],function(t,e){var i=t.globals&&t.globals.isSupportedScript;return!i||i(e[0].evaluate(t))}],upcase:[te,[te],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[te,[te],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[te,b($t),function(t,e){return e.map(function(i){return cr(i.evaluate(t))}).join("")}],"resolved-locale":[te,[Je],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var wa=function(t,e){var i;this.expression=t,this._warningHistory={},this._evaluator=new Ln,this._defaultValue=e?"color"===(i=e).type&&ye(i.default)?new fe(0,0,0,0):"color"===i.type?fe.parse(i.default)||null:void 0===i.default?null:i.default:null,this._enumValues=e&&"enum"===e.type?e.values:null};function Ro(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in ba}function $a(t,e){var h,p,i=new ao(ba,[],e?(p={color:Yt,string:te,number:Pt,enum:te,boolean:Kt,formatted:Ze,resolvedImage:Be},"array"===(h=e).type?si(p[h.value]||$t,h.length):p[h.type]):void 0),s=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?A(new wa(s,e)):V(i.errors)}wa.prototype.evaluateWithoutErrorHandling=function(t,e,i,s,h,p){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=s,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=p,this.expression.evaluate(this._evaluator)},wa.prototype.evaluate=function(t,e,i,s,h,p){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=s,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=p||null;try{var f=this.expression.evaluate(this._evaluator);if(null==f||"number"==typeof f&&f!=f)return this._defaultValue;if(this._enumValues&&!(f in this._enumValues))throw new Cn("Expected value to be one of "+Object.keys(this._enumValues).map(function(v){return JSON.stringify(v)}).join(", ")+", but found "+JSON.stringify(f)+" instead.");return f}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}};var on=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Eo(e.expression)};on.prototype.evaluateWithoutErrorHandling=function(t,e,i,s,h,p){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,s,h,p)},on.prototype.evaluate=function(t,e,i,s,h,p){return this._styleExpression.evaluate(t,e,i,s,h,p)};var $o=function(t,e,i,s){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Eo(e.expression),this.interpolationType=s};function Ta(t,e){if("error"===(t=$a(t,e)).result)return t;var i=t.value.expression,s=Or(i);if(!s&&!ct(e))return V([new vt("","data expressions not supported")]);var h=Ho(i,["zoom"]);if(!h&&!ut(e))return V([new vt("","zoom expressions not supported")]);var p=function f(v){var T=null;if(v instanceof Ao)T=f(v.result);else if(v instanceof $r)for(var E=0,C=v.args;E<C.length&&!(T=f(C[E]));E+=1);else(v instanceof or||v instanceof Nn)&&v.input instanceof Un&&"zoom"===v.input.name&&(T=v);return T instanceof vt||v.eachChild(function(k){var B=f(k);B instanceof vt?T=B:!T&&B?T=new vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):T&&B&&T!==B&&(T=new vt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),T}(i);return p||h?p instanceof vt?V([p]):p instanceof Nn&&!Dt(e)?V([new vt("",'"interpolate" expressions cannot be used with this property')]):A(p?new $o(s?"camera":"composite",t.value,p.labels,p instanceof Nn?p.interpolation:void 0):new on(s?"constant":"source",t.value)):V([new vt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}$o.prototype.evaluateWithoutErrorHandling=function(t,e,i,s,h,p){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,s,h,p)},$o.prototype.evaluate=function(t,e,i,s,h,p){return this._styleExpression.evaluate(t,e,i,s,h,p)},$o.prototype.interpolationFactor=function(t,e,i){return this.interpolationType?Nn.interpolationFactor(this.interpolationType,t,e,i):0};var us=function(t,e){this._parameters=t,this._specification=e,kt(this,function i(s,h){var p,f,v,T="color"===h.type,E=s.stops&&"object"==typeof s.stops[0][0],C=E||!(E||void 0!==s.property),k=s.type||(Dt(h)?"exponential":"interval");if(T&&((s=kt({},s)).stops&&(s.stops=s.stops.map(function(oe){return[oe[0],fe.parse(oe[1])]})),s.default=fe.parse(s.default?s.default:h.default)),s.colorSpace&&"rgb"!==s.colorSpace&&!Ma[s.colorSpace])throw new Error("Unknown color space: "+s.colorSpace);if("exponential"===k)p=Sr;else if("interval"===k)p=Bo;else if("categorical"===k){p=_n,f=Object.create(null);for(var B=0,U=s.stops;B<U.length;B+=1){var J=U[B];f[J[0]]=J[1]}v=typeof s.stops[0][0]}else{if("identity"!==k)throw new Error('Unknown function type "'+k+'"');p=Kn}if(E){for(var Y={},at=[],it=0;it<s.stops.length;it++){var pt=s.stops[it],gt=pt[0].zoom;void 0===Y[gt]&&(Y[gt]={zoom:gt,type:s.type,property:s.property,default:s.default,stops:[]},at.push(gt)),Y[gt].stops.push([pt[0].value,pt[1]])}for(var xt=[],St=0,zt=at;St<zt.length;St+=1){var qt=zt[St];xt.push([Y[qt].zoom,i(Y[qt],h)])}var Qt={name:"linear"};return{kind:"composite",interpolationType:Qt,interpolationFactor:Nn.interpolationFactor.bind(void 0,Qt),zoomStops:xt.map(function(oe){return oe[0]}),evaluate:function(oe,ve){var ae=oe.zoom;return Sr({stops:xt,base:s.base},h,ae).evaluate(ae,ve)}}}if(C){var _e="exponential"===k?{name:"exponential",base:void 0!==s.base?s.base:1}:null;return{kind:"camera",interpolationType:_e,interpolationFactor:Nn.interpolationFactor.bind(void 0,_e),zoomStops:s.stops.map(function(oe){return oe[0]}),evaluate:function(oe){return p(s,h,oe.zoom,f,v)}}}return{kind:"source",evaluate:function(oe,ve){var ae=ve&&ve.properties?ve.properties[s.property]:void 0;return void 0===ae?Ui(s.default,h.default):p(s,h,ae,f,v)}}}(this._parameters,this._specification))};function Fo(t){var e=t.key,i=t.value,s=t.valueSpec||{},h=t.objectElementValidators||{},p=t.style,f=t.styleSpec,v=[],T=jt(i);if("object"!==T)return[new et(e,i,"object expected, "+T+" found")];for(var E in i){var C=E.split(".")[0],k=s[C]||s["*"],B=void 0;if(h[C])B=h[C];else if(s[C])B=Gt;else if(h["*"])B=h["*"];else{if(!s["*"]){v.push(new et(e,i[E],'unknown property "'+E+'"'));continue}B=Gt}v=v.concat(B({key:(e&&e+".")+E,value:i[E],valueSpec:k,style:p,styleSpec:f,object:i,objectKey:E},i))}for(var U in s)h[U]||s[U].required&&void 0===s[U].default&&void 0===i[U]&&v.push(new et(e,i,'missing required property "'+U+'"'));return v}function _l(t){var e=t.value,i=t.valueSpec,s=t.style,h=t.styleSpec,p=t.key,f=t.arrayElementValidator||Gt;if("array"!==jt(e))return[new et(p,e,"array expected, "+jt(e)+" found")];if(i.length&&e.length!==i.length)return[new et(p,e,"array length "+i.length+" expected, length "+e.length+" found")];if(i["min-length"]&&e.length<i["min-length"])return[new et(p,e,"array length at least "+i["min-length"]+" expected, length "+e.length+" found")];var v={type:i.value,values:i.values};h.$version<7&&(v.function=i.function),"object"===jt(i.value)&&(v=i.value);for(var T=[],E=0;E<e.length;E++)T=T.concat(f({array:e,arrayIndex:E,value:e[E],valueSpec:v,style:s,styleSpec:h,key:p+"["+E+"]"}));return T}function Qs(t){var e=t.key,i=t.value,s=t.valueSpec,h=jt(i);return"number"===h&&i!=i&&(h="NaN"),"number"!==h?[new et(e,i,"number expected, "+h+" found")]:"minimum"in s&&i<s.minimum?[new et(e,i,i+" is less than the minimum value "+s.minimum)]:"maximum"in s&&i>s.maximum?[new et(e,i,i+" is greater than the maximum value "+s.maximum)]:[]}function As(t){var e,i,s,h=t.valueSpec,p=Rt(t.value.type),f={},v="categorical"!==p&&void 0===t.value.property,T=!v,E="array"===jt(t.value.stops)&&"array"===jt(t.value.stops[0])&&"object"===jt(t.value.stops[0][0]),C=Fo({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(U){if("identity"===p)return[new et(U.key,U.value,'identity function may not have a "stops" property')];var J=[],Y=U.value;return J=J.concat(_l({key:U.key,value:Y,valueSpec:U.valueSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:k})),"array"===jt(Y)&&0===Y.length&&J.push(new et(U.key,Y,"array must have at least one stop")),J},default:function(U){return Gt({key:U.key,value:U.value,valueSpec:h,style:U.style,styleSpec:U.styleSpec})}}});return"identity"===p&&v&&C.push(new et(t.key,t.value,'missing required property "property"')),"identity"===p||t.value.stops||C.push(new et(t.key,t.value,'missing required property "stops"')),"exponential"===p&&t.valueSpec.expression&&!Dt(t.valueSpec)&&C.push(new et(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(T&&!ct(t.valueSpec)?C.push(new et(t.key,t.value,"property functions not supported")):v&&!ut(t.valueSpec)&&C.push(new et(t.key,t.value,"zoom functions not supported"))),"categorical"!==p&&!E||void 0!==t.value.property||C.push(new et(t.key,t.value,'"property" property is required')),C;function k(U){var J=[],Y=U.value,at=U.key;if("array"!==jt(Y))return[new et(at,Y,"array expected, "+jt(Y)+" found")];if(2!==Y.length)return[new et(at,Y,"array length 2 expected, length "+Y.length+" found")];if(E){if("object"!==jt(Y[0]))return[new et(at,Y,"object expected, "+jt(Y[0])+" found")];if(void 0===Y[0].zoom)return[new et(at,Y,"object stop key must have zoom")];if(void 0===Y[0].value)return[new et(at,Y,"object stop key must have value")];if(s&&s>Rt(Y[0].zoom))return[new et(at,Y[0].zoom,"stop zoom values must appear in ascending order")];Rt(Y[0].zoom)!==s&&(s=Rt(Y[0].zoom),i=void 0,f={}),J=J.concat(Fo({key:at+"[0]",value:Y[0],valueSpec:{zoom:{}},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:Qs,value:B}}))}else J=J.concat(B({key:at+"[0]",value:Y[0],valueSpec:{},style:U.style,styleSpec:U.styleSpec},Y));return Ro(bt(Y[1]))?J.concat([new et(at+"[1]",Y[1],"expressions are not allowed in function stops.")]):J.concat(Gt({key:at+"[1]",value:Y[1],valueSpec:h,style:U.style,styleSpec:U.styleSpec}))}function B(U,J){var Y=jt(U.value),at=Rt(U.value),it=null!==U.value?U.value:J;if(e){if(Y!==e)return[new et(U.key,it,Y+" stop domain type must match previous stop domain type "+e)]}else e=Y;if("number"!==Y&&"string"!==Y&&"boolean"!==Y)return[new et(U.key,it,"stop domain value must be a number, string, or boolean")];if("number"!==Y&&"categorical"!==p){var pt="number expected, "+Y+" found";return ct(h)&&void 0===p&&(pt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new et(U.key,it,pt)]}return"categorical"!==p||"number"!==Y||isFinite(at)&&Math.floor(at)===at?"categorical"!==p&&"number"===Y&&void 0!==i&&at<i?[new et(U.key,it,"stop domain values must appear in ascending order")]:(i=at,"categorical"===p&&at in f?[new et(U.key,it,"stop domain values must be unique")]:(f[at]=!0,[])):[new et(U.key,it,"integer expected, found "+at)]}}function Oa(t){var e=("property"===t.expressionContext?Ta:$a)(bt(t.value),t.valueSpec);if("error"===e.result)return e.value.map(function(s){return new et(""+t.key+s.key,t.value,s.message)});var i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new et(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Eo(i))return[new et(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Eo(i))return[new et(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Ho(i,["zoom","feature-state"]))return[new et(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Or(i))return[new et(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Qa(t){var e=t.key,i=t.value,s=t.valueSpec,h=[];return Array.isArray(s.values)?-1===s.values.indexOf(Rt(i))&&h.push(new et(e,i,"expected one of ["+s.values.join(", ")+"], "+JSON.stringify(i)+" found")):-1===Object.keys(s.values).indexOf(Rt(i))&&h.push(new et(e,i,"expected one of ["+Object.keys(s.values).join(", ")+"], "+JSON.stringify(i)+" found")),h}function Is(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,i=t.slice(1);e<i.length;e+=1){var s=i[e];if(!Is(s)&&"boolean"!=typeof s)return!1}return!0;default:return!0}}us.deserialize=function(t){return new us(t._parameters,t._specification)},us.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Cs={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ua(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};Is(t)||(t=ts(t));var e=$a(t,Cs);if("error"===e.result)throw new Error(e.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,s,h){return e.value.evaluate(i,s,{},h)},needGeometry:function i(s){if(!Array.isArray(s))return!1;if("within"===s[0])return!0;for(var h=1;h<s.length;h++)if(i(s[h]))return!0;return!1}(t)}}function yl(t,e){return t<e?-1:t>e?1:0}function ts(t){if(!t)return!0;var e,i=t[0];return t.length<=1?"any"!==i:"=="===i?hs(t[1],t[2],"=="):"!="===i?Ba(hs(t[1],t[2],"==")):"<"===i||">"===i||"<="===i||">="===i?hs(t[1],t[2],i):"any"===i?(e=t.slice(1),["any"].concat(e.map(ts))):"all"===i?["all"].concat(t.slice(1).map(ts)):"none"===i?["all"].concat(t.slice(1).map(ts).map(Ba)):"in"===i?gl(t[1],t.slice(2)):"!in"===i?Ba(gl(t[1],t.slice(2))):"has"===i?vl(t[1]):"!has"===i?Ba(vl(t[1])):"within"!==i||t}function hs(t,e,i){switch(t){case"$type":return["filter-type-"+i,e];case"$id":return["filter-id-"+i,e];default:return["filter-"+i,t,e]}}function gl(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(i){return typeof i!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(yl)]]:["filter-in-small",t,["literal",e]]}}function vl(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Ba(t){return["!",t]}function R(t){return Is(bt(t.value))?Oa(kt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(i){var s=i.value,h=i.key;if("array"!==jt(s))return[new et(h,s,"array expected, "+jt(s)+" found")];var p,f=i.styleSpec,v=[];if(s.length<1)return[new et(h,s,"filter array must have at least 1 element")];switch(v=v.concat(Qa({key:h+"[0]",value:s[0],valueSpec:f.filter_operator,style:i.style,styleSpec:i.styleSpec})),Rt(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===Rt(s[1])&&v.push(new et(h,s,'"$type" cannot be use with operator "'+s[0]+'"'));case"==":case"!=":3!==s.length&&v.push(new et(h,s,'filter array for operator "'+s[0]+'" must have 3 elements'));case"in":case"!in":s.length>=2&&"string"!==(p=jt(s[1]))&&v.push(new et(h+"[1]",s[1],"string expected, "+p+" found"));for(var T=2;T<s.length;T++)p=jt(s[T]),"$type"===Rt(s[1])?v=v.concat(Qa({key:h+"["+T+"]",value:s[T],valueSpec:f.geometry_type,style:i.style,styleSpec:i.styleSpec})):"string"!==p&&"number"!==p&&"boolean"!==p&&v.push(new et(h+"["+T+"]",s[T],"string, number, or boolean expected, "+p+" found"));break;case"any":case"all":case"none":for(var E=1;E<s.length;E++)v=v.concat(e({key:h+"["+E+"]",value:s[E],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":p=jt(s[1]),2!==s.length?v.push(new et(h,s,'filter array for "'+s[0]+'" operator must have 2 elements')):"string"!==p&&v.push(new et(h+"[1]",s[1],"string expected, "+p+" found"));break;case"within":p=jt(s[1]),2!==s.length?v.push(new et(h,s,'filter array for "'+s[0]+'" operator must have 2 elements')):"object"!==p&&v.push(new et(h+"[1]",s[1],"object expected, "+p+" found"))}return v}(t)}function y(t,e){var i=t.key,s=t.style,h=t.styleSpec,p=t.value,f=t.objectKey,v=h[e+"_"+t.layerType];if(!v)return[];var T=f.match(/^(.*)-transition$/);if("paint"===e&&T&&v[T[1]]&&v[T[1]].transition)return Gt({key:i,value:p,valueSpec:h.transition,style:s,styleSpec:h});var E,C=t.valueSpec||v[f];if(!C)return[new et(i,p,'unknown property "'+f+'"')];if("string"===jt(p)&&ct(C)&&!C.tokens&&(E=/^{([^}]+)}$/.exec(p)))return[new et(i,p,'"'+f+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(E[1])+" }`.")];var k=[];return"symbol"===t.layerType&&("text-field"===f&&s&&!s.glyphs&&k.push(new et(i,p,'use of "text-field" requires a style "glyphs" property')),"text-font"===f&&ye(bt(p))&&"identity"===Rt(p.type)&&k.push(new et(i,p,'"text-font" does not support identity functions'))),k.concat(Gt({key:t.key,value:p,valueSpec:C,style:s,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:f}))}function P(t){return y(t,"paint")}function H(t){return y(t,"layout")}function mt(t){var e=[],i=t.value,s=t.key,h=t.style,p=t.styleSpec;i.type||i.ref||e.push(new et(s,i,'either "type" or "ref" is required'));var f,v=Rt(i.type),T=Rt(i.ref);if(i.id)for(var E=Rt(i.id),C=0;C<t.arrayIndex;C++){var k=h.layers[C];Rt(k.id)===E&&e.push(new et(s,i.id,'duplicate layer id "'+i.id+'", previously used at line '+k.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(J){J in i&&e.push(new et(s,i[J],'"'+J+'" is prohibited for ref layers'))}),h.layers.forEach(function(J){Rt(J.id)===T&&(f=J)}),f?f.ref?e.push(new et(s,i.ref,"ref cannot reference another ref layer")):v=Rt(f.type):e.push(new et(s,i.ref,'ref layer "'+T+'" not found'));else if("background"!==v)if(i.source){var B=h.sources&&h.sources[i.source],U=B&&Rt(B.type);B?"vector"===U&&"raster"===v?e.push(new et(s,i.source,'layer "'+i.id+'" requires a raster source')):"raster"===U&&"raster"!==v?e.push(new et(s,i.source,'layer "'+i.id+'" requires a vector source')):"vector"!==U||i["source-layer"]?"raster-dem"===U&&"hillshade"!==v?e.push(new et(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==v||!i.paint||!i.paint["line-gradient"]||"geojson"===U&&B.lineMetrics||e.push(new et(s,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new et(s,i,'layer "'+i.id+'" must specify a "source-layer"')):e.push(new et(s,i.source,'source "'+i.source+'" not found'))}else e.push(new et(s,i,'missing required property "source"'));return e=e.concat(Fo({key:s,value:i,valueSpec:p.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Gt({key:s+".type",value:i.type,valueSpec:p.layer.type,style:t.style,styleSpec:t.styleSpec,object:i,objectKey:"type"})},filter:R,layout:function(J){return Fo({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function(Y){return H(kt({layerType:v},Y))}}})},paint:function(J){return Fo({layer:i,key:J.key,value:J.value,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{"*":function(Y){return P(kt({layerType:v},Y))}}})}}}))}function _t(t){var e=t.value,i=t.key,s=jt(e);return"string"!==s?[new et(i,e,"string expected, "+s+" found")]:[]}var wt={promoteId:function(t){var e=t.key,i=t.value;if("string"===jt(i))return _t({key:e,value:i});var s=[];for(var h in i)s.push.apply(s,_t({key:e+"."+h,value:i[h]}));return s}};function Ut(t){var e=t.value,i=t.key,s=t.styleSpec,h=t.style;if(!e.type)return[new et(i,e,'"type" is required')];var p,f=Rt(e.type);switch(f){case"vector":case"raster":case"raster-dem":return Fo({key:i,value:e,valueSpec:s["source_"+f.replace("-","_")],style:t.style,styleSpec:s,objectElementValidators:wt});case"geojson":if(p=Fo({key:i,value:e,valueSpec:s.source_geojson,style:h,styleSpec:s,objectElementValidators:wt}),e.cluster)for(var v in e.clusterProperties){var T=e.clusterProperties[v],E=T[0],C="string"==typeof E?[E,["accumulated"],["get",v]]:E;p.push.apply(p,Oa({key:i+"."+v+".map",value:T[1],expressionContext:"cluster-map"})),p.push.apply(p,Oa({key:i+"."+v+".reduce",value:C,expressionContext:"cluster-reduce"}))}return p;case"video":return Fo({key:i,value:e,valueSpec:s.source_video,style:h,styleSpec:s});case"image":return Fo({key:i,value:e,valueSpec:s.source_image,style:h,styleSpec:s});case"canvas":return[new et(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Qa({key:i+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:s})}}function ie(t){var e=t.value,i=t.styleSpec,s=i.light,h=t.style,p=[],f=jt(e);if(void 0===e)return p;if("object"!==f)return p.concat([new et("light",e,"object expected, "+f+" found")]);for(var v in e){var T=v.match(/^(.*)-transition$/);p=p.concat(T&&s[T[1]]&&s[T[1]].transition?Gt({key:v,value:e[v],valueSpec:i.transition,style:h,styleSpec:i}):s[v]?Gt({key:v,value:e[v],valueSpec:s[v],style:h,styleSpec:i}):[new et(v,e[v],'unknown property "'+v+'"')])}return p}var de={"*":function(){return[]},array:_l,boolean:function(t){var e=t.value,i=t.key,s=jt(e);return"boolean"!==s?[new et(i,e,"boolean expected, "+s+" found")]:[]},number:Qs,color:function(t){var e=t.key,i=t.value,s=jt(i);return"string"!==s?[new et(e,i,"color expected, "+s+" found")]:null===Ye(i)?[new et(e,i,'color expected, "'+i+'" found')]:[]},constants:ft,enum:Qa,filter:R,function:As,layer:mt,object:Fo,source:Ut,light:ie,string:_t,formatted:function(t){return 0===_t(t).length?[]:Oa(t)},resolvedImage:function(t){return 0===_t(t).length?[]:Oa(t)}};function Gt(t){var e=t.value,i=t.valueSpec,s=t.styleSpec;return i.expression&&ye(Rt(e))?As(t):i.expression&&Ro(bt(e))?Oa(t):i.type&&de[i.type]?de[i.type](t):Fo(kt({},t,{valueSpec:i.type?s[i.type]:i}))}function Ht(t){var e=t.value,i=t.key,s=_t(t);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new et(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new et(i,e,'"glyphs" url must include a "{range}" token'))),s}function Ne(t,e){void 0===e&&(e=j);var i=[];return i=i.concat(Gt({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Ht,"*":function(){return[]}}})),t.constants&&(i=i.concat(ft({key:"constants",value:t.constants,style:t,styleSpec:e}))),Re(i)}function Re(t){return[].concat(t).sort(function(e,i){return e.line-i.line})}function Ge(t){return function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];return Re(t.apply(this,e))}}Ne.source=Ge(Ut),Ne.light=Ge(ie),Ne.layer=Ge(mt),Ne.filter=Ge(R),Ne.paintProperty=Ge(P),Ne.layoutProperty=Ge(H);var Ve=Ne,ii=Ve.light,tn=Ve.paintProperty,Xi=Ve.layoutProperty;function ui(t,e){var i=!1;if(e&&e.length)for(var s=0,h=e;s<h.length;s+=1)t.fire(new nt(new Error(h[s].message))),i=!0;return i}var mi=Ee;function Ee(t,e,i){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var h=new Int32Array(this.arrayBuffer);t=h[0],this.d=(e=h[1])+2*(i=h[2]);for(var p=0;p<this.d*this.d;p++){var f=h[3+p],v=h[3+p+1];s.push(f===v?null:h.subarray(f,v))}var T=h[3+s.length+1];this.keys=h.subarray(h[3+s.length],T),this.bboxes=h.subarray(T),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var E=0;E<this.d*this.d;E++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var C=i/e*t;this.min=-C,this.max=t+C}Ee.prototype.insert=function(t,e,i,s,h){this._forEachCell(e,i,s,h,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(h)},Ee.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ee.prototype._insertCell=function(t,e,i,s,h,p){this.cells[h].push(p)},Ee.prototype.query=function(t,e,i,s,h){var p=this.min,f=this.max;if(t<=p&&e<=p&&f<=i&&f<=s&&!h)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(t,e,i,s,this._queryCell,v,{},h),v},Ee.prototype._queryCell=function(t,e,i,s,h,p,f,v){var T=this.cells[h];if(null!==T)for(var E=this.keys,C=this.bboxes,k=0;k<T.length;k++){var B=T[k];if(void 0===f[B]){var U=4*B;(v?v(C[U+0],C[U+1],C[U+2],C[U+3]):t<=C[U+2]&&e<=C[U+3]&&i>=C[U+0]&&s>=C[U+1])?(f[B]=!0,p.push(E[B])):f[B]=!1}}},Ee.prototype._forEachCell=function(t,e,i,s,h,p,f,v){for(var T=this._convertToCellCoord(t),E=this._convertToCellCoord(e),C=this._convertToCellCoord(i),k=this._convertToCellCoord(s),B=T;B<=C;B++)for(var U=E;U<=k;U++){var J=this.d*U+B;if((!v||v(this._convertFromCellCoord(B),this._convertFromCellCoord(U),this._convertFromCellCoord(B+1),this._convertFromCellCoord(U+1)))&&h.call(this,t,e,i,s,J,p,f,v))return}},Ee.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Ee.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Ee.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,i=0,s=0;s<this.cells.length;s++)i+=this.cells[s].length;var h=new Int32Array(e+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var p=e,f=0;f<t.length;f++){var v=t[f];h[3+f]=p,h.set(v,p),p+=v.length}return h[3+t.length]=p,h.set(this.keys,p),h[3+t.length+1]=p+=this.keys.length,h.set(this.bboxes,p),p+=this.bboxes.length,h.buffer};var _i=Nt.ImageData,Ki=Nt.ImageBitmap,We={};function Zt(t,e,i){void 0===i&&(i={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),We[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}for(var Ni in Zt("Object",Object),mi.serialize=function(t,e){var i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}},mi.deserialize=function(t){return new mi(t.buffer)},Zt("Grid",mi),Zt("Color",fe),Zt("Error",Error),Zt("ResolvedImage",nr),Zt("StylePropertyFunction",us),Zt("StyleExpression",wa,{omit:["_evaluator"]}),Zt("ZoomDependentExpression",$o),Zt("ZoomConstantExpression",on),Zt("CompoundExpression",Un,{omit:["_evaluate"]}),ba)ba[Ni]._classRegistryKey||Zt("Expression_"+Ni,ba[Ni]);function Qr(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function to(t){return Ki&&t instanceof Ki}function yn(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Qr(t)||to(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var i=t;return e&&e.push(i.buffer),i}if(t instanceof _i)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var s=[],h=0,p=t;h<p.length;h+=1)s.push(yn(p[h],e));return s}if("object"==typeof t){var f=t.constructor,v=f._classRegistryKey;if(!v)throw new Error("can't serialize object of unregistered class");var T=f.serialize?f.serialize(t,e):{};if(!f.serialize){for(var E in t)if(t.hasOwnProperty(E)&&!(We[v].omit.indexOf(E)>=0)){var C=t[E];T[E]=We[v].shallow.indexOf(E)>=0?C:yn(C,e)}t instanceof Error&&(T.message=t.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==v&&(T.$name=v),T}throw new Error("can't serialize object of type "+typeof t)}function gn(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Qr(t)||to(t)||ArrayBuffer.isView(t)||t instanceof _i)return t;if(Array.isArray(t))return t.map(gn);if("object"==typeof t){var e=t.$name||"Object",i=We[e].klass;if(!i)throw new Error("can't deserialize unregistered class "+e);if(i.deserialize)return i.deserialize(t);for(var s=Object.create(i.prototype),h=0,p=Object.keys(t);h<p.length;h+=1){var f=p[h];if("$name"!==f){var v=t[f];s[f]=We[e].shallow.indexOf(f)>=0?v:gn(v)}}return s}throw new Error("can't deserialize object of type "+typeof t)}var Fr=function(){this.first=!0};Fr.prototype.update=function(t,e){var i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))};var Vt={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Uo(t){for(var e=0,i=t;e<i.length;e+=1)if(Co(i[e].charCodeAt(0)))return!0;return!1}function Co(t){return!(746!==t&&747!==t&&(t<4352||!(Vt["Bopomofo Extended"](t)||Vt.Bopomofo(t)||Vt["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Vt["CJK Compatibility Ideographs"](t)||Vt["CJK Compatibility"](t)||Vt["CJK Radicals Supplement"](t)||Vt["CJK Strokes"](t)||!(!Vt["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Vt["CJK Unified Ideographs Extension A"](t)||Vt["CJK Unified Ideographs"](t)||Vt["Enclosed CJK Letters and Months"](t)||Vt["Hangul Compatibility Jamo"](t)||Vt["Hangul Jamo Extended-A"](t)||Vt["Hangul Jamo Extended-B"](t)||Vt["Hangul Jamo"](t)||Vt["Hangul Syllables"](t)||Vt.Hiragana(t)||Vt["Ideographic Description Characters"](t)||Vt.Kanbun(t)||Vt["Kangxi Radicals"](t)||Vt["Katakana Phonetic Extensions"](t)||Vt.Katakana(t)&&12540!==t||!(!Vt["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Vt["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Vt["Unified Canadian Aboriginal Syllabics"](t)||Vt["Unified Canadian Aboriginal Syllabics Extended"](t)||Vt["Vertical Forms"](t)||Vt["Yijing Hexagram Symbols"](t)||Vt["Yi Syllables"](t)||Vt["Yi Radicals"](t))))}function Ra(t){return!(Co(t)||(e=t,Vt["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Vt["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Vt["Letterlike Symbols"](e)||Vt["Number Forms"](e)||Vt["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||Vt["Control Pictures"](e)&&9251!==e||Vt["Optical Character Recognition"](e)||Vt["Enclosed Alphanumerics"](e)||Vt["Geometric Shapes"](e)||Vt["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Vt["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Vt["CJK Symbols and Punctuation"](e)||Vt.Katakana(e)||Vt["Private Use Area"](e)||Vt["CJK Compatibility Forms"](e)||Vt["Small Form Variants"](e)||Vt["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e}function Yi(t){return t>=1424&&t<=2303||Vt["Arabic Presentation Forms-A"](t)||Vt["Arabic Presentation Forms-B"](t)}function fi(t,e){return!(!e&&Yi(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Vt.Khmer(t))}function Er(t){for(var e=0,i=t;e<i.length;e+=1)if(Yi(i[e].charCodeAt(0)))return!0;return!1}var ho=null,Jn="unavailable",No=null,tl=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Jn="error"),ho&&ho(t)};function cs(){ps.fire(new X("pluginStateChange",{pluginStatus:Jn,pluginURL:No}))}var ps=new st,el=function(){return Jn},ha=function(){if("deferred"!==Jn||!No)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Jn="loading",cs(),No&&Ce({url:No},function(t){t?tl(t):(Jn="loaded",cs())})},co={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Jn||null!=co.applyArabicShaping},isLoading:function(){return"loading"===Jn},setState:function(t){Jn=t.pluginStatus,No=t.pluginURL},isParsed:function(){return null!=co.applyArabicShaping&&null!=co.processBidirectionalText&&null!=co.processStyledBidirectionalText},getPluginURL:function(){return No}},oi=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Fr,this.transition={})};oi.prototype.isSupportedScript=function(t){return function(e,i){for(var s=0,h=e;s<h.length;s+=1)if(!fi(h[s].charCodeAt(0),i))return!1;return!0}(t,co.isLoaded())},oi.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},oi.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}};var Qo=function(t,e){this.property=t,this.value=e,this.expression=function(i,s){if(ye(i))return new us(i,s);if(Ro(i)){var h=Ta(i,s);if("error"===h.result)throw new Error(h.value.map(function(f){return f.key+": "+f.message}).join(", "));return h.value}var p=i;return"string"==typeof i&&"color"===s.type&&(p=fe.parse(i)),{kind:"constant",evaluate:function(){return p}}}(void 0===e?t.specification.default:e,t.specification)};Qo.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Qo.prototype.possiblyEvaluate=function(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)};var ta=function(t){this.property=t,this.value=new Qo(t,void 0)};ta.prototype.transitioned=function(t,e){return new Fa(this.property,this.value,e,Ct({},t.transition,this.transition),t.now)},ta.prototype.untransitioned=function(){return new Fa(this.property,this.value,null,{},0)};var fr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};fr.prototype.getValue=function(t){return Gn(this._values[t].value.value)},fr.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new ta(this._values[t].property)),this._values[t].value=new Qo(this._values[t].property,null===e?void 0:Gn(e))},fr.prototype.getTransition=function(t){return Gn(this._values[t].transition)},fr.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new ta(this._values[t].property)),this._values[t].transition=Gn(e)||void 0},fr.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var s=i[e],h=this.getValue(s);void 0!==h&&(t[s]=h);var p=this.getTransition(s);void 0!==p&&(t[s+"-transition"]=p)}return t},fr.prototype.transitioned=function(t,e){for(var i=new Ua(this._properties),s=0,h=Object.keys(this._values);s<h.length;s+=1){var p=h[s];i._values[p]=this._values[p].transitioned(t,e._values[p])}return i},fr.prototype.untransitioned=function(){for(var t=new Ua(this._properties),e=0,i=Object.keys(this._values);e<i.length;e+=1){var s=i[e];t._values[s]=this._values[s].untransitioned()}return t};var Fa=function(t,e,i,s,h){this.property=t,this.value=e,this.begin=h+s.delay||0,this.end=this.begin+s.duration||0,t.specification.transition&&(s.delay||s.duration)&&(this.prior=i)};Fa.prototype.possiblyEvaluate=function(t,e,i){var s=t.now||0,h=this.value.possiblyEvaluate(t,e,i),p=this.prior;if(p){if(s>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(s<this.begin)return p.possiblyEvaluate(t,e,i);var f=(s-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(t,e,i),h,function(v){if(v<=0)return 0;if(v>=1)return 1;var T=v*v,E=T*v;return 4*(v<.5?E:3*(v-T)+E-.75)}(f))}return h};var Ua=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Ua.prototype.possiblyEvaluate=function(t,e,i){for(var s=new Na(this._properties),h=0,p=Object.keys(this._values);h<p.length;h+=1){var f=p[h];s._values[f]=this._values[f].possiblyEvaluate(t,e,i)}return s},Ua.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var ea=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};ea.prototype.getValue=function(t){return Gn(this._values[t].value)},ea.prototype.setValue=function(t,e){this._values[t]=new Qo(this._values[t].property,null===e?void 0:Gn(e))},ea.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var s=i[e],h=this.getValue(s);void 0!==h&&(t[s]=h)}return t},ea.prototype.possiblyEvaluate=function(t,e,i){for(var s=new Na(this._properties),h=0,p=Object.keys(this._values);h<p.length;h+=1){var f=p[h];s._values[f]=this._values[f].possiblyEvaluate(t,e,i)}return s};var jn=function(t,e,i){this.property=t,this.value=e,this.parameters=i};jn.prototype.isConstant=function(){return"constant"===this.value.kind},jn.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},jn.prototype.evaluate=function(t,e,i,s){return this.property.evaluate(this.value,this.parameters,t,e,i,s)};var Na=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Na.prototype.get=function(t){return this._values[t]};var me=function(t){this.specification=t};me.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},me.prototype.interpolate=function(t,e,i){var s=Po[this.specification.type];return s?s(t,e,i):t};var ce=function(t,e){this.specification=t,this.overrides=e};ce.prototype.possiblyEvaluate=function(t,e,i,s){return new jn(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},i,s)}:t.expression,e)},ce.prototype.interpolate=function(t,e,i){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new jn(this,{kind:"constant",value:void 0},t.parameters);var s=Po[this.specification.type];return s?new jn(this,{kind:"constant",value:s(t.value.value,e.value.value,i)},t.parameters):t},ce.prototype.evaluate=function(t,e,i,s,h,p){return"constant"===t.kind?t.value:t.evaluate(e,i,s,h,p)};var ds=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(i,s,h,p){if(void 0===i.value)return new jn(this,{kind:"constant",value:void 0},s);if("constant"===i.expression.kind){var f=i.expression.evaluate(s,null,{},h,p),v="resolvedImage"===i.property.specification.type&&"string"!=typeof f?f.name:f,T=this._calculate(v,v,v,s);return new jn(this,{kind:"constant",value:T},s)}if("camera"===i.expression.kind){var E=this._calculate(i.expression.evaluate({zoom:s.zoom-1}),i.expression.evaluate({zoom:s.zoom}),i.expression.evaluate({zoom:s.zoom+1}),s);return new jn(this,{kind:"constant",value:E},s)}return new jn(this,i.expression,s)},e.prototype.evaluate=function(i,s,h,p,f,v){if("source"===i.kind){var T=i.evaluate(s,h,p,f,v);return this._calculate(T,T,T,s)}return"composite"===i.kind?this._calculate(i.evaluate({zoom:Math.floor(s.zoom)-1},h,p),i.evaluate({zoom:Math.floor(s.zoom)},h,p),i.evaluate({zoom:Math.floor(s.zoom)+1},h,p),s):i.value},e.prototype._calculate=function(i,s,h,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:i,to:s}:{from:h,to:s}},e.prototype.interpolate=function(i){return i},e}(ce),Ur=function(t){this.specification=t};Ur.prototype.possiblyEvaluate=function(t,e,i,s){if(void 0!==t.value){if("constant"===t.expression.kind){var h=t.expression.evaluate(e,null,{},i,s);return this._calculate(h,h,h,e)}return this._calculate(t.expression.evaluate(new oi(Math.floor(e.zoom-1),e)),t.expression.evaluate(new oi(Math.floor(e.zoom),e)),t.expression.evaluate(new oi(Math.floor(e.zoom+1),e)),e)}},Ur.prototype._calculate=function(t,e,i,s){return s.zoom>s.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}},Ur.prototype.interpolate=function(t){return t};var jo=function(t){this.specification=t};jo.prototype.possiblyEvaluate=function(t,e,i,s){return!!t.expression.evaluate(e,null,{},i,s)},jo.prototype.interpolate=function(){return!1};var mr=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var i=t[e];i.specification.overridable&&this.overridableProperties.push(e);var s=this.defaultPropertyValues[e]=new Qo(i,void 0),h=this.defaultTransitionablePropertyValues[e]=new ta(i);this.defaultTransitioningPropertyValues[e]=h.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=s.possiblyEvaluate({})}};Zt("DataDrivenProperty",ce),Zt("DataConstantProperty",me),Zt("CrossFadedDataDrivenProperty",ds),Zt("CrossFadedProperty",Ur),Zt("ColorRampProperty",jo);var ia=function(t){function e(i,s){if(t.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==i.type&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),s.layout&&(this._unevaluatedLayout=new ea(s.layout)),s.paint)){for(var h in this._transitionablePaint=new fr(s.paint),i.paint)this.setPaintProperty(h,i.paint[h],{validate:!1});for(var p in i.layout)this.setLayoutProperty(p,i.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Na(s.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)},e.prototype.setLayoutProperty=function(i,s,h){void 0===h&&(h={}),null!=s&&this._validate(Xi,"layers."+this.id+".layout."+i,i,s,h)||("visibility"!==i?this._unevaluatedLayout.setValue(i,s):this.visibility=s)},e.prototype.getPaintProperty=function(i){return qi(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},e.prototype.setPaintProperty=function(i,s,h){if(void 0===h&&(h={}),null!=s&&this._validate(tn,"layers."+this.id+".paint."+i,i,s,h))return!1;if(qi(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),s||void 0),!1;var p=this._transitionablePaint._values[i],f="cross-faded-data-driven"===p.property.specification["property-type"],v=p.value.isDataDriven(),T=p.value;this._transitionablePaint.setValue(i,s),this._handleSpecialPaintPropertyUpdate(i);var E=this._transitionablePaint._values[i].value;return E.isDataDriven()||v||f||this._handleOverridablePaintPropertyUpdate(i,T,E)},e.prototype._handleSpecialPaintPropertyUpdate=function(i){},e.prototype._handleOverridablePaintPropertyUpdate=function(i,s,h){return!1},e.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(i,s){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,s)},e.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Mi(i,function(s,h){return!(void 0===s||"layout"===h&&!Object.keys(s).length||"paint"===h&&!Object.keys(s).length)})},e.prototype._validate=function(i,s,h,p,f){return void 0===f&&(f={}),(!f||!1!==f.validate)&&ui(this,i.call(Ve,{key:s,layerType:this.type,objectKey:h,value:p,styleSpec:j,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var i in this.paint._values){var s=this.paint.get(i);if(s instanceof jn&&ct(s.property.specification)&&("source"===s.value.kind||"composite"===s.value.kind)&&s.value.isStateDependent)return!0}return!1},e}(st),il={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Zs=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Si=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function ar(t,e){void 0===e&&(e=1);var i=0,s=0;return{members:t.map(function(h){var p=il[h.type].BYTES_PER_ELEMENT,f=i=Au(i,Math.max(e,p)),v=h.components||1;return s=Math.max(s,p),i+=p*v,{name:h.name,type:h.type,components:v,offset:f}}),size:Au(i,Math.max(s,e)),alignment:e}}function Au(t,e){return Math.ceil(t/e)*e}Si.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Si.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Si.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Si.prototype.clear=function(){this.length=0},Si.prototype.resize=function(t){this.reserve(t),this.length=t},Si.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Si.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ls=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s){var h=this.length;return this.resize(h+1),this.emplace(h,i,s)},e.prototype.emplace=function(i,s,h){var p=2*i;return this.int16[p+0]=s,this.int16[p+1]=h,i},e}(Si);Ls.prototype.bytesPerElement=4,Zt("StructArrayLayout2i4",Ls);var Yl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p){var f=this.length;return this.resize(f+1),this.emplace(f,i,s,h,p)},e.prototype.emplace=function(i,s,h,p,f){var v=4*i;return this.int16[v+0]=s,this.int16[v+1]=h,this.int16[v+2]=p,this.int16[v+3]=f,i},e}(Si);Yl.prototype.bytesPerElement=8,Zt("StructArrayLayout4i8",Yl);var es=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p,f,v){var T=this.length;return this.resize(T+1),this.emplace(T,i,s,h,p,f,v)},e.prototype.emplace=function(i,s,h,p,f,v,T){var E=6*i;return this.int16[E+0]=s,this.int16[E+1]=h,this.int16[E+2]=p,this.int16[E+3]=f,this.int16[E+4]=v,this.int16[E+5]=T,i},e}(Si);es.prototype.bytesPerElement=12,Zt("StructArrayLayout2i4i12",es);var Zo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p,f,v){var T=this.length;return this.resize(T+1),this.emplace(T,i,s,h,p,f,v)},e.prototype.emplace=function(i,s,h,p,f,v,T){var E=4*i,C=8*i;return this.int16[E+0]=s,this.int16[E+1]=h,this.uint8[C+4]=p,this.uint8[C+5]=f,this.uint8[C+6]=v,this.uint8[C+7]=T,i},e}(Si);Zo.prototype.bytesPerElement=8,Zt("StructArrayLayout2i4ub8",Zo);var Vs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s){var h=this.length;return this.resize(h+1),this.emplace(h,i,s)},e.prototype.emplace=function(i,s,h){var p=2*i;return this.float32[p+0]=s,this.float32[p+1]=h,i},e}(Si);Vs.prototype.bytesPerElement=8,Zt("StructArrayLayout2f8",Vs);var ja=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p,f,v,T,E,C,k){var B=this.length;return this.resize(B+1),this.emplace(B,i,s,h,p,f,v,T,E,C,k)},e.prototype.emplace=function(i,s,h,p,f,v,T,E,C,k,B){var U=10*i;return this.uint16[U+0]=s,this.uint16[U+1]=h,this.uint16[U+2]=p,this.uint16[U+3]=f,this.uint16[U+4]=v,this.uint16[U+5]=T,this.uint16[U+6]=E,this.uint16[U+7]=C,this.uint16[U+8]=k,this.uint16[U+9]=B,i},e}(Si);ja.prototype.bytesPerElement=20,Zt("StructArrayLayout10ui20",ja);var xl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p,f,v,T,E,C,k,B,U){var J=this.length;return this.resize(J+1),this.emplace(J,i,s,h,p,f,v,T,E,C,k,B,U)},e.prototype.emplace=function(i,s,h,p,f,v,T,E,C,k,B,U,J){var Y=12*i;return this.int16[Y+0]=s,this.int16[Y+1]=h,this.int16[Y+2]=p,this.int16[Y+3]=f,this.uint16[Y+4]=v,this.uint16[Y+5]=T,this.uint16[Y+6]=E,this.uint16[Y+7]=C,this.int16[Y+8]=k,this.int16[Y+9]=B,this.int16[Y+10]=U,this.int16[Y+11]=J,i},e}(Si);xl.prototype.bytesPerElement=24,Zt("StructArrayLayout4i4ui4i24",xl);var qs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,h)},e.prototype.emplace=function(i,s,h,p){var f=3*i;return this.float32[f+0]=s,this.float32[f+1]=h,this.float32[f+2]=p,i},e}(Si);qs.prototype.bytesPerElement=12,Zt("StructArrayLayout3f12",qs);var nl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var s=this.length;return this.resize(s+1),this.emplace(s,i)},e.prototype.emplace=function(i,s){return this.uint32[1*i+0]=s,i},e}(Si);nl.prototype.bytesPerElement=4,Zt("StructArrayLayout1ul4",nl);var $l=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p,f,v,T,E,C){var k=this.length;return this.resize(k+1),this.emplace(k,i,s,h,p,f,v,T,E,C)},e.prototype.emplace=function(i,s,h,p,f,v,T,E,C,k){var B=10*i,U=5*i;return this.int16[B+0]=s,this.int16[B+1]=h,this.int16[B+2]=p,this.int16[B+3]=f,this.int16[B+4]=v,this.int16[B+5]=T,this.uint32[U+3]=E,this.uint16[B+8]=C,this.uint16[B+9]=k,i},e}(Si);$l.prototype.bytesPerElement=20,Zt("StructArrayLayout6i1ul2ui20",$l);var Gs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p,f,v){var T=this.length;return this.resize(T+1),this.emplace(T,i,s,h,p,f,v)},e.prototype.emplace=function(i,s,h,p,f,v,T){var E=6*i;return this.int16[E+0]=s,this.int16[E+1]=h,this.int16[E+2]=p,this.int16[E+3]=f,this.int16[E+4]=v,this.int16[E+5]=T,i},e}(Si);Gs.prototype.bytesPerElement=12,Zt("StructArrayLayout2i2i2i12",Gs);var zs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p,f){var v=this.length;return this.resize(v+1),this.emplace(v,i,s,h,p,f)},e.prototype.emplace=function(i,s,h,p,f,v){var T=4*i,E=8*i;return this.float32[T+0]=s,this.float32[T+1]=h,this.float32[T+2]=p,this.int16[E+6]=f,this.int16[E+7]=v,i},e}(Si);zs.prototype.bytesPerElement=16,Zt("StructArrayLayout2f1f2i16",zs);var Ql=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p){var f=this.length;return this.resize(f+1),this.emplace(f,i,s,h,p)},e.prototype.emplace=function(i,s,h,p,f){var v=12*i,T=3*i;return this.uint8[v+0]=s,this.uint8[v+1]=h,this.float32[T+1]=p,this.float32[T+2]=f,i},e}(Si);Ql.prototype.bytesPerElement=12,Zt("StructArrayLayout2ub2f12",Ql);var fs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,h)},e.prototype.emplace=function(i,s,h,p){var f=3*i;return this.uint16[f+0]=s,this.uint16[f+1]=h,this.uint16[f+2]=p,i},e}(Si);fs.prototype.bytesPerElement=6,Zt("StructArrayLayout3ui6",fs);var ms=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p,f,v,T,E,C,k,B,U,J,Y,at,it,pt){var gt=this.length;return this.resize(gt+1),this.emplace(gt,i,s,h,p,f,v,T,E,C,k,B,U,J,Y,at,it,pt)},e.prototype.emplace=function(i,s,h,p,f,v,T,E,C,k,B,U,J,Y,at,it,pt,gt){var xt=24*i,St=12*i,zt=48*i;return this.int16[xt+0]=s,this.int16[xt+1]=h,this.uint16[xt+2]=p,this.uint16[xt+3]=f,this.uint32[St+2]=v,this.uint32[St+3]=T,this.uint32[St+4]=E,this.uint16[xt+10]=C,this.uint16[xt+11]=k,this.uint16[xt+12]=B,this.float32[St+7]=U,this.float32[St+8]=J,this.uint8[zt+36]=Y,this.uint8[zt+37]=at,this.uint8[zt+38]=it,this.uint32[St+10]=pt,this.int16[xt+22]=gt,i},e}(Si);ms.prototype.bytesPerElement=48,Zt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ms);var bl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p,f,v,T,E,C,k,B,U,J,Y,at,it,pt,gt,xt,St,zt,qt,Qt,_e,oe,ve,ae,Qe){var Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,i,s,h,p,f,v,T,E,C,k,B,U,J,Y,at,it,pt,gt,xt,St,zt,qt,Qt,_e,oe,ve,ae,Qe)},e.prototype.emplace=function(i,s,h,p,f,v,T,E,C,k,B,U,J,Y,at,it,pt,gt,xt,St,zt,qt,Qt,_e,oe,ve,ae,Qe,Ie){var pe=34*i,ai=17*i;return this.int16[pe+0]=s,this.int16[pe+1]=h,this.int16[pe+2]=p,this.int16[pe+3]=f,this.int16[pe+4]=v,this.int16[pe+5]=T,this.int16[pe+6]=E,this.int16[pe+7]=C,this.uint16[pe+8]=k,this.uint16[pe+9]=B,this.uint16[pe+10]=U,this.uint16[pe+11]=J,this.uint16[pe+12]=Y,this.uint16[pe+13]=at,this.uint16[pe+14]=it,this.uint16[pe+15]=pt,this.uint16[pe+16]=gt,this.uint16[pe+17]=xt,this.uint16[pe+18]=St,this.uint16[pe+19]=zt,this.uint16[pe+20]=qt,this.uint16[pe+21]=Qt,this.uint16[pe+22]=_e,this.uint32[ai+12]=oe,this.float32[ai+13]=ve,this.float32[ai+14]=ae,this.float32[ai+15]=Qe,this.float32[ai+16]=Ie,i},e}(Si);bl.prototype.bytesPerElement=68,Zt("StructArrayLayout8i15ui1ul4f68",bl);var _s=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var s=this.length;return this.resize(s+1),this.emplace(s,i)},e.prototype.emplace=function(i,s){return this.float32[1*i+0]=s,i},e}(Si);_s.prototype.bytesPerElement=4,Zt("StructArrayLayout1f4",_s);var ca=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,h)},e.prototype.emplace=function(i,s,h,p){var f=3*i;return this.int16[f+0]=s,this.int16[f+1]=h,this.int16[f+2]=p,i},e}(Si);ca.prototype.bytesPerElement=6,Zt("StructArrayLayout3i6",ca);var tu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,h)},e.prototype.emplace=function(i,s,h,p){var f=4*i;return this.uint32[2*i+0]=s,this.uint16[f+2]=h,this.uint16[f+3]=p,i},e}(Si);tu.prototype.bytesPerElement=8,Zt("StructArrayLayout1ul2ui8",tu);var rl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s){var h=this.length;return this.resize(h+1),this.emplace(h,i,s)},e.prototype.emplace=function(i,s,h){var p=2*i;return this.uint16[p+0]=s,this.uint16[p+1]=h,i},e}(Si);rl.prototype.bytesPerElement=4,Zt("StructArrayLayout2ui4",rl);var eu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var s=this.length;return this.resize(s+1),this.emplace(s,i)},e.prototype.emplace=function(i,s){return this.uint16[1*i+0]=s,i},e}(Si);eu.prototype.bytesPerElement=2,Zt("StructArrayLayout1ui2",eu);var wl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,h,p){var f=this.length;return this.resize(f+1),this.emplace(f,i,s,h,p)},e.prototype.emplace=function(i,s,h,p,f){var v=4*i;return this.float32[v+0]=s,this.float32[v+1]=h,this.float32[v+2]=p,this.float32[v+3]=f,i},e}(Si);wl.prototype.bytesPerElement=16,Zt("StructArrayLayout4f16",wl);var n=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new le(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,i),e}(Zs);n.prototype.size=20;var a=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new n(this,i)},e}($l);Zt("CollisionBoxArray",a);var o=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(s){this._structArray.uint8[this._pos1+37]=s},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(s){this._structArray.uint8[this._pos1+38]=s},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(s){this._structArray.uint32[this._pos4+10]=s},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,i),e}(Zs);o.prototype.size=48;var l=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new o(this,i)},e}(ms);Zt("PlacedSymbolArray",l);var d=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(s){this._structArray.uint32[this._pos4+12]=s},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,i),e}(Zs);d.prototype.size=68;var _=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new d(this,i)},e}(bl);Zt("SymbolInstanceArray",_);var g=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(i){return this.float32[1*i+0]},e}(_s);Zt("GlyphOffsetArray",g);var w=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(i){return this.int16[3*i+0]},e.prototype.gety=function(i){return this.int16[3*i+1]},e.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},e}(ca);Zt("SymbolLineVertexArray",w);var I=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,i),e}(Zs);I.prototype.size=8;var M=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new I(this,i)},e}(tu);Zt("FeatureIndexArray",M);var N=ar([{name:"a_pos",components:2,type:"Int16"}],4).members,Z=function(t){void 0===t&&(t=[]),this.segments=t};function q(t,e){return 256*(t=er(Math.floor(t),0,255))+er(Math.floor(e),0,255)}Z.prototype.prepareSegment=function(t,e,i,s){var h=this.segments[this.segments.length-1];return t>Z.MAX_VERTEX_ARRAY_LENGTH&&Ri("Max vertices per segment is "+Z.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!h||h.vertexLength+t>Z.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==s)&&(h={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==s&&(h.sortKey=s),this.segments.push(h)),h},Z.prototype.get=function(){return this.segments},Z.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var i=e[t];for(var s in i.vaos)i.vaos[s].destroy()}},Z.simpleSegment=function(t,e,i,s){return new Z([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:s,vaos:{},sortKey:0}])},Z.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Zt("SegmentVector",Z);var Q=ar([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),$=gi(function(t){t.exports=function(e,i){var s,h,p,f,v,T,E,C;for(h=e.length-(s=3&e.length),p=i,v=3432918353,T=461845907,C=0;C<h;)E=255&e.charCodeAt(C)|(255&e.charCodeAt(++C))<<8|(255&e.charCodeAt(++C))<<16|(255&e.charCodeAt(++C))<<24,++C,p=27492+(65535&(f=5*(65535&(p=(p^=E=(65535&(E=(E=(65535&E)*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*T+(((E>>>16)*T&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(E=0,s){case 3:E^=(255&e.charCodeAt(C+2))<<16;case 2:E^=(255&e.charCodeAt(C+1))<<8;case 1:p^=E=(65535&(E=(E=(65535&(E^=255&e.charCodeAt(C)))*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*T+(((E>>>16)*T&65535)<<16)&4294967295}return p^=e.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),ot=gi(function(t){t.exports=function(e,i){for(var s,h=e.length,p=i^h,f=0;h>=4;)s=1540483477*(65535&(s=255&e.charCodeAt(f)|(255&e.charCodeAt(++f))<<8|(255&e.charCodeAt(++f))<<16|(255&e.charCodeAt(++f))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),h-=4,++f;switch(h){case 3:p^=(255&e.charCodeAt(f+2))<<16;case 2:p^=(255&e.charCodeAt(f+1))<<8;case 1:p=1540483477*(65535&(p^=255&e.charCodeAt(f)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),K=$,rt=ot;K.murmur3=$,K.murmur2=rt;var lt=function(){this.ids=[],this.positions=[],this.indexed=!1};lt.prototype.add=function(t,e,i,s){this.ids.push(Et(t)),this.positions.push(e,i,s)},lt.prototype.getPositions=function(t){for(var e=Et(t),i=0,s=this.ids.length-1;i<s;){var h=i+s>>1;this.ids[h]>=e?s=h:i=h+1}for(var p=[];this.ids[i]===e;)p.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return p},lt.serialize=function(t,e){var i=new Float64Array(t.ids),s=new Uint32Array(t.positions);return function h(p,f,v,T){for(;v<T;){for(var E=p[v+T>>1],C=v-1,k=T+1;;){do{C++}while(p[C]<E);do{k--}while(p[k]>E);if(C>=k)break;Tt(p,C,k),Tt(f,3*C,3*k),Tt(f,3*C+1,3*k+1),Tt(f,3*C+2,3*k+2)}k-v<T-k?(h(p,f,v,k),v=k+1):(h(p,f,k+1,T),T=k)}}(i,s,0,i.length-1),e&&e.push(i.buffer,s.buffer),{ids:i,positions:s}},lt.deserialize=function(t){var e=new lt;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var yt=Math.pow(2,53)-1;function Et(t){var e=+t;return!isNaN(e)&&e<=yt?e:K(String(t))}function Tt(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}Zt("FeaturePositionMap",lt);var It=function(t,e){this.gl=t.gl,this.location=e},Ot=function(t){function e(i,s){t.call(this,i,s),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},e}(It),Xt=function(t){function e(i,s){t.call(this,i,s),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},e}(It),Wt=function(t){function e(i,s){t.call(this,i,s),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},e}(It),se=function(t){function e(i,s){t.call(this,i,s),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},e}(It),ge=function(t){function e(i,s){t.call(this,i,s),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},e}(It),we=function(t){function e(i,s){t.call(this,i,s),this.current=fe.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},e}(It),be=new Float32Array(16),xi=function(t){function e(i,s){t.call(this,i,s),this.current=be}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var s=1;s<16;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},e}(It);function he(t){return[q(255*t.r,255*t.g),q(255*t.b,255*t.a)]}var Fe=function(t,e,i){this.value=t,this.uniformNames=e.map(function(s){return"u_"+s}),this.type=i};Fe.prototype.setUniform=function(t,e,i){t.set(i.constantOr(this.value))},Fe.prototype.getBinding=function(t,e,i){return"color"===this.type?new we(t,e):new Xt(t,e)};var $e=function(t,e){this.uniformNames=e.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};$e.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},$e.prototype.setUniform=function(t,e,i,s){var h="u_pattern_to"===s?this.patternTo:"u_pattern_from"===s?this.patternFrom:"u_pixel_ratio_to"===s?this.pixelRatioTo:"u_pixel_ratio_from"===s?this.pixelRatioFrom:null;h&&t.set(h)},$e.prototype.getBinding=function(t,e,i){return"u_pattern"===i.substr(0,9)?new ge(t,e):new Xt(t,e)};var De=function(t,e,i,s){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map(function(h){return{name:"a_"+h,type:"Float32",components:"color"===i?2:1,offset:0}}),this.paintVertexArray=new s};De.prototype.populatePaintArray=function(t,e,i,s,h){var p=this.paintVertexArray.length,f=this.expression.evaluate(new oi(0),e,{},s,[],h);this.paintVertexArray.resize(t),this._setPaintValue(p,t,f)},De.prototype.updatePaintArray=function(t,e,i,s){var h=this.expression.evaluate({zoom:0},i,s);this._setPaintValue(t,e,h)},De.prototype._setPaintValue=function(t,e,i){if("color"===this.type)for(var s=he(i),h=t;h<e;h++)this.paintVertexArray.emplace(h,s[0],s[1]);else{for(var p=t;p<e;p++)this.paintVertexArray.emplace(p,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},De.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},De.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ke=function(t,e,i,s,h,p){this.expression=t,this.uniformNames=e.map(function(f){return"u_"+f+"_t"}),this.type=i,this.useIntegerZoom=s,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=e.map(function(f){return{name:"a_"+f,type:"Float32",components:"color"===i?4:2,offset:0}}),this.paintVertexArray=new p};ke.prototype.populatePaintArray=function(t,e,i,s,h){var p=this.expression.evaluate(new oi(this.zoom),e,{},s,[],h),f=this.expression.evaluate(new oi(this.zoom+1),e,{},s,[],h),v=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(v,t,p,f)},ke.prototype.updatePaintArray=function(t,e,i,s){var h=this.expression.evaluate({zoom:this.zoom},i,s),p=this.expression.evaluate({zoom:this.zoom+1},i,s);this._setPaintValue(t,e,h,p)},ke.prototype._setPaintValue=function(t,e,i,s){if("color"===this.type)for(var h=he(i),p=he(s),f=t;f<e;f++)this.paintVertexArray.emplace(f,h[0],h[1],p[0],p[1]);else{for(var v=t;v<e;v++)this.paintVertexArray.emplace(v,i,s);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(s))}},ke.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ke.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ke.prototype.setUniform=function(t,e){var i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,s=er(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(s)},ke.prototype.getBinding=function(t,e,i){return new Xt(t,e)};var Xe=function(t,e,i,s,h,p){this.expression=t,this.type=e,this.useIntegerZoom=i,this.zoom=s,this.layerId=p,this.zoomInPaintVertexArray=new h,this.zoomOutPaintVertexArray=new h};Xe.prototype.populatePaintArray=function(t,e,i){var s=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(s,t,e.patterns&&e.patterns[this.layerId],i)},Xe.prototype.updatePaintArray=function(t,e,i,s,h){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],h)},Xe.prototype._setPaintValues=function(t,e,i,s){if(s&&i){var h=s[i.min],p=s[i.mid],f=s[i.max];if(h&&p&&f)for(var v=t;v<e;v++)this.zoomInPaintVertexArray.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],p.pixelRatio,h.pixelRatio),this.zoomOutPaintVertexArray.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],p.pixelRatio,f.pixelRatio)}},Xe.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Q.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Q.members,this.expression.isStateDependent))},Xe.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Le=function(t,e,i){this.binders={},this._buffers=[];var s=[];for(var h in t.paint._values)if(i(h)){var p=t.paint.get(h);if(p instanceof jn&&ct(p.property.specification)){var f=Pr(h,t.type),v=p.value,T=p.property.specification.type,E=p.property.useIntegerZoom,C=p.property.specification["property-type"],k="cross-faded"===C||"cross-faded-data-driven"===C;if("constant"===v.kind)this.binders[h]=k?new $e(v.value,f):new Fe(v.value,f,T),s.push("/u_"+h);else if("source"===v.kind||k){var B=Zn(h,T,"source");this.binders[h]=k?new Xe(v,T,E,e,B,t.id):new De(v,f,T,B),s.push("/a_"+h)}else{var U=Zn(h,T,"composite");this.binders[h]=new ke(v,f,T,E,e,U),s.push("/z_"+h)}}}this.cacheKey=s.sort().join("")};Le.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof De||e instanceof ke?e.maxValue:0},Le.prototype.populatePaintArrays=function(t,e,i,s,h){for(var p in this.binders){var f=this.binders[p];(f instanceof De||f instanceof ke||f instanceof Xe)&&f.populatePaintArray(t,e,i,s,h)}},Le.prototype.setConstantPatternPositions=function(t,e){for(var i in this.binders){var s=this.binders[i];s instanceof $e&&s.setConstantPatternPositions(t,e)}},Le.prototype.updatePaintArrays=function(t,e,i,s,h){var p=!1;for(var f in t)for(var v=0,T=e.getPositions(f);v<T.length;v+=1){var E=T[v],C=i.feature(E.index);for(var k in this.binders){var B=this.binders[k];if((B instanceof De||B instanceof ke||B instanceof Xe)&&!0===B.expression.isStateDependent){var U=s.paint.get(k);B.expression=U.value,B.updatePaintArray(E.start,E.end,C,t[f],h),p=!0}}}return p},Le.prototype.defines=function(){var t=[];for(var e in this.binders){var i=this.binders[e];(i instanceof Fe||i instanceof $e)&&t.push.apply(t,i.uniformNames.map(function(s){return"#define HAS_UNIFORM_"+s}))}return t},Le.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof De||i instanceof ke)for(var s=0;s<i.paintVertexAttributes.length;s++)t.push(i.paintVertexAttributes[s].name);else if(i instanceof Xe)for(var h=0;h<Q.members.length;h++)t.push(Q.members[h].name)}return t},Le.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof Fe||i instanceof $e||i instanceof ke)for(var s=0,h=i.uniformNames;s<h.length;s+=1)t.push(h[s])}return t},Le.prototype.getPaintVertexBuffers=function(){return this._buffers},Le.prototype.getUniforms=function(t,e){var i=[];for(var s in this.binders){var h=this.binders[s];if(h instanceof Fe||h instanceof $e||h instanceof ke)for(var p=0,f=h.uniformNames;p<f.length;p+=1){var v=f[p];if(e[v]){var T=h.getBinding(t,e[v],v);i.push({name:v,property:s,binding:T})}}}return i},Le.prototype.setUniforms=function(t,e,i,s){for(var h=0,p=e;h<p.length;h+=1){var f=p[h],v=f.name,T=f.property;this.binders[T].setUniform(f.binding,s,i.get(T),v)}},Le.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var i=this.binders[e];if(t&&i instanceof Xe){var s=2===t.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;s&&this._buffers.push(s)}else(i instanceof De||i instanceof ke)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Le.prototype.upload=function(t){for(var e in this.binders){var i=this.binders[e];(i instanceof De||i instanceof ke||i instanceof Xe)&&i.upload(t)}this.updatePaintBuffers()},Le.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof De||e instanceof ke||e instanceof Xe)&&e.destroy()}};var Pe=function(t,e,i){void 0===i&&(i=function(){return!0}),this.programConfigurations={};for(var s=0,h=t;s<h.length;s+=1){var p=h[s];this.programConfigurations[p.id]=new Le(p,e,i)}this.needsUpload=!1,this._featureMap=new lt,this._bufferOffset=0};function Pr(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function Zn(t,e,i){var h={"line-pattern":{source:ja,composite:ja},"fill-pattern":{source:ja,composite:ja},"fill-extrusion-pattern":{source:ja,composite:ja}}[t];return h&&h[i]||{color:{source:Vs,composite:wl},number:{source:_s,composite:Vs}}[e][i]}Pe.prototype.populatePaintArrays=function(t,e,i,s,h,p){for(var f in this.programConfigurations)this.programConfigurations[f].populatePaintArrays(t,e,s,h,p);void 0!==e.id&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Pe.prototype.updatePaintArrays=function(t,e,i,s){for(var h=0,p=i;h<p.length;h+=1){var f=p[h];this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(t,this._featureMap,e,f,s)||this.needsUpload}},Pe.prototype.get=function(t){return this.programConfigurations[t]},Pe.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Pe.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Zt("ConstantBinder",Fe),Zt("CrossFadedConstantBinder",$e),Zt("SourceExpressionBinder",De),Zt("CrossFadedCompositeBinder",Xe),Zt("CompositeExpressionBinder",ke),Zt("ProgramConfiguration",Le,{omit:["_buffers"]}),Zt("ProgramConfigurationSet",Pe);var po=Math.pow(2,14)-1,Nr=-po-1;function zn(t){for(var e=8192/t.extent,i=t.loadGeometry(),s=0;s<i.length;s++)for(var h=i[s],p=0;p<h.length;p++){var f=h[p],v=Math.round(f.x*e),T=Math.round(f.y*e);f.x=er(v,Nr,po),f.y=er(T,Nr,po),(v<f.x||v>f.x+1||T<f.y||T>f.y+1)&&Ri("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function Yn(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?zn(t):[]}}function Vo(t,e,i,s,h){t.emplaceBack(2*e+(s+1)/2,2*i+(h+1)/2)}var vo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ls,this.indexArray=new fs,this.segments=new Z,this.programConfigurations=new Pe(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function ys(t,e){for(var i=0;i<t.length;i++)if(Za(e,t[i]))return!0;for(var s=0;s<e.length;s++)if(Za(t,e[s]))return!0;return!!ol(t,e)}function Lo(t,e,i){return!!Za(t,e)||!!gs(e,t,i)}function Sa(t,e){if(1===t.length)return al(e,t[0]);for(var i=0;i<e.length;i++)for(var s=e[i],h=0;h<s.length;h++)if(Za(t,s[h]))return!0;for(var p=0;p<t.length;p++)if(al(e,t[p]))return!0;for(var f=0;f<e.length;f++)if(ol(t,e[f]))return!0;return!1}function pa(t,e,i){if(t.length>1){if(ol(t,e))return!0;for(var s=0;s<e.length;s++)if(gs(e[s],t,i))return!0}for(var h=0;h<t.length;h++)if(gs(t[h],e,i))return!0;return!1}function ol(t,e){if(0===t.length||0===e.length)return!1;for(var i=0;i<t.length-1;i++)for(var s=t[i],h=t[i+1],p=0;p<e.length-1;p++)if(Ws(s,h,e[p],e[p+1]))return!0;return!1}function Ws(t,e,i,s){return un(t,i,s)!==un(e,i,s)&&un(t,e,i)!==un(t,e,s)}function gs(t,e,i){var s=i*i;if(1===e.length)return t.distSqr(e[0])<s;for(var h=1;h<e.length;h++)if(Hs(t,e[h-1],e[h])<s)return!0;return!1}function Hs(t,e,i){var s=e.distSqr(i);if(0===s)return t.distSqr(e);var h=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/s;return t.distSqr(h<0?e:h>1?i:i.sub(e)._mult(h)._add(e))}function al(t,e){for(var i,s,h,p=!1,f=0;f<t.length;f++)for(var v=0,T=(i=t[f]).length-1;v<i.length;T=v++)(s=i[v]).y>e.y!=(h=i[T]).y>e.y&&e.x<(h.x-s.x)*(e.y-s.y)/(h.y-s.y)+s.x&&(p=!p);return p}function Za(t,e){for(var i=!1,s=0,h=t.length-1;s<t.length;h=s++){var p=t[s],f=t[h];p.y>e.y!=f.y>e.y&&e.x<(f.x-p.x)*(e.y-p.y)/(f.y-p.y)+p.x&&(i=!i)}return i}function sl(t,e,i){var s=i[0],h=i[2];if(t.x<s.x&&e.x<s.x||t.x>h.x&&e.x>h.x||t.y<s.y&&e.y<s.y||t.y>h.y&&e.y>h.y)return!1;var p=un(t,e,i[0]);return p!==un(t,e,i[1])||p!==un(t,e,i[2])||p!==un(t,e,i[3])}function Va(t,e,i){var s=e.paint.get(t).value;return"constant"===s.kind?s.value:i.programConfigurations.get(e.id).getMaxValue(t)}function Ar(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function is(t,e,i,s,h){if(!e[0]&&!e[1])return t;var p=le.convert(e)._mult(h);"viewport"===i&&p._rotate(-s);for(var f=[],v=0;v<t.length;v++)f.push(t[v].sub(p));return f}vo.prototype.populate=function(t,e,i){var s=this.layers[0],h=[],p=null;"circle"===s.type&&(p=s.layout.get("circle-sort-key"));for(var f=0,v=t;f<v.length;f+=1){var T=v[f],E=T.feature,C=T.id,k=T.index,B=T.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,J=Yn(E,U);if(this.layers[0]._featureFilter.filter(new oi(this.zoom),J,i)){var Y=p?p.evaluate(J,{},i):void 0,at={id:C,properties:E.properties,type:E.type,sourceLayerIndex:B,index:k,geometry:U?J.geometry:zn(E),patterns:{},sortKey:Y};h.push(at)}}p&&h.sort(function(Qt,_e){return Qt.sortKey-_e.sortKey});for(var it=0,pt=h;it<pt.length;it+=1){var gt=pt[it],xt=gt.geometry,St=gt.index,zt=gt.sourceLayerIndex,qt=t[St].feature;this.addFeature(gt,xt,St,i),e.featureIndex.insert(qt,xt,St,zt,this.index)}},vo.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},vo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},vo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},vo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,N),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},vo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},vo.prototype.addFeature=function(t,e,i,s){for(var h=0,p=e;h<p.length;h+=1)for(var f=0,v=p[h];f<v.length;f+=1){var T=v[f],E=T.x,C=T.y;if(!(E<0||E>=8192||C<0||C>=8192)){var k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),B=k.vertexLength;Vo(this.layoutVertexArray,E,C,-1,-1),Vo(this.layoutVertexArray,E,C,1,-1),Vo(this.layoutVertexArray,E,C,1,1),Vo(this.layoutVertexArray,E,C,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),k.vertexLength+=4,k.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},s)},Zt("CircleBucket",vo,{omit:["layers"]});var vs=new mr({"circle-sort-key":new ce(j.layout_circle["circle-sort-key"])}),ks={paint:new mr({"circle-radius":new ce(j.paint_circle["circle-radius"]),"circle-color":new ce(j.paint_circle["circle-color"]),"circle-blur":new ce(j.paint_circle["circle-blur"]),"circle-opacity":new ce(j.paint_circle["circle-opacity"]),"circle-translate":new me(j.paint_circle["circle-translate"]),"circle-translate-anchor":new me(j.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new me(j.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new me(j.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ce(j.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ce(j.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ce(j.paint_circle["circle-stroke-opacity"])}),layout:vs},Oi=typeof Float32Array<"u"?Float32Array:Array;function na(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function zo(t,e,i){var s=e[0],h=e[1],p=e[2],f=e[3],v=e[4],T=e[5],E=e[6],C=e[7],k=e[8],B=e[9],U=e[10],J=e[11],Y=e[12],at=e[13],it=e[14],pt=e[15],gt=i[0],xt=i[1],St=i[2],zt=i[3];return t[0]=gt*s+xt*v+St*k+zt*Y,t[1]=gt*h+xt*T+St*B+zt*at,t[2]=gt*p+xt*E+St*U+zt*it,t[3]=gt*f+xt*C+St*J+zt*pt,t[4]=(gt=i[4])*s+(xt=i[5])*v+(St=i[6])*k+(zt=i[7])*Y,t[5]=gt*h+xt*T+St*B+zt*at,t[6]=gt*p+xt*E+St*U+zt*it,t[7]=gt*f+xt*C+St*J+zt*pt,t[8]=(gt=i[8])*s+(xt=i[9])*v+(St=i[10])*k+(zt=i[11])*Y,t[9]=gt*h+xt*T+St*B+zt*at,t[10]=gt*p+xt*E+St*U+zt*it,t[11]=gt*f+xt*C+St*J+zt*pt,t[12]=(gt=i[12])*s+(xt=i[13])*v+(St=i[14])*k+(zt=i[15])*Y,t[13]=gt*h+xt*T+St*B+zt*at,t[14]=gt*p+xt*E+St*U+zt*it,t[15]=gt*f+xt*C+St*J+zt*pt,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,i=arguments.length;i--;)e+=t[i]*t[i];return Math.sqrt(e)});var Ms,t,sh=zo;function Tl(t,e,i){var s=e[0],h=e[1],p=e[2],f=e[3];return t[0]=i[0]*s+i[4]*h+i[8]*p+i[12]*f,t[1]=i[1]*s+i[5]*h+i[9]*p+i[13]*f,t[2]=i[2]*s+i[6]*h+i[10]*p+i[14]*f,t[3]=i[3]*s+i[7]*h+i[11]*p+i[15]*f,t}Ms=new Oi(3),Oi!=Float32Array&&(Ms[0]=0,Ms[1]=0,Ms[2]=0),t=new Oi(4),Oi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0);var lh=(function(){var t=new Oi(2);Oi!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(i){t.call(this,i,ks)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new vo(i)},e.prototype.queryRadius=function(i){var s=i;return Va("circle-radius",this,s)+Va("circle-stroke-width",this,s)+Ar(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(i,s,h,p,f,v,T,E){for(var C=is(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,T),k=this.paint.get("circle-radius").evaluate(s,h)+this.paint.get("circle-stroke-width").evaluate(s,h),B="map"===this.paint.get("circle-pitch-alignment"),U=B?C:function(qt,Qt){return qt.map(function(_e){return ll(_e,Qt)})}(C,E),J=B?k*T:k,Y=0,at=p;Y<at.length;Y+=1)for(var it=0,pt=at[Y];it<pt.length;it+=1){var gt=pt[it],xt=B?gt:ll(gt,E),St=J,zt=Tl([],[gt.x,gt.y,0,1],E);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?St*=zt[3]/v.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(St*=v.cameraToCenterDistance/zt[3]),Lo(U,xt,St))return!0}return!1},e}(ia));function ll(t,e){var i=Tl([],[t.x,t.y,0,1],e);return new le(i[0]/i[3],i[1]/i[3])}var Iu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(vo);function Xs(t,e,i,s){var h=e.width,p=e.height;if(s){if(s instanceof Uint8ClampedArray)s=new Uint8Array(s.buffer);else if(s.length!==h*p*i)throw new RangeError("mismatched image size")}else s=new Uint8Array(h*p*i);return t.width=h,t.height=p,t.data=s,t}function Sl(t,e,i){var s=e.width,h=e.height;if(s!==t.width||h!==t.height){var p=Xs({},{width:s,height:h},i);uh(t,p,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,s),height:Math.min(t.height,h)},i),t.width=s,t.height=h,t.data=p.data}}function uh(t,e,i,s,h,p){if(0===h.width||0===h.height)return e;if(h.width>t.width||h.height>t.height||i.x>t.width-h.width||i.y>t.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||s.x>e.width-h.width||s.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");for(var f=t.data,v=e.data,T=0;T<h.height;T++)for(var E=((i.y+T)*t.width+i.x)*p,C=((s.y+T)*e.width+s.x)*p,k=0;k<h.width*p;k++)v[C+k]=f[E+k];return e}Zt("HeatmapBucket",Iu,{omit:["layers"]});var ul=function(t,e){Xs(this,t,1,e)};ul.prototype.resize=function(t){Sl(this,t,1)},ul.prototype.clone=function(){return new ul({width:this.width,height:this.height},new Uint8Array(this.data))},ul.copy=function(t,e,i,s,h){uh(t,e,i,s,h,1)};var qo=function(t,e){Xs(this,t,4,e)};qo.prototype.resize=function(t){Sl(this,t,4)},qo.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},qo.prototype.clone=function(){return new qo({width:this.width,height:this.height},new Uint8Array(this.data))},qo.copy=function(t,e,i,s,h){uh(t,e,i,s,h,4)},Zt("AlphaImage",ul),Zt("RGBAImage",qo);var op={paint:new mr({"heatmap-radius":new ce(j.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ce(j.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new me(j.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jo(j.paint_heatmap["heatmap-color"]),"heatmap-opacity":new me(j.paint_heatmap["heatmap-opacity"])})};function Uh(t){var e={},i=t.resolution||256,s=t.clips?t.clips.length:1,h=t.image||new qo({width:i,height:s}),p=function(J,Y,at){e[t.evaluationKey]=at;var it=t.expression.evaluate(e);h.data[J+Y+0]=Math.floor(255*it.r/it.a),h.data[J+Y+1]=Math.floor(255*it.g/it.a),h.data[J+Y+2]=Math.floor(255*it.b/it.a),h.data[J+Y+3]=Math.floor(255*it.a)};if(t.clips)for(var f=0,v=0;f<s;++f,v+=4*i)for(var T=0,E=0;T<i;T++,E+=4){var C=T/(i-1),k=t.clips[f];p(v,E,k.start*(1-C)+k.end*C)}else for(var B=0,U=0;B<i;B++,U+=4)p(0,U,B/(i-1));return h}var ap=function(t){function e(i){t.call(this,i,op),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new Iu(i)},e.prototype._handleSpecialPaintPropertyUpdate=function(i){"heatmap-color"===i&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=Uh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(ia),sp={paint:new mr({"hillshade-illumination-direction":new me(j.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new me(j.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new me(j.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new me(j.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new me(j.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new me(j.paint_hillshade["hillshade-accent-color"])})},lp=function(t){function e(i){t.call(this,i,sp)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(ia),up=ar([{name:"a_pos",components:2,type:"Int16"}],4).members,hh=Cu,hp=Cu;function Cu(t,e,i){i=i||2;var s,h,p,f,v,T,E,C=e&&e.length,k=C?e[0]*i:t.length,B=Nh(t,0,k,i,!0),U=[];if(!B||B.next===B.prev)return U;if(C&&(B=function(Y,at,it,pt){var gt,xt,St,zt=[];for(gt=0,xt=at.length;gt<xt;gt++)(St=Nh(Y,at[gt]*pt,gt<xt-1?at[gt+1]*pt:Y.length,pt,!1))===St.next&&(St.steiner=!0),zt.push(gp(St));for(zt.sort(mp),gt=0;gt<zt.length;gt++)_p(zt[gt],it),it=Ks(it,it.next);return it}(t,e,B,i)),t.length>80*i){s=p=t[0],h=f=t[1];for(var J=i;J<k;J+=i)(v=t[J])<s&&(s=v),(T=t[J+1])<h&&(h=T),v>p&&(p=v),T>f&&(f=T);E=0!==(E=Math.max(p-s,f-h))?1/E:0}return iu(B,U,i,s,h,E),U}function Nh(t,e,i,s,h){var p,f;if(h===dh(t,e,i,s)>0)for(p=e;p<i;p+=s)f=Vh(p,t[p],t[p+1],f);else for(p=i-s;p>=e;p-=s)f=Vh(p,t[p],t[p+1],f);return f&&Lu(f,f.next)&&(ru(f),f=f.next),f}function Ks(t,e){if(!t)return t;e||(e=t);var i,s=t;do{if(i=!1,s.steiner||!Lu(s,s.next)&&0!==_r(s.prev,s,s.next))s=s.next;else{if(ru(s),(s=e=s.prev)===s.next)break;i=!0}}while(i||s!==e);return e}function iu(t,e,i,s,h,p,f){if(t){!f&&p&&function(C,k,B,U){var J=C;do{null===J.z&&(J.z=ch(J.x,J.y,k,B,U)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next}while(J!==C);J.prevZ.nextZ=null,J.prevZ=null,function(Y){var at,it,pt,gt,xt,St,zt,qt,Qt=1;do{for(it=Y,Y=null,xt=null,St=0;it;){for(St++,pt=it,zt=0,at=0;at<Qt&&(zt++,pt=pt.nextZ);at++);for(qt=Qt;zt>0||qt>0&&pt;)0!==zt&&(0===qt||!pt||it.z<=pt.z)?(gt=it,it=it.nextZ,zt--):(gt=pt,pt=pt.nextZ,qt--),xt?xt.nextZ=gt:Y=gt,gt.prevZ=xt,xt=gt;it=pt}xt.nextZ=null,Qt*=2}while(St>1)}(J)}(t,s,h,p);for(var v,T,E=t;t.prev!==t.next;)if(v=t.prev,T=t.next,p?pp(t,s,h,p):cp(t))e.push(v.i/i),e.push(t.i/i),e.push(T.i/i),ru(t),t=T.next,E=T.next;else if((t=T)===E){f?1===f?iu(t=dp(Ks(t),e,i),e,i,s,h,p,2):2===f&&fp(t,e,i,s,h,p):iu(Ks(t),e,i,s,h,p,1);break}}}function cp(t){var e=t.prev,i=t,s=t.next;if(_r(e,i,s)>=0)return!1;for(var h=t.next.next;h!==t.prev;){if(El(e.x,e.y,i.x,i.y,s.x,s.y,h.x,h.y)&&_r(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function pp(t,e,i,s){var h=t.prev,p=t,f=t.next;if(_r(h,p,f)>=0)return!1;for(var v=h.x>p.x?h.x>f.x?h.x:f.x:p.x>f.x?p.x:f.x,T=h.y>p.y?h.y>f.y?h.y:f.y:p.y>f.y?p.y:f.y,E=ch(h.x<p.x?h.x<f.x?h.x:f.x:p.x<f.x?p.x:f.x,h.y<p.y?h.y<f.y?h.y:f.y:p.y<f.y?p.y:f.y,e,i,s),C=ch(v,T,e,i,s),k=t.prevZ,B=t.nextZ;k&&k.z>=E&&B&&B.z<=C;){if(k!==t.prev&&k!==t.next&&El(h.x,h.y,p.x,p.y,f.x,f.y,k.x,k.y)&&_r(k.prev,k,k.next)>=0||(k=k.prevZ,B!==t.prev&&B!==t.next&&El(h.x,h.y,p.x,p.y,f.x,f.y,B.x,B.y)&&_r(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;k&&k.z>=E;){if(k!==t.prev&&k!==t.next&&El(h.x,h.y,p.x,p.y,f.x,f.y,k.x,k.y)&&_r(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;B&&B.z<=C;){if(B!==t.prev&&B!==t.next&&El(h.x,h.y,p.x,p.y,f.x,f.y,B.x,B.y)&&_r(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function dp(t,e,i){var s=t;do{var h=s.prev,p=s.next.next;!Lu(h,p)&&jh(h,s,s.next,p)&&nu(h,p)&&nu(p,h)&&(e.push(h.i/i),e.push(s.i/i),e.push(p.i/i),ru(s),ru(s.next),s=t=p),s=s.next}while(s!==t);return Ks(s)}function fp(t,e,i,s,h,p){var f=t;do{for(var v=f.next.next;v!==f.prev;){if(f.i!==v.i&&vp(f,v)){var T=Zh(f,v);return f=Ks(f,f.next),T=Ks(T,T.next),iu(f,e,i,s,h,p),void iu(T,e,i,s,h,p)}v=v.next}f=f.next}while(f!==t)}function mp(t,e){return t.x-e.x}function _p(t,e){if(e=function(s,h){var p,f=h,v=s.x,T=s.y,E=-1/0;do{if(T<=f.y&&T>=f.next.y&&f.next.y!==f.y){var C=f.x+(T-f.y)*(f.next.x-f.x)/(f.next.y-f.y);if(C<=v&&C>E){if(E=C,C===v){if(T===f.y)return f;if(T===f.next.y)return f.next}p=f.x<f.next.x?f:f.next}}f=f.next}while(f!==h);if(!p)return null;if(v===E)return p;var k,B=p,U=p.x,J=p.y,Y=1/0;f=p;do{v>=f.x&&f.x>=U&&v!==f.x&&El(T<J?v:E,T,U,J,T<J?E:v,T,f.x,f.y)&&(k=Math.abs(T-f.y)/(v-f.x),nu(f,s)&&(k<Y||k===Y&&(f.x>p.x||f.x===p.x&&yp(p,f)))&&(p=f,Y=k)),f=f.next}while(f!==B);return p}(t,e)){var i=Zh(e,t);Ks(e,e.next),Ks(i,i.next)}}function yp(t,e){return _r(t.prev,t,e.prev)<0&&_r(e.next,t,t.next)<0}function ch(t,e,i,s,h){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*h)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*h)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function gp(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function El(t,e,i,s,h,p,f,v){return(h-f)*(e-v)-(t-f)*(p-v)>=0&&(t-f)*(s-v)-(i-f)*(e-v)>=0&&(i-f)*(p-v)-(h-f)*(s-v)>=0}function vp(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(i,s){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==s.i&&h.next.i!==s.i&&jh(h,h.next,i,s))return!0;h=h.next}while(h!==i);return!1}(t,e)&&(nu(t,e)&&nu(e,t)&&function(i,s){var h=i,p=!1,f=(i.x+s.x)/2,v=(i.y+s.y)/2;do{h.y>v!=h.next.y>v&&h.next.y!==h.y&&f<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(p=!p),h=h.next}while(h!==i);return p}(t,e)&&(_r(t.prev,t,e.prev)||_r(t,e.prev,e))||Lu(t,e)&&_r(t.prev,t,t.next)>0&&_r(e.prev,e,e.next)>0)}function _r(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Lu(t,e){return t.x===e.x&&t.y===e.y}function jh(t,e,i,s){var h=ku(_r(t,e,i)),p=ku(_r(t,e,s)),f=ku(_r(i,s,t)),v=ku(_r(i,s,e));return h!==p&&f!==v||!(0!==h||!zu(t,i,e))||!(0!==p||!zu(t,s,e))||!(0!==f||!zu(i,t,s))||!(0!==v||!zu(i,e,s))}function zu(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function ku(t){return t>0?1:t<0?-1:0}function nu(t,e){return _r(t.prev,t,t.next)<0?_r(t,e,t.next)>=0&&_r(t,t.prev,e)>=0:_r(t,e,t.prev)<0||_r(t,t.next,e)<0}function Zh(t,e){var i=new ph(t.i,t.x,t.y),s=new ph(e.i,e.x,e.y),h=t.next,p=e.prev;return t.next=e,e.prev=t,i.next=h,h.prev=i,s.next=i,i.prev=s,p.next=s,s.prev=p,s}function Vh(t,e,i,s){var h=new ph(t,e,i);return s?(h.next=s.next,h.prev=s,s.next.prev=h,s.next=h):(h.prev=h,h.next=h),h}function ru(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ph(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function dh(t,e,i,s){for(var h=0,p=e,f=i-s;p<i;p+=s)h+=(t[f]-t[p])*(t[p+1]+t[f+1]),f=p;return h}function xp(t,e,i,s,h){!function p(f,v,T,E,C){for(;E>T;){if(E-T>600){var k=E-T+1,B=v-T+1,U=Math.log(k),J=.5*Math.exp(2*U/3),Y=.5*Math.sqrt(U*J*(k-J)/k)*(B-k/2<0?-1:1);p(f,v,Math.max(T,Math.floor(v-B*J/k+Y)),Math.min(E,Math.floor(v+(k-B)*J/k+Y)),C)}var at=f[v],it=T,pt=E;for(ou(f,T,v),C(f[E],at)>0&&ou(f,T,E);it<pt;){for(ou(f,it,pt),it++,pt--;C(f[it],at)<0;)it++;for(;C(f[pt],at)>0;)pt--}0===C(f[T],at)?ou(f,T,pt):ou(f,++pt,E),pt<=v&&(T=pt+1),v<=pt&&(E=pt-1)}}(t,e,i||0,s||t.length-1,h||bp)}function ou(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function bp(t,e){return t<e?-1:t>e?1:0}function fh(t,e){var i=t.length;if(i<=1)return[t];for(var s,h,p=[],f=0;f<i;f++){var v=qe(t[f]);0!==v&&(t[f].area=Math.abs(v),void 0===h&&(h=v<0),h===v<0?(s&&p.push(s),s=[t[f]]):s.push(t[f]))}if(s&&p.push(s),e>1)for(var T=0;T<p.length;T++)p[T].length<=e||(xp(p[T],e,1,p[T].length-1,wp),p[T]=p[T].slice(0,e));return p}function wp(t,e){return e.area-t.area}function mh(t,e,i){for(var s=i.patternDependencies,h=!1,p=0,f=e;p<f.length;p+=1){var v=f[p].paint.get(t+"-pattern");v.isConstant()||(h=!0);var T=v.constantOr(null);T&&(h=!0,s[T.to]=!0,s[T.from]=!0)}return h}function _h(t,e,i,s,h){for(var p=h.patternDependencies,f=0,v=e;f<v.length;f+=1){var T=v[f],E=T.paint.get(t+"-pattern").value;if("constant"!==E.kind){var C=E.evaluate({zoom:s-1},i,{},h.availableImages),k=E.evaluate({zoom:s},i,{},h.availableImages),B=E.evaluate({zoom:s+1},i,{},h.availableImages);k=k&&k.name?k.name:k,B=B&&B.name?B.name:B,p[C=C&&C.name?C.name:C]=!0,p[k]=!0,p[B]=!0,i.patterns[T.id]={min:C,mid:k,max:B}}}return i}Cu.deviation=function(t,e,i,s){var h=e&&e.length,p=Math.abs(dh(t,0,h?e[0]*i:t.length,i));if(h)for(var f=0,v=e.length;f<v;f++)p-=Math.abs(dh(t,e[f]*i,f<v-1?e[f+1]*i:t.length,i));var T=0;for(f=0;f<s.length;f+=3){var E=s[f]*i,C=s[f+1]*i,k=s[f+2]*i;T+=Math.abs((t[E]-t[k])*(t[C+1]-t[E+1])-(t[E]-t[C])*(t[k+1]-t[E+1]))}return 0===p&&0===T?0:Math.abs((T-p)/p)},Cu.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,h=0;h<t.length;h++){for(var p=0;p<t[h].length;p++)for(var f=0;f<e;f++)i.vertices.push(t[h][p][f]);h>0&&i.holes.push(s+=t[h-1].length)}return i},hh.default=hp;var ns=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ls,this.indexArray=new fs,this.indexArray2=new rl,this.programConfigurations=new Pe(t.layers,t.zoom),this.segments=new Z,this.segments2=new Z,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};ns.prototype.populate=function(t,e,i){this.hasPattern=mh("fill",this.layers,e);for(var s=this.layers[0].layout.get("fill-sort-key"),h=[],p=0,f=t;p<f.length;p+=1){var v=f[p],T=v.feature,E=v.id,C=v.index,k=v.sourceLayerIndex,B=this.layers[0]._featureFilter.needGeometry,U=Yn(T,B);if(this.layers[0]._featureFilter.filter(new oi(this.zoom),U,i)){var J=s?s.evaluate(U,{},i,e.availableImages):void 0,Y={id:E,properties:T.properties,type:T.type,sourceLayerIndex:k,index:C,geometry:B?U.geometry:zn(T),patterns:{},sortKey:J};h.push(Y)}}s&&h.sort(function(qt,Qt){return qt.sortKey-Qt.sortKey});for(var at=0,it=h;at<it.length;at+=1){var pt=it[at],gt=pt.geometry,xt=pt.index,St=pt.sourceLayerIndex;if(this.hasPattern){var zt=_h("fill",this.layers,pt,this.zoom,e);this.patternFeatures.push(zt)}else this.addFeature(pt,gt,xt,i,{});e.featureIndex.insert(t[xt].feature,gt,xt,St,this.index)}},ns.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},ns.prototype.addFeatures=function(t,e,i){for(var s=0,h=this.patternFeatures;s<h.length;s+=1){var p=h[s];this.addFeature(p,p.geometry,p.index,e,i)}},ns.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ns.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ns.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,up),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},ns.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ns.prototype.addFeature=function(t,e,i,s,h){for(var p=0,f=fh(e,500);p<f.length;p+=1){for(var v=f[p],T=0,E=0,C=v;E<C.length;E+=1)T+=C[E].length;for(var k=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),B=k.vertexLength,U=[],J=[],Y=0,at=v;Y<at.length;Y+=1){var it=at[Y];if(0!==it.length){it!==v[0]&&J.push(U.length/2);var pt=this.segments2.prepareSegment(it.length,this.layoutVertexArray,this.indexArray2),gt=pt.vertexLength;this.layoutVertexArray.emplaceBack(it[0].x,it[0].y),this.indexArray2.emplaceBack(gt+it.length-1,gt),U.push(it[0].x),U.push(it[0].y);for(var xt=1;xt<it.length;xt++)this.layoutVertexArray.emplaceBack(it[xt].x,it[xt].y),this.indexArray2.emplaceBack(gt+xt-1,gt+xt),U.push(it[xt].x),U.push(it[xt].y);pt.vertexLength+=it.length,pt.primitiveLength+=it.length}}for(var St=hh(U,J),zt=0;zt<St.length;zt+=3)this.indexArray.emplaceBack(B+St[zt],B+St[zt+1],B+St[zt+2]);k.vertexLength+=T,k.primitiveLength+=St.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,h,s)},Zt("FillBucket",ns,{omit:["layers","patternFeatures"]});var Tp=new mr({"fill-sort-key":new ce(j.layout_fill["fill-sort-key"])}),Sp={paint:new mr({"fill-antialias":new me(j.paint_fill["fill-antialias"]),"fill-opacity":new ce(j.paint_fill["fill-opacity"]),"fill-color":new ce(j.paint_fill["fill-color"]),"fill-outline-color":new ce(j.paint_fill["fill-outline-color"]),"fill-translate":new me(j.paint_fill["fill-translate"]),"fill-translate-anchor":new me(j.paint_fill["fill-translate-anchor"]),"fill-pattern":new ds(j.paint_fill["fill-pattern"])}),layout:Tp},Ep=function(t){function e(i){t.call(this,i,Sp)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(i,s){t.prototype.recalculate.call(this,i,s);var h=this.paint._values["fill-outline-color"];"constant"===h.value.kind&&void 0===h.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(i){return new ns(i)},e.prototype.queryRadius=function(){return Ar(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(i,s,h,p,f,v,T){return Sa(is(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,T),p)},e.prototype.isTileClipped=function(){return!0},e}(ia),Pp=ar([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,qh=Pl;function Pl(t,e,i,s,h){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=h,t.readFields(Ap,this,e)}function Ap(t,e,i){1==t?e.id=i.readVarint():2==t?function(s,h){for(var p=s.readVarint()+s.pos;s.pos<p;){var f=h._keys[s.readVarint()],v=h._values[s.readVarint()];h.properties[f]=v}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function Ip(t){for(var e,i,s=0,h=0,p=t.length,f=p-1;h<p;f=h++)s+=((i=t[f]).x-(e=t[h]).x)*(e.y+i.y);return s}Pl.types=["Unknown","Point","LineString","Polygon"],Pl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,s=1,h=0,p=0,f=0,v=[];t.pos<i;){if(h<=0){var T=t.readVarint();s=7&T,h=T>>3}if(h--,1===s||2===s)p+=t.readSVarint(),f+=t.readSVarint(),1===s&&(e&&v.push(e),e=[]),e.push(new le(p,f));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&v.push(e),v},Pl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,s=0,h=0,p=0,f=1/0,v=-1/0,T=1/0,E=-1/0;t.pos<e;){if(s<=0){var C=t.readVarint();i=7&C,s=C>>3}if(s--,1===i||2===i)(h+=t.readSVarint())<f&&(f=h),h>v&&(v=h),(p+=t.readSVarint())<T&&(T=p),p>E&&(E=p);else if(7!==i)throw new Error("unknown command "+i)}return[f,T,v,E]},Pl.prototype.toGeoJSON=function(t,e,i){var s,h,p=this.extent*Math.pow(2,i),f=this.extent*t,v=this.extent*e,T=this.loadGeometry(),E=Pl.types[this.type];function C(U){for(var J=0;J<U.length;J++){var Y=U[J];U[J]=[360*(Y.x+f)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(Y.y+v)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var k=[];for(s=0;s<T.length;s++)k[s]=T[s][0];C(T=k);break;case 2:for(s=0;s<T.length;s++)C(T[s]);break;case 3:for(T=function(U){var J=U.length;if(J<=1)return[U];for(var Y,at,it=[],pt=0;pt<J;pt++){var gt=Ip(U[pt]);0!==gt&&(void 0===at&&(at=gt<0),at===gt<0?(Y&&it.push(Y),Y=[U[pt]]):Y.push(U[pt]))}return Y&&it.push(Y),it}(T),s=0;s<T.length;s++)for(h=0;h<T[s].length;h++)C(T[s][h])}1===T.length?T=T[0]:E="Multi"+E;var B={type:"Feature",geometry:{type:E,coordinates:T},properties:this.properties};return"id"in this&&(B.id=this.id),B};var Gh=Wh;function Wh(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Cp,this,e),this.length=this._features.length}function Cp(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(s){for(var h=null,p=s.readVarint()+s.pos;s.pos<p;){var f=s.readVarint()>>3;h=1===f?s.readString():2===f?s.readFloat():3===f?s.readDouble():4===f?s.readVarint64():5===f?s.readVarint():6===f?s.readSVarint():7===f?s.readBoolean():null}return h}(i))}function Lp(t,e,i){if(3===t){var s=new Gh(i,i.readVarint()+i.pos);s.length&&(e[s.name]=s)}}Wh.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new qh(this._pbf,e,this.extent,this._keys,this._values)};var Al={VectorTile:function(t,e){this.layers=t.readFields(Lp,{},e)},VectorTileFeature:qh,VectorTileLayer:Gh},zp=Al.VectorTileFeature.types,yh=Math.pow(2,13);function au(t,e,i,s,h,p,f,v){t.emplaceBack(e,i,2*Math.floor(s*yh)+f,h*yh*2,p*yh*2,Math.round(v))}var rs=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new es,this.indexArray=new fs,this.programConfigurations=new Pe(t.layers,t.zoom),this.segments=new Z,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function kp(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}rs.prototype.populate=function(t,e,i){this.features=[],this.hasPattern=mh("fill-extrusion",this.layers,e);for(var s=0,h=t;s<h.length;s+=1){var p=h[s],f=p.feature,v=p.id,T=p.index,E=p.sourceLayerIndex,C=this.layers[0]._featureFilter.needGeometry,k=Yn(f,C);if(this.layers[0]._featureFilter.filter(new oi(this.zoom),k,i)){var B={id:v,sourceLayerIndex:E,index:T,geometry:C?k.geometry:zn(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(_h("fill-extrusion",this.layers,B,this.zoom,e)):this.addFeature(B,B.geometry,T,i,{}),e.featureIndex.insert(f,B.geometry,T,E,this.index,!0)}}},rs.prototype.addFeatures=function(t,e,i){for(var s=0,h=this.features;s<h.length;s+=1){var p=h[s];this.addFeature(p,p.geometry,p.index,e,i)}},rs.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},rs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},rs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rs.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pp),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},rs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},rs.prototype.addFeature=function(t,e,i,s,h){for(var p=0,f=fh(e,500);p<f.length;p+=1){for(var v=f[p],T=0,E=0,C=v;E<C.length;E+=1)T+=C[E].length;for(var k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),B=0,U=v;B<U.length;B+=1){var J=U[B];if(0!==J.length&&!((ai=J).every(function(He){return He.x<0})||ai.every(function(He){return He.x>8192})||ai.every(function(He){return He.y<0})||ai.every(function(He){return He.y>8192})))for(var Y=0,at=0;at<J.length;at++){var it=J[at];if(at>=1){var pt=J[at-1];if(!kp(it,pt)){k.vertexLength+4>Z.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var gt=it.sub(pt)._perp()._unit(),xt=pt.dist(it);Y+xt>32768&&(Y=0),au(this.layoutVertexArray,it.x,it.y,gt.x,gt.y,0,0,Y),au(this.layoutVertexArray,it.x,it.y,gt.x,gt.y,0,1,Y),au(this.layoutVertexArray,pt.x,pt.y,gt.x,gt.y,0,0,Y+=xt),au(this.layoutVertexArray,pt.x,pt.y,gt.x,gt.y,0,1,Y);var St=k.vertexLength;this.indexArray.emplaceBack(St,St+2,St+1),this.indexArray.emplaceBack(St+1,St+2,St+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+T>Z.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),"Polygon"===zp[t.type]){for(var zt=[],qt=[],Qt=k.vertexLength,_e=0,oe=v;_e<oe.length;_e+=1){var ve=oe[_e];if(0!==ve.length){ve!==v[0]&&qt.push(zt.length/2);for(var ae=0;ae<ve.length;ae++){var Qe=ve[ae];au(this.layoutVertexArray,Qe.x,Qe.y,0,0,1,1,0),zt.push(Qe.x),zt.push(Qe.y)}}}for(var Ie=hh(zt,qt),pe=0;pe<Ie.length;pe+=3)this.indexArray.emplaceBack(Qt+Ie[pe],Qt+Ie[pe+2],Qt+Ie[pe+1]);k.primitiveLength+=Ie.length/3,k.vertexLength+=T}}var ai;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,h,s)},Zt("FillExtrusionBucket",rs,{omit:["layers","features"]});var Mp={paint:new mr({"fill-extrusion-opacity":new me(j["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ce(j["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new me(j["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new me(j["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ds(j["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ce(j["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ce(j["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new me(j["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Dp=function(t){function e(i){t.call(this,i,Mp)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new rs(i)},e.prototype.queryRadius=function(){return Ar(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(i,s,h,p,f,v,T,E){var C=is(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,T),k=this.paint.get("fill-extrusion-height").evaluate(s,h),B=this.paint.get("fill-extrusion-base").evaluate(s,h),U=function(Y,at,it,pt){for(var gt=[],xt=0,St=Y;xt<St.length;xt+=1){var zt=St[xt],qt=[zt.x,zt.y,0,1];Tl(qt,qt,at),gt.push(new le(qt[0]/qt[3],qt[1]/qt[3]))}return gt}(C,E),J=function(Y,at,it,pt){for(var gt=[],xt=[],St=pt[8]*at,zt=pt[9]*at,qt=pt[10]*at,Qt=pt[11]*at,_e=pt[8]*it,oe=pt[9]*it,ve=pt[10]*it,ae=pt[11]*it,Qe=0,Ie=Y;Qe<Ie.length;Qe+=1){for(var pe=[],ai=[],He=0,yi=Ie[Qe];He<yi.length;He+=1){var xe=yi[He],Ci=xe.x,xn=xe.y,Vn=pt[0]*Ci+pt[4]*xn+pt[12],kn=pt[1]*Ci+pt[5]*xn+pt[13],bn=pt[2]*Ci+pt[6]*xn+pt[14],qn=pt[3]*Ci+pt[7]*xn+pt[15],Ir=bn+qt,Cr=qn+Qt,bo=Vn+_e,Zr=kn+oe,wo=bn+ve,$n=qn+ae,Vr=new le((Vn+St)/Cr,(kn+zt)/Cr);Vr.z=Ir/Cr,pe.push(Vr);var hi=new le(bo/$n,Zr/$n);hi.z=wo/$n,ai.push(hi)}gt.push(pe),xt.push(ai)}return[gt,xt]}(p,B,k,E);return function(Y,at,it){var pt=1/0;Sa(it,at)&&(pt=Hh(it,at[0]));for(var gt=0;gt<at.length;gt++)for(var xt=at[gt],St=Y[gt],zt=0;zt<xt.length-1;zt++){var qt=xt[zt],Qt=[qt,xt[zt+1],St[zt+1],St[zt],qt];ys(it,Qt)&&(pt=Math.min(pt,Hh(it,Qt)))}return pt!==1/0&&pt}(J[0],J[1],U)},e}(ia);function su(t,e){return t.x*e.x+t.y*e.y}function Hh(t,e){if(1===t.length){for(var i,s=0,h=e[s++];!i||h.equals(i);)if(!(i=e[s++]))return 1/0;for(;s<e.length;s++){var p=e[s],f=t[0],v=i.sub(h),T=p.sub(h),E=f.sub(h),C=su(v,v),k=su(v,T),B=su(T,T),U=su(E,v),J=su(E,T),Y=C*B-k*k,at=(B*U-k*J)/Y,it=(C*J-k*U)/Y,pt=h.z*(1-at-it)+i.z*at+p.z*it;if(isFinite(pt))return pt}return 1/0}for(var gt=1/0,xt=0,St=e;xt<St.length;xt+=1)gt=Math.min(gt,St[xt].z);return gt}var Op=ar([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Bp=ar([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Rp=Al.VectorTileFeature.types,Fp=Math.cos(Math.PI/180*37.5),Xh=Math.pow(2,14)/.5,ko=function(t){var e=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){e.gradients[i.id]={}}),this.layoutVertexArray=new Zo,this.layoutVertexArray2=new Vs,this.indexArray=new fs,this.programConfigurations=new Pe(t.layers,t.zoom),this.segments=new Z,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};ko.prototype.populate=function(t,e,i){this.hasPattern=mh("line",this.layers,e);for(var s=this.layers[0].layout.get("line-sort-key"),h=[],p=0,f=t;p<f.length;p+=1){var v=f[p],T=v.feature,E=v.id,C=v.index,k=v.sourceLayerIndex,B=this.layers[0]._featureFilter.needGeometry,U=Yn(T,B);if(this.layers[0]._featureFilter.filter(new oi(this.zoom),U,i)){var J=s?s.evaluate(U,{},i):void 0,Y={id:E,properties:T.properties,type:T.type,sourceLayerIndex:k,index:C,geometry:B?U.geometry:zn(T),patterns:{},sortKey:J};h.push(Y)}}s&&h.sort(function(qt,Qt){return qt.sortKey-Qt.sortKey});for(var at=0,it=h;at<it.length;at+=1){var pt=it[at],gt=pt.geometry,xt=pt.index,St=pt.sourceLayerIndex;if(this.hasPattern){var zt=_h("line",this.layers,pt,this.zoom,e);this.patternFeatures.push(zt)}else this.addFeature(pt,gt,xt,i,{});e.featureIndex.insert(t[xt].feature,gt,xt,St,this.index)}},ko.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},ko.prototype.addFeatures=function(t,e,i){for(var s=0,h=this.patternFeatures;s<h.length;s+=1){var p=h[s];this.addFeature(p,p.geometry,p.index,e,i)}},ko.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ko.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ko.prototype.upload=function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Bp)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Op),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ko.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ko.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},ko.prototype.addFeature=function(t,e,i,s,h){var p=this.layers[0].layout,f=p.get("line-join").evaluate(t,{}),v=p.get("line-cap"),T=p.get("line-miter-limit"),E=p.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var C=0,k=e;C<k.length;C+=1)this.addLine(k[C],t,f,v,T,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,h,s)},ko.prototype.addLine=function(t,e,i,s,h,p){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var f=0;f<t.length-1;f++)this.totalDistance+=t[f].dist(t[f+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var v="Polygon"===Rp[e.type],T=t.length;T>=2&&t[T-1].equals(t[T-2]);)T--;for(var E=0;E<T-1&&t[E].equals(t[E+1]);)E++;if(!(T<(v?3:2))){"bevel"===i&&(h=1.05);var C,k=this.overscaling<=16?122880/(512*this.overscaling):0,B=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray),U=void 0,J=void 0,Y=void 0,at=void 0;this.e1=this.e2=-1,v&&(at=t[E].sub(C=t[T-2])._unit()._perp());for(var it=E;it<T;it++)if(!(J=it===T-1?v?t[E+1]:void 0:t[it+1])||!t[it].equals(J)){at&&(Y=at),C&&(U=C),C=t[it],at=J?J.sub(C)._unit()._perp():Y;var pt=(Y=Y||at).add(at);0===pt.x&&0===pt.y||pt._unit();var gt=Y.x*at.x+Y.y*at.y,xt=pt.x*at.x+pt.y*at.y,St=0!==xt?1/xt:1/0,zt=2*Math.sqrt(2-2*xt),qt=xt<Fp&&U&&J,Qt=Y.x*at.y-Y.y*at.x>0;if(qt&&it>E){var _e=C.dist(U);if(_e>2*k){var oe=C.sub(C.sub(U)._mult(k/_e)._round());this.updateDistance(U,oe),this.addCurrentVertex(oe,Y,0,0,B),U=oe}}var ve=U&&J,ae=ve?i:v?"butt":s;if(ve&&"round"===ae&&(St<p?ae="miter":St<=2&&(ae="fakeround")),"miter"===ae&&St>h&&(ae="bevel"),"bevel"===ae&&(St>2&&(ae="flipbevel"),St<h&&(ae="miter")),U&&this.updateDistance(U,C),"miter"===ae)pt._mult(St),this.addCurrentVertex(C,pt,0,0,B);else if("flipbevel"===ae){if(St>100)pt=at.mult(-1);else{var Qe=St*Y.add(at).mag()/Y.sub(at).mag();pt._perp()._mult(Qe*(Qt?-1:1))}this.addCurrentVertex(C,pt,0,0,B),this.addCurrentVertex(C,pt.mult(-1),0,0,B)}else if("bevel"===ae||"fakeround"===ae){var Ie=-Math.sqrt(St*St-1),pe=Qt?Ie:0,ai=Qt?0:Ie;if(U&&this.addCurrentVertex(C,Y,pe,ai,B),"fakeround"===ae)for(var He=Math.round(180*zt/Math.PI/20),yi=1;yi<He;yi++){var xe=yi/He;if(.5!==xe){var Ci=xe-.5;xe+=xe*Ci*(xe-1)*((1.0904+gt*(gt*(3.55645-1.43519*gt)-3.2452))*Ci*Ci+(.848013+gt*(.215638*gt-1.06021)))}var xn=at.sub(Y)._mult(xe)._add(Y)._unit()._mult(Qt?-1:1);this.addHalfVertex(C,xn.x,xn.y,!1,Qt,0,B)}J&&this.addCurrentVertex(C,at,-pe,-ai,B)}else if("butt"===ae)this.addCurrentVertex(C,pt,0,0,B);else if("square"===ae){var Vn=U?1:-1;this.addCurrentVertex(C,pt,Vn,Vn,B)}else"round"===ae&&(U&&(this.addCurrentVertex(C,Y,0,0,B),this.addCurrentVertex(C,Y,1,1,B,!0)),J&&(this.addCurrentVertex(C,at,-1,-1,B,!0),this.addCurrentVertex(C,at,0,0,B)));if(qt&&it<T-1){var kn=C.dist(J);if(kn>2*k){var bn=C.add(J.sub(C)._mult(k/kn)._round());this.updateDistance(C,bn),this.addCurrentVertex(bn,at,0,0,B),C=bn}}}}},ko.prototype.addCurrentVertex=function(t,e,i,s,h,p){void 0===p&&(p=!1);var f=e.y*s-e.x,v=-e.y-e.x*s;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,p,!1,i,h),this.addHalfVertex(t,f,v,p,!0,-s,h),this.distance>Xh/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,i,s,h,p))},ko.prototype.addHalfVertex=function(t,e,i,s,h,p,f){var v=.5*(this.lineClips?this.scaledDistance*(Xh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(s?1:0),(t.y<<1)+(h?1:0),Math.round(63*e)+128,Math.round(63*i)+128,1+(0===p?0:p<0?-1:1)|(63&v)<<2,v>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var T=f.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),f.primitiveLength++),h?this.e2=T:this.e1=T},ko.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ko.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},Zt("LineBucket",ko,{omit:["layers","patternFeatures"]});var Up=new mr({"line-cap":new me(j.layout_line["line-cap"]),"line-join":new ce(j.layout_line["line-join"]),"line-miter-limit":new me(j.layout_line["line-miter-limit"]),"line-round-limit":new me(j.layout_line["line-round-limit"]),"line-sort-key":new ce(j.layout_line["line-sort-key"])}),Kh={paint:new mr({"line-opacity":new ce(j.paint_line["line-opacity"]),"line-color":new ce(j.paint_line["line-color"]),"line-translate":new me(j.paint_line["line-translate"]),"line-translate-anchor":new me(j.paint_line["line-translate-anchor"]),"line-width":new ce(j.paint_line["line-width"]),"line-gap-width":new ce(j.paint_line["line-gap-width"]),"line-offset":new ce(j.paint_line["line-offset"]),"line-blur":new ce(j.paint_line["line-blur"]),"line-dasharray":new Ur(j.paint_line["line-dasharray"]),"line-pattern":new ds(j.paint_line["line-pattern"]),"line-gradient":new jo(j.paint_line["line-gradient"])}),layout:Up},Jh=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(i,s){return s=new oi(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),t.prototype.possiblyEvaluate.call(this,i,s)},e.prototype.evaluate=function(i,s,h,p){return s=Ct({},s,{zoom:Math.floor(s.zoom)}),t.prototype.evaluate.call(this,i,s,h,p)},e}(ce))(Kh.paint.properties["line-width"].specification);Jh.useIntegerZoom=!0;var Np=function(t){function e(i){t.call(this,i,Kh),this.gradientVersion=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(i){"line-gradient"===i&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof or,this.gradientVersion=(this.gradientVersion+1)%dn)},e.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},e.prototype.recalculate=function(i,s){t.prototype.recalculate.call(this,i,s),this.paint._values["line-floorwidth"]=Jh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},e.prototype.createBucket=function(i){return new ko(i)},e.prototype.queryRadius=function(i){var s=i,h=Yh(Va("line-width",this,s),Va("line-gap-width",this,s)),p=Va("line-offset",this,s);return h/2+Math.abs(p)+Ar(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(i,s,h,p,f,v,T){var E=is(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,T),C=T/2*Yh(this.paint.get("line-width").evaluate(s,h),this.paint.get("line-gap-width").evaluate(s,h)),k=this.paint.get("line-offset").evaluate(s,h);return k&&(p=function(B,U){for(var J=[],Y=new le(0,0),at=0;at<B.length;at++){for(var it=B[at],pt=[],gt=0;gt<it.length;gt++){var xt=it[gt],St=it[gt+1],zt=0===gt?Y:xt.sub(it[gt-1])._unit()._perp(),qt=gt===it.length-1?Y:St.sub(xt)._unit()._perp(),Qt=zt._add(qt)._unit();Qt._mult(1/(Qt.x*qt.x+Qt.y*qt.y)),pt.push(Qt._mult(U)._add(xt))}J.push(pt)}return J}(p,k*T)),function(B,U,J){for(var Y=0;Y<U.length;Y++){var at=U[Y];if(B.length>=3)for(var it=0;it<at.length;it++)if(Za(B,at[it]))return!0;if(pa(B,at,J))return!0}return!1}(E,p,C)},e.prototype.isTileClipped=function(){return!0},e}(ia);function Yh(t,e){return e>0?e+2*t:t}var jp=ar([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Zp=ar([{name:"a_projected_pos",components:3,type:"Float32"}],4),Vp=(ar([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ar([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),$h=(ar([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),ar([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),qp=ar([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Gp(t,e,i){return t.sections.forEach(function(s){var h,f,v;s.text=(h=s.text,f=i,"uppercase"===(v=e.layout.get("text-transform").evaluate(f,{}))?h=h.toLocaleUpperCase():"lowercase"===v&&(h=h.toLocaleLowerCase()),co.applyArabicShaping&&(h=co.applyArabicShaping(h)),h)}),t}ar([{name:"triangle",components:3,type:"Uint16"}]),ar([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ar([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ar([{type:"Float32",name:"offsetX"}]),ar([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var lu={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Qh=function(t,e,i,s,h){var p,f,v=8*h-s-1,T=(1<<v)-1,E=T>>1,C=-7,k=i?h-1:0,B=i?-1:1,U=t[e+k];for(k+=B,p=U&(1<<-C)-1,U>>=-C,C+=v;C>0;p=256*p+t[e+k],k+=B,C-=8);for(f=p&(1<<-C)-1,p>>=-C,C+=s;C>0;f=256*f+t[e+k],k+=B,C-=8);if(0===p)p=1-E;else{if(p===T)return f?NaN:1/0*(U?-1:1);f+=Math.pow(2,s),p-=E}return(U?-1:1)*f*Math.pow(2,p-s)},tc=function(t,e,i,s,h,p){var f,v,T,E=8*p-h-1,C=(1<<E)-1,k=C>>1,B=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,U=s?0:p-1,J=s?1:-1,Y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,f=C):(f=Math.floor(Math.log(e)/Math.LN2),e*(T=Math.pow(2,-f))<1&&(f--,T*=2),(e+=f+k>=1?B/T:B*Math.pow(2,1-k))*T>=2&&(f++,T/=2),f+k>=C?(v=0,f=C):f+k>=1?(v=(e*T-1)*Math.pow(2,h),f+=k):(v=e*Math.pow(2,k-1)*Math.pow(2,h),f=0));h>=8;t[i+U]=255&v,U+=J,v/=256,h-=8);for(f=f<<h|v,E+=h;E>0;t[i+U]=255&f,U+=J,f/=256,E-=8);t[i+U-J]|=128*Y},Mu=an;function an(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}an.Varint=0,an.Fixed64=1,an.Bytes=2,an.Fixed32=5;var ec=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ds(t){return t.type===an.Bytes?t.readVarint()+t.pos:t.pos+1}function ic(t,e,i){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(s);for(var h=i.pos-1;h>=t;h--)i.buf[h+s]=i.buf[h]}function Wp(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Hp(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function Xp(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function Kp(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function Jp(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function Yp(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function $p(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Qp(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function td(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Du(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Cl(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function nc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function ed(t,e,i){1===t&&i.readMessage(id,e)}function id(t,e,i){if(3===t){var s=i.readMessage(nd,{}),h=s.width,p=s.height,f=s.left,v=s.top,T=s.advance;e.push({id:s.id,bitmap:new ul({width:h+6,height:p+6},s.bitmap),metrics:{width:h,height:p,left:f,top:v,advance:T}})}}function nd(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}function rc(t){for(var e=0,i=0,s=0,h=t;s<h.length;s+=1){var p=h[s];e+=p.w*p.h,i=Math.max(i,p.w)}t.sort(function(Y,at){return at.h-Y.h});for(var f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}],v=0,T=0,E=0,C=t;E<C.length;E+=1)for(var k=C[E],B=f.length-1;B>=0;B--){var U=f[B];if(!(k.w>U.w||k.h>U.h)){if(k.x=U.x,k.y=U.y,T=Math.max(T,k.y+k.h),v=Math.max(v,k.x+k.w),k.w===U.w&&k.h===U.h){var J=f.pop();B<f.length&&(f[B]=J)}else k.h===U.h?(U.x+=k.w,U.w-=k.w):k.w===U.w?(U.y+=k.h,U.h-=k.h):(f.push({x:U.x+k.w,y:U.y,w:U.w-k.w,h:k.h}),U.y+=k.h,U.h-=k.h);break}}return{w:v,h:T,fill:e/(v*T)||0}}an.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),h=s>>3,p=this.pos;this.type=7&s,t(h,e,this),this.pos===p&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Du(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=nc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Du(this.buf,this.pos)+4294967296*Du(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Du(this.buf,this.pos)+4294967296*nc(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Qh(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Qh(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,s=this.buf;return e=127&(i=s[this.pos++]),i<128?e:(e|=(127&(i=s[this.pos++]))<<7,i<128?e:(e|=(127&(i=s[this.pos++]))<<14,i<128?e:(e|=(127&(i=s[this.pos++]))<<21,i<128?e:function(h,p,f){var v,T,E=f.buf;if(v=(112&(T=E[f.pos++]))>>4,T<128||(v|=(127&(T=E[f.pos++]))<<3,T<128)||(v|=(127&(T=E[f.pos++]))<<10,T<128)||(v|=(127&(T=E[f.pos++]))<<17,T<128)||(v|=(127&(T=E[f.pos++]))<<24,T<128)||(v|=(1&(T=E[f.pos++]))<<31,T<128))return function Il(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}(h,v,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&ec?ec.decode(this.buf.subarray(e,t)):function(i,s,h){for(var p="",f=s;f<h;){var v,T,E,C=i[f],k=null,B=C>239?4:C>223?3:C>191?2:1;if(f+B>h)break;1===B?C<128&&(k=C):2===B?128==(192&(v=i[f+1]))&&(k=(31&C)<<6|63&v)<=127&&(k=null):3===B?(T=i[f+2],128==(192&(v=i[f+1]))&&128==(192&T)&&((k=(15&C)<<12|(63&v)<<6|63&T)<=2047||k>=55296&&k<=57343)&&(k=null)):4===B&&(T=i[f+2],E=i[f+3],128==(192&(v=i[f+1]))&&128==(192&T)&&128==(192&E)&&((k=(15&C)<<18|(63&v)<<12|(63&T)<<6|63&E)<=65535||k>=1114112)&&(k=null)),null===k?(k=65533,B=1):k>65535&&(k-=65536,p+=String.fromCharCode(k>>>10&1023|55296),k=56320|1023&k),p+=String.fromCharCode(k),f+=B}return p}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==an.Bytes)return t.push(this.readVarint(e));var i=Ds(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==an.Bytes)return t.push(this.readSVarint());var e=Ds(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==an.Bytes)return t.push(this.readBoolean());var e=Ds(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==an.Bytes)return t.push(this.readFloat());var e=Ds(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==an.Bytes)return t.push(this.readDouble());var e=Ds(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==an.Bytes)return t.push(this.readFixed32());var e=Ds(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==an.Bytes)return t.push(this.readSFixed32());var e=Ds(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==an.Bytes)return t.push(this.readFixed64());var e=Ds(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==an.Bytes)return t.push(this.readSFixed64());var e=Ds(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===an.Varint)for(;this.buf[this.pos++]>127;);else if(e===an.Bytes)this.pos=this.readVarint()+this.pos;else if(e===an.Fixed32)this.pos+=4;else{if(e!==an.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Cl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Cl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Cl(this.buf,-1&t,this.pos),Cl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Cl(this.buf,-1&t,this.pos),Cl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,i){var s,h,p,v;if(e>=0?(s=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,h=h+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),p=s,(v=i).buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,v.buf[v.pos]=127&(p>>>=7),function(p,f){var v=(7&p)<<4;f.buf[f.pos++]|=v|((p>>>=3)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p|((p>>>=7)?128:0),p&&(f.buf[f.pos++]=127&p)))))}(h,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,h,p){for(var f,v,T=0;T<h.length;T++){if((f=h.charCodeAt(T))>55295&&f<57344){if(!v){f>56319||T+1===h.length?(s[p++]=239,s[p++]=191,s[p++]=189):v=f;continue}if(f<56320){s[p++]=239,s[p++]=191,s[p++]=189,v=f;continue}f=v-55296<<10|f-56320|65536,v=null}else v&&(s[p++]=239,s[p++]=191,s[p++]=189,v=null);f<128?s[p++]=f:(f<2048?s[p++]=f>>6|192:(f<65536?s[p++]=f>>12|224:(s[p++]=f>>18|240,s[p++]=f>>12&63|128),s[p++]=f>>6&63|128),s[p++]=63&f|128)}return p}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&ic(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),tc(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),tc(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var s=this.pos-i;s>=128&&ic(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,i){this.writeTag(t,an.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Wp,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Hp,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Jp,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Xp,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Kp,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Yp,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,$p,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Qp,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,td,e)},writeBytesField:function(t,e){this.writeTag(t,an.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,an.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,an.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,an.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,an.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,an.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,an.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,an.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,an.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,an.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Ou=function(t,e){var i=e.pixelRatio,s=e.version,h=e.stretchX,p=e.stretchY,f=e.content;this.paddedRect=t,this.pixelRatio=i,this.stretchX=h,this.stretchY=p,this.content=f,this.version=s},uu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};uu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},uu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},uu.tlbr.get=function(){return this.tl.concat(this.br)},uu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Ou.prototype,uu);var hu=function(t,e){var i={},s={};this.haveRenderCallbacks=[];var h=[];this.addImages(t,i,h),this.addImages(e,s,h);var p=rc(h),f=new qo({width:p.w||1,height:p.h||1});for(var v in t){var T=t[v],E=i[v].paddedRect;qo.copy(T.data,f,{x:0,y:0},{x:E.x+1,y:E.y+1},T.data)}for(var C in e){var k=e[C],B=s[C].paddedRect,U=B.x+1,J=B.y+1,Y=k.data.width,at=k.data.height;qo.copy(k.data,f,{x:0,y:0},{x:U,y:J},k.data),qo.copy(k.data,f,{x:0,y:at-1},{x:U,y:J-1},{width:Y,height:1}),qo.copy(k.data,f,{x:0,y:0},{x:U,y:J+at},{width:Y,height:1}),qo.copy(k.data,f,{x:Y-1,y:0},{x:U-1,y:J},{width:1,height:at}),qo.copy(k.data,f,{x:0,y:0},{x:U+Y,y:J},{width:1,height:at})}this.image=f,this.iconPositions=i,this.patternPositions=s};hu.prototype.addImages=function(t,e,i){for(var s in t){var h=t[s],p={x:0,y:0,w:h.data.width+2,h:h.data.height+2};i.push(p),e[s]=new Ou(p,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(s)}},hu.prototype.patchUpdatedImages=function(t,e){for(var i in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)},hu.prototype.patchUpdatedImage=function(t,e,i){if(t&&e&&t.version!==e.version){t.version=e.version;var s=t.tl;i.update(e.data,void 0,{x:s[0],y:s[1]})}},Zt("ImagePosition",Ou),Zt("ImageAtlas",hu);var da={horizontal:1,vertical:2,horizontalOnly:3},Ll=function(){this.scale=1,this.fontStack="",this.imageName=null};Ll.forText=function(t,e){var i=new Ll;return i.scale=t||1,i.fontStack=e,i},Ll.forImage=function(t){var e=new Ll;return e.imageName=t,e};var xo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Bu(t,e,i,s,h,p,f,v,T,E,C,k,B,U,J,Y){var at,it=xo.fromFeature(t,h);k===da.vertical&&it.verticalizePunctuation();var pt=co.processBidirectionalText,gt=co.processStyledBidirectionalText;if(pt&&1===it.sections.length){at=[];for(var xt=0,St=pt(it.toString(),gh(it,E,p,e,s,U,J));xt<St.length;xt+=1){var zt=St[xt],qt=new xo;qt.text=zt,qt.sections=it.sections;for(var Qt=0;Qt<zt.length;Qt++)qt.sectionIndex.push(0);at.push(qt)}}else if(gt){at=[];for(var _e=0,oe=gt(it.text,it.sectionIndex,gh(it,E,p,e,s,U,J));_e<oe.length;_e+=1){var ve=oe[_e],ae=new xo;ae.text=ve[0],ae.sectionIndex=ve[1],ae.sections=it.sections,at.push(ae)}}else at=function(pe,ai){for(var He=[],yi=pe.text,xe=0,Ci=0,xn=ai;Ci<xn.length;Ci+=1){var Vn=xn[Ci];He.push(pe.substring(xe,Vn)),xe=Vn}return xe<yi.length&&He.push(pe.substring(xe,yi.length)),He}(it,gh(it,E,p,e,s,U,J));var Qe=[],Ie={positionedLines:Qe,text:it.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:k,iconsInText:!1,verticalizable:!1};return function(pe,ai,He,yi,xe,Ci,xn,Vn,kn,bn,qn,Ir){for(var Cr=0,bo=-17,Zr=0,wo=0,$n="right"===Vn?1:"left"===Vn?0:.5,Vr=0,hi=0,$i=xe;hi<$i.length;hi+=1){var Wi=$i[hi];Wi.trim();var bi=Wi.getMaxScale(),Mo=24*(bi-1),fo={positionedGlyphs:[],lineOffset:0};pe.positionedLines[Vr]=fo;var pn=fo.positionedGlyphs,sr=0;if(Wi.length()){for(var mo=0;mo<Wi.length();mo++){var Li=Wi.getSection(mo),xs=Wi.getSectionIndex(mo),fa=Wi.getCharCode(mo),bs=0,Qn=null,ws=null,qa=null,Fl=24,dl=!(kn===da.horizontal||!qn&&!Co(fa)||qn&&(Ru[fa]||(Fs=fa,Vt.Arabic(Fs)||Vt["Arabic Supplement"](Fs)||Vt["Arabic Extended-A"](Fs)||Vt["Arabic Presentation Forms-A"](Fs)||Vt["Arabic Presentation Forms-B"](Fs))));if(Li.imageName){var Ul=yi[Li.imageName];if(!Ul)continue;qa=Li.imageName,pe.iconsInText=pe.iconsInText||!0,ws=Ul.paddedRect;var Rs=Ul.displaySize;Li.scale=24*Li.scale/Ir,bs=Mo+(24-Rs[1]*Li.scale),Fl=(Qn={width:Rs[0],height:Rs[1],left:1,top:-3,advance:dl?Rs[1]:Rs[0]}).advance;var Nl=dl?Rs[0]*Li.scale-24*bi:Rs[1]*Li.scale-24*bi;Nl>0&&Nl>sr&&(sr=Nl)}else{var Wu=He[Li.fontStack],jl=Wu&&Wu[fa];if(jl&&jl.rect)ws=jl.rect,Qn=jl.metrics;else{var du=ai[Li.fontStack],Hu=du&&du[fa];if(!Hu)continue;Qn=Hu.metrics}bs=24*(bi-Li.scale)}dl?(pe.verticalizable=!0,pn.push({glyph:fa,imageName:qa,x:Cr,y:bo+bs,vertical:dl,scale:Li.scale,fontStack:Li.fontStack,sectionIndex:xs,metrics:Qn,rect:ws}),Cr+=Fl*Li.scale+bn):(pn.push({glyph:fa,imageName:qa,x:Cr,y:bo+bs,vertical:dl,scale:Li.scale,fontStack:Li.fontStack,sectionIndex:xs,metrics:Qn,rect:ws}),Cr+=Qn.advance*Li.scale+bn)}0!==pn.length&&(Zr=Math.max(Cr-bn,Zr),od(pn,0,pn.length-1,$n,sr)),Cr=0;var Xu=Ci*bi+sr;fo.lineOffset=Math.max(sr,Mo),bo+=Xu,wo=Math.max(Xu,wo),++Vr}else bo+=Ci,++Vr}var Fs,fu=bo- -17,Zl=vh(xn),Ys=Zl.horizontalAlign,Vl=Zl.verticalAlign;(function(Ku,Ju,mu,_u,Yu,yu,gu,vu,$u){var ql,Qu=(Ju-mu)*Yu;ql=yu!==gu?-vu*_u- -17:(-_u*$u+.5)*gu;for(var Gl=0,xu=Ku;Gl<xu.length;Gl+=1)for(var fl=0,bu=xu[Gl].positionedGlyphs;fl<bu.length;fl+=1){var Wl=bu[fl];Wl.x+=Qu,Wl.y+=ql}})(pe.positionedLines,$n,Ys,Vl,Zr,wo,Ci,fu,xe.length),pe.top+=-Vl*fu,pe.bottom=pe.top+fu,pe.left+=-Ys*Zr,pe.right=pe.left+Zr}(Ie,e,i,s,at,f,v,T,k,E,B,Y),!function(pe){for(var ai=0,He=pe;ai<He.length;ai+=1)if(0!==He[ai].positionedGlyphs.length)return!1;return!0}(Qe)&&Ie}xo.fromFeature=function(t,e){for(var i=new xo,s=0;s<t.sections.length;s++){var h=t.sections[s];h.image?i.addImageSection(h):i.addTextSection(h,e)}return i},xo.prototype.length=function(){return this.text.length},xo.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},xo.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},xo.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},xo.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",i=0;i<t.length;i++){var s=t.charCodeAt(i+1)||null,h=t.charCodeAt(i-1)||null;e+=s&&Ra(s)&&!lu[t[i+1]]||h&&Ra(h)&&!lu[t[i-1]]||!lu[t[i]]?t[i]:lu[t[i]]}return e}(this.text)},xo.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&Ru[this.text.charCodeAt(e)];e++)t++;for(var i=this.text.length,s=this.text.length-1;s>=0&&s>=t&&Ru[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)},xo.prototype.substring=function(t,e){var i=new xo;return i.text=this.text.substring(t,e),i.sectionIndex=this.sectionIndex.slice(t,e),i.sections=this.sections,i},xo.prototype.toString=function(){return this.text},xo.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,i){return Math.max(e,t.sections[i].scale)},0)},xo.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(Ll.forText(t.scale,t.fontStack||e));for(var i=this.sections.length-1,s=0;s<t.text.length;++s)this.sectionIndex.push(i)},xo.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(Ll.forImage(e)),this.sectionIndex.push(this.sections.length-1)):Ri("Reached maximum number of images 6401")}else Ri("Can't add FormattedSection with an empty image.")},xo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Ru={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ra={};function oc(t,e,i,s,h,p){if(e.imageName){var f=s[e.imageName];return f?f.displaySize[0]*e.scale*24/p+h:0}var v=i[e.fontStack],T=v&&v[t];return T?T.metrics.advance*e.scale+h:0}function ac(t,e,i,s){var h=Math.pow(t-e,2);return s?t<e?h/2:2*h:h+Math.abs(i)*i}function rd(t,e,i){var s=0;return 10===t&&(s-=1e4),i&&(s+=150),40!==t&&65288!==t||(s+=50),41!==e&&65289!==e||(s+=50),s}function sc(t,e,i,s,h,p){for(var f=null,v=ac(e,i,h,p),T=0,E=s;T<E.length;T+=1){var C=E[T],k=ac(e-C.x,i,h,p)+C.badness;k<=v&&(f=C,v=k)}return{index:t,x:e,priorBreak:f,badness:v}}function gh(t,e,i,s,h,p,f){if("point"!==p)return[];if(!t)return[];for(var v,T=[],E=function(at,it,pt,gt,xt,St){for(var zt=0,qt=0;qt<at.length();qt++){var Qt=at.getSection(qt);zt+=oc(at.getCharCode(qt),Qt,gt,xt,it,St)}return zt/Math.max(1,Math.ceil(zt/pt))}(t,e,i,s,h,f),C=t.text.indexOf("\u200b")>=0,k=0,B=0;B<t.length();B++){var U=t.getSection(B),J=t.getCharCode(B);if(Ru[J]||(k+=oc(J,U,s,h,e,f)),B<t.length()-1){var Y=!((v=J)<11904||!(Vt["Bopomofo Extended"](v)||Vt.Bopomofo(v)||Vt["CJK Compatibility Forms"](v)||Vt["CJK Compatibility Ideographs"](v)||Vt["CJK Compatibility"](v)||Vt["CJK Radicals Supplement"](v)||Vt["CJK Strokes"](v)||Vt["CJK Symbols and Punctuation"](v)||Vt["CJK Unified Ideographs Extension A"](v)||Vt["CJK Unified Ideographs"](v)||Vt["Enclosed CJK Letters and Months"](v)||Vt["Halfwidth and Fullwidth Forms"](v)||Vt.Hiragana(v)||Vt["Ideographic Description Characters"](v)||Vt["Kangxi Radicals"](v)||Vt["Katakana Phonetic Extensions"](v)||Vt.Katakana(v)||Vt["Vertical Forms"](v)||Vt["Yi Radicals"](v)||Vt["Yi Syllables"](v)));(ra[J]||Y||U.imageName)&&T.push(sc(B+1,k,E,T,rd(J,t.getCharCode(B+1),Y&&C),!1))}}return function at(it){return it?at(it.priorBreak).concat(it.index):[]}(sc(t.length(),k,E,T,0,!0))}function vh(t){var e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function od(t,e,i,s,h){if(s||h)for(var p=t[i],f=(t[i].x+p.metrics.advance*p.scale)*s,v=e;v<=i;v++)t[v].x-=f,t[v].y+=h}function lc(t,e,i,s,h,p){var f,v=t.image;if(v.content){var T=v.content,E=v.pixelRatio||1;f=[T[0]/E,T[1]/E,v.displaySize[0]-T[2]/E,v.displaySize[1]-T[3]/E]}var C,k,B,U,J=e.left*p,Y=e.right*p;"width"===i||"both"===i?(U=h[0]+J-s[3],k=h[0]+Y+s[1]):k=(U=h[0]+(J+Y-v.displaySize[0])/2)+v.displaySize[0];var at=e.top*p,it=e.bottom*p;return"height"===i||"both"===i?(C=h[1]+at-s[0],B=h[1]+it+s[2]):B=(C=h[1]+(at+it-v.displaySize[1])/2)+v.displaySize[1],{image:v,top:C,right:k,bottom:B,left:U,collisionPadding:f}}ra[10]=!0,ra[32]=!0,ra[38]=!0,ra[40]=!0,ra[41]=!0,ra[43]=!0,ra[45]=!0,ra[47]=!0,ra[173]=!0,ra[183]=!0,ra[8203]=!0,ra[8208]=!0,ra[8211]=!0,ra[8231]=!0;var zl=function(t){function e(i,s,h,p){t.call(this,i,s),this.angle=h,void 0!==p&&(this.segment=p)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(le);function xh(t,e){var i=e.expression;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new oi(t+1))};if("source"===i.kind)return{kind:"source"};for(var s=i.zoomStops,h=i.interpolationType,p=0;p<s.length&&s[p]<=t;)p++;for(var f=p=Math.max(0,p-1);f<s.length&&s[f]<t+1;)f++;f=Math.min(s.length-1,f);var v=s[p],T=s[f];return"composite"===i.kind?{kind:"composite",minZoom:v,maxZoom:T,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:T,minSize:i.evaluate(new oi(v)),maxSize:i.evaluate(new oi(T)),interpolationType:h}}function uc(t,e,i){var s=e.uSize,h=i.lowerSize;return"source"===t.kind?h/128:"composite"===t.kind?cn(h/128,i.upperSize/128,e.uSizeT):s}function hc(t,e){var i=0,s=0;if("constant"===t.kind)s=t.layoutSize;else if("source"!==t.kind){var h=t.interpolationType,p=h?er(Nn.interpolationFactor(h,e,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?s=cn(t.minSize,t.maxSize,p):i=p}return{uSizeT:i,uSize:s}}Zt("Anchor",zl);var ad=Object.freeze({__proto__:null,getSizeData:xh,evaluateSizeForFeature:uc,evaluateSizeForZoom:hc,SIZE_PACK_FACTOR:128});function cc(t,e,i,s,h){if(void 0===e.segment)return!0;for(var p=e,f=e.segment+1,v=0;v>-i/2;){if(--f<0)return!1;v-=t[f].dist(p),p=t[f]}v+=t[f].dist(t[f+1]),f++;for(var T=[],E=0;v<i/2;){var C=t[f],k=t[f+1];if(!k)return!1;var B=t[f-1].angleTo(C)-C.angleTo(k);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:v,angleDelta:B}),E+=B;v-T[0].distance>s;)E-=T.shift().angleDelta;if(E>h)return!1;f++,v+=C.dist(k)}return!0}function pc(t){for(var e=0,i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function dc(t,e,i){return t?.6*e*i:0}function fc(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function sd(t,e,i,s,h,p){for(var f=dc(i,h,p),v=fc(i,s)*p,T=0,E=pc(t)/2,C=0;C<t.length-1;C++){var k=t[C],B=t[C+1],U=k.dist(B);if(T+U>E){var J=(E-T)/U,Y=cn(k.x,B.x,J),at=cn(k.y,B.y,J),it=new zl(Y,at,B.angleTo(k),C);return it._round(),!f||cc(t,it,v,f,e)?it:void 0}T+=U}}function ld(t,e,i,s,h,p,f,v,T){var E=dc(s,p,f),C=fc(s,h),k=C*f,B=0===t[0].x||t[0].x===T||0===t[0].y||t[0].y===T;return e-k<e/4&&(e=k+e/4),function U(J,Y,at,it,pt,gt,xt,St,zt){for(var qt=gt/2,Qt=pc(J),_e=0,oe=Y-at,ve=[],ae=0;ae<J.length-1;ae++){for(var Qe=J[ae],Ie=J[ae+1],pe=Qe.dist(Ie),ai=Ie.angleTo(Qe);oe+at<_e+pe;){var He=((oe+=at)-_e)/pe,yi=cn(Qe.x,Ie.x,He),xe=cn(Qe.y,Ie.y,He);if(yi>=0&&yi<zt&&xe>=0&&xe<zt&&oe-qt>=0&&oe+qt<=Qt){var Ci=new zl(yi,xe,ai,ae);Ci._round(),it&&!cc(J,Ci,gt,it,pt)||ve.push(Ci)}}_e+=pe}return St||ve.length||xt||(ve=U(J,_e/2,at,it,pt,gt,xt,!0,zt)),ve}(t,B?e/2*v%e:(C/2+2*p)*f*v%e,e,E,i,k,B,!1,T)}function mc(t,e,i,s,h){for(var p=[],f=0;f<t.length;f++)for(var v=t[f],T=void 0,E=0;E<v.length-1;E++){var C=v[E],k=v[E+1];C.x<e&&k.x<e||(C.x<e?C=new le(e,C.y+(e-C.x)/(k.x-C.x)*(k.y-C.y))._round():k.x<e&&(k=new le(e,C.y+(e-C.x)/(k.x-C.x)*(k.y-C.y))._round()),C.y<i&&k.y<i||(C.y<i?C=new le(C.x+(i-C.y)/(k.y-C.y)*(k.x-C.x),i)._round():k.y<i&&(k=new le(C.x+(i-C.y)/(k.y-C.y)*(k.x-C.x),i)._round()),C.x>=s&&k.x>=s||(C.x>=s?C=new le(s,C.y+(s-C.x)/(k.x-C.x)*(k.y-C.y))._round():k.x>=s&&(k=new le(s,C.y+(s-C.x)/(k.x-C.x)*(k.y-C.y))._round()),C.y>=h&&k.y>=h||(C.y>=h?C=new le(C.x+(h-C.y)/(k.y-C.y)*(k.x-C.x),h)._round():k.y>=h&&(k=new le(C.x+(h-C.y)/(k.y-C.y)*(k.x-C.x),h)._round()),T&&C.equals(T[T.length-1])||p.push(T=[C]),T.push(k)))))}return p}function _c(t,e,i,s){var h=[],p=t.image,f=p.pixelRatio,v=p.paddedRect.w-2,T=p.paddedRect.h-2,E=t.right-t.left,C=t.bottom-t.top,k=p.stretchX||[[0,v]],B=p.stretchY||[[0,T]],U=function(yi,xe){return yi+xe[1]-xe[0]},J=k.reduce(U,0),Y=B.reduce(U,0),at=v-J,it=T-Y,pt=0,gt=J,xt=0,St=Y,zt=0,qt=at,Qt=0,_e=it;if(p.content&&s){var oe=p.content;pt=Fu(k,0,oe[0]),xt=Fu(B,0,oe[1]),gt=Fu(k,oe[0],oe[2]),St=Fu(B,oe[1],oe[3]),zt=oe[0]-pt,Qt=oe[1]-xt,qt=oe[2]-oe[0]-gt,_e=oe[3]-oe[1]-St}var ve=function(yi,xe,Ci,xn){var Vn=Uu(yi.stretch-pt,gt,E,t.left),kn=Nu(yi.fixed-zt,qt,yi.stretch,J),bn=Uu(xe.stretch-xt,St,C,t.top),qn=Nu(xe.fixed-Qt,_e,xe.stretch,Y),Ir=Uu(Ci.stretch-pt,gt,E,t.left),Cr=Nu(Ci.fixed-zt,qt,Ci.stretch,J),bo=Uu(xn.stretch-xt,St,C,t.top),Zr=Nu(xn.fixed-Qt,_e,xn.stretch,Y),wo=new le(Vn,bn),$n=new le(Ir,bn),Vr=new le(Ir,bo),hi=new le(Vn,bo),$i=new le(kn/f,qn/f),Wi=new le(Cr/f,Zr/f),bi=e*Math.PI/180;if(bi){var Mo=Math.sin(bi),fo=Math.cos(bi),pn=[fo,-Mo,Mo,fo];wo._matMult(pn),$n._matMult(pn),hi._matMult(pn),Vr._matMult(pn)}var sr=yi.stretch+yi.fixed,mo=xe.stretch+xe.fixed;return{tl:wo,tr:$n,bl:hi,br:Vr,tex:{x:p.paddedRect.x+1+sr,y:p.paddedRect.y+1+mo,w:Ci.stretch+Ci.fixed-sr,h:xn.stretch+xn.fixed-mo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$i,pixelOffsetBR:Wi,minFontScaleX:qt/f/E,minFontScaleY:_e/f/C,isSDF:i}};if(s&&(p.stretchX||p.stretchY))for(var ae=yc(k,at,J),Qe=yc(B,it,Y),Ie=0;Ie<ae.length-1;Ie++)for(var pe=ae[Ie],ai=ae[Ie+1],He=0;He<Qe.length-1;He++)h.push(ve(pe,Qe[He],ai,Qe[He+1]));else h.push(ve({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:T+1}));return h}function Fu(t,e,i){for(var s=0,h=0,p=t;h<p.length;h+=1){var f=p[h];s+=Math.max(e,Math.min(i,f[1]))-Math.max(e,Math.min(i,f[0]))}return s}function yc(t,e,i){for(var s=[{fixed:-1,stretch:0}],h=0,p=t;h<p.length;h+=1){var f=p[h],v=f[0],T=f[1],E=s[s.length-1];s.push({fixed:v-E.stretch,stretch:E.stretch}),s.push({fixed:v-E.stretch,stretch:E.stretch+(T-v)})}return s.push({fixed:e+1,stretch:i}),s}function Uu(t,e,i,s){return t/e*i+s}function Nu(t,e,i,s){return t-e*i/s}var ju=function(t,e,i,s,h,p,f,v,T,E){if(this.boxStartIndex=t.length,T){var C=p.top,k=p.bottom,B=p.collisionPadding;B&&(C-=B[1],k+=B[3]);var U=k-C;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{var J=p.top*f-v,Y=p.bottom*f+v,at=p.left*f-v,it=p.right*f+v,pt=p.collisionPadding;if(pt&&(at-=pt[0]*f,J-=pt[1]*f,it+=pt[2]*f,Y+=pt[3]*f),E){var gt=new le(at,J),xt=new le(it,J),St=new le(at,Y),zt=new le(it,Y),qt=E*Math.PI/180;gt._rotate(qt),xt._rotate(qt),St._rotate(qt),zt._rotate(qt),at=Math.min(gt.x,xt.x,St.x,zt.x),it=Math.max(gt.x,xt.x,St.x,zt.x),J=Math.min(gt.y,xt.y,St.y,zt.y),Y=Math.max(gt.y,xt.y,St.y,zt.y)}t.emplaceBack(e.x,e.y,at,J,it,Y,i,s,h)}this.boxEndIndex=t.length},kl=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=ud),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function ud(t,e){return t<e?-1:t>e?1:0}function hd(t,e,i){void 0===e&&(e=1),void 0===i&&(i=!1);for(var s=1/0,h=1/0,p=-1/0,f=-1/0,v=t[0],T=0;T<v.length;T++){var E=v[T];(!T||E.x<s)&&(s=E.x),(!T||E.y<h)&&(h=E.y),(!T||E.x>p)&&(p=E.x),(!T||E.y>f)&&(f=E.y)}var C=Math.min(p-s,f-h),k=C/2,B=new kl([],cd);if(0===C)return new le(s,h);for(var U=s;U<p;U+=C)for(var J=h;J<f;J+=C)B.push(new Ml(U+k,J+k,k,t));for(var Y=function(pt){for(var gt=0,xt=0,St=0,zt=pt[0],qt=0,Qt=zt.length,_e=Qt-1;qt<Qt;_e=qt++){var oe=zt[qt],ve=zt[_e],ae=oe.x*ve.y-ve.x*oe.y;xt+=(oe.x+ve.x)*ae,St+=(oe.y+ve.y)*ae,gt+=3*ae}return new Ml(xt/gt,St/gt,0,pt)}(t),at=B.length;B.length;){var it=B.pop();(it.d>Y.d||!Y.d)&&(Y=it,i&&console.log("found best %d after %d probes",Math.round(1e4*it.d)/1e4,at)),it.max-Y.d<=e||(B.push(new Ml(it.p.x-(k=it.h/2),it.p.y-k,k,t)),B.push(new Ml(it.p.x+k,it.p.y-k,k,t)),B.push(new Ml(it.p.x-k,it.p.y+k,k,t)),B.push(new Ml(it.p.x+k,it.p.y+k,k,t)),at+=4)}return i&&(console.log("num probes: "+at),console.log("best distance: "+Y.d)),Y.p}function cd(t,e){return e.max-t.max}function Ml(t,e,i,s){this.p=new le(t,e),this.h=i,this.d=function(h,p){for(var f=!1,v=1/0,T=0;T<p.length;T++)for(var E=p[T],C=0,k=E.length,B=k-1;C<k;B=C++){var U=E[C],J=E[B];U.y>h.y!=J.y>h.y&&h.x<(J.x-U.x)*(h.y-U.y)/(J.y-U.y)+U.x&&(f=!f),v=Math.min(v,Hs(h,U,J))}return(f?1:-1)*Math.sqrt(v)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}kl.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},kl.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},kl.prototype.peek=function(){return this.data[0]},kl.prototype._up=function(t){for(var e=this.data,i=this.compare,s=e[t];t>0;){var h=t-1>>1,p=e[h];if(i(s,p)>=0)break;e[t]=p,t=h}e[t]=s},kl.prototype._down=function(t){for(var e=this.data,i=this.compare,s=this.length>>1,h=e[t];t<s;){var p=1+(t<<1),f=e[p],v=p+1;if(v<this.length&&i(e[v],f)<0&&(p=v,f=e[v]),i(f,h)>=0)break;e[t]=f,t=p}e[t]=h};var bh=Number.POSITIVE_INFINITY;function gc(t,e){return e[1]!==bh?function(i,s,h){var p=0,f=0;switch(s=Math.abs(s),h=Math.abs(h),i){case"top-right":case"top-left":case"top":f=h-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-h}switch(i){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}return[p,f]}(t,e[0],e[1]):function(i,s){var h=0,p=0;s<0&&(s=0);var f=s/Math.sqrt(2);switch(i){case"top-right":case"top-left":p=f-7;break;case"bottom-right":case"bottom-left":p=7-f;break;case"bottom":p=7-s;break;case"top":p=s-7}switch(i){case"top-right":case"bottom-right":h=-f;break;case"top-left":case"bottom-left":h=f;break;case"left":h=s;break;case"right":h=-s}return[h,p]}(t,e[0])}function wh(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vc(t,e,i,s,h,p,f,v,T,E,C,k,B,U,J){var Y=function(xt,St,zt,qt,Qt,_e,oe,ve){for(var ae=qt.layout.get("text-rotate").evaluate(_e,{})*Math.PI/180,Qe=[],Ie=0,pe=St.positionedLines;Ie<pe.length;Ie+=1)for(var ai=pe[Ie],He=0,yi=ai.positionedGlyphs;He<yi.length;He+=1){var xe=yi[He];if(xe.rect){var Ci=xe.rect||{},xn=4,Vn=!0,kn=1,bn=0,qn=(Qt||ve)&&xe.vertical,Ir=xe.metrics.advance*xe.scale/2;if(ve&&St.verticalizable&&(bn=ai.lineOffset/2-(xe.imageName?-(24-xe.metrics.width*xe.scale)/2:24*(xe.scale-1))),xe.imageName){var Cr=oe[xe.imageName];Vn=Cr.sdf,xn=1/(kn=Cr.pixelRatio)}var bo=Qt?[xe.x+Ir,xe.y]:[0,0],Zr=Qt?[0,0]:[xe.x+Ir+zt[0],xe.y+zt[1]-bn],wo=[0,0];qn&&(wo=Zr,Zr=[0,0]);var $n=(xe.metrics.left-xn)*xe.scale-Ir+Zr[0],Vr=(-xe.metrics.top-xn)*xe.scale+Zr[1],hi=$n+Ci.w*xe.scale/kn,$i=Vr+Ci.h*xe.scale/kn,Wi=new le($n,Vr),bi=new le(hi,Vr),Mo=new le($n,$i),fo=new le(hi,$i);if(qn){var pn=new le(-Ir,Ir- -17),sr=-Math.PI/2,mo=12-Ir,Li=new le(22-mo,-(xe.imageName?mo:0)),xs=new(Function.prototype.bind.apply(le,[null].concat(wo)));Wi._rotateAround(sr,pn)._add(Li)._add(xs),bi._rotateAround(sr,pn)._add(Li)._add(xs),Mo._rotateAround(sr,pn)._add(Li)._add(xs),fo._rotateAround(sr,pn)._add(Li)._add(xs)}if(ae){var fa=Math.sin(ae),bs=Math.cos(ae),Qn=[bs,-fa,fa,bs];Wi._matMult(Qn),bi._matMult(Qn),Mo._matMult(Qn),fo._matMult(Qn)}var ws=new le(0,0),qa=new le(0,0);Qe.push({tl:Wi,tr:bi,bl:Mo,br:fo,tex:Ci,writingMode:St.writingMode,glyphOffset:bo,sectionIndex:xe.sectionIndex,isSDF:Vn,pixelOffsetTL:ws,pixelOffsetBR:qa,minFontScaleX:0,minFontScaleY:0})}}return Qe}(0,i,v,h,p,f,s,t.allowVerticalPlacement),at=t.textSizeData,it=null;"source"===at.kind?(it=[128*h.layout.get("text-size").evaluate(f,{})])[0]>32640&&Ri(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===at.kind&&((it=[128*U.compositeTextSizes[0].evaluate(f,{},J),128*U.compositeTextSizes[1].evaluate(f,{},J)])[0]>32640||it[1]>32640)&&Ri(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,Y,it,v,p,f,E,e,T.lineStartIndex,T.lineLength,B,J);for(var pt=0,gt=C;pt<gt.length;pt+=1)k[gt[pt]]=t.text.placedSymbolArray.length-1;return 4*Y.length}function xc(t){for(var e in t)return t[e];return null}function pd(t,e,i,s){var h=t.compareText;if(e in h){for(var p=h[e],f=p.length-1;f>=0;f--)if(s.dist(p[f])<i)return!0}else h[e]=[];return h[e].push(s),!1}var dd=Al.VectorTileFeature.types,fd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Zu(t,e,i,s,h,p,f,v,T,E,C,k,B){var U=v?Math.min(32640,Math.round(v[0])):0,J=v?Math.min(32640,Math.round(v[1])):0;t.emplaceBack(e,i,Math.round(32*s),Math.round(32*h),p,f,(U<<1)+(T?1:0),J,16*E,16*C,256*k,256*B)}function Th(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function md(t){for(var e=0,i=t.sections;e<i.length;e+=1)if(Er(i[e].text))return!0;return!1}var Dl=function(t){this.layoutVertexArray=new xl,this.indexArray=new fs,this.programConfigurations=t,this.segments=new Z,this.dynamicLayoutVertexArray=new qs,this.opacityVertexArray=new nl,this.placedSymbolArray=new l};Dl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Dl.prototype.upload=function(t,e,i,s){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,jp.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Zp.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,fd,!0),this.opacityVertexBuffer.itemSize=1),(i||s)&&this.programConfigurations.upload(t))},Dl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Zt("SymbolBuffers",Dl);var cu=function(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new Z,this.collisionVertexArray=new Ql};cu.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Vp.members,!0)},cu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Zt("CollisionBuffers",cu);var Ji=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(p){return p.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=na([]),this.placementViewportMatrix=na([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=xh(this.zoom,e["text-size"]),this.iconSizeData=xh(this.zoom,e["icon-size"]);var i=this.layers[0].layout,s=i.get("symbol-sort-key"),h=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==h&&void 0!==s.constantOr(1),this.sortFeaturesByY=("viewport-y"===h||"auto"===h&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map(function(p){return da[p]})),this.stateDependentLayerIds=this.layers.filter(function(p){return p.isStateDependent()}).map(function(p){return p.id}),this.sourceID=t.sourceID};Ji.prototype.createArrays=function(){this.text=new Dl(new Pe(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new Dl(new Pe(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new g,this.lineVertexArray=new w,this.symbolInstances=new _},Ji.prototype.calculateGlyphDependencies=function(t,e,i,s,h){for(var p=0;p<t.length;p++)if(e[t.charCodeAt(p)]=!0,(i||s)&&h){var f=lu[t.charAt(p)];f&&(e[f.charCodeAt(0)]=!0)}},Ji.prototype.populate=function(t,e,i){var s=this.layers[0],h=s.layout,p=h.get("text-font"),f=h.get("text-field"),v=h.get("icon-image"),T=("constant"!==f.value.kind||f.value.value instanceof Ai&&!f.value.value.isEmpty()||f.value.value.toString().length>0)&&("constant"!==p.value.kind||p.value.value.length>0),E="constant"!==v.value.kind||!!v.value.value||Object.keys(v.parameters).length>0,C=h.get("symbol-sort-key");if(this.features=[],T||E){for(var k=e.iconDependencies,B=e.glyphDependencies,U=e.availableImages,J=new oi(this.zoom),Y=0,at=t;Y<at.length;Y+=1){var it=at[Y],pt=it.feature,gt=it.id,xt=it.index,St=it.sourceLayerIndex,zt=s._featureFilter.needGeometry,qt=Yn(pt,zt);if(s._featureFilter.filter(J,qt,i)){zt||(qt.geometry=zn(pt));var Qt=void 0;if(T){var _e=s.getValueAndResolveTokens("text-field",qt,i,U),oe=Ai.factory(_e);md(oe)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===el()||this.hasRTLText&&co.isParsed())&&(Qt=Gp(oe,s,qt))}var ve=void 0;if(E){var ae=s.getValueAndResolveTokens("icon-image",qt,i,U);ve=ae instanceof nr?ae:nr.fromString(ae)}if(Qt||ve){var Qe=this.sortFeaturesByKey?C.evaluate(qt,{},i):void 0;if(this.features.push({id:gt,text:Qt,icon:ve,index:xt,sourceLayerIndex:St,geometry:qt.geometry,properties:pt.properties,type:dd[pt.type],sortKey:Qe}),ve&&(k[ve.name]=!0),Qt){var Ie=p.evaluate(qt,{},i).join(","),pe="map"===h.get("text-rotation-alignment")&&"point"!==h.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(da.vertical)>=0;for(var ai=0,He=Qt.sections;ai<He.length;ai+=1){var yi=He[ai];if(yi.image)k[yi.image.name]=!0;else{var xe=Uo(Qt.toString()),Ci=yi.fontStack||Ie,xn=B[Ci]=B[Ci]||{};this.calculateGlyphDependencies(yi.text,xn,pe,this.allowVerticalPlacement,xe)}}}}}}"line"===h.get("symbol-placement")&&(this.features=function(Vn){var kn={},bn={},qn=[],Ir=0;function Cr(pn){qn.push(Vn[pn]),Ir++}function bo(pn,sr,mo){var Li=bn[pn];return delete bn[pn],bn[sr]=Li,qn[Li].geometry[0].pop(),qn[Li].geometry[0]=qn[Li].geometry[0].concat(mo[0]),Li}function Zr(pn,sr,mo){var Li=kn[sr];return delete kn[sr],kn[pn]=Li,qn[Li].geometry[0].shift(),qn[Li].geometry[0]=mo[0].concat(qn[Li].geometry[0]),Li}function wo(pn,sr,mo){var Li=mo?sr[0][sr[0].length-1]:sr[0][0];return pn+":"+Li.x+":"+Li.y}for(var $n=0;$n<Vn.length;$n++){var Vr=Vn[$n],hi=Vr.geometry,$i=Vr.text?Vr.text.toString():null;if($i){var Wi=wo($i,hi),bi=wo($i,hi,!0);if(Wi in bn&&bi in kn&&bn[Wi]!==kn[bi]){var Mo=Zr(Wi,bi,hi),fo=bo(Wi,bi,qn[Mo].geometry);delete kn[Wi],delete bn[bi],bn[wo($i,qn[fo].geometry,!0)]=fo,qn[Mo].geometry=null}else Wi in bn?bo(Wi,bi,hi):bi in kn?Zr(Wi,bi,hi):(Cr($n),kn[Wi]=Ir-1,bn[bi]=Ir-1)}else Cr($n)}return qn.filter(function(pn){return pn.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Vn,kn){return Vn.sortKey-kn.sortKey})}},Ji.prototype.update=function(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))},Ji.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Ji.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Ji.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Ji.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Ji.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Ji.prototype.addToLineVertexArray=function(t,e){var i=this.lineVertexArray.length;if(void 0!==t.segment){for(var s=t.dist(e[t.segment+1]),h=t.dist(e[t.segment]),p={},f=t.segment+1;f<e.length;f++)p[f]={x:e[f].x,y:e[f].y,tileUnitDistanceFromAnchor:s},f<e.length-1&&(s+=e[f+1].dist(e[f]));for(var v=t.segment||0;v>=0;v--)p[v]={x:e[v].x,y:e[v].y,tileUnitDistanceFromAnchor:h},v>0&&(h+=e[v-1].dist(e[v]));for(var T=0;T<e.length;T++){var E=p[T];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Ji.prototype.addSymbols=function(t,e,i,s,h,p,f,v,T,E,C,k){for(var B=t.indexArray,U=t.layoutVertexArray,J=t.segments.prepareSegment(4*e.length,U,B,this.canOverlap?p.sortKey:void 0),Y=this.glyphOffsetArray.length,at=J.vertexLength,it=this.allowVerticalPlacement&&f===da.vertical?Math.PI/2:0,pt=p.text&&p.text.sections,gt=0;gt<e.length;gt++){var xt=e[gt],St=xt.tl,zt=xt.tr,qt=xt.bl,Qt=xt.br,_e=xt.tex,oe=xt.pixelOffsetTL,ve=xt.pixelOffsetBR,ae=xt.minFontScaleX,Qe=xt.minFontScaleY,Ie=xt.glyphOffset,pe=xt.isSDF,ai=xt.sectionIndex,He=J.vertexLength,yi=Ie[1];Zu(U,v.x,v.y,St.x,yi+St.y,_e.x,_e.y,i,pe,oe.x,oe.y,ae,Qe),Zu(U,v.x,v.y,zt.x,yi+zt.y,_e.x+_e.w,_e.y,i,pe,ve.x,oe.y,ae,Qe),Zu(U,v.x,v.y,qt.x,yi+qt.y,_e.x,_e.y+_e.h,i,pe,oe.x,ve.y,ae,Qe),Zu(U,v.x,v.y,Qt.x,yi+Qt.y,_e.x+_e.w,_e.y+_e.h,i,pe,ve.x,ve.y,ae,Qe),Th(t.dynamicLayoutVertexArray,v,it),B.emplaceBack(He,He+1,He+2),B.emplaceBack(He+1,He+2,He+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ie[0]),gt!==e.length-1&&ai===e[gt+1].sectionIndex||t.programConfigurations.populatePaintArrays(U.length,p,p.index,{},k,pt&&pt[ai])}t.placedSymbolArray.emplaceBack(v.x,v.y,Y,this.glyphOffsetArray.length-Y,at,T,E,v.segment,i?i[0]:0,i?i[1]:0,s[0],s[1],f,0,!1,0,C)},Ji.prototype._addCollisionDebugVertex=function(t,e,i,s,h,p){return e.emplaceBack(0,0),t.emplaceBack(i.x,i.y,s,h,Math.round(p.x),Math.round(p.y))},Ji.prototype.addCollisionDebugVertices=function(t,e,i,s,h,p,f){var v=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),T=v.vertexLength,E=h.layoutVertexArray,C=h.collisionVertexArray,k=f.anchorX,B=f.anchorY;this._addCollisionDebugVertex(E,C,p,k,B,new le(t,e)),this._addCollisionDebugVertex(E,C,p,k,B,new le(i,e)),this._addCollisionDebugVertex(E,C,p,k,B,new le(i,s)),this._addCollisionDebugVertex(E,C,p,k,B,new le(t,s)),v.vertexLength+=4;var U=h.indexArray;U.emplaceBack(T,T+1),U.emplaceBack(T+1,T+2),U.emplaceBack(T+2,T+3),U.emplaceBack(T+3,T),v.primitiveLength+=4},Ji.prototype.addDebugCollisionBoxes=function(t,e,i,s){for(var h=t;h<e;h++){var p=this.collisionBoxArray.get(h);this.addCollisionDebugVertices(p.x1,p.y1,p.x2,p.y2,s?this.textCollisionBox:this.iconCollisionBox,p.anchorPoint,i)}},Ji.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new cu(Gs,$h.members,rl),this.iconCollisionBox=new cu(Gs,$h.members,rl);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},Ji.prototype._deserializeCollisionBoxesForSymbol=function(t,e,i,s,h,p,f,v,T){for(var E={},C=e;C<i;C++){var k=t.get(C);E.textBox={x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,anchorPointX:k.anchorPointX,anchorPointY:k.anchorPointY},E.textFeatureIndex=k.featureIndex;break}for(var B=s;B<h;B++){var U=t.get(B);E.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},E.verticalTextFeatureIndex=U.featureIndex;break}for(var J=p;J<f;J++){var Y=t.get(J);E.iconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},E.iconFeatureIndex=Y.featureIndex;break}for(var at=v;at<T;at++){var it=t.get(at);E.verticalIconBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},E.verticalIconFeatureIndex=it.featureIndex;break}return E},Ji.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Ji.prototype.hasTextData=function(){return this.text.segments.get().length>0},Ji.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Ji.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Ji.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Ji.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Ji.prototype.addIndicesForPlacedSymbol=function(t,e){for(var i=t.placedSymbolArray.get(e),s=i.vertexStartIndex+4*i.numGlyphs,h=i.vertexStartIndex;h<s;h+=4)t.indexArray.emplaceBack(h,h+1,h+2),t.indexArray.emplaceBack(h+1,h+2,h+3)},Ji.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),i=Math.cos(t),s=[],h=[],p=[],f=0;f<this.symbolInstances.length;++f){p.push(f);var v=this.symbolInstances.get(f);s.push(0|Math.round(e*v.anchorX+i*v.anchorY)),h.push(v.featureIndex)}return p.sort(function(T,E){return s[T]-s[E]||h[E]-h[T]}),p},Ji.prototype.addToSortKeyRanges=function(t,e){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Ji.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,s=this.symbolInstanceIndexes;i<s.length;i+=1){var h=this.symbolInstances.get(s[i]);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach(function(p,f,v){p>=0&&v.indexOf(p)===f&&e.addIndicesForPlacedSymbol(e.text,p)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Zt("SymbolBucket",Ji,{omit:["layers","collisionBoxArray","features","compareText"]}),Ji.MAX_GLYPHS=65535,Ji.addDynamicAttributes=Th;var _d=new mr({"symbol-placement":new me(j.layout_symbol["symbol-placement"]),"symbol-spacing":new me(j.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new me(j.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ce(j.layout_symbol["symbol-sort-key"]),"symbol-z-order":new me(j.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new me(j.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new me(j.layout_symbol["icon-ignore-placement"]),"icon-optional":new me(j.layout_symbol["icon-optional"]),"icon-rotation-alignment":new me(j.layout_symbol["icon-rotation-alignment"]),"icon-size":new ce(j.layout_symbol["icon-size"]),"icon-text-fit":new me(j.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new me(j.layout_symbol["icon-text-fit-padding"]),"icon-image":new ce(j.layout_symbol["icon-image"]),"icon-rotate":new ce(j.layout_symbol["icon-rotate"]),"icon-padding":new me(j.layout_symbol["icon-padding"]),"icon-keep-upright":new me(j.layout_symbol["icon-keep-upright"]),"icon-offset":new ce(j.layout_symbol["icon-offset"]),"icon-anchor":new ce(j.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new me(j.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new me(j.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new me(j.layout_symbol["text-rotation-alignment"]),"text-field":new ce(j.layout_symbol["text-field"]),"text-font":new ce(j.layout_symbol["text-font"]),"text-size":new ce(j.layout_symbol["text-size"]),"text-max-width":new ce(j.layout_symbol["text-max-width"]),"text-line-height":new me(j.layout_symbol["text-line-height"]),"text-letter-spacing":new ce(j.layout_symbol["text-letter-spacing"]),"text-justify":new ce(j.layout_symbol["text-justify"]),"text-radial-offset":new ce(j.layout_symbol["text-radial-offset"]),"text-variable-anchor":new me(j.layout_symbol["text-variable-anchor"]),"text-anchor":new ce(j.layout_symbol["text-anchor"]),"text-max-angle":new me(j.layout_symbol["text-max-angle"]),"text-writing-mode":new me(j.layout_symbol["text-writing-mode"]),"text-rotate":new ce(j.layout_symbol["text-rotate"]),"text-padding":new me(j.layout_symbol["text-padding"]),"text-keep-upright":new me(j.layout_symbol["text-keep-upright"]),"text-transform":new ce(j.layout_symbol["text-transform"]),"text-offset":new ce(j.layout_symbol["text-offset"]),"text-allow-overlap":new me(j.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new me(j.layout_symbol["text-ignore-placement"]),"text-optional":new me(j.layout_symbol["text-optional"])}),Sh={paint:new mr({"icon-opacity":new ce(j.paint_symbol["icon-opacity"]),"icon-color":new ce(j.paint_symbol["icon-color"]),"icon-halo-color":new ce(j.paint_symbol["icon-halo-color"]),"icon-halo-width":new ce(j.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ce(j.paint_symbol["icon-halo-blur"]),"icon-translate":new me(j.paint_symbol["icon-translate"]),"icon-translate-anchor":new me(j.paint_symbol["icon-translate-anchor"]),"text-opacity":new ce(j.paint_symbol["text-opacity"]),"text-color":new ce(j.paint_symbol["text-color"],{runtimeType:Yt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new ce(j.paint_symbol["text-halo-color"]),"text-halo-width":new ce(j.paint_symbol["text-halo-width"]),"text-halo-blur":new ce(j.paint_symbol["text-halo-blur"]),"text-translate":new me(j.paint_symbol["text-translate"]),"text-translate-anchor":new me(j.paint_symbol["text-translate-anchor"])}),layout:_d},Ol=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ft,this.defaultValue=t};Ol.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Ol.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Ol.prototype.outputDefined=function(){return!1},Ol.prototype.serialize=function(){return null},Zt("FormatSectionOverride",Ol,{omit:["defaultValue"]});var yd=function(t){function e(i){t.call(this,i,Sh)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(i,s){if(t.prototype.recalculate.call(this,i,s),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var h=this.layout.get("text-writing-mode");if(h){for(var p=[],f=0,v=h;f<v.length;f+=1){var T=v[f];p.indexOf(T)<0&&p.push(T)}this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(i,s,h,p){var T,f=this.layout.get(i).evaluate(s,{},h,p),v=this._unevaluatedLayout._values[i];return v.isDataDriven()||Ro(v.value)||!f?f:(T=s.properties,f.replace(/{([^{}]+)}/g,function(C,k){return k in T?String(T[k]):""}))},e.prototype.createBucket=function(i){return new Ji(i)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var i=0,s=Sh.paint.overridableProperties;i<s.length;i+=1){var h=s[i];if(e.hasPaintOverride(this.layout,h)){var p,f=this.paint.get(h),v=new Ol(f),T=new wa(v,f.property.specification);p="constant"===f.value.kind||"source"===f.value.kind?new on("source",T):new $o("composite",T,f.value.zoomStops,f.value._interpolationType),this.paint._values[h]=new jn(f.property,p,f.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(i,s,h){return!(!this.layout||s.isDataDriven()||h.isDataDriven())&&e.hasPaintOverride(this.layout,i)},e.hasPaintOverride=function(i,s){var h=i.get("text-field"),p=Sh.paint.properties[s],f=!1,v=function(C){for(var k=0,B=C;k<B.length;k+=1)if(p.overrides&&p.overrides.hasOverride(B[k]))return void(f=!0)};if("constant"===h.value.kind&&h.value.value instanceof Ai)v(h.value.value.sections);else if("source"===h.value.kind){var T=function(C){f||(C instanceof In&&Zi(C.value)===Ze?v(C.value.sections):C instanceof ro?v(C.sections):C.eachChild(T))},E=h.value;E._styleExpression&&T(E._styleExpression.expression)}return f},e}(ia),gd={paint:new mr({"background-color":new me(j.paint_background["background-color"]),"background-pattern":new Ur(j.paint_background["background-pattern"]),"background-opacity":new me(j.paint_background["background-opacity"])})},vd=function(t){function e(i){t.call(this,i,gd)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(ia),xd={paint:new mr({"raster-opacity":new me(j.paint_raster["raster-opacity"]),"raster-hue-rotate":new me(j.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new me(j.paint_raster["raster-brightness-min"]),"raster-brightness-max":new me(j.paint_raster["raster-brightness-max"]),"raster-saturation":new me(j.paint_raster["raster-saturation"]),"raster-contrast":new me(j.paint_raster["raster-contrast"]),"raster-resampling":new me(j.paint_raster["raster-resampling"]),"raster-fade-duration":new me(j.paint_raster["raster-fade-duration"])})},bd=function(t){function e(i){t.call(this,i,xd)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(ia),wd=function(t){function e(i){t.call(this,i,{}),this.implementation=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},e.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},e}(ia),Td={circle:lh,heatmap:ap,hillshade:lp,fill:Ep,"fill-extrusion":Dp,line:Np,symbol:yd,background:vd,raster:bd},bc=Nt.HTMLImageElement,wc=Nt.HTMLCanvasElement,Tc=Nt.HTMLVideoElement,Sc=Nt.ImageData,Vu=Nt.ImageBitmap,hl=function(t,e,i,s){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,s)};hl.prototype.update=function(t,e,i){var s=t.width,h=t.height,p=!(this.size&&this.size[0]===s&&this.size[1]===h||i),f=this.context,v=f.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),v.bindTexture(v.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!e||!1!==e.premultiply)),p)this.size=[s,h],t instanceof bc||t instanceof wc||t instanceof Tc||t instanceof Sc||Vu&&t instanceof Vu?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,t):v.texImage2D(v.TEXTURE_2D,0,this.format,s,h,0,this.format,v.UNSIGNED_BYTE,t.data);else{var T=i||{x:0,y:0},E=T.x,C=T.y;t instanceof bc||t instanceof wc||t instanceof Tc||t instanceof Sc||Vu&&t instanceof Vu?v.texSubImage2D(v.TEXTURE_2D,0,E,C,v.RGBA,v.UNSIGNED_BYTE,t):v.texSubImage2D(v.TEXTURE_2D,0,E,C,s,h,v.RGBA,v.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&v.generateMipmap(v.TEXTURE_2D)},hl.prototype.bind=function(t,e,i){var s=this.context.gl;s.bindTexture(s.TEXTURE_2D,this.texture),i!==s.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=s.LINEAR),t!==this.filter&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,e),this.wrap=e)},hl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},hl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Eh=function(t){var e=this;this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};Eh.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Eh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Bl=function(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},pi(["receive","process"],this),this.invoker=new Eh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=hr()?t:Nt};function Ec(t,e,i){var s=2*Math.PI*6378137/256/Math.pow(2,i);return[t*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}Bl.prototype.send=function(t,e,i,s,h){var p=this;void 0===h&&(h=!1);var f=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[f]=i);var v=vr(this.globalScope)?void 0:[];return this.target.postMessage({id:f,type:t,hasCallback:!!i,targetMapId:s,mustQueue:h,sourceMapId:this.mapId,data:yn(e,v)},v),{cancel:function(){i&&delete p.callbacks[f],p.target.postMessage({id:f,type:"<cancel>",targetMapId:s,sourceMapId:p.mapId})}}},Bl.prototype.receive=function(t){var e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[i];var s=this.cancelCallbacks[i];delete this.cancelCallbacks[i],s&&s()}else hr()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)},Bl.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Bl.prototype.processTask=function(t,e){var i=this;if("<response>"===e.type){var s=this.callbacks[t];delete this.callbacks[t],s&&(e.error?s(gn(e.error)):s(null,gn(e.data)))}else{var h=!1,p=vr(this.globalScope)?void 0:[],f=e.hasCallback?function(C,k){h=!0,delete i.cancelCallbacks[t],i.target.postMessage({id:t,type:"<response>",sourceMapId:i.mapId,error:C?yn(C):null,data:yn(k,p)},p)}:function(C){h=!0},v=null,T=gn(e.data);if(this.parent[e.type])v=this.parent[e.type](e.sourceMapId,T,f);else if(this.parent.getWorkerSource){var E=e.type.split(".");v=this.parent.getWorkerSource(e.sourceMapId,E[0],T.source)[E[1]](T,f)}else f(new Error("Could not find function "+e.type));!h&&v&&v.cancel&&(this.cancelCallbacks[t]=v.cancel)}},Bl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var yr=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};yr.prototype.setNorthEast=function(t){return this._ne=t instanceof vn?new vn(t.lng,t.lat):vn.convert(t),this},yr.prototype.setSouthWest=function(t){return this._sw=t instanceof vn?new vn(t.lng,t.lat):vn.convert(t),this},yr.prototype.extend=function(t){var e,i,s=this._sw,h=this._ne;if(t instanceof vn)e=t,i=t;else{if(!(t instanceof yr))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(yr.convert(t)):this.extend(vn.convert(t)):this;if(i=t._ne,!(e=t._sw)||!i)return this}return s||h?(s.lng=Math.min(e.lng,s.lng),s.lat=Math.min(e.lat,s.lat),h.lng=Math.max(i.lng,h.lng),h.lat=Math.max(i.lat,h.lat)):(this._sw=new vn(e.lng,e.lat),this._ne=new vn(i.lng,i.lat)),this},yr.prototype.getCenter=function(){return new vn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},yr.prototype.getSouthWest=function(){return this._sw},yr.prototype.getNorthEast=function(){return this._ne},yr.prototype.getNorthWest=function(){return new vn(this.getWest(),this.getNorth())},yr.prototype.getSouthEast=function(){return new vn(this.getEast(),this.getSouth())},yr.prototype.getWest=function(){return this._sw.lng},yr.prototype.getSouth=function(){return this._sw.lat},yr.prototype.getEast=function(){return this._ne.lng},yr.prototype.getNorth=function(){return this._ne.lat},yr.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},yr.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},yr.prototype.isEmpty=function(){return!(this._sw&&this._ne)},yr.prototype.contains=function(t){var e=vn.convert(t),i=e.lng,s=e.lat,h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&h},yr.convert=function(t){return!t||t instanceof yr?t:new yr(t)};var vn=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};vn.prototype.wrap=function(){return new vn(Oe(this.lng,-180,180),this.lat)},vn.prototype.toArray=function(){return[this.lng,this.lat]},vn.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},vn.prototype.distanceTo=function(t){var e=Math.PI/180,i=this.lat*e,s=t.lat*e,h=Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos((t.lng-this.lng)*e);return 6371008.8*Math.acos(Math.min(h,1))},vn.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return new yr(new vn(this.lng-i,this.lat-e),new vn(this.lng+i,this.lat+e))},vn.convert=function(t){if(t instanceof vn)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new vn(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new vn(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Pc=2*Math.PI*6371008.8;function Ac(t){return Pc*Math.cos(t*Math.PI/180)}function Ic(t){return(180+t)/360}function Cc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Lc(t,e){return t/Ac(e)}function Ph(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var cl=function(t,e,i){void 0===i&&(i=0),this.x=+t,this.y=+e,this.z=+i};cl.fromLngLat=function(t,e){void 0===e&&(e=0);var i=vn.convert(t);return new cl(Ic(i.lng),Cc(i.lat),Lc(e,i.lat))},cl.prototype.toLngLat=function(){return new vn(360*this.x-180,Ph(this.y))},cl.prototype.toAltitude=function(){return this.z*Ac(Ph(this.y))},cl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Pc*(t=Ph(this.y),1/Math.cos(t*Math.PI/180));var t};var pl=function(t,e,i){this.z=t,this.x=e,this.y=i,this.key=pu(0,t,t,e,i)};pl.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},pl.prototype.url=function(t,e){var i,s,h,p,f,v=(s=this.y,h=this.z,p=Ec(256*(i=this.x),256*(s=Math.pow(2,h)-s-1),h),f=Ec(256*(i+1),256*(s+1),h),p[0]+","+p[1]+","+f[0]+","+f[1]),T=function(E,C,k){for(var B,U="",J=E;J>0;J--)U+=(C&(B=1<<J-1)?1:0)+(k&B?2:0);return U}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",T).replace("{bbox-epsg-3857}",v)},pl.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new le(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},pl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var zc=function(t,e){this.wrap=t,this.canonical=e,this.key=pu(t,e.z,e.z,e.x,e.y)},gr=function(t,e,i,s,h){this.overscaledZ=t,this.wrap=e,this.canonical=new pl(i,+s,+h),this.key=pu(e,t,i,s,h)};function pu(t,e,i,s,h){(t*=2)<0&&(t=-1*t-1);var p=1<<i;return(p*p*t+p*h+s).toString(36)+i.toString(36)+e.toString(36)}gr.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},gr.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new gr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new gr(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},gr.prototype.calculateScaledKey=function(t,e){var i=this.canonical.z-t;return t>this.canonical.z?pu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):pu(this.wrap*+e,t,t,this.canonical.x>>i,this.canonical.y>>i)},gr.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},gr.prototype.children=function(t){if(this.overscaledZ>=t)return[new gr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,i=2*this.canonical.x,s=2*this.canonical.y;return[new gr(e,this.wrap,e,i,s),new gr(e,this.wrap,e,i+1,s),new gr(e,this.wrap,e,i,s+1),new gr(e,this.wrap,e,i+1,s+1)]},gr.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},gr.prototype.wrapped=function(){return new gr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},gr.prototype.unwrapTo=function(t){return new gr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},gr.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},gr.prototype.toUnwrapped=function(){return new zc(this.wrap,this.canonical)},gr.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},gr.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new cl(t.x-this.wrap,t.y))},Zt("CanonicalTileID",pl),Zt("OverscaledTileID",gr,{omit:["posMatrix"]});var Os=function(t,e,i){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return Ri('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var s=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=i||"mapbox";for(var h=0;h<s;h++)this.data[this._idx(-1,h)]=this.data[this._idx(0,h)],this.data[this._idx(s,h)]=this.data[this._idx(s-1,h)],this.data[this._idx(h,-1)]=this.data[this._idx(h,0)],this.data[this._idx(h,s)]=this.data[this._idx(h,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)]};Os.prototype.get=function(t,e){var i=new Uint8Array(this.data.buffer),s=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(i[s],i[s+1],i[s+2])},Os.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Os.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Os.prototype._unpackMapbox=function(t,e,i){return(256*t*256+256*e+i)/10-1e4},Os.prototype._unpackTerrarium=function(t,e,i){return 256*t+e+i/256-32768},Os.prototype.getPixels=function(){return new qo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Os.prototype.backfillBorder=function(t,e,i){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var s=e*this.dim,h=e*this.dim+this.dim,p=i*this.dim,f=i*this.dim+this.dim;switch(e){case-1:s=h-1;break;case 1:h=s+1}switch(i){case-1:p=f-1;break;case 1:f=p+1}for(var v=-e*this.dim,T=-i*this.dim,E=p;E<f;E++)for(var C=s;C<h;C++)this.data[this._idx(C,E)]=t.data[this._idx(C+v,E+T)]},Zt("DEMData",Os);var qu=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}};qu.prototype.encode=function(t){return this._stringToNumber[t]},qu.prototype.decode=function(t){return this._numberToString[t]};var Gu=function(t,e,i,s,h){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=s,this.properties=t.properties,this.id=h},Ah={geometry:{configurable:!0}};Ah.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ah.geometry.set=function(t){this._geometry=t},Gu.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Gu.prototype,Ah);var Rl=function(){this.state={},this.stateChanges={},this.deletedStates={}};Rl.prototype.updateState=function(t,e,i){var s=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][s]=this.stateChanges[t][s]||{},Ct(this.stateChanges[t][s],i),null===this.deletedStates[t])for(var h in this.deletedStates[t]={},this.state[t])h!==s&&(this.deletedStates[t][h]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][s])for(var p in this.deletedStates[t][s]={},this.state[t][s])i[p]||(this.deletedStates[t][s][p]=null);else for(var f in i)this.deletedStates[t]&&this.deletedStates[t][s]&&null===this.deletedStates[t][s][f]&&delete this.deletedStates[t][s][f]},Rl.prototype.removeFeatureState=function(t,e,i){if(null!==this.deletedStates[t]){var s=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},i&&void 0!==e)null!==this.deletedStates[t][s]&&(this.deletedStates[t][s]=this.deletedStates[t][s]||{},this.deletedStates[t][s][i]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][s])for(i in this.deletedStates[t][s]={},this.stateChanges[t][s])this.deletedStates[t][s][i]=null;else this.deletedStates[t][s]=null;else this.deletedStates[t]=null}},Rl.prototype.getState=function(t,e){var i=String(e),s=Ct({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var h=this.deletedStates[t][e];if(null===h)return{};for(var p in h)delete s[p]}return s},Rl.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Rl.prototype.coalesceChanges=function(t,e){var i={};for(var s in this.stateChanges){this.state[s]=this.state[s]||{};var h={};for(var p in this.stateChanges[s])this.state[s][p]||(this.state[s][p]={}),Ct(this.state[s][p],this.stateChanges[s][p]),h[p]=this.state[s][p];i[s]=h}for(var f in this.deletedStates){this.state[f]=this.state[f]||{};var v={};if(null===this.deletedStates[f])for(var T in this.state[f])v[T]={},this.state[f][T]={};else for(var E in this.deletedStates[f]){if(null===this.deletedStates[f][E])this.state[f][E]={};else for(var C=0,k=Object.keys(this.deletedStates[f][E]);C<k.length;C+=1)delete this.state[f][E][k[C]];v[E]=this.state[f][E]}i[f]=i[f]||{},Ct(i[f],v)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(var B in t)t[B].setFeatureState(i,e)};var Bs=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new mi(8192,16,0),this.grid3D=new mi(8192,16,0),this.featureIndexArray=new M,this.promoteId=e};function kc(t,e,i,s,h){return ki(t,function(p,f){var v=e instanceof Na?e.get(f):null;return v&&v.evaluate?v.evaluate(i,s,h):v})}function Mc(t){for(var e=1/0,i=1/0,s=-1/0,h=-1/0,p=0,f=t;p<f.length;p+=1){var v=f[p];e=Math.min(e,v.x),i=Math.min(i,v.y),s=Math.max(s,v.x),h=Math.max(h,v.y)}return{minX:e,minY:i,maxX:s,maxY:h}}function Sd(t,e){return e-t}Bs.prototype.insert=function(t,e,i,s,h,p){var f=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,s,h);for(var v=p?this.grid3D:this.grid,T=0;T<e.length;T++){for(var E=e[T],C=[1/0,1/0,-1/0,-1/0],k=0;k<E.length;k++){var B=E[k];C[0]=Math.min(C[0],B.x),C[1]=Math.min(C[1],B.y),C[2]=Math.max(C[2],B.x),C[3]=Math.max(C[3],B.y)}C[0]<8192&&C[1]<8192&&C[2]>=0&&C[3]>=0&&v.insert(f,C[0],C[1],C[2],C[3])}},Bs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Al.VectorTile(new Mu(this.rawTileData)).layers,this.sourceLayerCoder=new qu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Bs.prototype.query=function(t,e,i,s){var h=this;this.loadVTLayers();for(var p=t.params||{},f=8192/t.tileSize/t.scale,v=ua(p.filter),T=t.queryGeometry,E=t.queryPadding*f,C=Mc(T),k=this.grid.query(C.minX-E,C.minY-E,C.maxX+E,C.maxY+E),B=Mc(t.cameraQueryGeometry),J=0,Y=this.grid3D.query(B.minX-E,B.minY-E,B.maxX+E,B.maxY+E,function(xt,St,zt,qt){return function(Qt,_e,oe,ve,ae){for(var Qe=0,Ie=Qt;Qe<Ie.length;Qe+=1){var pe=Ie[Qe];if(_e<=pe.x&&oe<=pe.y&&ve>=pe.x&&ae>=pe.y)return!0}var ai=[new le(_e,oe),new le(_e,ae),new le(ve,ae),new le(ve,oe)];if(Qt.length>2)for(var He=0,yi=ai;He<yi.length;He+=1)if(Za(Qt,yi[He]))return!0;for(var xe=0;xe<Qt.length-1;xe++)if(sl(Qt[xe],Qt[xe+1],ai))return!0;return!1}(t.cameraQueryGeometry,xt-E,St-E,zt+E,qt+E)});J<Y.length;J+=1)k.push(Y[J]);k.sort(Sd);for(var at,it={},pt=function(xt){var St=k[xt];if(St!==at){at=St;var zt=h.featureIndexArray.get(St),qt=null;h.loadMatchingFeature(it,zt.bucketIndex,zt.sourceLayerIndex,zt.featureIndex,v,p.layers,p.availableImages,e,i,s,function(Qt,_e,oe){return qt||(qt=zn(Qt)),_e.queryIntersectsFeature(T,Qt,oe,qt,h.z,t.transform,f,t.pixelPosMatrix)})}},gt=0;gt<k.length;gt++)pt(gt);return it},Bs.prototype.loadMatchingFeature=function(t,e,i,s,h,p,f,v,T,E,C){var k=this.bucketLayerIDs[e];if(!p||function(Qt,_e){for(var oe=0;oe<Qt.length;oe++)if(_e.indexOf(Qt[oe])>=0)return!0;return!1}(p,k)){var B=this.sourceLayerCoder.decode(i),U=this.vtLayers[B].feature(s);if(h.needGeometry){var J=Yn(U,!0);if(!h.filter(new oi(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!h.filter(new oi(this.tileID.overscaledZ),U))return;for(var Y=this.getId(U,B),at=0;at<k.length;at++){var it=k[at];if(!(p&&p.indexOf(it)<0)){var pt=v[it];if(pt){var gt={};void 0!==Y&&E&&(gt=E.getState(pt.sourceLayer||"_geojsonTileLayer",Y));var xt=Ct({},T[it]);xt.paint=kc(xt.paint,pt.paint,U,gt,f),xt.layout=kc(xt.layout,pt.layout,U,gt,f);var St=!C||C(U,pt,gt);if(St){var zt=new Gu(U,this.z,this.x,this.y,Y);zt.layer=xt;var qt=t[it];void 0===qt&&(qt=t[it]=[]),qt.push({featureIndex:s,feature:zt,intersectionZ:St})}}}}}},Bs.prototype.lookupSymbolFeatures=function(t,e,i,s,h,p,f,v){var T={};this.loadVTLayers();for(var E=ua(h),C=0,k=t;C<k.length;C+=1)this.loadMatchingFeature(T,i,s,k[C],E,p,f,v,e);return T},Bs.prototype.hasLayer=function(t){for(var e=0,i=this.bucketLayerIDs;e<i.length;e+=1)for(var s=0,h=i[e];s<h.length;s+=1)if(t===h[s])return!0;return!1},Bs.prototype.getId=function(t,e){var i=t.id;return this.promoteId&&"boolean"==typeof(i=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(i=Number(i)),i},Zt("FeatureIndex",Bs,{omit:["rawTileData","sourceLayerCoder"]});var jr=function(t,e){this.tileID=t,this.uid=wi(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};jr.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<Xr.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},jr.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},jr.prototype.loadVectorData=function(t,e,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var s in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(E,C){var k={};if(!C)return k;for(var B=function(){var Y=J[U],at=Y.layerIds.map(function(gt){return C.getLayer(gt)}).filter(Boolean);if(0!==at.length){Y.layers=at,Y.stateDependentLayerIds&&(Y.stateDependentLayers=Y.stateDependentLayerIds.map(function(gt){return at.filter(function(xt){return xt.id===gt})[0]}));for(var it=0,pt=at;it<pt.length;it+=1)k[pt[it].id]=Y}},U=0,J=E;U<J.length;U+=1)B();return k}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var h=this.buckets[s];if(h instanceof Ji){if(this.hasSymbolBuckets=!0,!i)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var p in this.buckets){var f=this.buckets[p];if(f instanceof Ji&&f.hasRTLText){this.hasRTLText=!0,co.isLoading()||co.isLoaded()||"deferred"!==el()||ha();break}}for(var v in this.queryPadding=0,this.buckets){var T=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(v).queryRadius(T))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new a},jr.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},jr.prototype.getBucket=function(t){return this.buckets[t.id]},jr.prototype.upload=function(t){for(var e in this.buckets){var i=this.buckets[e];i.uploadPending()&&i.upload(t)}var s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new hl(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new hl(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)},jr.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},jr.prototype.queryRenderedFeatures=function(t,e,i,s,h,p,f,v,T,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:s,cameraQueryGeometry:h,scale:p,tileSize:this.tileSize,pixelPosMatrix:E,transform:v,params:f,queryPadding:this.queryPadding*T},t,e,i):{}},jr.prototype.querySourceFeatures=function(t,e){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var s=i.loadVTLayers(),h=e?e.sourceLayer:"",p=s._geojsonTileLayer||s[h];if(p)for(var f=ua(e&&e.filter),v=this.tileID.canonical,T=v.z,E=v.x,C=v.y,k={z:T,x:E,y:C},B=0;B<p.length;B++){var U=p.feature(B);if(f.needGeometry){var J=Yn(U,!0);if(!f.filter(new oi(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!f.filter(new oi(this.tileID.overscaledZ),U))continue;var Y=i.getId(U,h),at=new Gu(U,T,E,C,Y);at.tile=k,t.push(at)}}},jr.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},jr.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},jr.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var i=Gr(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var s=Date.now(),h=!1;if(this.expirationTime>s)h=!1;else if(e)if(this.expirationTime<e)h=!0;else{var p=this.expirationTime-e;p?this.expirationTime=s+Math.max(p,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},jr.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},jr.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var i=this.latestFeatureIndex.loadVTLayers();for(var s in this.buckets)if(e.style.hasLayer(s)){var h=this.buckets[s],p=h.layers[0].sourceLayer||"_geojsonTileLayer",f=i[p],v=t[p];if(f&&v&&0!==Object.keys(v).length){h.update(v,f,this.imageAtlas&&this.imageAtlas.patternPositions||{});var T=e&&e.style&&e.style.getLayer(s);T&&(this.queryPadding=Math.max(this.queryPadding,T.queryRadius(h)))}}}},jr.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},jr.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Xr.now()},jr.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},jr.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=Xr.now()+t},jr.prototype.setDependencies=function(t,e){for(var i={},s=0,h=e;s<h.length;s+=1)i[h[s]]=!0;this.dependencies[t]=i},jr.prototype.hasDependency=function(t,e){for(var i=0,s=t;i<s.length;i+=1){var h=this.dependencies[s[i]];if(h)for(var p=0,f=e;p<f.length;p+=1)if(h[f[p]])return!0}return!1};var Js=Nt.performance,Dc=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Js.mark(this._marks.start)};Dc.prototype.finish=function(){Js.mark(this._marks.end);var t=Js.getEntriesByName(this._marks.measure);return 0===t.length&&(Js.measure(this._marks.measure,this._marks.start,this._marks.end),t=Js.getEntriesByName(this._marks.measure),Js.clearMarks(this._marks.start),Js.clearMarks(this._marks.end),Js.clearMeasures(this._marks.measure)),t},c.Actor=Bl,c.AlphaImage=ul,c.CanonicalTileID=pl,c.CollisionBoxArray=a,c.Color=fe,c.DEMData=Os,c.DataConstantProperty=me,c.DictionaryCoder=qu,c.EXTENT=8192,c.ErrorEvent=nt,c.EvaluationParameters=oi,c.Event=X,c.Evented=st,c.FeatureIndex=Bs,c.FillBucket=ns,c.FillExtrusionBucket=rs,c.ImageAtlas=hu,c.ImagePosition=Ou,c.LineBucket=ko,c.LngLat=vn,c.LngLatBounds=yr,c.MercatorCoordinate=cl,c.ONE_EM=24,c.OverscaledTileID=gr,c.Point=le,c.Point$1=le,c.Properties=mr,c.Protobuf=Mu,c.RGBAImage=qo,c.RequestManager=Rn,c.RequestPerformance=Dc,c.ResourceType=ri,c.SegmentVector=Z,c.SourceFeatureState=Rl,c.StructArrayLayout1ui2=eu,c.StructArrayLayout2f1f2i16=zs,c.StructArrayLayout2i4=Ls,c.StructArrayLayout3ui6=fs,c.StructArrayLayout4i8=Yl,c.SymbolBucket=Ji,c.Texture=hl,c.Tile=jr,c.Transitionable=fr,c.Uniform1f=Xt,c.Uniform1i=Ot,c.Uniform2f=Wt,c.Uniform3f=se,c.Uniform4f=ge,c.UniformColor=we,c.UniformMatrix4f=xi,c.UnwrappedTileID=zc,c.ValidationError=et,c.WritingMode=da,c.ZoomHistory=Fr,c.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},c.addDynamicAttributes=Th,c.asyncAll=function(t,e,i){if(!t.length)return i(null,[]);var s=t.length,h=new Array(t.length),p=null;t.forEach(function(f,v){e(f,function(T,E){T&&(p=T),h[v]=E,0==--s&&i(p,h)})})},c.bezier=nn,c.bindAll=pi,c.browser=Xr,c.cacheEntryPossiblyAdded=function(t){++ir>Ae&&(t.getActor().send("enforceCacheSizeLimit",ue),ir=0)},c.clamp=er,c.clearTileCache=function(t){var e=Nt.caches.delete("mapbox-tiles");t&&e.catch(t).then(function(){return t()})},c.clipLine=mc,c.clone=function(t){var e=new Oi(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},c.clone$1=Gn,c.clone$2=function(t){var e=new Oi(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},c.collisionCircleLayout=qp,c.config=ei,c.create=function(){var t=new Oi(16);return Oi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},c.create$1=function(){var t=new Oi(9);return Oi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},c.create$2=function(){var t=new Oi(4);return Oi!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},c.createCommonjsModule=gi,c.createExpression=$a,c.createLayout=ar,c.createStyleLayer=function(t){return"custom"===t.type?new wd(t):new Td[t.type](t)},c.cross=function(t,e,i){var s=e[0],h=e[1],p=e[2],f=i[0],v=i[1],T=i[2];return t[0]=h*T-p*v,t[1]=p*f-s*T,t[2]=s*v-h*f,t},c.deepEqual=function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(var s=0;s<e.length;s++)if(!t(e[s],i[s]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==i){if("object"!=typeof i||Object.keys(e).length!==Object.keys(i).length)return!1;for(var h in e)if(!t(e[h],i[h]))return!1;return!0}return e===i},c.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},c.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},c.ease=Se,c.emitValidationErrors=ui,c.endsWith=qi,c.enforceCacheSizeLimit=function(t){Di(),S&&S.then(function(e){e.keys().then(function(i){for(var s=0;s<i.length-t;s++)e.delete(i[s])})})},c.evaluateSizeForFeature=uc,c.evaluateSizeForZoom=hc,c.evaluateVariableOffset=gc,c.evented=ps,c.extend=Ct,c.featureFilter=ua,c.filterObject=Mi,c.fromRotation=function(t,e){var i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=-i,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},c.getAnchorAlignment=vh,c.getAnchorJustification=wh,c.getArrayBuffer=Ce,c.getImage=O,c.getJSON=function(t,e){return Kr(Ct(t,{type:"json"}),e)},c.getRTLTextPluginStatus=el,c.getReferrer=mn,c.getVideo=function(t,e){var i,s,h=Nt.document.createElement("video");h.muted=!0,h.onloadstart=function(){e(null,h)};for(var p=0;p<t.length;p++){var f=Nt.document.createElement("source");i=t[p],s=void 0,(s=Nt.document.createElement("a")).href=i,(s.protocol!==Nt.document.location.protocol||s.host!==Nt.document.location.host)&&(h.crossOrigin="Anonymous"),f.src=t[p],h.appendChild(f)}return{cancel:function(){}}},c.identity=na,c.invert=function(t,e){var i=e[0],s=e[1],h=e[2],p=e[3],f=e[4],v=e[5],T=e[6],E=e[7],C=e[8],k=e[9],B=e[10],U=e[11],J=e[12],Y=e[13],at=e[14],it=e[15],pt=i*v-s*f,gt=i*T-h*f,xt=i*E-p*f,St=s*T-h*v,zt=s*E-p*v,qt=h*E-p*T,Qt=C*Y-k*J,_e=C*at-B*J,oe=C*it-U*J,ve=k*at-B*Y,ae=k*it-U*Y,Qe=B*it-U*at,Ie=pt*Qe-gt*ae+xt*ve+St*oe-zt*_e+qt*Qt;return Ie?(t[0]=(v*Qe-T*ae+E*ve)*(Ie=1/Ie),t[1]=(h*ae-s*Qe-p*ve)*Ie,t[2]=(Y*qt-at*zt+it*St)*Ie,t[3]=(B*zt-k*qt-U*St)*Ie,t[4]=(T*oe-f*Qe-E*_e)*Ie,t[5]=(i*Qe-h*oe+p*_e)*Ie,t[6]=(at*xt-J*qt-it*gt)*Ie,t[7]=(C*qt-B*xt+U*gt)*Ie,t[8]=(f*ae-v*oe+E*Qt)*Ie,t[9]=(s*oe-i*ae-p*Qt)*Ie,t[10]=(J*zt-Y*xt+it*pt)*Ie,t[11]=(k*xt-C*zt-U*pt)*Ie,t[12]=(v*_e-f*ve-T*Qt)*Ie,t[13]=(i*ve-s*_e+h*Qt)*Ie,t[14]=(Y*gt-J*St-at*pt)*Ie,t[15]=(C*St-k*gt+B*pt)*Ie,t):null},c.isChar=Vt,c.isMapboxURL=Tn,c.keysDifference=function(t,e){var i=[];for(var s in t)s in e||i.push(s);return i},c.makeRequest=Kr,c.mapObject=ki,c.mercatorXfromLng=Ic,c.mercatorYfromLat=Cc,c.mercatorZfromAltitude=Lc,c.mul=sh,c.multiply=zo,c.mvt=Al,c.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},c.normalize=function(t,e){var i=e[0],s=e[1],h=e[2],p=i*i+s*s+h*h;return p>0&&(p=1/Math.sqrt(p)),t[0]=e[0]*p,t[1]=e[1]*p,t[2]=e[2]*p,t},c.number=cn,c.offscreenCanvasSupported=Pn,c.ortho=function(t,e,i,s,h,p,f){var v=1/(e-i),T=1/(s-h),E=1/(p-f);return t[0]=-2*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*T,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*E,t[11]=0,t[12]=(e+i)*v,t[13]=(h+s)*T,t[14]=(f+p)*E,t[15]=1,t},c.parseGlyphPBF=function(t){return new Mu(t).readFields(ed,[])},c.pbf=Mu,c.performSymbolLayout=function(t,e,i,s,h,p,f){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var v=t.layers[0].layout,T=t.layers[0]._unevaluatedLayout._values,E={};if("composite"===t.textSizeData.kind){var C=t.textSizeData,k=C.maxZoom;E.compositeTextSizes=[T["text-size"].possiblyEvaluate(new oi(C.minZoom),f),T["text-size"].possiblyEvaluate(new oi(k),f)]}if("composite"===t.iconSizeData.kind){var B=t.iconSizeData,U=B.maxZoom;E.compositeIconSizes=[T["icon-size"].possiblyEvaluate(new oi(B.minZoom),f),T["icon-size"].possiblyEvaluate(new oi(U),f)]}E.layoutTextSize=T["text-size"].possiblyEvaluate(new oi(t.zoom+1),f),E.layoutIconSize=T["icon-size"].possiblyEvaluate(new oi(t.zoom+1),f),E.textMaxSize=T["text-size"].possiblyEvaluate(new oi(18));for(var J=24*v.get("text-line-height"),Y="map"===v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement"),at=v.get("text-keep-upright"),it=v.get("text-size"),pt=function(){var St=xt[gt],zt=v.get("text-font").evaluate(St,{},f).join(","),qt=it.evaluate(St,{},f),Qt=E.layoutTextSize.evaluate(St,{},f),_e=E.layoutIconSize.evaluate(St,{},f),oe={horizontal:{},vertical:void 0},ve=St.text,ae=[0,0];if(ve){var Qe=ve.toString(),Ie=24*v.get("text-letter-spacing").evaluate(St,{},f),pe=function(hi){for(var $i=0,Wi=hi;$i<Wi.length;$i+=1)if(bi=Wi[$i].charCodeAt(0),Vt.Arabic(bi)||Vt["Arabic Supplement"](bi)||Vt["Arabic Extended-A"](bi)||Vt["Arabic Presentation Forms-A"](bi)||Vt["Arabic Presentation Forms-B"](bi))return!1;var bi;return!0}(Qe)?Ie:0,ai=v.get("text-anchor").evaluate(St,{},f),He=v.get("text-variable-anchor");if(!He){var yi=v.get("text-radial-offset").evaluate(St,{},f);ae=yi?gc(ai,[24*yi,bh]):v.get("text-offset").evaluate(St,{},f).map(function(hi){return 24*hi})}var xe=Y?"center":v.get("text-justify").evaluate(St,{},f),Ci=v.get("symbol-placement"),xn="point"===Ci?24*v.get("text-max-width").evaluate(St,{},f):0,Vn=function(){t.allowVerticalPlacement&&Uo(Qe)&&(oe.vertical=Bu(ve,e,i,h,zt,xn,J,ai,"left",pe,ae,da.vertical,!0,Ci,Qt,qt))};if(!Y&&He){for(var kn="auto"===xe?He.map(function(hi){return wh(hi)}):[xe],bn=!1,qn=0;qn<kn.length;qn++){var Ir=kn[qn];if(!oe.horizontal[Ir])if(bn)oe.horizontal[Ir]=oe.horizontal[0];else{var Cr=Bu(ve,e,i,h,zt,xn,J,"center",Ir,pe,ae,da.horizontal,!1,Ci,Qt,qt);Cr&&(oe.horizontal[Ir]=Cr,bn=1===Cr.positionedLines.length)}}Vn()}else{"auto"===xe&&(xe=wh(ai));var bo=Bu(ve,e,i,h,zt,xn,J,ai,xe,pe,ae,da.horizontal,!1,Ci,Qt,qt);bo&&(oe.horizontal[xe]=bo),Vn(),Uo(Qe)&&Y&&at&&(oe.vertical=Bu(ve,e,i,h,zt,xn,J,ai,xe,pe,ae,da.vertical,!1,Ci,Qt,qt))}}var hi,$i,bi,Mo,fo,Zr=void 0,wo=!1;if(St.icon&&St.icon.name){var $n=s[St.icon.name];$n&&(hi=h[St.icon.name],$i=v.get("icon-offset").evaluate(St,{},f),bi=vh(v.get("icon-anchor").evaluate(St,{},f)),Zr={image:hi,top:fo=$i[1]-hi.displaySize[1]*bi.verticalAlign,bottom:fo+hi.displaySize[1],left:Mo=$i[0]-hi.displaySize[0]*bi.horizontalAlign,right:Mo+hi.displaySize[0]},wo=$n.sdf,void 0===t.sdfIcons?t.sdfIcons=$n.sdf:t.sdfIcons!==$n.sdf&&Ri("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),($n.pixelRatio!==t.pixelRatio||0!==v.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var Vr=xc(oe.horizontal)||oe.vertical;t.iconsInText=!!Vr&&Vr.iconsInText,(Vr||Zr)&&function(hi,$i,Wi,bi,Mo,fo,pn,sr,mo,Li,xs){var fa=fo.textMaxSize.evaluate($i,{});void 0===fa&&(fa=pn);var bs,Qn=hi.layers[0].layout,ws=Qn.get("icon-offset").evaluate($i,{},xs),qa=xc(Wi.horizontal),Fl=pn/24,dl=hi.tilePixelRatio*Fl,Ul=hi.tilePixelRatio*fa/24,Rs=hi.tilePixelRatio*sr,Nl=hi.tilePixelRatio*Qn.get("symbol-spacing"),Wu=Qn.get("text-padding")*hi.tilePixelRatio,jl=Qn.get("icon-padding")*hi.tilePixelRatio,du=Qn.get("text-max-angle")/180*Math.PI,Hu="map"===Qn.get("text-rotation-alignment")&&"point"!==Qn.get("symbol-placement"),Xu="map"===Qn.get("icon-rotation-alignment")&&"point"!==Qn.get("symbol-placement"),Fs=Qn.get("symbol-placement"),fu=Nl/2,Zl=Qn.get("icon-text-fit");bi&&"none"!==Zl&&(hi.allowVerticalPlacement&&Wi.vertical&&(bs=lc(bi,Wi.vertical,Zl,Qn.get("icon-text-fit-padding"),ws,Fl)),qa&&(bi=lc(bi,qa,Zl,Qn.get("icon-text-fit-padding"),ws,Fl)));var Ys=function(Ed,wu){wu.x<0||wu.x>=8192||wu.y<0||wu.y>=8192||function(tr,os,Pd,$s,zh,Rc,th,Ts,eh,Tu,ih,nh,kh,Fc,Su,Uc,Nc,jc,Zc,Vc,ma,rh,qc,Ss,Ad){var Gc,ml,Hl,Xl,Kl,Jl=tr.addToLineVertexArray(os,Pd),Wc=0,Hc=0,Xc=0,Kc=0,Mh=-1,Dh=-1,Us={},Jc=K(""),Oh=0,Bh=0;if(void 0===Ts._unevaluatedLayout.getValue("text-radial-offset")?(Oh=(Gc=Ts.layout.get("text-offset").evaluate(ma,{},Ss).map(function(Pu){return 24*Pu}))[0],Bh=Gc[1]):(Oh=24*Ts.layout.get("text-radial-offset").evaluate(ma,{},Ss),Bh=bh),tr.allowVerticalPlacement&&$s.vertical){var Yc=Ts.layout.get("text-rotate").evaluate(ma,{},Ss)+90;Xl=new ju(eh,os,Tu,ih,nh,$s.vertical,kh,Fc,Su,Yc),th&&(Kl=new ju(eh,os,Tu,ih,nh,th,Nc,jc,Su,Yc))}if(zh){var Rh=Ts.layout.get("icon-rotate").evaluate(ma,{}),$c="none"!==Ts.layout.get("icon-text-fit"),Qc=_c(zh,Rh,qc,$c),Fh=th?_c(th,Rh,qc,$c):void 0;Hl=new ju(eh,os,Tu,ih,nh,zh,Nc,jc,!1,Rh),Wc=4*Qc.length;var tp=tr.iconSizeData,Eu=null;"source"===tp.kind?(Eu=[128*Ts.layout.get("icon-size").evaluate(ma,{})])[0]>32640&&Ri(tr.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===tp.kind&&((Eu=[128*rh.compositeIconSizes[0].evaluate(ma,{},Ss),128*rh.compositeIconSizes[1].evaluate(ma,{},Ss)])[0]>32640||Eu[1]>32640)&&Ri(tr.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),tr.addSymbols(tr.icon,Qc,Eu,Vc,Zc,ma,!1,os,Jl.lineStartIndex,Jl.lineLength,-1,Ss),Mh=tr.icon.placedSymbolArray.length-1,Fh&&(Hc=4*Fh.length,tr.addSymbols(tr.icon,Fh,Eu,Vc,Zc,ma,da.vertical,os,Jl.lineStartIndex,Jl.lineLength,-1,Ss),Dh=tr.icon.placedSymbolArray.length-1)}for(var ep in $s.horizontal){var oh=$s.horizontal[ep];if(!ml){Jc=K(oh.text);var Id=Ts.layout.get("text-rotate").evaluate(ma,{},Ss);ml=new ju(eh,os,Tu,ih,nh,oh,kh,Fc,Su,Id)}var ip=1===oh.positionedLines.length;if(Xc+=vc(tr,os,oh,Rc,Ts,Su,ma,Uc,Jl,$s.vertical?da.horizontal:da.horizontalOnly,ip?Object.keys($s.horizontal):[ep],Us,Mh,rh,Ss),ip)break}$s.vertical&&(Kc+=vc(tr,os,$s.vertical,Rc,Ts,Su,ma,Uc,Jl,da.vertical,["vertical"],Us,Dh,rh,Ss));var Cd=ml?ml.boxStartIndex:tr.collisionBoxArray.length,Ld=ml?ml.boxEndIndex:tr.collisionBoxArray.length,zd=Xl?Xl.boxStartIndex:tr.collisionBoxArray.length,kd=Xl?Xl.boxEndIndex:tr.collisionBoxArray.length,Md=Hl?Hl.boxStartIndex:tr.collisionBoxArray.length,Dd=Hl?Hl.boxEndIndex:tr.collisionBoxArray.length,Od=Kl?Kl.boxStartIndex:tr.collisionBoxArray.length,Bd=Kl?Kl.boxEndIndex:tr.collisionBoxArray.length,Es=-1,ah=function(Pu,rp){return Pu&&Pu.circleDiameter?Math.max(Pu.circleDiameter,rp):rp};Es=ah(ml,Es),Es=ah(Xl,Es),Es=ah(Hl,Es);var np=(Es=ah(Kl,Es))>-1?1:0;np&&(Es*=Ad/24),tr.glyphOffsetArray.length>=Ji.MAX_GLYPHS&&Ri("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==ma.sortKey&&tr.addToSortKeyRanges(tr.symbolInstances.length,ma.sortKey),tr.symbolInstances.emplaceBack(os.x,os.y,Us.right>=0?Us.right:-1,Us.center>=0?Us.center:-1,Us.left>=0?Us.left:-1,Us.vertical||-1,Mh,Dh,Jc,Cd,Ld,zd,kd,Md,Dd,Od,Bd,Tu,Xc,Kc,Wc,Hc,np,0,kh,Oh,Bh,Es)}(hi,wu,Ed,Wi,bi,Mo,bs,hi.layers[0],hi.collisionBoxArray,$i.index,$i.sourceLayerIndex,hi.index,dl,Wu,Hu,mo,Rs,jl,Xu,ws,$i,fo,Li,xs,pn)};if("line"===Fs)for(var Vl=0,Ku=mc($i.geometry,0,0,8192,8192);Vl<Ku.length;Vl+=1)for(var Ju=Ku[Vl],mu=0,_u=ld(Ju,Nl,du,Wi.vertical||qa,bi,24,Ul,hi.overscaling,8192);mu<_u.length;mu+=1){var Yu=_u[mu];qa&&pd(hi,qa.text,fu,Yu)||Ys(Ju,Yu)}else if("line-center"===Fs)for(var yu=0,gu=$i.geometry;yu<gu.length;yu+=1){var vu=gu[yu];if(vu.length>1){var $u=sd(vu,du,Wi.vertical||qa,bi,24,Ul);$u&&Ys(vu,$u)}}else if("Polygon"===$i.type)for(var ql=0,Qu=fh($i.geometry,0);ql<Qu.length;ql+=1){var Gl=Qu[ql],xu=hd(Gl,16);Ys(Gl[0],new zl(xu.x,xu.y,0))}else if("LineString"===$i.type)for(var fl=0,bu=$i.geometry;fl<bu.length;fl+=1){var Wl=bu[fl];Ys(Wl,new zl(Wl[0].x,Wl[0].y,0))}else if("Point"===$i.type)for(var Ih=0,Oc=$i.geometry;Ih<Oc.length;Ih+=1)for(var Ch=0,Bc=Oc[Ih];Ch<Bc.length;Ch+=1){var Lh=Bc[Ch];Ys([Lh],new zl(Lh.x,Lh.y,0))}}(t,St,oe,Zr,s,E,Qt,_e,ae,wo,f)},gt=0,xt=t.features;gt<xt.length;gt+=1)pt();p&&t.generateCollisionDebugBuffers()},c.perspective=function(t,e,i,s,h){var p,f=1/Math.tan(e/2);return t[0]=f/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=h&&h!==1/0?(t[10]=(h+s)*(p=1/(s-h)),t[14]=2*h*s*p):(t[10]=-1,t[14]=-2*s),t},c.pick=function(t,e){for(var i={},s=0;s<e.length;s++){var h=e[s];h in t&&(i[h]=t[h])}return i},c.plugin=co,c.polygonIntersectsPolygon=ys,c.postMapLoadEvent=Jt,c.postTurnstileEvent=ht,c.potpack=rc,c.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],c.register=Zt,c.registerForPluginStateChange=function(t){return t({pluginStatus:Jn,pluginURL:No}),ps.on("pluginStateChange",t),t},c.renderColorRamp=Uh,c.rotate=function(t,e,i){var s=e[0],h=e[1],p=e[2],f=e[3],v=Math.sin(i),T=Math.cos(i);return t[0]=s*T+p*v,t[1]=h*T+f*v,t[2]=s*-v+p*T,t[3]=h*-v+f*T,t},c.rotateX=function(t,e,i){var s=Math.sin(i),h=Math.cos(i),p=e[4],f=e[5],v=e[6],T=e[7],E=e[8],C=e[9],k=e[10],B=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=p*h+E*s,t[5]=f*h+C*s,t[6]=v*h+k*s,t[7]=T*h+B*s,t[8]=E*h-p*s,t[9]=C*h-f*s,t[10]=k*h-v*s,t[11]=B*h-T*s,t},c.rotateZ=function(t,e,i){var s=Math.sin(i),h=Math.cos(i),p=e[0],f=e[1],v=e[2],T=e[3],E=e[4],C=e[5],k=e[6],B=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=p*h+E*s,t[1]=f*h+C*s,t[2]=v*h+k*s,t[3]=T*h+B*s,t[4]=E*h-p*s,t[5]=C*h-f*s,t[6]=k*h-v*s,t[7]=B*h-T*s,t},c.scale=function(t,e,i){var s=i[0],h=i[1],p=i[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*h,t[5]=e[5]*h,t[6]=e[6]*h,t[7]=e[7]*h,t[8]=e[8]*p,t[9]=e[9]*p,t[10]=e[10]*p,t[11]=e[11]*p,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},c.scale$1=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},c.scale$2=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},c.setCacheLimits=function(t,e){ue=t,Ae=e},c.setRTLTextPlugin=function(t,e,i){if(void 0===i&&(i=!1),"deferred"===Jn||"loading"===Jn||"loaded"===Jn)throw new Error("setRTLTextPlugin cannot be called multiple times.");No=Xr.resolveURL(t),Jn="deferred",ho=e,cs(),i||ha()},c.sphericalToCartesian=function(t){var e=t[0],i=t[1],s=t[2];return i+=90,i*=Math.PI/180,s*=Math.PI/180,{x:e*Math.cos(i)*Math.sin(s),y:e*Math.sin(i)*Math.sin(s),z:e*Math.cos(s)}},c.sqrLen=function(t){var e=t[0],i=t[1];return e*e+i*i},c.styleSpec=j,c.sub=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},c.symbolSize=ad,c.transformMat3=function(t,e,i){var s=e[0],h=e[1],p=e[2];return t[0]=s*i[0]+h*i[3]+p*i[6],t[1]=s*i[1]+h*i[4]+p*i[7],t[2]=s*i[2]+h*i[5]+p*i[8],t},c.transformMat4=Tl,c.translate=function(t,e,i){var s,h,p,f,v,T,E,C,k,B,U,J,Y=i[0],at=i[1],it=i[2];return e===t?(t[12]=e[0]*Y+e[4]*at+e[8]*it+e[12],t[13]=e[1]*Y+e[5]*at+e[9]*it+e[13],t[14]=e[2]*Y+e[6]*at+e[10]*it+e[14],t[15]=e[3]*Y+e[7]*at+e[11]*it+e[15]):(h=e[1],p=e[2],f=e[3],v=e[4],T=e[5],E=e[6],C=e[7],k=e[8],B=e[9],U=e[10],J=e[11],t[0]=s=e[0],t[1]=h,t[2]=p,t[3]=f,t[4]=v,t[5]=T,t[6]=E,t[7]=C,t[8]=k,t[9]=B,t[10]=U,t[11]=J,t[12]=s*Y+v*at+k*it+e[12],t[13]=h*Y+T*at+B*it+e[13],t[14]=p*Y+E*at+U*it+e[14],t[15]=f*Y+C*at+J*it+e[15]),t},c.triggerPluginCompletionEvent=tl,c.uniqueId=wi,c.validateCustomStyleLayer=function(t){var e=[],i=t.id;return void 0===i&&e.push({message:"layers."+i+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+i+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),e},c.validateLight=ii,c.validateStyle=Ve,c.values=function(t){var e=[];for(var i in t)e.push(t[i]);return e},c.vectorTile=Al,c.version="1.13.1",c.warnOnce=Ri,c.webpSupported=hn,c.window=Nt,c.wrap=Oe}),wn(0,function(c){function gi(z){var O=typeof z;if("number"===O||"boolean"===O||"string"===O||null==z)return JSON.stringify(z);if(Array.isArray(z)){for(var F="[",G=0,X=z;G<X.length;G+=1)F+=gi(X[G])+",";return F+"]"}for(var nt=Object.keys(z).sort(),st="{",j=0;j<nt.length;j++)st+=JSON.stringify(nt[j])+":"+gi(z[nt[j]])+",";return st+"}"}function Mt(z){for(var O="",F=0,G=c.refProperties;F<G.length;F+=1)O+="/"+gi(z[G[F]]);return O}var Ue=function(z){this.keyCache={},z&&this.replace(z)};Ue.prototype.replace=function(z){this._layerConfigs={},this._layers={},this.update(z,[])},Ue.prototype.update=function(z,O){for(var F=this,G=0,X=z;G<X.length;G+=1){var nt=X[G];this._layerConfigs[nt.id]=nt;var st=this._layers[nt.id]=c.createStyleLayer(nt);st._featureFilter=c.featureFilter(st.filter),this.keyCache[nt.id]&&delete this.keyCache[nt.id]}for(var j=0,et=O;j<et.length;j+=1){var ft=et[j];delete this.keyCache[ft],delete this._layerConfigs[ft],delete this._layers[ft]}this.familiesBySource={};for(var kt=0,Rt=function(Kt,Yt){for(var ze={},$t=0;$t<Kt.length;$t++){var Je=Yt&&Yt[Kt[$t].id]||Mt(Kt[$t]);Yt&&(Yt[Kt[$t].id]=Je);var Ze=ze[Je];Ze||(Ze=ze[Je]=[]),Ze.push(Kt[$t])}var Be=[];for(var si in ze)Be.push(ze[si]);return Be}(c.values(this._layerConfigs),this.keyCache);kt<Rt.length;kt+=1){var bt=Rt[kt].map(function(Kt){return F._layers[Kt.id]}),vt=bt[0];if("none"!==vt.visibility){var ne=vt.source||"",Ft=this.familiesBySource[ne];Ft||(Ft=this.familiesBySource[ne]={});var Pt=vt.sourceLayer||"_geojsonTileLayer",te=Ft[Pt];te||(te=Ft[Pt]=[]),te.push(bt)}}};var le=function(z){var O={},F=[];for(var G in z){var X=z[G],nt=O[G]={};for(var st in X){var j=X[+st];if(j&&0!==j.bitmap.width&&0!==j.bitmap.height){var et={x:0,y:0,w:j.bitmap.width+2,h:j.bitmap.height+2};F.push(et),nt[st]={rect:et,metrics:j.metrics}}}}var ft=c.potpack(F),kt=new c.AlphaImage({width:ft.w||1,height:ft.h||1});for(var Rt in z){var bt=z[Rt];for(var vt in bt){var ne=bt[+vt];if(ne&&0!==ne.bitmap.width&&0!==ne.bitmap.height){var Ft=O[Rt][vt].rect;c.AlphaImage.copy(ne.bitmap,kt,{x:0,y:0},{x:Ft.x+1,y:Ft.y+1},ne.bitmap)}}}this.image=kt,this.positions=O};c.register("GlyphAtlas",le);var en=function(z){this.tileID=new c.OverscaledTileID(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId};function Nt(z,O,F){for(var G=new c.EvaluationParameters(O),X=0,nt=z;X<nt.length;X+=1)nt[X].recalculate(G,F)}function dn(z,O){var F=c.getArrayBuffer(z.request,function(G,X,nt,st){G?O(G):X&&O(null,{vectorTile:new c.vectorTile.VectorTile(new c.pbf(X)),rawData:X,cacheControl:nt,expires:st})});return function(){F.cancel(),O()}}en.prototype.parse=function(z,O,F,G,X){var nt=this;this.status="parsing",this.data=z,this.collisionBoxArray=new c.CollisionBoxArray;var st=new c.DictionaryCoder(Object.keys(z.layers).sort()),j=new c.FeatureIndex(this.tileID,this.promoteId);j.bucketLayerIDs=[];var et,ft,kt,Rt,bt={},vt={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:F},ne=O.familiesBySource[this.source];for(var Ft in ne){var Pt=z.layers[Ft];if(Pt){1===Pt.version&&c.warnOnce('Vector tile source "'+this.source+'" layer "'+Ft+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var te=st.encode(Ft),Kt=[],Yt=0;Yt<Pt.length;Yt++){var ze=Pt.feature(Yt),$t=j.getId(ze,Ft);Kt.push({feature:ze,id:$t,index:Yt,sourceLayerIndex:te})}for(var Je=0,Ze=ne[Ft];Je<Ze.length;Je+=1){var Be=Ze[Je],si=Be[0];si.minzoom&&this.zoom<Math.floor(si.minzoom)||si.maxzoom&&this.zoom>=si.maxzoom||"none"!==si.visibility&&(Nt(Be,this.zoom,F),(bt[si.id]=si.createBucket({index:j.bucketLayerIDs.length,layers:Be,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:te,sourceID:this.source})).populate(Kt,vt,this.tileID.canonical),j.bucketLayerIDs.push(Be.map(function(vi){return vi.id})))}}}var ti=c.mapObject(vt.glyphDependencies,function(vi){return Object.keys(vi).map(Number)});Object.keys(ti).length?G.send("getGlyphs",{uid:this.uid,stacks:ti},function(vi,Ye){et||(et=vi,ft=Ye,rn.call(nt))}):ft={};var br=Object.keys(vt.iconDependencies);br.length?G.send("getImages",{icons:br,source:this.source,tileID:this.tileID,type:"icons"},function(vi,Ye){et||(et=vi,kt=Ye,rn.call(nt))}):kt={};var di=Object.keys(vt.patternDependencies);function rn(){if(et)return X(et);if(ft&&kt&&Rt){var vi=new le(ft),Ye=new c.ImageAtlas(kt,Rt);for(var fe in bt){var An=bt[fe];An instanceof c.SymbolBucket?(Nt(An.layers,this.zoom,F),c.performSymbolLayout(An,ft,vi.positions,kt,Ye.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):An.hasPattern&&(An instanceof c.LineBucket||An instanceof c.FillBucket||An instanceof c.FillExtrusionBucket)&&(Nt(An.layers,this.zoom,F),An.addFeatures(vt,this.tileID.canonical,Ye.patternPositions))}this.status="done",X(null,{buckets:c.values(bt).filter(function(ya){return!ya.isEmpty()}),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vi.image,imageAtlas:Ye,glyphMap:this.returnDependencies?ft:null,iconMap:this.returnDependencies?kt:null,glyphPositions:this.returnDependencies?vi.positions:null})}}di.length?G.send("getImages",{icons:di,source:this.source,tileID:this.tileID,type:"patterns"},function(vi,Ye){et||(et=vi,Rt=Ye,rn.call(nt))}):Rt={},rn.call(this)};var nn=function(z,O,F,G){this.actor=z,this.layerIndex=O,this.availableImages=F,this.loadVectorData=G||dn,this.loading={},this.loaded={}};nn.prototype.loadTile=function(z,O){var F=this,G=z.uid;this.loading||(this.loading={});var X=!!(z&&z.request&&z.request.collectResourceTiming)&&new c.RequestPerformance(z.request),nt=this.loading[G]=new en(z);nt.abort=this.loadVectorData(z,function(st,j){if(delete F.loading[G],st||!j)return nt.status="done",F.loaded[G]=nt,O(st);var et=j.rawData,ft={};j.expires&&(ft.expires=j.expires),j.cacheControl&&(ft.cacheControl=j.cacheControl);var kt={};if(X){var Rt=X.finish();Rt&&(kt.resourceTiming=JSON.parse(JSON.stringify(Rt)))}nt.vectorTile=j.vectorTile,nt.parse(j.vectorTile,F.layerIndex,F.availableImages,F.actor,function(bt,vt){if(bt||!vt)return O(bt);O(null,c.extend({rawTileData:et.slice(0)},vt,ft,kt))}),F.loaded=F.loaded||{},F.loaded[G]=nt})},nn.prototype.reloadTile=function(z,O){var F=this,G=this.loaded,X=z.uid,nt=this;if(G&&G[X]){var st=G[X];st.showCollisionBoxes=z.showCollisionBoxes;var j=function(et,ft){var kt=st.reloadCallback;kt&&(delete st.reloadCallback,st.parse(st.vectorTile,nt.layerIndex,F.availableImages,nt.actor,kt)),O(et,ft)};"parsing"===st.status?st.reloadCallback=j:"done"===st.status&&(st.vectorTile?st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,j):j())}},nn.prototype.abortTile=function(z,O){var F=this.loading,G=z.uid;F&&F[G]&&F[G].abort&&(F[G].abort(),delete F[G]),O()},nn.prototype.removeTile=function(z,O){var F=this.loaded,G=z.uid;F&&F[G]&&delete F[G],O()};var Se=c.window.ImageBitmap,er=function(){this.loaded={}};function Oe(z,O){if(0!==z.length){Ct(z[0],O);for(var F=1;F<z.length;F++)Ct(z[F],!O)}}function Ct(z,O){for(var F=0,G=0,X=z.length,nt=X-1;G<X;nt=G++)F+=(z[G][0]-z[nt][0])*(z[nt][1]+z[G][1]);F>=0!=!!O&&z.reverse()}er.prototype.loadTile=function(z,O){var F=z.uid,G=z.encoding,X=z.rawImageData,nt=Se&&X instanceof Se?this.getImageData(X):X,st=new c.DEMData(F,nt,G);this.loaded=this.loaded||{},this.loaded[F]=st,O(null,st)},er.prototype.getImageData=function(z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(z.width,z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=z.width,this.offscreenCanvas.height=z.height,this.offscreenCanvasContext.drawImage(z,0,0,z.width,z.height);var O=this.offscreenCanvasContext.getImageData(-1,-1,z.width+2,z.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new c.RGBAImage({width:O.width,height:O.height},O.data)},er.prototype.removeTile=function(z){var O=this.loaded,F=z.uid;O&&O[F]&&delete O[F]};var ln=c.vectorTile.VectorTileFeature.prototype.toGeoJSON,wi=function(z){this._feature=z,this.extent=c.EXTENT,this.type=z.type,this.properties=z.tags,"id"in z&&!isNaN(z.id)&&(this.id=parseInt(z.id,10))};wi.prototype.loadGeometry=function(){if(1===this._feature.type){for(var z=[],O=0,F=this._feature.geometry;O<F.length;O+=1){var G=F[O];z.push([new c.Point$1(G[0],G[1])])}return z}for(var X=[],nt=0,st=this._feature.geometry;nt<st.length;nt+=1){for(var j=[],et=0,ft=st[nt];et<ft.length;et+=1){var kt=ft[et];j.push(new c.Point$1(kt[0],kt[1]))}X.push(j)}return X},wi.prototype.toGeoJSON=function(z,O,F){return ln.call(this,z,O,F)};var Bi=function(z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.EXTENT,this.length=z.length,this._features=z};Bi.prototype.feature=function(z){return new wi(this._features[z])};var ci=c.vectorTile.VectorTileFeature,pi=qi;function qi(z,O){this.options=O||{},this.features=z,this.length=z.length}function ki(z,O){this.id="number"==typeof z.id?z.id:void 0,this.type=z.type,this.rawGeometry=1===z.type?[z.geometry]:z.geometry,this.properties=z.tags,this.extent=O||4096}qi.prototype.feature=function(z){return new ki(this.features[z],this.options.extent)},ki.prototype.loadGeometry=function(){var z=this.rawGeometry;this.geometry=[];for(var O=0;O<z.length;O++){for(var F=z[O],G=[],X=0;X<F.length;X++)G.push(new c.Point$1(F[X][0],F[X][1]));this.geometry.push(G)}return this.geometry},ki.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var z=this.geometry,O=1/0,F=-1/0,G=1/0,X=-1/0,nt=0;nt<z.length;nt++)for(var st=z[nt],j=0;j<st.length;j++){var et=st[j];O=Math.min(O,et.x),F=Math.max(F,et.x),G=Math.min(G,et.y),X=Math.max(X,et.y)}return[O,G,F,X]},ki.prototype.toGeoJSON=ci.prototype.toGeoJSON;var Mi=Wn,Gn=pi;function Wn(z){var O=new c.pbf;return function(F,G){for(var X in F.layers)G.writeMessage(3,Ri,F.layers[X])}(z,O),O.finish()}function Ri(z,O){var F;O.writeVarintField(15,z.version||1),O.writeStringField(1,z.name||""),O.writeVarintField(5,z.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<z.length;F++)G.feature=z.feature(F),O.writeMessage(2,un,G);var X=G.keys;for(F=0;F<X.length;F++)O.writeStringField(3,X[F]);var nt=G.values;for(F=0;F<nt.length;F++)O.writeMessage(4,vr,nt[F])}function un(z,O){var F=z.feature;void 0!==F.id&&O.writeVarintField(1,F.id),O.writeMessage(2,qe,z),O.writeVarintField(3,F.type),O.writeMessage(4,kr,F)}function qe(z,O){var F=z.feature,G=z.keys,X=z.values,nt=z.keycache,st=z.valuecache;for(var j in F.properties){var et=nt[j];void 0===et&&(G.push(j),nt[j]=et=G.length-1),O.writeVarint(et);var ft=F.properties[j],kt=typeof ft;"string"!==kt&&"boolean"!==kt&&"number"!==kt&&(ft=JSON.stringify(ft));var Rt=kt+":"+ft,bt=st[Rt];void 0===bt&&(X.push(ft),st[Rt]=bt=X.length-1),O.writeVarint(bt)}}function hr(z,O){return(O<<3)+(7&z)}function Gr(z){return z<<1^z>>31}function kr(z,O){for(var F=z.loadGeometry(),G=z.type,X=0,nt=0,st=F.length,j=0;j<st;j++){var et=F[j],ft=1;1===G&&(ft=et.length),O.writeVarint(hr(1,ft));for(var kt=3===G?et.length-1:et.length,Rt=0;Rt<kt;Rt++){1===Rt&&1!==G&&O.writeVarint(hr(2,kt-1));var bt=et[Rt].x-X,vt=et[Rt].y-nt;O.writeVarint(Gr(bt)),O.writeVarint(Gr(vt)),X+=bt,nt+=vt}3===G&&O.writeVarint(hr(7,1))}}function vr(z,O){var F=typeof z;"string"===F?O.writeStringField(1,z):"boolean"===F?O.writeBooleanField(7,z):"number"===F&&(z%1!=0?O.writeDoubleField(3,z):z<0?O.writeSVarintField(6,z):O.writeVarintField(5,z))}function Dn(z,O,F,G){On(z,F,G),On(O,2*F,2*G),On(O,2*F+1,2*G+1)}function On(z,O,F){var G=z[O];z[O]=z[F],z[F]=G}function xr(z,O,F,G){var X=z-F,nt=O-G;return X*X+nt*nt}Mi.fromVectorTileJs=Wn,Mi.fromGeojsonVt=function(z,O){O=O||{};var F={};for(var G in z)F[G]=new pi(z[G].features,O),F[G].name=G,F[G].version=O.version,F[G].extent=O.extent;return Wn({layers:F})},Mi.GeoJSONWrapper=Gn;var _o=function(z){return z[0]},Wr=function(z){return z[1]},Hr=function(z,O,F,G,X){void 0===O&&(O=_o),void 0===F&&(F=Wr),void 0===G&&(G=64),void 0===X&&(X=Float64Array),this.nodeSize=G,this.points=z;for(var nt=z.length<65536?Uint16Array:Uint32Array,st=this.ids=new nt(z.length),j=this.coords=new X(2*z.length),et=0;et<z.length;et++)st[et]=et,j[2*et]=O(z[et]),j[2*et+1]=F(z[et]);!function ft(kt,Rt,bt,vt,ne,Ft){if(!(ne-vt<=bt)){var Pt=vt+ne>>1;(function te(Kt,Yt,ze,$t,Je,Ze){for(;Je>$t;){if(Je-$t>600){var Be=Je-$t+1,si=ze-$t+1,ti=Math.log(Be),br=.5*Math.exp(2*ti/3),di=.5*Math.sqrt(ti*br*(Be-br)/Be)*(si-Be/2<0?-1:1);te(Kt,Yt,ze,Math.max($t,Math.floor(ze-si*br/Be+di)),Math.min(Je,Math.floor(ze+(Be-si)*br/Be+di)),Ze)}var rn=Yt[2*ze+Ze],vi=$t,Ye=Je;for(Dn(Kt,Yt,$t,ze),Yt[2*Je+Ze]>rn&&Dn(Kt,Yt,$t,Je);vi<Ye;){for(Dn(Kt,Yt,vi,Ye),vi++,Ye--;Yt[2*vi+Ze]<rn;)vi++;for(;Yt[2*Ye+Ze]>rn;)Ye--}Yt[2*$t+Ze]===rn?Dn(Kt,Yt,$t,Ye):Dn(Kt,Yt,++Ye,Je),Ye<=ze&&($t=Ye+1),ze<=Ye&&(Je=Ye-1)}})(kt,Rt,Pt,vt,ne,Ft%2),ft(kt,Rt,bt,vt,Pt-1,Ft+1),ft(kt,Rt,bt,Pt+1,ne,Ft+1)}}(st,j,G,0,st.length-1,0)};Hr.prototype.range=function(z,O,F,G){return function(X,nt,st,j,et,ft,kt){for(var Rt,bt,vt=[0,X.length-1,0],ne=[];vt.length;){var Ft=vt.pop(),Pt=vt.pop(),te=vt.pop();if(Pt-te<=kt)for(var Kt=te;Kt<=Pt;Kt++)bt=nt[2*Kt+1],(Rt=nt[2*Kt])>=st&&Rt<=et&&bt>=j&&bt<=ft&&ne.push(X[Kt]);else{var Yt=Math.floor((te+Pt)/2);bt=nt[2*Yt+1],(Rt=nt[2*Yt])>=st&&Rt<=et&&bt>=j&&bt<=ft&&ne.push(X[Yt]);var ze=(Ft+1)%2;(0===Ft?st<=Rt:j<=bt)&&(vt.push(te),vt.push(Yt-1),vt.push(ze)),(0===Ft?et>=Rt:ft>=bt)&&(vt.push(Yt+1),vt.push(Pt),vt.push(ze))}}return ne}(this.ids,this.coords,z,O,F,G,this.nodeSize)},Hr.prototype.within=function(z,O,F){return function(G,X,nt,st,j,et){for(var ft=[0,G.length-1,0],kt=[],Rt=j*j;ft.length;){var bt=ft.pop(),vt=ft.pop(),ne=ft.pop();if(vt-ne<=et)for(var Ft=ne;Ft<=vt;Ft++)xr(X[2*Ft],X[2*Ft+1],nt,st)<=Rt&&kt.push(G[Ft]);else{var Pt=Math.floor((ne+vt)/2),te=X[2*Pt],Kt=X[2*Pt+1];xr(te,Kt,nt,st)<=Rt&&kt.push(G[Pt]);var Yt=(bt+1)%2;(0===bt?nt-j<=te:st-j<=Kt)&&(ft.push(ne),ft.push(Pt-1),ft.push(Yt)),(0===bt?nt+j>=te:st+j>=Kt)&&(ft.push(Pt+1),ft.push(vt),ft.push(Yt))}}return kt}(this.ids,this.coords,z,O,F,this.nodeSize)};var _a={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(z){return z}},Hn=function(z){this.options=To(Object.create(_a),z),this.trees=new Array(this.options.maxZoom+1)};function Xr(z,O,F,G,X){return{x:z,y:O,zoom:1/0,id:F,parentId:-1,numPoints:G,properties:X}}function ei(z,O){var F=z.geometry.coordinates,G=F[1];return{x:Bn(F[0]),y:je(G),zoom:1/0,index:O,parentId:-1}}function hn(z){return{type:"Feature",id:z.id,properties:re(z),geometry:{type:"Point",coordinates:[(G=z.x,360*(G-.5)),(O=z.y,F=(180-360*O)*Math.PI/180,360*Math.atan(Math.exp(F))/Math.PI-90)]}};var O,F,G}function re(z){var O=z.numPoints,F=O>=1e4?Math.round(O/1e3)+"k":O>=1e3?Math.round(O/100)/10+"k":O;return To(To({},z.properties),{cluster:!0,cluster_id:z.id,point_count:O,point_count_abbreviated:F})}function Bn(z){return z/360+.5}function je(z){var O=Math.sin(z*Math.PI/180),F=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return F<0?0:F>1?1:F}function To(z,O){for(var F in O)z[F]=O[F];return z}function Rn(z){return z.x}function Tn(z){return z.y}function En(z,O,F,G,X,nt){var st=X-F,j=nt-G;if(0!==st||0!==j){var et=((z-F)*st+(O-G)*j)/(st*st+j*j);et>1?(F=X,G=nt):et>0&&(F+=st*et,G+=j*et)}return(st=z-F)*st+(j=O-G)*j}function Pi(z,O,F,G){var X={id:void 0===z?null:z,type:O,geometry:F,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(nt){var st=nt.geometry,j=nt.type;if("Point"===j||"MultiPoint"===j||"LineString"===j)Hi(nt,st);else if("Polygon"===j||"MultiLineString"===j)for(var et=0;et<st.length;et++)Hi(nt,st[et]);else if("MultiPolygon"===j)for(et=0;et<st.length;et++)for(var ft=0;ft<st[et].length;ft++)Hi(nt,st[et][ft])}(X),X}function Hi(z,O){for(var F=0;F<O.length;F+=3)z.minX=Math.min(z.minX,O[F]),z.minY=Math.min(z.minY,O[F+1]),z.maxX=Math.max(z.maxX,O[F]),z.maxY=Math.max(z.maxY,O[F+1])}function Fi(z,O,F,G){if(O.geometry){var X=O.geometry.coordinates,nt=O.geometry.type,st=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2),j=[],et=O.id;if(F.promoteId?et=O.properties[F.promoteId]:F.generateId&&(et=G||0),"Point"===nt)io(X,j);else if("MultiPoint"===nt)for(var ft=0;ft<X.length;ft++)io(X[ft],j);else if("LineString"===nt)no(X,j,st,!1);else if("MultiLineString"===nt){if(F.lineMetrics){for(ft=0;ft<X.length;ft++)no(X[ft],j=[],st,!1),z.push(Pi(et,"LineString",j,O.properties));return}x(X,j,st,!1)}else if("Polygon"===nt)x(X,j,st,!0);else{if("MultiPolygon"!==nt){if("GeometryCollection"===nt){for(ft=0;ft<O.geometry.geometries.length;ft++)Fi(z,{id:et,geometry:O.geometry.geometries[ft],properties:O.properties},F,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ft=0;ft<X.length;ft++){var kt=[];x(X[ft],kt,st,!0),j.push(kt)}}z.push(Pi(et,nt,j,O.properties))}}function io(z,O){O.push(S(z[0])),O.push(D(z[1])),O.push(0)}function no(z,O,F,G){for(var X,nt,st=0,j=0;j<z.length;j++){var et=S(z[j][0]),ft=D(z[j][1]);O.push(et),O.push(ft),O.push(0),j>0&&(st+=G?(X*ft-et*nt)/2:Math.sqrt(Math.pow(et-X,2)+Math.pow(ft-nt,2))),X=et,nt=ft}var kt=O.length-3;O[2]=1,function Rt(bt,vt,ne,Ft){for(var Pt,te=Ft,Kt=ne-vt>>1,Yt=ne-vt,ze=bt[vt],$t=bt[vt+1],Je=bt[ne],Ze=bt[ne+1],Be=vt+3;Be<ne;Be+=3){var si=En(bt[Be],bt[Be+1],ze,$t,Je,Ze);if(si>te)Pt=Be,te=si;else if(si===te){var ti=Math.abs(Be-Kt);ti<Yt&&(Pt=Be,Yt=ti)}}te>Ft&&(Pt-vt>3&&Rt(bt,vt,Pt,Ft),bt[Pt+2]=te,ne-Pt>3&&Rt(bt,Pt,ne,Ft))}(O,0,kt,F),O[kt+2]=1,O.size=Math.abs(st),O.start=0,O.end=O.size}function x(z,O,F,G){for(var X=0;X<z.length;X++){var nt=[];no(z[X],nt,F,G),O.push(nt)}}function S(z){return z/360+.5}function D(z){var O=Math.sin(z*Math.PI/180),F=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return F<0?0:F>1?1:F}function W(z,O,F,G,X,nt,st,j){if(G/=O,nt>=(F/=O)&&st<G)return z;if(st<F||nt>=G)return null;for(var et=[],ft=0;ft<z.length;ft++){var kt=z[ft],Rt=kt.geometry,bt=kt.type,vt=0===X?kt.minX:kt.minY,ne=0===X?kt.maxX:kt.maxY;if(vt>=F&&ne<G)et.push(kt);else if(!(ne<F||vt>=G)){var Ft=[];if("Point"===bt||"MultiPoint"===bt)tt(Rt,Ft,F,G,X);else if("LineString"===bt)ht(Rt,Ft,F,G,X,!1,j.lineMetrics);else if("MultiLineString"===bt)Jt(Rt,Ft,F,G,X,!1);else if("Polygon"===bt)Jt(Rt,Ft,F,G,X,!0);else if("MultiPolygon"===bt)for(var Pt=0;Pt<Rt.length;Pt++){var te=[];Jt(Rt[Pt],te,F,G,X,!0),te.length&&Ft.push(te)}if(Ft.length){if(j.lineMetrics&&"LineString"===bt){for(Pt=0;Pt<Ft.length;Pt++)et.push(Pi(kt.id,bt,Ft[Pt],kt.tags));continue}"LineString"!==bt&&"MultiLineString"!==bt||(1===Ft.length?(bt="LineString",Ft=Ft[0]):bt="MultiLineString"),"Point"!==bt&&"MultiPoint"!==bt||(bt=3===Ft.length?"Point":"MultiPoint"),et.push(Pi(kt.id,bt,Ft,kt.tags))}}}return et.length?et:null}function tt(z,O,F,G,X){for(var nt=0;nt<z.length;nt+=3){var st=z[nt+X];st>=F&&st<=G&&(O.push(z[nt]),O.push(z[nt+1]),O.push(z[nt+2]))}}function ht(z,O,F,G,X,nt,st){for(var j,et,ft=Lt(z),kt=0===X?Ae:Di,Rt=z.start,bt=0;bt<z.length-3;bt+=3){var vt=z[bt],ne=z[bt+1],Ft=z[bt+2],Pt=z[bt+3],te=z[bt+4],Kt=0===X?vt:ne,Yt=0===X?Pt:te,ze=!1;st&&(j=Math.sqrt(Math.pow(vt-Pt,2)+Math.pow(ne-te,2))),Kt<F?Yt>F&&(et=kt(ft,vt,ne,Pt,te,F),st&&(ft.start=Rt+j*et)):Kt>G?Yt<G&&(et=kt(ft,vt,ne,Pt,te,G),st&&(ft.start=Rt+j*et)):ue(ft,vt,ne,Ft),Yt<F&&Kt>=F&&(et=kt(ft,vt,ne,Pt,te,F),ze=!0),Yt>G&&Kt<=G&&(et=kt(ft,vt,ne,Pt,te,G),ze=!0),!nt&&ze&&(st&&(ft.end=Rt+j*et),O.push(ft),ft=Lt(z)),st&&(Rt+=j)}var $t=z.length-3;vt=z[$t],ne=z[$t+1],Ft=z[$t+2],(Kt=0===X?vt:ne)>=F&&Kt<=G&&ue(ft,vt,ne,Ft),$t=ft.length-3,nt&&$t>=3&&(ft[$t]!==ft[0]||ft[$t+1]!==ft[1])&&ue(ft,ft[0],ft[1],ft[2]),ft.length&&O.push(ft)}function Lt(z){var O=[];return O.size=z.size,O.start=z.start,O.end=z.end,O}function Jt(z,O,F,G,X,nt){for(var st=0;st<z.length;st++)ht(z[st],O,F,G,X,nt,!1)}function ue(z,O,F,G){z.push(O),z.push(F),z.push(G)}function Ae(z,O,F,G,X,nt){var st=(nt-O)/(G-O);return z.push(nt),z.push(F+(X-F)*st),z.push(1),st}function Di(z,O,F,G,X,nt){var st=(nt-F)/(X-F);return z.push(O+(G-O)*st),z.push(nt),z.push(1),st}function Qi(z,O){for(var F=[],G=0;G<z.length;G++){var X,nt=z[G],st=nt.type;if("Point"===st||"MultiPoint"===st||"LineString"===st)X=ji(nt.geometry,O);else if("MultiLineString"===st||"Polygon"===st){X=[];for(var j=0;j<nt.geometry.length;j++)X.push(ji(nt.geometry[j],O))}else if("MultiPolygon"===st)for(X=[],j=0;j<nt.geometry.length;j++){for(var et=[],ft=0;ft<nt.geometry[j].length;ft++)et.push(ji(nt.geometry[j][ft],O));X.push(et)}F.push(Pi(nt.id,st,X,nt.tags))}return F}function ji(z,O){var F=[];F.size=z.size,void 0!==z.start&&(F.start=z.start,F.end=z.end);for(var G=0;G<z.length;G+=3)F.push(z[G]+O,z[G+1],z[G+2]);return F}function ir(z,O){if(z.transformed)return z;var F,G,X,nt=1<<z.z,st=z.x,j=z.y;for(F=0;F<z.features.length;F++){var et=z.features[F],ft=et.geometry,kt=et.type;if(et.geometry=[],1===kt)for(G=0;G<ft.length;G+=2)et.geometry.push(Pn(ft[G],ft[G+1],O,nt,st,j));else for(G=0;G<ft.length;G++){var Rt=[];for(X=0;X<ft[G].length;X+=2)Rt.push(Pn(ft[G][X],ft[G][X+1],O,nt,st,j));et.geometry.push(Rt)}}return z.transformed=!0,z}function Pn(z,O,F,G,X,nt){return[Math.round(F*(z*G-X)),Math.round(F*(O*G-nt))]}function ri(z,O,F,G,X){for(var nt=O===X.maxZoom?0:X.tolerance/((1<<O)*X.extent),st={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:F,y:G,z:O,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},j=0;j<z.length;j++){st.numFeatures++,Ti(st,z[j],nt,X);var et=z[j].minX,ft=z[j].minY,kt=z[j].maxX,Rt=z[j].maxY;et<st.minX&&(st.minX=et),ft<st.minY&&(st.minY=ft),kt>st.maxX&&(st.maxX=kt),Rt>st.maxY&&(st.maxY=Rt)}return st}function Ti(z,O,F,G){var X=O.geometry,nt=O.type,st=[];if("Point"===nt||"MultiPoint"===nt)for(var j=0;j<X.length;j+=3)st.push(X[j]),st.push(X[j+1]),z.numPoints++,z.numSimplified++;else if("LineString"===nt)Mr(st,X,z,F,!1,!1);else if("MultiLineString"===nt||"Polygon"===nt)for(j=0;j<X.length;j++)Mr(st,X[j],z,F,"Polygon"===nt,0===j);else if("MultiPolygon"===nt)for(var et=0;et<X.length;et++){var ft=X[et];for(j=0;j<ft.length;j++)Mr(st,ft[j],z,F,!0,0===j)}if(st.length){var kt=O.tags||null;if("LineString"===nt&&G.lineMetrics){for(var Rt in kt={},O.tags)kt[Rt]=O.tags[Rt];kt.mapbox_clip_start=X.start/X.size,kt.mapbox_clip_end=X.end/X.size}var bt={geometry:st,type:"Polygon"===nt||"MultiPolygon"===nt?3:"LineString"===nt||"MultiLineString"===nt?2:1,tags:kt};null!==O.id&&(bt.id=O.id),z.features.push(bt)}}function Mr(z,O,F,G,X,nt){var st=G*G;if(G>0&&O.size<(X?st:G))F.numPoints+=O.length/3;else{for(var j=[],et=0;et<O.length;et+=3)(0===G||O[et+2]>st)&&(F.numSimplified++,j.push(O[et]),j.push(O[et+1])),F.numPoints++;X&&function(ft,kt){for(var Rt=0,bt=0,vt=ft.length,ne=vt-2;bt<vt;ne=bt,bt+=2)Rt+=(ft[bt]-ft[ne])*(ft[bt+1]+ft[ne+1]);if(Rt>0===kt)for(bt=0,vt=ft.length;bt<vt/2;bt+=2){var Ft=ft[bt],Pt=ft[bt+1];ft[bt]=ft[vt-2-bt],ft[bt+1]=ft[vt-1-bt],ft[vt-2-bt]=Ft,ft[vt-1-bt]=Pt}}(j,nt),z.push(j)}}function fn(z,O){var F=(O=this.options=function(X,nt){for(var st in nt)X[st]=nt[st];return X}(Object.create(this.options),O)).debug;if(F&&console.time("preprocess data"),O.maxZoom<0||O.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(O.promoteId&&O.generateId)throw new Error("promoteId and generateId cannot be used together.");var X,nt,st,j,et,ft,G=function(X,nt){var st=[];if("FeatureCollection"===X.type)for(var j=0;j<X.features.length;j++)Fi(st,X.features[j],nt,j);else Fi(st,"Feature"===X.type?X:{geometry:X},nt);return st}(z,O);this.tiles={},this.tileCoords=[],F&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",O.indexMaxZoom,O.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(X=G,nt=O,st=nt.buffer/nt.extent,j=X,et=W(X,1,-1-st,st,0,-1,2,nt),ft=W(X,1,1-st,2+st,0,-1,2,nt),(et||ft)&&(j=W(X,1,-st,1+st,0,-1,2,nt)||[],et&&(j=Qi(et,1).concat(j)),ft&&(j=j.concat(Qi(ft,-1)))),G=j).length&&this.splitTile(G,0,0,0),F&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function mn(z,O,F){return 32*((1<<z)*F+O)+z}function Kr(z,O){var F=z.tileID.canonical;if(!this._geoJSONIndex)return O(null,null);var G=this._geoJSONIndex.getTile(F.z,F.x,F.y);if(!G)return O(null,null);var X=new Bi(G.features),nt=Mi(X);0===nt.byteOffset&&nt.byteLength===nt.buffer.byteLength||(nt=new Uint8Array(nt)),O(null,{vectorTile:X,rawData:nt.buffer})}Hn.prototype.load=function(z){var O=this.options,F=O.log,G=O.minZoom,X=O.maxZoom,nt=O.nodeSize;F&&console.time("total time");var st="prepare "+z.length+" points";F&&console.time(st),this.points=z;for(var j=[],et=0;et<z.length;et++)z[et].geometry&&j.push(ei(z[et],et));this.trees[X+1]=new Hr(j,Rn,Tn,nt,Float32Array),F&&console.timeEnd(st);for(var ft=X;ft>=G;ft--){var kt=+Date.now();j=this._cluster(j,ft),this.trees[ft]=new Hr(j,Rn,Tn,nt,Float32Array),F&&console.log("z%d: %d clusters in %dms",ft,j.length,+Date.now()-kt)}return F&&console.timeEnd("total time"),this},Hn.prototype.getClusters=function(z,O){var F=((z[0]+180)%360+360)%360-180,G=Math.max(-90,Math.min(90,z[1])),X=180===z[2]?180:((z[2]+180)%360+360)%360-180,nt=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)F=-180,X=180;else if(F>X){var st=this.getClusters([F,G,180,nt],O),j=this.getClusters([-180,G,X,nt],O);return st.concat(j)}for(var et=this.trees[this._limitZoom(O)],ft=[],kt=0,Rt=et.range(Bn(F),je(nt),Bn(X),je(G));kt<Rt.length;kt+=1){var bt=et.points[Rt[kt]];ft.push(bt.numPoints?hn(bt):this.points[bt.index])}return ft},Hn.prototype.getChildren=function(z){var O=this._getOriginId(z),F=this._getOriginZoom(z),G="No cluster with the specified id.",X=this.trees[F];if(!X)throw new Error(G);var nt=X.points[O];if(!nt)throw new Error(G);for(var st=this.options.radius/(this.options.extent*Math.pow(2,F-1)),j=[],et=0,ft=X.within(nt.x,nt.y,st);et<ft.length;et+=1){var kt=X.points[ft[et]];kt.parentId===z&&j.push(kt.numPoints?hn(kt):this.points[kt.index])}if(0===j.length)throw new Error(G);return j},Hn.prototype.getLeaves=function(z,O,F){var G=[];return this._appendLeaves(G,z,O=O||10,F=F||0,0),G},Hn.prototype.getTile=function(z,O,F){var G=this.trees[this._limitZoom(z)],X=Math.pow(2,z),nt=this.options,st=nt.radius/nt.extent,j=(F-st)/X,et=(F+1+st)/X,ft={features:[]};return this._addTileFeatures(G.range((O-st)/X,j,(O+1+st)/X,et),G.points,O,F,X,ft),0===O&&this._addTileFeatures(G.range(1-st/X,j,1,et),G.points,X,F,X,ft),O===X-1&&this._addTileFeatures(G.range(0,j,st/X,et),G.points,-1,F,X,ft),ft.features.length?ft:null},Hn.prototype.getClusterExpansionZoom=function(z){for(var O=this._getOriginZoom(z)-1;O<=this.options.maxZoom;){var F=this.getChildren(z);if(O++,1!==F.length)break;z=F[0].properties.cluster_id}return O},Hn.prototype._appendLeaves=function(z,O,F,G,X){for(var nt=0,st=this.getChildren(O);nt<st.length;nt+=1){var j=st[nt],et=j.properties;if(et&&et.cluster?X+et.point_count<=G?X+=et.point_count:X=this._appendLeaves(z,et.cluster_id,F,G,X):X<G?X++:z.push(j),z.length===F)break}return X},Hn.prototype._addTileFeatures=function(z,O,F,G,X,nt){for(var st=0,j=z;st<j.length;st+=1){var et=O[j[st]],ft=et.numPoints,kt={type:1,geometry:[[Math.round(this.options.extent*(et.x*X-F)),Math.round(this.options.extent*(et.y*X-G))]],tags:ft?re(et):this.points[et.index].properties},Rt=void 0;ft?Rt=et.id:this.options.generateId?Rt=et.index:this.points[et.index].id&&(Rt=this.points[et.index].id),void 0!==Rt&&(kt.id=Rt),nt.features.push(kt)}},Hn.prototype._limitZoom=function(z){return Math.max(this.options.minZoom,Math.min(+z,this.options.maxZoom+1))},Hn.prototype._cluster=function(z,O){for(var F=[],G=this.options,X=G.reduce,nt=G.minPoints,st=G.radius/(G.extent*Math.pow(2,O)),j=0;j<z.length;j++){var et=z[j];if(!(et.zoom<=O)){et.zoom=O;for(var ft=this.trees[O+1],kt=ft.within(et.x,et.y,st),Rt=et.numPoints||1,bt=Rt,vt=0,ne=kt;vt<ne.length;vt+=1){var Ft=ft.points[ne[vt]];Ft.zoom>O&&(bt+=Ft.numPoints||1)}if(bt>=nt){for(var Pt=et.x*Rt,te=et.y*Rt,Kt=X&&Rt>1?this._map(et,!0):null,Yt=(j<<5)+(O+1)+this.points.length,ze=0,$t=kt;ze<$t.length;ze+=1){var Je=ft.points[$t[ze]];if(!(Je.zoom<=O)){Je.zoom=O;var Ze=Je.numPoints||1;Pt+=Je.x*Ze,te+=Je.y*Ze,Je.parentId=Yt,X&&(Kt||(Kt=this._map(et,!0)),X(Kt,this._map(Je)))}}et.parentId=Yt,F.push(Xr(Pt/bt,te/bt,Yt,bt,Kt))}else if(F.push(et),bt>1)for(var Be=0,si=kt;Be<si.length;Be+=1){var ti=ft.points[si[Be]];ti.zoom<=O||(ti.zoom=O,F.push(ti))}}}return F},Hn.prototype._getOriginId=function(z){return z-this.points.length>>5},Hn.prototype._getOriginZoom=function(z){return(z-this.points.length)%32},Hn.prototype._map=function(z,O){if(z.numPoints)return O?To({},z.properties):z.properties;var F=this.points[z.index].properties,G=this.options.map(F);return O&&G===F?To({},G):G},fn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},fn.prototype.splitTile=function(z,O,F,G,X,nt,st){for(var j=[z,O,F,G],et=this.options,ft=et.debug;j.length;){G=j.pop(),F=j.pop(),O=j.pop(),z=j.pop();var kt=1<<O,Rt=mn(O,F,G),bt=this.tiles[Rt];if(!bt&&(ft>1&&console.time("creation"),bt=this.tiles[Rt]=ri(z,O,F,G,et),this.tileCoords.push({z:O,x:F,y:G}),ft)){ft>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",O,F,G,bt.numFeatures,bt.numPoints,bt.numSimplified),console.timeEnd("creation"));var vt="z"+O;this.stats[vt]=(this.stats[vt]||0)+1,this.total++}if(bt.source=z,X){if(O===et.maxZoom||O===X)continue;var ne=1<<X-O;if(F!==Math.floor(nt/ne)||G!==Math.floor(st/ne))continue}else if(O===et.indexMaxZoom||bt.numPoints<=et.indexMaxPoints)continue;if(bt.source=null,0!==z.length){ft>1&&console.time("clipping");var Ft,Pt,te,Kt,Yt,ze,$t=.5*et.buffer/et.extent,Je=.5-$t,Ze=.5+$t,Be=1+$t;Ft=Pt=te=Kt=null,Yt=W(z,kt,F-$t,F+Ze,0,bt.minX,bt.maxX,et),ze=W(z,kt,F+Je,F+Be,0,bt.minX,bt.maxX,et),z=null,Yt&&(Ft=W(Yt,kt,G-$t,G+Ze,1,bt.minY,bt.maxY,et),Pt=W(Yt,kt,G+Je,G+Be,1,bt.minY,bt.maxY,et),Yt=null),ze&&(te=W(ze,kt,G-$t,G+Ze,1,bt.minY,bt.maxY,et),Kt=W(ze,kt,G+Je,G+Be,1,bt.minY,bt.maxY,et),ze=null),ft>1&&console.timeEnd("clipping"),j.push(Ft||[],O+1,2*F,2*G),j.push(Pt||[],O+1,2*F,2*G+1),j.push(te||[],O+1,2*F+1,2*G),j.push(Kt||[],O+1,2*F+1,2*G+1)}}},fn.prototype.getTile=function(z,O,F){var G=this.options,X=G.extent,nt=G.debug;if(z<0||z>24)return null;var st=1<<z,j=mn(z,O=(O%st+st)%st,F);if(this.tiles[j])return ir(this.tiles[j],X);nt>1&&console.log("drilling down to z%d-%d-%d",z,O,F);for(var et,ft=z,kt=O,Rt=F;!et&&ft>0;)ft--,kt=Math.floor(kt/2),Rt=Math.floor(Rt/2),et=this.tiles[mn(ft,kt,Rt)];return et&&et.source?(nt>1&&console.log("found parent tile z%d-%d-%d",ft,kt,Rt),nt>1&&console.time("drilling down"),this.splitTile(et.source,ft,kt,Rt,z,O,F),nt>1&&console.timeEnd("drilling down"),this.tiles[j]?ir(this.tiles[j],X):null):null};var Ce=function(z){function O(F,G,X,nt){z.call(this,F,G,X,Kr),nt&&(this.loadGeoJSON=nt)}return z&&(O.__proto__=z),(O.prototype=Object.create(z&&z.prototype)).constructor=O,O.prototype.loadData=function(F,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=G,this._pendingLoadDataParams=F,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},O.prototype._loadData=function(){var F=this;if(this._pendingCallback&&this._pendingLoadDataParams){var G=this._pendingCallback,X=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var nt=!!(X&&X.request&&X.request.collectResourceTiming)&&new c.RequestPerformance(X.request);this.loadGeoJSON(X,function(st,j){if(st||!j)return G(st);if("object"!=typeof j)return G(new Error("Input data given to '"+X.source+"' is not a valid GeoJSON object."));!function bt(vt,ne){var Ft,Pt=vt&&vt.type;if("FeatureCollection"===Pt)for(Ft=0;Ft<vt.features.length;Ft++)bt(vt.features[Ft],ne);else if("GeometryCollection"===Pt)for(Ft=0;Ft<vt.geometries.length;Ft++)bt(vt.geometries[Ft],ne);else if("Feature"===Pt)bt(vt.geometry,ne);else if("Polygon"===Pt)Oe(vt.coordinates,ne);else if("MultiPolygon"===Pt)for(Ft=0;Ft<vt.coordinates.length;Ft++)Oe(vt.coordinates[Ft],ne);return vt}(j,!0);try{if(X.filter){var et=c.createExpression(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===et.result)throw new Error(et.value.map(function(bt){return bt.key+": "+bt.message}).join(", "));var ft=j.features.filter(function(bt){return et.value.evaluate({zoom:0},bt)});j={type:"FeatureCollection",features:ft}}F._geoJSONIndex=X.cluster?new Hn(function(bt){var vt=bt.superclusterOptions,ne=bt.clusterProperties;if(!ne||!vt)return vt;for(var Ft={},Pt={},te={accumulated:null,zoom:0},Kt={properties:null},Yt=Object.keys(ne),ze=0,$t=Yt;ze<$t.length;ze+=1){var Je=$t[ze],Ze=ne[Je],Be=Ze[0],si=c.createExpression(Ze[1]),ti=c.createExpression("string"==typeof Be?[Be,["accumulated"],["get",Je]]:Be);Ft[Je]=si.value,Pt[Je]=ti.value}return vt.map=function(br){Kt.properties=br;for(var di={},rn=0,vi=Yt;rn<vi.length;rn+=1){var Ye=vi[rn];di[Ye]=Ft[Ye].evaluate(te,Kt)}return di},vt.reduce=function(br,di){Kt.properties=di;for(var rn=0,vi=Yt;rn<vi.length;rn+=1){var Ye=vi[rn];te.accumulated=br[Ye],br[Ye]=Pt[Ye].evaluate(te,Kt)}},vt}(X)).load(j.features):new fn(bt=j,X.geojsonVtOptions)}catch(bt){return G(bt)}var bt;F.loaded={};var kt={};if(nt){var Rt=nt.finish();Rt&&(kt.resourceTiming={},kt.resourceTiming[X.source]=JSON.parse(JSON.stringify(Rt)))}G(null,kt)})}},O.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},O.prototype.reloadTile=function(F,G){var X=this.loaded;return X&&X[F.uid]?z.prototype.reloadTile.call(this,F,G):this.loadTile(F,G)},O.prototype.loadGeoJSON=function(F,G){if(F.request)c.getJSON(F.request,G);else{if("string"!=typeof F.data)return G(new Error("Input data given to '"+F.source+"' is not a valid GeoJSON object."));try{return G(null,JSON.parse(F.data))}catch{return G(new Error("Input data given to '"+F.source+"' is not a valid GeoJSON object."))}}},O.prototype.removeSource=function(F,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),G()},O.prototype.getClusterExpansionZoom=function(F,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(F.clusterId))}catch(X){G(X)}},O.prototype.getClusterChildren=function(F,G){try{G(null,this._geoJSONIndex.getChildren(F.clusterId))}catch(X){G(X)}},O.prototype.getClusterLeaves=function(F,G){try{G(null,this._geoJSONIndex.getLeaves(F.clusterId,F.limit,F.offset))}catch(X){G(X)}},O}(nn),Ke=function(z){var O=this;this.self=z,this.actor=new c.Actor(z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:nn,geojson:Ce},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(F,G){if(O.workerSourceTypes[F])throw new Error('Worker source with name "'+F+'" already registered.');O.workerSourceTypes[F]=G},this.self.registerRTLTextPlugin=function(F){if(c.plugin.isParsed())throw new Error("RTL text plugin already registered.");c.plugin.applyArabicShaping=F.applyArabicShaping,c.plugin.processBidirectionalText=F.processBidirectionalText,c.plugin.processStyledBidirectionalText=F.processStyledBidirectionalText}};return Ke.prototype.setReferrer=function(z,O){this.referrer=O},Ke.prototype.setImages=function(z,O,F){for(var G in this.availableImages[z]=O,this.workerSources[z]){var X=this.workerSources[z][G];for(var nt in X)X[nt].availableImages=O}F()},Ke.prototype.setLayers=function(z,O,F){this.getLayerIndex(z).replace(O),F()},Ke.prototype.updateLayers=function(z,O,F){this.getLayerIndex(z).update(O.layers,O.removedIds),F()},Ke.prototype.loadTile=function(z,O,F){this.getWorkerSource(z,O.type,O.source).loadTile(O,F)},Ke.prototype.loadDEMTile=function(z,O,F){this.getDEMWorkerSource(z,O.source).loadTile(O,F)},Ke.prototype.reloadTile=function(z,O,F){this.getWorkerSource(z,O.type,O.source).reloadTile(O,F)},Ke.prototype.abortTile=function(z,O,F){this.getWorkerSource(z,O.type,O.source).abortTile(O,F)},Ke.prototype.removeTile=function(z,O,F){this.getWorkerSource(z,O.type,O.source).removeTile(O,F)},Ke.prototype.removeDEMTile=function(z,O){this.getDEMWorkerSource(z,O.source).removeTile(O)},Ke.prototype.removeSource=function(z,O,F){if(this.workerSources[z]&&this.workerSources[z][O.type]&&this.workerSources[z][O.type][O.source]){var G=this.workerSources[z][O.type][O.source];delete this.workerSources[z][O.type][O.source],void 0!==G.removeSource?G.removeSource(O,F):F()}},Ke.prototype.loadWorkerSource=function(z,O,F){try{this.self.importScripts(O.url),F()}catch(G){F(G.toString())}},Ke.prototype.syncRTLPluginState=function(z,O,F){try{c.plugin.setState(O);var G=c.plugin.getPluginURL();if(c.plugin.isLoaded()&&!c.plugin.isParsed()&&null!=G){this.self.importScripts(G);var X=c.plugin.isParsed();F(X?void 0:new Error("RTL Text Plugin failed to import scripts from "+G),X)}}catch(nt){F(nt.toString())}},Ke.prototype.getAvailableImages=function(z){var O=this.availableImages[z];return O||(O=[]),O},Ke.prototype.getLayerIndex=function(z){var O=this.layerIndexes[z];return O||(O=this.layerIndexes[z]=new Ue),O},Ke.prototype.getWorkerSource=function(z,O,F){var G=this;return this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][O]||(this.workerSources[z][O]={}),this.workerSources[z][O][F]||(this.workerSources[z][O][F]=new this.workerSourceTypes[O]({send:function(X,nt,st){G.actor.send(X,nt,st,z)}},this.getLayerIndex(z),this.getAvailableImages(z))),this.workerSources[z][O][F]},Ke.prototype.getDEMWorkerSource=function(z,O){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][O]||(this.demWorkerSources[z][O]=new er),this.demWorkerSources[z][O]},Ke.prototype.enforceCacheSizeLimit=function(z,O){c.enforceCacheSizeLimit(O)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ke(self)),Ke}),wn(0,function(c){var gi=c.createCommonjsModule(function(n){function a(d){return!o(d)}function o(d){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,w,I=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(I);try{w=new Worker(M),g=!0}catch{g=!1}return w&&w.terminate(),URL.revokeObjectURL(M),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var w=g.getContext("2d");if(!w)return!1;var I=w.getImageData(0,0,1,1);return I&&I.width===g.width}()?(void 0===l[_=d&&d.failIfMajorPerformanceCaveat]&&(l[_]=function(g){var M,N,Z,w=(M=g,N=document.createElement("canvas"),(Z=Object.create(a.webGLContextAttributes)).failIfMajorPerformanceCaveat=M,N.probablySupportsContext?N.probablySupportsContext("webgl",Z)||N.probablySupportsContext("experimental-webgl",Z):N.supportsContext?N.supportsContext("webgl",Z)||N.supportsContext("experimental-webgl",Z):N.getContext("webgl",Z)||N.getContext("experimental-webgl",Z));if(!w)return!1;var I=w.createShader(w.VERTEX_SHADER);return!(!I||w.isContextLost())&&(w.shaderSource(I,"void main() {}"),w.compileShader(I),!0===w.getShaderParameter(I,w.COMPILE_STATUS))}(_)),l[_]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}n.exports?n.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=o);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),Mt={create:function(n,a,o){var l=c.window.document.createElement(n);return void 0!==a&&(l.className=a),o&&o.appendChild(l),l},createNS:function(n,a){return c.window.document.createElementNS(n,a)}},Ue=c.window.document&&c.window.document.documentElement.style;function le(n){if(!Ue)return n[0];for(var a=0;a<n.length;a++)if(n[a]in Ue)return n[a];return n[0]}var en,Nt=le(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);Mt.disableDrag=function(){Ue&&Nt&&(en=Ue[Nt],Ue[Nt]="none")},Mt.enableDrag=function(){Ue&&Nt&&(Ue[Nt]=en)};var dn=le(["transform","WebkitTransform"]);Mt.setTransform=function(n,a){n.style[dn]=a};var nn=!1;try{var Se=Object.defineProperty({},"passive",{get:function(){nn=!0}});c.window.addEventListener("test",Se,Se),c.window.removeEventListener("test",Se,Se)}catch{nn=!1}Mt.addEventListener=function(n,a,o,l){void 0===l&&(l={}),n.addEventListener(a,o,"passive"in l&&nn?l:l.capture)},Mt.removeEventListener=function(n,a,o,l){void 0===l&&(l={}),n.removeEventListener(a,o,"passive"in l&&nn?l:l.capture)};var er=function(n){n.preventDefault(),n.stopPropagation(),c.window.removeEventListener("click",er,!0)};function Oe(n){var a=n.userImage;return!!(a&&a.render&&a.render())&&(n.data.replace(new Uint8Array(a.data.buffer)),!0)}Mt.suppressClick=function(){c.window.addEventListener("click",er,!0),c.window.setTimeout(function(){c.window.removeEventListener("click",er,!0)},0)},Mt.mousePos=function(n,a){var o=n.getBoundingClientRect();return new c.Point(a.clientX-o.left-n.clientLeft,a.clientY-o.top-n.clientTop)},Mt.touchPos=function(n,a){for(var o=n.getBoundingClientRect(),l=[],d=0;d<a.length;d++)l.push(new c.Point(a[d].clientX-o.left-n.clientLeft,a[d].clientY-o.top-n.clientTop));return l},Mt.mouseButton=function(n){return void 0!==c.window.InstallTrigger&&2===n.button&&n.ctrlKey&&c.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},Mt.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var Ct=function(n){function a(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var l=0,d=this.requestors;l<d.length;l+=1){var _=d[l];this._notify(_.ids,_.callback)}this.requestors=[]}},a.prototype.getImage=function(o){return this.images[o]},a.prototype.addImage=function(o,l){this._validate(o,l)&&(this.images[o]=l)},a.prototype._validate=function(o,l){var d=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new c.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),d=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new c.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),d=!1),this._validateContent(l.content,l)||(this.fire(new c.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),d=!1),d},a.prototype._validateStretch=function(o,l){if(!o)return!0;for(var d=0,_=0,g=o;_<g.length;_+=1){var w=g[_];if(w[0]<d||w[1]<w[0]||l<w[1])return!1;d=w[1]}return!0},a.prototype._validateContent=function(o,l){return!(o&&(4!==o.length||o[0]<0||l.data.width<o[0]||o[1]<0||l.data.height<o[1]||o[2]<0||l.data.width<o[2]||o[3]<0||l.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},a.prototype.updateImage=function(o,l){l.version=this.images[o].version+1,this.images[o]=l,this.updatedImages[o]=!0},a.prototype.removeImage=function(o){var l=this.images[o];delete this.images[o],delete this.patterns[o],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(o,l){var d=!0;if(!this.isLoaded())for(var _=0,g=o;_<g.length;_+=1)this.images[g[_]]||(d=!1);this.isLoaded()||d?this._notify(o,l):this.requestors.push({ids:o,callback:l})},a.prototype._notify=function(o,l){for(var d={},_=0,g=o;_<g.length;_+=1){var w=g[_];this.images[w]||this.fire(new c.Event("styleimagemissing",{id:w}));var I=this.images[w];I?d[w]={data:I.data.clone(),pixelRatio:I.pixelRatio,sdf:I.sdf,version:I.version,stretchX:I.stretchX,stretchY:I.stretchY,content:I.content,hasRenderCallback:Boolean(I.userImage&&I.userImage.render)}:c.warnOnce('Image "'+w+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,d)},a.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},a.prototype.getPattern=function(o){var l=this.patterns[o],d=this.getImage(o);if(!d)return null;if(l&&l.position.version===d.version)return l.position;if(l)l.position.version=d.version;else{var _={w:d.data.width+2,h:d.data.height+2,x:0,y:0},g=new c.ImagePosition(_,d);this.patterns[o]={bin:_,position:g}}return this._updatePatternAtlas(),this.patterns[o].position},a.prototype.bind=function(o){var l=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.Texture(o,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var o=[];for(var l in this.patterns)o.push(this.patterns[l].bin);var d=c.potpack(o),_=d.w,g=d.h,w=this.atlasImage;for(var I in w.resize({width:_||1,height:g||1}),this.patterns){var M=this.patterns[I].bin,N=M.x+1,Z=M.y+1,q=this.images[I].data,Q=q.width,$=q.height;c.RGBAImage.copy(q,w,{x:0,y:0},{x:N,y:Z},{width:Q,height:$}),c.RGBAImage.copy(q,w,{x:0,y:$-1},{x:N,y:Z-1},{width:Q,height:1}),c.RGBAImage.copy(q,w,{x:0,y:0},{x:N,y:Z+$},{width:Q,height:1}),c.RGBAImage.copy(q,w,{x:Q-1,y:0},{x:N-1,y:Z},{width:1,height:$}),c.RGBAImage.copy(q,w,{x:0,y:0},{x:N+Q,y:Z},{width:1,height:$})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(o){for(var l=0,d=o;l<d.length;l+=1){var _=d[l];if(!this.callbackDispatchedThisFrame[_]){this.callbackDispatchedThisFrame[_]=!0;var g=this.images[_];Oe(g)&&this.updateImage(_,g)}}},a}(c.Evented),ln=ci,wi=ci,Bi=1e20;function ci(n,a,o,l,d,_){this.fontSize=n||24,this.buffer=void 0===a?3:a,this.cutoff=l||.25,this.fontFamily=d||"sans-serif",this.fontWeight=_||"normal",this.radius=o||8;var g=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=g,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.d=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Int16Array(g),this.middle=Math.round(g/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function pi(n,a,o,l,d,_,g){for(var w=0;w<a;w++){for(var I=0;I<o;I++)l[I]=n[I*a+w];for(qi(l,d,_,g,o),I=0;I<o;I++)n[I*a+w]=d[I]}for(I=0;I<o;I++){for(w=0;w<a;w++)l[w]=n[I*a+w];for(qi(l,d,_,g,a),w=0;w<a;w++)n[I*a+w]=Math.sqrt(d[w])}}function qi(n,a,o,l,d){o[0]=0,l[0]=-Bi,l[1]=+Bi;for(var _=1,g=0;_<d;_++){for(var w=(n[_]+_*_-(n[o[g]]+o[g]*o[g]))/(2*_-2*o[g]);w<=l[g];)g--,w=(n[_]+_*_-(n[o[g]]+o[g]*o[g]))/(2*_-2*o[g]);o[++g]=_,l[g]=w,l[g+1]=+Bi}for(_=0,g=0;_<d;_++){for(;l[g+1]<_;)g++;a[_]=(_-o[g])*(_-o[g])+n[o[g]]}}ci.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var d=a.data[4*l+3]/255;this.gridOuter[l]=1===d?0:0===d?Bi:Math.pow(Math.max(0,.5-d),2),this.gridInner[l]=1===d?Bi:0===d?0:Math.pow(Math.max(0,d-.5),2)}for(pi(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),pi(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)o[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return o},ln.default=wi;var ki=function(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}};ki.prototype.setURL=function(n){this.url=n},ki.prototype.getGlyphs=function(n,a){var o=this,l=[];for(var d in n)for(var _=0,g=n[d];_<g.length;_+=1)l.push({stack:d,id:g[_]});c.asyncAll(l,function(w,I){var M=w.stack,N=w.id,Z=o.entries[M];Z||(Z=o.entries[M]={glyphs:{},requests:{},ranges:{}});var q=Z.glyphs[N];if(void 0===q){if(q=o._tinySDF(Z,M,N))return Z.glyphs[N]=q,void I(null,{stack:M,id:N,glyph:q});var Q=Math.floor(N/256);if(256*Q>65535)I(new Error("glyphs > 65535 not supported"));else if(Z.ranges[Q])I(null,{stack:M,id:N,glyph:q});else{var $=Z.requests[Q];$||($=Z.requests[Q]=[],ki.loadGlyphRange(M,Q,o.url,o.requestManager,function(ot,K){if(K){for(var rt in K)o._doesCharSupportLocalGlyph(+rt)||(Z.glyphs[+rt]=K[+rt]);Z.ranges[Q]=!0}for(var lt=0,yt=$;lt<yt.length;lt+=1)(0,yt[lt])(ot,K);delete Z.requests[Q]})),$.push(function(ot,K){ot?I(ot):K&&I(null,{stack:M,id:N,glyph:K[N]||null})})}}else I(null,{stack:M,id:N,glyph:q})},function(w,I){if(w)a(w);else if(I){for(var M={},N=0,Z=I;N<Z.length;N+=1){var q=Z[N],Q=q.stack,$=q.id,ot=q.glyph;(M[Q]||(M[Q]={}))[$]=ot&&{id:ot.id,bitmap:ot.bitmap.clone(),metrics:ot.metrics}}a(null,M)}})},ki.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(c.isChar["CJK Unified Ideographs"](n)||c.isChar["Hangul Syllables"](n)||c.isChar.Hiragana(n)||c.isChar.Katakana(n))},ki.prototype._tinySDF=function(n,a,o){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(o)){var d=n.tinySDF;if(!d){var _="400";/bold/i.test(a)?_="900":/medium/i.test(a)?_="500":/light/i.test(a)&&(_="200"),d=n.tinySDF=new ki.TinySDF(24,3,8,.25,l,_)}return{id:o,bitmap:new c.AlphaImage({width:30,height:30},d.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ki.loadGlyphRange=function(n,a,o,l,d){var _=256*a,g=_+255,w=l.transformRequest(l.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",_+"-"+g),c.ResourceType.Glyphs);c.getArrayBuffer(w,function(I,M){if(I)d(I);else if(M){for(var N={},Z=0,q=c.parseGlyphPBF(M);Z<q.length;Z+=1){var Q=q[Z];N[Q.id]=Q}d(null,N)}})},ki.TinySDF=ln;var Mi=function(){this.specification=c.styleSpec.light.position};Mi.prototype.possiblyEvaluate=function(n,a){return c.sphericalToCartesian(n.expression.evaluate(a))},Mi.prototype.interpolate=function(n,a,o){return{x:c.number(n.x,a.x,o),y:c.number(n.y,a.y,o),z:c.number(n.z,a.z,o)}};var Gn=new c.Properties({anchor:new c.DataConstantProperty(c.styleSpec.light.anchor),position:new Mi,color:new c.DataConstantProperty(c.styleSpec.light.color),intensity:new c.DataConstantProperty(c.styleSpec.light.intensity)}),Wn=function(n){function a(o){n.call(this),this._transitionable=new c.Transitionable(Gn),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(o,l){if(void 0===l&&(l={}),!this._validate(c.validateLight,o,l))for(var d in o){var _=o[d];c.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-11),_):this._transitionable.setValue(d,_)}},a.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},a.prototype._validate=function(o,l,d){return(!d||!1!==d.validate)&&c.emitValidationErrors(this,o.call(c.validateStyle,c.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:c.styleSpec})))},a}(c.Evented),Ri=function(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Ri.prototype.getDash=function(n,a){var o=n.join(",")+String(a);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,a)),this.dashEntry[o]},Ri.prototype.getDashRanges=function(n,a,o){var l=[],d=n.length%2==1?-n[n.length-1]*o:0,_=n[0]*o,g=!0;l.push({left:d,right:_,isDash:g,zeroLength:0===n[0]});for(var w=n[0],I=1;I<n.length;I++){var M=n[I];l.push({left:d=w*o,right:_=(w+=M)*o,isDash:g=!g,zeroLength:0===M})}return l},Ri.prototype.addRoundDash=function(n,a,o){for(var l=a/2,d=-o;d<=o;d++)for(var _=this.width*(this.nextRow+o+d),g=0,w=n[g],I=0;I<this.width;I++){I/w.right>1&&(w=n[++g]);var M=Math.abs(I-w.left),N=Math.abs(I-w.right),Z=Math.min(M,N),q=void 0,Q=d/o*(l+1);if(w.isDash){var $=l-Math.abs(Q);q=Math.sqrt(Z*Z+$*$)}else q=l-Math.sqrt(Z*Z+Q*Q);this.data[_+I]=Math.max(0,Math.min(255,q+128))}},Ri.prototype.addRegularDash=function(n){for(var a=n.length-1;a>=0;--a){var o=n[a],l=n[a+1];o.zeroLength?n.splice(a,1):l&&l.isDash===o.isDash&&(l.left=o.left,n.splice(a,1))}var d=n[0],_=n[n.length-1];d.isDash===_.isDash&&(d.left=_.left-this.width,_.right=d.right+this.width);for(var g=this.width*this.nextRow,w=0,I=n[w],M=0;M<this.width;M++){M/I.right>1&&(I=n[++w]);var N=Math.abs(M-I.left),Z=Math.abs(M-I.right),q=Math.min(N,Z);this.data[g+M]=Math.max(0,Math.min(255,(I.isDash?q:-q)+128))}},Ri.prototype.addDash=function(n,a){var o=a?7:0,l=2*o+1;if(this.nextRow+l>this.height)return c.warnOnce("LineAtlas out of space"),null;for(var d=0,_=0;_<n.length;_++)d+=n[_];if(0!==d){var g=this.width/d,w=this.getDashRanges(n,this.width,g);a?this.addRoundDash(w,g,o):this.addRegularDash(w)}var I={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:d};return this.nextRow+=l,this.dirty=!0,I},Ri.prototype.bind=function(n){var a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var un=function n(a,o){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=c.uniqueId();for(var l=this.workerPool.acquire(this.id),d=0;d<l.length;d++){var _=new n.Actor(l[d],o,this.id);_.name="Worker "+d,this.actors.push(_)}};function qe(n,a,o){var l=function(d,_){if(d)return o(d);if(_){var g=c.pick(c.extend(_,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(g.vectorLayers=_.vector_layers,g.vectorLayerIds=g.vectorLayers.map(function(w){return w.id})),g.tiles=a.canonicalizeTileset(g,n.url),o(null,g)}};return n.url?c.getJSON(a.transformRequest(a.normalizeSourceURL(n.url),c.ResourceType.Source),l):c.browser.frame(function(){return l(null,n)})}un.prototype.broadcast=function(n,a,o){c.asyncAll(this.actors,function(l,d){l.send(n,a,d)},o=o||function(){})},un.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},un.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},un.Actor=c.Actor;var hr=function(n,a,o){this.bounds=c.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=o||24};hr.prototype.validateBounds=function(n){return Array.isArray(n)&&4===n.length?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},hr.prototype.contains=function(n){var a=Math.pow(2,n.z),o=Math.floor(c.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(c.mercatorYfromLat(this.bounds.getNorth())*a),d=Math.ceil(c.mercatorXfromLng(this.bounds.getEast())*a),_=Math.ceil(c.mercatorYfromLat(this.bounds.getSouth())*a);return n.x>=o&&n.x<d&&n.y>=l&&n.y<_};var Gr=function(n){function a(o,l,d,_){if(n.call(this),this.id=o,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.extend(this,c.pick(l,["url","scheme","tileSize","promoteId"])),this._options=c.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=qe(this._options,this.map._requestManager,function(l,d){o._tileJSONRequest=null,o._loaded=!0,l?o.fire(new c.ErrorEvent(l)):d&&(c.extend(o,d),d.bounds&&(o.tileBounds=new hr(d.bounds,o.minzoom,o.maxzoom)),c.postTurnstileEvent(d.tiles,o.map._requestManager._customAccessToken),c.postMapLoadEvent(d.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(o){var l=this;return this.setSourceProperty(function(){l._options.tiles=o}),this},a.prototype.setUrl=function(o){var l=this;return this.setSourceProperty(function(){l.url=o,l._options.url=o}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return c.extend({},this._options)},a.prototype.loadTile=function(o,l){var d=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(d,c.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:c.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function g(w,I){return delete o.request,o.aborted?l(null):w&&404!==w.status?l(w):(I&&I.resourceTiming&&(o.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&o.setExpiryData(I),o.loadVectorData(I,this.map.painter),c.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,o.actor&&"expired"!==o.state?"loading"===o.state?o.reloadCallback=l:o.request=o.actor.send("reloadTile",_,g.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",_,g.bind(this)))},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(c.Evented),kr=function(n){function a(o,l,d,_){n.call(this),this.id=o,this.dispatcher=d,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.extend({type:"raster"},l),c.extend(this,c.pick(l,["url","scheme","tileSize"]))}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=qe(this._options,this.map._requestManager,function(l,d){o._tileJSONRequest=null,o._loaded=!0,l?o.fire(new c.ErrorEvent(l)):d&&(c.extend(o,d),d.bounds&&(o.tileBounds=new hr(d.bounds,o.minzoom,o.maxzoom)),c.postTurnstileEvent(d.tiles),c.postMapLoadEvent(d.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return c.extend({},this._options)},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.loadTile=function(o,l){var d=this,_=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=c.getImage(this.map._requestManager.transformRequest(_,c.ResourceType.Tile),function(g,w){if(delete o.request,o.aborted)o.state="unloaded",l(null);else if(g)o.state="errored",l(g);else if(w){d.map._refreshExpiredTiles&&o.setExpiryData(w),delete w.cacheControl,delete w.expires;var I=d.map.painter.context,M=I.gl;o.texture=d.map.painter.getTileTexture(w.width),o.texture?o.texture.update(w,{useMipmap:!0}):(o.texture=new c.Texture(I,w,M.RGBA,{useMipmap:!0}),o.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),I.extTextureFilterAnisotropic&&M.texParameterf(M.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax)),o.state="loaded",c.cacheEntryPossiblyAdded(d.dispatcher),l(null)}})},a.prototype.abortTile=function(o,l){o.request&&(o.request.cancel(),delete o.request),l()},a.prototype.unloadTile=function(o,l){o.texture&&this.map.painter.saveTileTexture(o.texture),l()},a.prototype.hasTransition=function(){return!1},a}(c.Evented),vr=function(n){function a(o,l,d,_){n.call(this,o,l,d,_),this.type="raster-dem",this.maxzoom=22,this._options=c.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(o,l){var d=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function _(g,w){g&&(o.state="errored",l(g)),w&&(o.dem=w,o.needsHillshadePrepare=!0,o.state="loaded",l(null))}o.request=c.getImage(this.map._requestManager.transformRequest(d,c.ResourceType.Tile),function(g,w){if(delete o.request,o.aborted)o.state="unloaded",l(null);else if(g)o.state="errored",l(g);else if(w){this.map._refreshExpiredTiles&&o.setExpiryData(w),delete w.cacheControl,delete w.expires;var I=c.window.ImageBitmap&&w instanceof c.window.ImageBitmap&&c.offscreenCanvasSupported()?w:c.browser.getImageData(w,1),M={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:I,encoding:this.encoding};o.actor&&"expired"!==o.state||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",M,_.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},a.prototype._getNeighboringTiles=function(o){var l=o.canonical,d=Math.pow(2,l.z),_=(l.x-1+d)%d,g=0===l.x?o.wrap-1:o.wrap,w=(l.x+1+d)%d,I=l.x+1===d?o.wrap+1:o.wrap,M={};return M[new c.OverscaledTileID(o.overscaledZ,g,l.z,_,l.y).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,I,l.z,w,l.y).key]={backfilled:!1},l.y>0&&(M[new c.OverscaledTileID(o.overscaledZ,g,l.z,_,l.y-1).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,o.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,I,l.z,w,l.y-1).key]={backfilled:!1}),l.y+1<d&&(M[new c.OverscaledTileID(o.overscaledZ,g,l.z,_,l.y+1).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,o.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},M[new c.OverscaledTileID(o.overscaledZ,I,l.z,w,l.y+1).key]={backfilled:!1}),M},a.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},a}(kr),Dn=function(n){function a(o,l,d,_){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(_),this._data=l.data,this._options=c.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],void 0!==l.maxzoom&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var g=c.EXTENT/this.tileSize;this.workerOptions=c.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(void 0!==l.buffer?l.buffer:128)*g,tolerance:(void 0!==l.tolerance?l.tolerance:.375)*g,extent:c.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:void 0!==l.clusterMaxZoom?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:c.EXTENT,radius:(l.clusterRadius||50)*g,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this.fire(new c.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)o.fire(new c.ErrorEvent(l));else{var d={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(d.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new c.Event("data",d))}})},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setData=function(o){var l=this;return this._data=o,this.fire(new c.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(d){if(d)l.fire(new c.ErrorEvent(d));else{var _={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(_.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new c.Event("data",_))}}),this},a.prototype.getClusterExpansionZoom=function(o,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},l),this},a.prototype.getClusterChildren=function(o,l){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},l),this},a.prototype.getClusterLeaves=function(o,l,d,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:l,offset:d},_),this},a.prototype._updateWorkerData=function(o){var l=this;this._loaded=!1;var d=c.extend({},this.workerOptions),_=this._data;"string"==typeof _?(d.request=this.map._requestManager.transformRequest(c.browser.resolveURL(_),c.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(_),this.actor.send(this.type+".loadData",d,function(g,w){l._removed||w&&w.abandoned||(l._loaded=!0,w&&w.resourceTiming&&w.resourceTiming[l.id]&&(l._resourceTiming=w.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:d.source},null),o(g))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(o,l){var d=this,_=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(_,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:c.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(g,w){return delete o.request,o.unloadVectorData(),o.aborted?l(null):g?l(g):(o.loadVectorData(w,d.map.painter,"reloadTile"===_),l(null))})},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},a.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return c.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(c.Evented),On=c.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),xr=function(n){function a(o,l,d,_){n.call(this),this.id=o,this.dispatcher=d,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=l}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(o,l){var d=this;this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this.url=this.options.url,c.getImage(this.map._requestManager.transformRequest(this.url,c.ResourceType.Image),function(_,g){d._loaded=!0,_?d.fire(new c.ErrorEvent(_)):g&&(d.image=g,o&&(d.coordinates=o),l&&l(),d._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(o){var l=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setCoordinates=function(o){var l=this;this.coordinates=o;var d=o.map(c.MercatorCoordinate.fromLngLat);this.tileID=function(g){for(var w=1/0,I=1/0,M=-1/0,N=-1/0,Z=0,q=g;Z<q.length;Z+=1){var Q=q[Z];w=Math.min(w,Q.x),I=Math.min(I,Q.y),M=Math.max(M,Q.x),N=Math.max(N,Q.y)}var $=Math.max(M-w,N-I),ot=Math.max(0,Math.floor(-Math.log($)/Math.LN2)),K=Math.pow(2,ot);return new c.CanonicalTileID(ot,Math.floor((w+M)/2*K),Math.floor((I+N)/2*K))}(d),this.minzoom=this.maxzoom=this.tileID.z;var _=d.map(function(g){return l.tileID.getTilePoint(g)._round()});return this._boundsArray=new c.StructArrayLayout4i8,this._boundsArray.emplaceBack(_[0].x,_[0].y,0,0),this._boundsArray.emplaceBack(_[1].x,_[1].y,c.EXTENT,0),this._boundsArray.emplaceBack(_[3].x,_[3].y,0,c.EXTENT),this._boundsArray.emplaceBack(_[2].x,_[2].y,c.EXTENT,c.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var o=this.map.painter.context,l=o.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,On.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new c.Texture(o,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[d];"loaded"!==_.state&&(_.state="loaded",_.texture=this.texture)}}},a.prototype.loadTile=function(o,l){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},l(null)):(o.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(c.Evented),_o=function(n){function a(o,l,d,_){n.call(this,o,l,d,_),this.roundZoom=!0,this.type="video",this.options=l}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1;var l=this.options;this.urls=[];for(var d=0,_=l.urls;d<_.length;d+=1)this.urls.push(this.map._requestManager.transformRequest(_[d],c.ResourceType.Source).url);c.getVideo(this.urls,function(g,w){o._loaded=!0,g?o.fire(new c.ErrorEvent(g)):w&&(o.video=w,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(o){if(this.video){var l=this.video.seekable;o<l.start(0)||o>l.end(0)?this.fire(new c.ErrorEvent(new c.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=o}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var o=this.map.painter.context,l=o.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,On.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new c.Texture(o,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[d];"loaded"!==_.state&&(_.state="loaded",_.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(xr),Wr=function(n){function a(o,l,d,_){n.call(this,o,l,d,_),l.coordinates?Array.isArray(l.coordinates)&&4===l.coordinates.length&&!l.coordinates.some(function(g){return!Array.isArray(g)||2!==g.length||g.some(function(w){return"number"!=typeof w})})||this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'missing required property "coordinates"'))),l.animate&&"boolean"!=typeof l.animate&&this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),l.canvas?"string"==typeof l.canvas||l.canvas instanceof c.window.HTMLCanvasElement||this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=l,this.animate=void 0===l.animate||l.animate}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof c.window.HTMLCanvasElement?this.options.canvas:c.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var l=this.map.painter.context,d=l.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,On.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.Texture(l,this.canvas,d.RGBA,{premultiply:!0}),this.tiles){var g=this.tiles[_];"loaded"!==g.state&&(g.state="loaded",g.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var o=0,l=[this.canvas.width,this.canvas.height];o<l.length;o+=1){var d=l[o];if(isNaN(d)||d<=0)return!0}return!1},a}(xr),Hr={vector:Gr,raster:kr,"raster-dem":vr,geojson:Dn,video:_o,image:xr,canvas:Wr};function _a(n,a){var o=c.identity([]);return c.translate(o,o,[1,1,0]),c.scale(o,o,[.5*n.width,.5*n.height,1]),c.multiply(o,o,n.calculatePosMatrix(a.toUnwrapped()))}function Hn(n,a,o,l,d,_){var g=function(ot,K,rt){if(ot)for(var lt=0,yt=ot;lt<yt.length;lt+=1){var Et=K[yt[lt]];if(Et&&Et.source===rt&&"fill-extrusion"===Et.type)return!0}else for(var Tt in K){var It=K[Tt];if(It.source===rt&&"fill-extrusion"===It.type)return!0}return!1}(d&&d.layers,a,n.id),w=_.maxPitchScaleFactor(),I=n.tilesIn(l,w,g);I.sort(Xr);for(var M=[],N=0,Z=I;N<Z.length;N+=1){var q=Z[N];M.push({wrappedTileID:q.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(a,o,n._state,q.queryGeometry,q.cameraQueryGeometry,q.scale,d,_,w,_a(n.transform,q.tileID))})}var Q=function(ot){for(var K={},rt={},lt=0,yt=ot;lt<yt.length;lt+=1){var Et=yt[lt],Tt=Et.queryResults,It=Et.wrappedTileID,Ot=rt[It]=rt[It]||{};for(var Xt in Tt)for(var Wt=Tt[Xt],se=Ot[Xt]=Ot[Xt]||{},ge=K[Xt]=K[Xt]||[],we=0,be=Wt;we<be.length;we+=1){var xi=be[we];se[xi.featureIndex]||(se[xi.featureIndex]=!0,ge.push(xi))}}return K}(M);for(var $ in Q)Q[$].forEach(function(ot){var K=ot.feature,rt=n.getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=rt});return Q}function Xr(n,a){var o=n.tileID,l=a.tileID;return o.overscaledZ-l.overscaledZ||o.canonical.y-l.canonical.y||o.wrap-l.wrap||o.canonical.x-l.canonical.x}var ei=function(n,a){this.max=n,this.onRemove=a,this.reset()};ei.prototype.reset=function(){for(var n in this.data)for(var a=0,o=this.data[n];a<o.length;a+=1){var l=o[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},ei.prototype.add=function(n,a,o){var l=this,d=n.wrapped().key;void 0===this.data[d]&&(this.data[d]=[]);var _={value:a,timeout:void 0};if(void 0!==o&&(_.timeout=setTimeout(function(){l.remove(n,_)},o)),this.data[d].push(_),this.order.push(d),this.order.length>this.max){var g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this},ei.prototype.has=function(n){return n.wrapped().key in this.data},ei.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},ei.prototype._getAndRemoveByKey=function(n){var a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),0===this.data[n].length&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value},ei.prototype.getByKey=function(n){var a=this.data[n];return a?a[0].value:null},ei.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},ei.prototype.remove=function(n,a){if(!this.has(n))return this;var o=n.wrapped().key,l=void 0===a?0:this.data[o].indexOf(a),d=this.data[o][l];return this.data[o].splice(l,1),d.timeout&&clearTimeout(d.timeout),0===this.data[o].length&&delete this.data[o],this.onRemove(d.value),this.order.splice(this.order.indexOf(o),1),this},ei.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},ei.prototype.filter=function(n){var a=[];for(var o in this.data)for(var l=0,d=this.data[o];l<d.length;l+=1){var _=d[l];n(_.value)||a.push(_)}for(var g=0,w=a;g<w.length;g+=1){var I=w[g];this.remove(I.value.tileID,I)}};var hn=function(n,a,o){this.context=n;var l=n.gl;this.buffer=l.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};hn.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},hn.prototype.updateData=function(n){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},hn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var re={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Bn=function(n,a,o,l){this.length=a.length,this.attributes=o,this.itemSize=a.bytesPerElement,this.dynamicDraw=l,this.context=n;var d=n.gl;this.buffer=d.createBuffer(),n.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};Bn.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Bn.prototype.updateData=function(n){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)},Bn.prototype.enableAttributes=function(n,a){for(var o=0;o<this.attributes.length;o++){var l=a.attributes[this.attributes[o].name];void 0!==l&&n.enableVertexAttribArray(l)}},Bn.prototype.setVertexAttribPointers=function(n,a,o){for(var l=0;l<this.attributes.length;l++){var d=this.attributes[l],_=a.attributes[d.name];void 0!==_&&n.vertexAttribPointer(_,d.components,n[re[d.type]],!1,this.itemSize,d.offset+this.itemSize*(o||0))}},Bn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var je=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};je.prototype.get=function(){return this.current},je.prototype.set=function(n){},je.prototype.getDefault=function(){return this.default},je.prototype.setDefault=function(){this.set(this.default)};var To=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return c.Color.transparent},a.prototype.set=function(o){var l=this.current;(o.r!==l.r||o.g!==l.g||o.b!==l.b||o.a!==l.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(je),Rn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},a}(je),Tn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},a}(je),En=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(je),Pi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},a}(je),Hi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},a}(je),Fi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(o){var l=this.current;(o.func!==l.func||o.ref!==l.ref||o.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},a}(je),io=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},a}(je),no=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=o,this.dirty=!1}},a}(je),x=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},a}(je),S=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=o,this.dirty=!1}},a}(je),D=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},a}(je),W=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.BLEND):l.disable(l.BLEND),this.current=o,this.dirty=!1}},a}(je),tt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},a}(je),ht=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return c.Color.transparent},a.prototype.set=function(o){var l=this.current;(o.r!==l.r||o.g!==l.g||o.b!==l.b||o.a!==l.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(je),Lt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},a}(je),Jt=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=o,this.dirty=!1}},a}(je),ue=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},a}(je),Ae=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},a}(je),Di=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},a}(je),Qi=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},a}(je),ji=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(je),ir=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},a}(je),Pn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}(je),ri=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,o),this.current=o,this.dirty=!1}},a}(je),Ti=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},a}(je),Mr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},a}(je),fn=function(n){function a(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},a}(je),mn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},a}(je),Kr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},a}(je),Ce=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},a}(je),Ke=function(n){function a(o,l){n.call(this,o),this.context=o,this.parent=l}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(je),z=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},a}(Ke),O=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}(Ke),F=function(n,a,o,l){this.context=n,this.width=a,this.height=o;var d=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new z(n,d),l&&(this.depthAttachment=new O(n,d))};F.prototype.destroy=function(){var n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var G=function(n,a,o){this.func=n,this.mask=a,this.range=o};G.ReadOnly=!1,G.ReadWrite=!0,G.disabled=new G(519,G.ReadOnly,[0,1]);var X=function(n,a,o,l,d,_){this.test=n,this.ref=a,this.mask=o,this.fail=l,this.depthFail=d,this.pass=_};X.disabled=new X({func:519,mask:0},0,0,7680,7680,7680);var nt=function(n,a,o){this.blendFunction=n,this.blendColor=a,this.mask=o};nt.disabled=new nt(nt.Replace=[1,0],c.Color.transparent,[!1,!1,!1,!1]),nt.unblended=new nt(nt.Replace,c.Color.transparent,[!0,!0,!0,!0]),nt.alphaBlended=new nt([1,771],c.Color.transparent,[!0,!0,!0,!0]);var st=function(n,a,o){this.enable=n,this.mode=a,this.frontFace=o};st.disabled=new st(!1,1029,2305),st.backCCW=new st(!0,1029,2305);var j=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new To(this),this.clearDepth=new Rn(this),this.clearStencil=new Tn(this),this.colorMask=new En(this),this.depthMask=new Pi(this),this.stencilMask=new Hi(this),this.stencilFunc=new Fi(this),this.stencilOp=new io(this),this.stencilTest=new no(this),this.depthRange=new x(this),this.depthTest=new S(this),this.depthFunc=new D(this),this.blend=new W(this),this.blendFunc=new tt(this),this.blendColor=new ht(this),this.blendEquation=new Lt(this),this.cullFace=new Jt(this),this.cullFaceSide=new ue(this),this.frontFace=new Ae(this),this.program=new Di(this),this.activeTexture=new Qi(this),this.viewport=new ji(this),this.bindFramebuffer=new ir(this),this.bindRenderbuffer=new Pn(this),this.bindTexture=new ri(this),this.bindVertexBuffer=new Ti(this),this.bindElementBuffer=new Mr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new fn(this),this.pixelStoreUnpack=new mn(this),this.pixelStoreUnpackPremultiplyAlpha=new Kr(this),this.pixelStoreUnpackFlipY=new Ce(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};j.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},j.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},j.prototype.createIndexBuffer=function(n,a){return new hn(this,n,a)},j.prototype.createVertexBuffer=function(n,a,o){return new Bn(this,n,a,o)},j.prototype.createRenderbuffer=function(n,a,o){var l=this.gl,d=l.createRenderbuffer();return this.bindRenderbuffer.set(d),l.renderbufferStorage(l.RENDERBUFFER,n,a,o),this.bindRenderbuffer.set(null),d},j.prototype.createFramebuffer=function(n,a,o){return new F(this,n,a,o)},j.prototype.clear=function(n){var a=n.color,o=n.depth,l=this.gl,d=0;a&&(d|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),void 0!==o&&(d|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),l.clear(d)},j.prototype.setCullFace=function(n){!1===n.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},j.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},j.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},j.prototype.setColorMode=function(n){c.deepEqual(n.blendFunction,nt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},j.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var et=function(n){function a(o,l,d){var _=this;n.call(this),this.id=o,this.dispatcher=d,this.on("data",function(g){"source"===g.dataType&&"metadata"===g.sourceDataType&&(_._sourceLoaded=!0),_._sourceLoaded&&!_._paused&&"source"===g.dataType&&"content"===g.sourceDataType&&(_.reload(),_.transform&&_.update(_.transform))}),this.on("error",function(){_._sourceErrored=!0}),this._source=function(g,w,I,M){var N=new Hr[w.type](g,w,I,M);if(N.id!==g)throw new Error("Expected Source id to be "+g+" instead of "+N.id);return c.bindAll(["load","abort","unload","serialize","prepare"],N),N}(o,l,d,this),this._tiles={},this._cache=new ei(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new c.SourceFeatureState}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},a.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var l=this._tiles[o];if("loaded"!==l.state&&"errored"!==l.state)return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(o,l){return this._source.loadTile(o,l)},a.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},a.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(o){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var d=this._tiles[l];d.upload(o),d.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return c.values(this._tiles).map(function(o){return o.tileID}).sort(ft).map(function(o){return o.key})},a.prototype.getRenderableIds=function(o){var l=this,d=[];for(var _ in this._tiles)this._isIdRenderable(_,o)&&d.push(this._tiles[_]);return o?d.sort(function(g,w){var I=g.tileID,M=w.tileID,N=new c.Point(I.canonical.x,I.canonical.y)._rotate(l.transform.angle),Z=new c.Point(M.canonical.x,M.canonical.y)._rotate(l.transform.angle);return I.overscaledZ-M.overscaledZ||Z.y-N.y||Z.x-N.x}).map(function(g){return g.tileID.key}):d.map(function(g){return g.tileID}).sort(ft).map(function(g){return g.key})},a.prototype.hasRenderableParent=function(o){var l=this.findLoadedParent(o,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(o,l){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(l||!this._tiles[o].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(o,"reloading")},a.prototype._reloadTile=function(o,l){var d=this._tiles[o];d&&("loading"!==d.state&&(d.state=l),this._loadTile(d,this._tileLoaded.bind(this,d,o,l)))},a.prototype._tileLoaded=function(o,l,d,_){if(_)return o.state="errored",void(404!==_.status?this._source.fire(new c.ErrorEvent(_,{tile:o})):this.update(this.transform));o.timeAdded=c.browser.now(),"expired"===d&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(l,o),"raster-dem"===this.getSource().type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new c.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},a.prototype._backfillDEM=function(o){for(var l=this.getRenderableIds(),d=0;d<l.length;d++){var _=l[d];if(o.neighboringTiles&&o.neighboringTiles[_]){var g=this.getTileByID(_);w(o,g),w(g,o)}}function w(I,M){I.needsHillshadePrepare=!0;var N=M.tileID.canonical.x-I.tileID.canonical.x,Z=M.tileID.canonical.y-I.tileID.canonical.y,q=Math.pow(2,I.tileID.canonical.z),Q=M.tileID.key;0===N&&0===Z||Math.abs(Z)>1||(Math.abs(N)>1&&(1===Math.abs(N+q)?N+=q:1===Math.abs(N-q)&&(N-=q)),M.dem&&I.dem&&(I.dem.backfillBorder(M.dem,N,Z),I.neighboringTiles&&I.neighboringTiles[Q]&&(I.neighboringTiles[Q].backfilled=!0)))}},a.prototype.getTile=function(o){return this.getTileByID(o.key)},a.prototype.getTileByID=function(o){return this._tiles[o]},a.prototype._retainLoadedChildren=function(o,l,d,_){for(var g in this._tiles){var w=this._tiles[g];if(!(_[g]||!w.hasData()||w.tileID.overscaledZ<=l||w.tileID.overscaledZ>d)){for(var I=w.tileID;w&&w.tileID.overscaledZ>l+1;){var M=w.tileID.scaledTo(w.tileID.overscaledZ-1);(w=this._tiles[M.key])&&w.hasData()&&(I=M)}for(var N=I;N.overscaledZ>l;)if(o[(N=N.scaledTo(N.overscaledZ-1)).key]){_[I.key]=I;break}}}},a.prototype.findLoadedParent=function(o,l){if(o.key in this._loadedParentTiles){var d=this._loadedParentTiles[o.key];return d&&d.tileID.overscaledZ>=l?d:null}for(var _=o.overscaledZ-1;_>=l;_--){var g=o.scaledTo(_),w=this._getLoadedTile(g);if(w)return w}},a.prototype._getLoadedTile=function(o){var l=this._tiles[o.key];return l&&l.hasData()?l:this._cache.getByKey(o.wrapped().key)},a.prototype.updateCacheSize=function(o){var l=Math.ceil(o.width/this._source.tileSize)+1,d=Math.ceil(o.height/this._source.tileSize)+1,_=Math.floor(l*d*5),g="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(g)},a.prototype.handleWrapJump=function(o){var l=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,l){var d={};for(var _ in this._tiles){var g=this._tiles[_];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+l),d[g.tileID.key]=g}for(var w in this._tiles=d,this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(var I in this._tiles)this._setTileReloadTimer(I,this._tiles[I])}},a.prototype.update=function(o){var l=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var d;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?d=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ot){return new c.OverscaledTileID(Ot.canonical.z,Ot.wrap,Ot.canonical.z,Ot.canonical.x,Ot.canonical.y)}):(d=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(d=d.filter(function(Ot){return l._source.hasTile(Ot)}))):d=[];var _=o.coveringZoomLevel(this._source),g=Math.max(_-a.maxOverzooming,this._source.minzoom),w=Math.max(_+a.maxUnderzooming,this._source.minzoom),I=this._updateRetainedTiles(d,_);if(kt(this._source.type)){for(var M={},N={},Z=0,q=Object.keys(I);Z<q.length;Z+=1){var Q=q[Z],$=I[Q],ot=this._tiles[Q];if(ot&&!(ot.fadeEndTime&&ot.fadeEndTime<=c.browser.now())){var K=this.findLoadedParent($,g);K&&(this._addTile(K.tileID),M[K.tileID.key]=K.tileID),N[Q]=$}}for(var rt in this._retainLoadedChildren(N,_,w,I),M)I[rt]||(this._coveredTiles[rt]=!0,I[rt]=M[rt])}for(var lt in I)this._tiles[lt].clearFadeHold();for(var yt=0,Et=c.keysDifference(this._tiles,I);yt<Et.length;yt+=1){var Tt=Et[yt],It=this._tiles[Tt];It.hasSymbolBuckets&&!It.holdingForFade()?It.setHoldDuration(this.map._fadeDuration):It.hasSymbolBuckets&&!It.symbolFadeFinished()||this._removeTile(Tt)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},a.prototype._updateRetainedTiles=function(o,l){for(var d={},_={},g=Math.max(l-a.maxOverzooming,this._source.minzoom),w=Math.max(l+a.maxUnderzooming,this._source.minzoom),I={},M=0,N=o;M<N.length;M+=1){var Z=N[M],q=this._addTile(Z);d[Z.key]=Z,q.hasData()||l<this._source.maxzoom&&(I[Z.key]=Z)}this._retainLoadedChildren(I,l,w,d);for(var Q=0,$=o;Q<$.length;Q+=1){var ot=$[Q],K=this._tiles[ot.key];if(!K.hasData()){if(l+1>this._source.maxzoom){var rt=ot.children(this._source.maxzoom)[0],lt=this.getTile(rt);if(lt&&lt.hasData()){d[rt.key]=rt;continue}}else{var yt=ot.children(this._source.maxzoom);if(d[yt[0].key]&&d[yt[1].key]&&d[yt[2].key]&&d[yt[3].key])continue}for(var Et=K.wasRequested(),Tt=ot.overscaledZ-1;Tt>=g;--Tt){var It=ot.scaledTo(Tt);if(_[It.key]||(_[It.key]=!0,!(K=this.getTile(It))&&Et&&(K=this._addTile(It)),K&&(d[It.key]=It,Et=K.wasRequested(),K.hasData())))break}}}return d},a.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var l=[],d=void 0,_=this._tiles[o].tileID;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){d=this._loadedParentTiles[_.key];break}l.push(_.key);var g=_.scaledTo(_.overscaledZ-1);if(d=this._getLoadedTile(g))break;_=g}for(var w=0,I=l;w<I.length;w+=1)this._loadedParentTiles[I[w]]=d}},a.prototype._addTile=function(o){var l=this._tiles[o.key];if(l)return l;(l=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,l),l.tileID=o,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,l)));var d=Boolean(l);return d||(l=new c.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,o.key,l.state))),l?(l.uses++,this._tiles[o.key]=l,d||this._source.fire(new c.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(o,l){var d=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var _=l.getExpiryTimeout();_&&(this._timers[o]=setTimeout(function(){d._reloadTile(o,"expired"),delete d._timers[o]},_))},a.prototype._removeTile=function(o){var l=this._tiles[o];l&&(l.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),l.uses>0||(l.hasData()&&"reloading"!==l.state?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},a.prototype.tilesIn=function(o,l,d){var _=this,g=[],w=this.transform;if(!w)return g;for(var I=d?w.getCameraQueryGeometry(o):o,M=o.map(function(Tt){return w.pointCoordinate(Tt)}),N=I.map(function(Tt){return w.pointCoordinate(Tt)}),Z=this.getIds(),q=1/0,Q=1/0,$=-1/0,ot=-1/0,K=0,rt=N;K<rt.length;K+=1){var lt=rt[K];q=Math.min(q,lt.x),Q=Math.min(Q,lt.y),$=Math.max($,lt.x),ot=Math.max(ot,lt.y)}for(var yt=function(Tt){var It=_._tiles[Z[Tt]];if(!It.holdingForFade()){var Ot=It.tileID,Xt=Math.pow(2,w.zoom-It.tileID.overscaledZ),Wt=l*It.queryPadding*c.EXTENT/It.tileSize/Xt,se=[Ot.getTilePoint(new c.MercatorCoordinate(q,Q)),Ot.getTilePoint(new c.MercatorCoordinate($,ot))];if(se[0].x-Wt<c.EXTENT&&se[0].y-Wt<c.EXTENT&&se[1].x+Wt>=0&&se[1].y+Wt>=0){var ge=M.map(function(be){return Ot.getTilePoint(be)}),we=N.map(function(be){return Ot.getTilePoint(be)});g.push({tile:It,tileID:Ot,queryGeometry:ge,cameraQueryGeometry:we,scale:Xt})}}},Et=0;Et<Z.length;Et++)yt(Et);return g},a.prototype.getVisibleCoordinates=function(o){for(var l=this,d=this.getRenderableIds(o).map(function(I){return l._tiles[I].tileID}),_=0,g=d;_<g.length;_+=1){var w=g[_];w.posMatrix=this.transform.calculatePosMatrix(w.toUnwrapped())}return d},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(kt(this._source.type))for(var o in this._tiles){var l=this._tiles[o];if(void 0!==l.fadeEndTime&&l.fadeEndTime>=c.browser.now())return!0}return!1},a.prototype.setFeatureState=function(o,l,d){this._state.updateState(o=o||"_geojsonTileLayer",l,d)},a.prototype.removeFeatureState=function(o,l,d){this._state.removeFeatureState(o=o||"_geojsonTileLayer",l,d)},a.prototype.getFeatureState=function(o,l){return this._state.getState(o=o||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(o,l,d){var _=this._tiles[o];_&&_.setDependencies(l,d)},a.prototype.reloadTilesForDependencies=function(o,l){for(var d in this._tiles)this._tiles[d].hasDependency(o,l)&&this._reloadTile(d,"reloading");this._cache.filter(function(_){return!_.hasDependency(o,l)})},a}(c.Evented);function ft(n,a){var o=Math.abs(2*n.wrap)-+(n.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return n.overscaledZ-a.overscaledZ||l-o||a.canonical.y-n.canonical.y||a.canonical.x-n.canonical.x}function kt(n){return"raster"===n||"image"===n||"video"===n}function Rt(){return new c.window.Worker(wl.workerUrl)}et.maxOverzooming=10,et.maxUnderzooming=3;var bt="mapboxgl_preloaded_worker_pool",vt=function(){this.active={}};vt.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<vt.workerCount;)this.workers.push(new Rt);return this.active[n]=!0,this.workers.slice()},vt.prototype.release=function(n){delete this.active[n],0===this.numActive()&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},vt.prototype.isPreloaded=function(){return!!this.active[bt]},vt.prototype.numActive=function(){return Object.keys(this.active).length};var ne,Ft=Math.floor(c.browser.hardwareConcurrency/2);function Pt(){return ne||(ne=new vt),ne}function te(n,a){var o={};for(var l in n)"ref"!==l&&(o[l]=n[l]);return c.refProperties.forEach(function(d){d in a&&(o[d]=a[d])}),o}function Kt(n){n=n.slice();for(var a=Object.create(null),o=0;o<n.length;o++)a[n[o].id]=n[o];for(var l=0;l<n.length;l++)"ref"in n[l]&&(n[l]=te(n[l],a[n[l].ref]));return n}vt.workerCount=Math.max(Math.min(Ft,6),1);var Yt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ze(n,a,o){o.push({command:Yt.addSource,args:[n,a[n]]})}function $t(n,a,o){a.push({command:Yt.removeSource,args:[n]}),o[n]=!0}function Je(n,a,o,l){$t(n,o,l),ze(n,a,o)}function Ze(n,a,o){var l;for(l in n[o])if(n[o].hasOwnProperty(l)&&"data"!==l&&!c.deepEqual(n[o][l],a[o][l]))return!1;for(l in a[o])if(a[o].hasOwnProperty(l)&&"data"!==l&&!c.deepEqual(n[o][l],a[o][l]))return!1;return!0}function Be(n,a,o,l,d,_){var g;for(g in a=a||{},n=n||{})n.hasOwnProperty(g)&&(c.deepEqual(n[g],a[g])||o.push({command:_,args:[l,g,a[g],d]}));for(g in a)a.hasOwnProperty(g)&&!n.hasOwnProperty(g)&&(c.deepEqual(n[g],a[g])||o.push({command:_,args:[l,g,a[g],d]}))}function si(n){return n.id}function ti(n,a){return n[a.id]=a,n}var br=function(n,a){this.reset(n,a)};br.prototype.reset=function(n,a){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},br.prototype.lerp=function(n){if(1===this.points.length)return this.points[0];n=c.clamp(n,0,1);for(var a=1,o=this._distances[a],l=n*this.paddedLength+this.padding;o<l&&a<this._distances.length;)o=this._distances[++a];var d=a-1,_=this._distances[d],g=o-_,w=g>0?(l-_)/g:0;return this.points[d].mult(1-w).add(this.points[a].mult(w))};var di=function(n,a,o){var l=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(a/o);for(var _=0;_<this.xCellCount*this.yCellCount;_++)l.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0};function rn(n,a,o,l,d){var _=c.create();return a?(c.scale(_,_,[1/d,1/d,1]),o||c.rotateZ(_,_,l.angle)):c.multiply(_,l.labelPlaneMatrix,n),_}function vi(n,a,o,l,d){if(a){var _=c.clone(n);return c.scale(_,_,[d,d,1]),o||c.rotateZ(_,_,-l.angle),_}return l.glCoordMatrix}function Ye(n,a){var o=[n.x,n.y,0,1];Cn(o,o,a);var l=o[3];return{point:new c.Point(o[0]/l,o[1]/l),signedDistanceFromCamera:l}}function fe(n,a){return.5+n/a*.5}function An(n,a){var o=n[0]/n[3],l=n[1]/n[3];return o>=-a[0]&&o<=a[0]&&l>=-a[1]&&l<=a[1]}function ya(n,a,o,l,d,_,g,w){var I=l?n.textSizeData:n.iconSizeData,M=c.evaluateSizeForZoom(I,o.transform.zoom),N=[256/o.width*2+1,256/o.height*2+1],Z=l?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;Z.clear();for(var q=n.lineVertexArray,Q=l?n.text.placedSymbolArray:n.icon.placedSymbolArray,$=o.transform.width/o.transform.height,ot=!1,K=0;K<Q.length;K++){var rt=Q.get(K);if(rt.hidden||rt.writingMode===c.WritingMode.vertical&&!ot)In(rt.numGlyphs,Z);else{ot=!1;var lt=[rt.anchorX,rt.anchorY,0,1];if(c.transformMat4(lt,lt,a),An(lt,N)){var yt=fe(o.transform.cameraToCenterDistance,lt[3]),Et=c.evaluateSizeForFeature(I,M,rt),Tt=g?Et/yt:Et*yt,It=new c.Point(rt.anchorX,rt.anchorY),Ot=Ye(It,d).point,Xt={},Wt=Ea(rt,Tt,!1,w,a,d,_,n.glyphOffsetArray,q,Z,Ot,It,Xt,$);ot=Wt.useVertical,(Wt.notEnoughRoom||ot||Wt.needsFlipping&&Ea(rt,Tt,!0,w,a,d,_,n.glyphOffsetArray,q,Z,Ot,It,Xt,$).notEnoughRoom)&&In(rt.numGlyphs,Z)}else In(rt.numGlyphs,Z)}}l?n.text.dynamicLayoutVertexBuffer.updateData(Z):n.icon.dynamicLayoutVertexBuffer.updateData(Z)}function Ai(n,a,o,l,d,_,g,w,I,M,N){var Z=w.glyphStartIndex+w.numGlyphs,q=w.lineStartIndex,Q=w.lineStartIndex+w.lineLength,$=a.getoffsetX(w.glyphStartIndex),ot=a.getoffsetX(Z-1),K=Zi(n*$,o,l,d,_,g,w.segment,q,Q,I,M,N);if(!K)return null;var rt=Zi(n*ot,o,l,d,_,g,w.segment,q,Q,I,M,N);return rt?{first:K,last:rt}:null}function nr(n,a,o,l){return n===c.WritingMode.horizontal&&Math.abs(o.y-a.y)>Math.abs(o.x-a.x)*l?{useVertical:!0}:(n===c.WritingMode.vertical?a.y<o.y:a.x>o.x)?{needsFlipping:!0}:null}function Ea(n,a,o,l,d,_,g,w,I,M,N,Z,q,Q){var $,ot=a/24,K=n.lineOffsetX*ot,rt=n.lineOffsetY*ot;if(n.numGlyphs>1){var lt=n.glyphStartIndex+n.numGlyphs,yt=n.lineStartIndex,Et=n.lineStartIndex+n.lineLength,Tt=Ai(ot,w,K,rt,o,N,Z,n,I,_,q);if(!Tt)return{notEnoughRoom:!0};var It=Ye(Tt.first.point,g).point,Ot=Ye(Tt.last.point,g).point;if(l&&!o){var Xt=nr(n.writingMode,It,Ot,Q);if(Xt)return Xt}$=[Tt.first];for(var Wt=n.glyphStartIndex+1;Wt<lt-1;Wt++)$.push(Zi(ot*w.getoffsetX(Wt),K,rt,o,N,Z,n.segment,yt,Et,I,_,q));$.push(Tt.last)}else{if(l&&!o){var se=Ye(Z,d).point,ge=n.lineStartIndex+n.segment+1,we=new c.Point(I.getx(ge),I.gety(ge)),be=Ye(we,d),xi=be.signedDistanceFromCamera>0?be.point:ga(Z,we,se,1,d),he=nr(n.writingMode,se,xi,Q);if(he)return he}var Fe=Zi(ot*w.getoffsetX(n.glyphStartIndex),K,rt,o,N,Z,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,I,_,q);if(!Fe)return{notEnoughRoom:!0};$=[Fe]}for(var $e=0,De=$;$e<De.length;$e+=1){var ke=De[$e];c.addDynamicAttributes(M,ke.point,ke.angle)}return{}}function ga(n,a,o,l,d){var _=Ye(n.add(n.sub(a)._unit()),d).point,g=o.sub(_);return o.add(g._mult(l/g.mag()))}function Zi(n,a,o,l,d,_,g,w,I,M,N,Z){var q=l?n-a:n+a,Q=q>0?1:-1,$=0;l&&(Q*=-1,$=Math.PI),Q<0&&($+=Math.PI);for(var ot=Q>0?w+g:w+g+1,K=d,rt=d,lt=0,yt=0,Et=Math.abs(q),Tt=[];lt+yt<=Et;){if((ot+=Q)<w||ot>=I)return null;if(rt=K,Tt.push(K),void 0===(K=Z[ot])){var It=new c.Point(M.getx(ot),M.gety(ot)),Ot=Ye(It,N);if(Ot.signedDistanceFromCamera>0)K=Z[ot]=Ot.point;else{var Xt=ot-Q;K=ga(0===lt?_:new c.Point(M.getx(Xt),M.gety(Xt)),It,rt,Et-lt+1,N)}}lt+=yt,yt=rt.dist(K)}var Wt=(Et-lt)/yt,se=K.sub(rt),ge=se.mult(Wt)._add(rt);ge._add(se._unit()._perp()._mult(o*Q));var we=$+Math.atan2(K.y-rt.y,K.x-rt.x);return Tt.push(ge),{point:ge,angle:we,path:Tt}}di.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},di.prototype.insert=function(n,a,o,l,d){this._forEachCell(a,o,l,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(d)},di.prototype.insertCircle=function(n,a,o,l){this._forEachCell(a-l,o-l,a+l,o+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(o),this.circles.push(l)},di.prototype._insertBoxCell=function(n,a,o,l,d,_){this.boxCells[d].push(_)},di.prototype._insertCircleCell=function(n,a,o,l,d,_){this.circleCells[d].push(_)},di.prototype._query=function(n,a,o,l,d,_){if(o<0||n>this.width||l<0||a>this.height)return!d&&[];var g=[];if(n<=0&&a<=0&&this.width<=o&&this.height<=l){if(d)return!0;for(var w=0;w<this.boxKeys.length;w++)g.push({key:this.boxKeys[w],x1:this.bboxes[4*w],y1:this.bboxes[4*w+1],x2:this.bboxes[4*w+2],y2:this.bboxes[4*w+3]});for(var I=0;I<this.circleKeys.length;I++){var M=this.circles[3*I],N=this.circles[3*I+1],Z=this.circles[3*I+2];g.push({key:this.circleKeys[I],x1:M-Z,y1:N-Z,x2:M+Z,y2:N+Z})}return _?g.filter(_):g}return this._forEachCell(n,a,o,l,this._queryCell,g,{hitTest:d,seenUids:{box:{},circle:{}}},_),d?g.length>0:g},di.prototype._queryCircle=function(n,a,o,l,d){var _=n-o,g=n+o,w=a-o,I=a+o;if(g<0||_>this.width||I<0||w>this.height)return!l&&[];var M=[];return this._forEachCell(_,w,g,I,this._queryCellCircle,M,{hitTest:l,circle:{x:n,y:a,radius:o},seenUids:{box:{},circle:{}}},d),l?M.length>0:M},di.prototype.query=function(n,a,o,l,d){return this._query(n,a,o,l,!1,d)},di.prototype.hitTest=function(n,a,o,l,d){return this._query(n,a,o,l,!0,d)},di.prototype.hitTestCircle=function(n,a,o,l){return this._queryCircle(n,a,o,!0,l)},di.prototype._queryCell=function(n,a,o,l,d,_,g,w){var I=g.seenUids,M=this.boxCells[d];if(null!==M)for(var N=this.bboxes,Z=0,q=M;Z<q.length;Z+=1){var Q=q[Z];if(!I.box[Q]){I.box[Q]=!0;var $=4*Q;if(n<=N[$+2]&&a<=N[$+3]&&o>=N[$+0]&&l>=N[$+1]&&(!w||w(this.boxKeys[Q]))){if(g.hitTest)return _.push(!0),!0;_.push({key:this.boxKeys[Q],x1:N[$],y1:N[$+1],x2:N[$+2],y2:N[$+3]})}}}var ot=this.circleCells[d];if(null!==ot)for(var K=this.circles,rt=0,lt=ot;rt<lt.length;rt+=1){var yt=lt[rt];if(!I.circle[yt]){I.circle[yt]=!0;var Et=3*yt;if(this._circleAndRectCollide(K[Et],K[Et+1],K[Et+2],n,a,o,l)&&(!w||w(this.circleKeys[yt]))){if(g.hitTest)return _.push(!0),!0;var Tt=K[Et],It=K[Et+1],Ot=K[Et+2];_.push({key:this.circleKeys[yt],x1:Tt-Ot,y1:It-Ot,x2:Tt+Ot,y2:It+Ot})}}}},di.prototype._queryCellCircle=function(n,a,o,l,d,_,g,w){var I=g.circle,M=g.seenUids,N=this.boxCells[d];if(null!==N)for(var Z=this.bboxes,q=0,Q=N;q<Q.length;q+=1){var $=Q[q];if(!M.box[$]){M.box[$]=!0;var ot=4*$;if(this._circleAndRectCollide(I.x,I.y,I.radius,Z[ot+0],Z[ot+1],Z[ot+2],Z[ot+3])&&(!w||w(this.boxKeys[$])))return _.push(!0),!0}}var K=this.circleCells[d];if(null!==K)for(var rt=this.circles,lt=0,yt=K;lt<yt.length;lt+=1){var Et=yt[lt];if(!M.circle[Et]){M.circle[Et]=!0;var Tt=3*Et;if(this._circlesCollide(rt[Tt],rt[Tt+1],rt[Tt+2],I.x,I.y,I.radius)&&(!w||w(this.circleKeys[Et])))return _.push(!0),!0}}},di.prototype._forEachCell=function(n,a,o,l,d,_,g,w){for(var I=this._convertToXCellCoord(n),M=this._convertToYCellCoord(a),N=this._convertToXCellCoord(o),Z=this._convertToYCellCoord(l),q=I;q<=N;q++)for(var Q=M;Q<=Z;Q++)if(d.call(this,n,a,o,l,this.xCellCount*Q+q,_,g,w))return},di.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},di.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},di.prototype._circlesCollide=function(n,a,o,l,d,_){var g=l-n,w=d-a,I=o+_;return I*I>g*g+w*w},di.prototype._circleAndRectCollide=function(n,a,o,l,d,_,g){var w=(_-l)/2,I=Math.abs(n-(l+w));if(I>w+o)return!1;var M=(g-d)/2,N=Math.abs(a-(d+M));if(N>M+o)return!1;if(I<=w||N<=M)return!0;var Z=I-w,q=N-M;return Z*Z+q*q<=o*o};var cr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function In(n,a){for(var o=0;o<n;o++){var l=a.length;a.resize(l+4),a.float32.set(cr,3*l)}}function Cn(n,a,o){var l=a[0],d=a[1];return n[0]=o[0]*l+o[4]*d+o[12],n[1]=o[1]*l+o[5]*d+o[13],n[3]=o[3]*l+o[7]*d+o[15],n}var Fn=function(n,a,o){void 0===a&&(a=new di(n.width+200,n.height+200,25)),void 0===o&&(o=new di(n.width+200,n.height+200,25)),this.transform=n,this.grid=a,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Gi(n,a,o){return a*(c.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}Fn.prototype.placeCollisionBox=function(n,a,o,l,d){var _=this.projectAndGetPerspectiveRatio(l,n.anchorPointX,n.anchorPointY),g=o*_.perspectiveRatio,w=n.x1*g+_.point.x,I=n.y1*g+_.point.y,M=n.x2*g+_.point.x,N=n.y2*g+_.point.y;return!this.isInsideGrid(w,I,M,N)||!a&&this.grid.hitTest(w,I,M,N,d)?{box:[],offscreen:!1}:{box:[w,I,M,N],offscreen:this.isOffscreen(w,I,M,N)}},Fn.prototype.placeCollisionCircles=function(n,a,o,l,d,_,g,w,I,M,N,Z,q){var Q=[],$=new c.Point(a.anchorX,a.anchorY),ot=Ye($,_),K=fe(this.transform.cameraToCenterDistance,ot.signedDistanceFromCamera),rt=(M?d/K:d*K)/c.ONE_EM,lt=Ye($,g).point,yt=Ai(rt,l,a.lineOffsetX*rt,a.lineOffsetY*rt,!1,lt,$,a,o,g,{}),Et=!1,Tt=!1,It=!0;if(yt){for(var Ot=.5*Z*K+q,Xt=new c.Point(-100,-100),Wt=new c.Point(this.screenRightBoundary,this.screenBottomBoundary),se=new br,ge=yt.first,we=yt.last,be=[],xi=ge.path.length-1;xi>=1;xi--)be.push(ge.path[xi]);for(var he=1;he<we.path.length;he++)be.push(we.path[he]);var Fe=2.5*Ot;if(w){var $e=be.map(function(pa){return Ye(pa,w)});be=$e.some(function(pa){return pa.signedDistanceFromCamera<=0})?[]:$e.map(function(pa){return pa.point})}var De=[];if(be.length>0){for(var ke=be[0].clone(),Xe=be[0].clone(),Le=1;Le<be.length;Le++)ke.x=Math.min(ke.x,be[Le].x),ke.y=Math.min(ke.y,be[Le].y),Xe.x=Math.max(Xe.x,be[Le].x),Xe.y=Math.max(Xe.y,be[Le].y);De=ke.x>=Xt.x&&Xe.x<=Wt.x&&ke.y>=Xt.y&&Xe.y<=Wt.y?[be]:Xe.x<Xt.x||ke.x>Wt.x||Xe.y<Xt.y||ke.y>Wt.y?[]:c.clipLine([be],Xt.x,Xt.y,Wt.x,Wt.y)}for(var Pe=0,Pr=De;Pe<Pr.length;Pe+=1){var Zn;se.reset(Pr[Pe],.25*Ot),Zn=se.length<=.5*Ot?1:Math.ceil(se.paddedLength/Fe)+1;for(var po=0;po<Zn;po++){var Nr=po/Math.max(Zn-1,1),zn=se.lerp(Nr),Yn=zn.x+100,Vo=zn.y+100;Q.push(Yn,Vo,Ot,0);var vo=Yn-Ot,ys=Vo-Ot,Lo=Yn+Ot,Sa=Vo+Ot;if(It=It&&this.isOffscreen(vo,ys,Lo,Sa),Tt=Tt||this.isInsideGrid(vo,ys,Lo,Sa),!n&&this.grid.hitTestCircle(Yn,Vo,Ot,N)&&(Et=!0,!I))return{circles:[],offscreen:!1,collisionDetected:Et}}}}return{circles:!I&&Et||!Tt?[]:Q,offscreen:It,collisionDetected:Et}},Fn.prototype.queryRenderedSymbols=function(n){if(0===n.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var a=[],o=1/0,l=1/0,d=-1/0,_=-1/0,g=0,w=n;g<w.length;g+=1){var I=w[g],M=new c.Point(I.x+100,I.y+100);o=Math.min(o,M.x),l=Math.min(l,M.y),d=Math.max(d,M.x),_=Math.max(_,M.y),a.push(M)}for(var N={},Z={},q=0,Q=this.grid.query(o,l,d,_).concat(this.ignoredGrid.query(o,l,d,_));q<Q.length;q+=1){var $=Q[q],ot=$.key;if(void 0===N[ot.bucketInstanceId]&&(N[ot.bucketInstanceId]={}),!N[ot.bucketInstanceId][ot.featureIndex]){var K=[new c.Point($.x1,$.y1),new c.Point($.x2,$.y1),new c.Point($.x2,$.y2),new c.Point($.x1,$.y2)];c.polygonIntersectsPolygon(a,K)&&(N[ot.bucketInstanceId][ot.featureIndex]=!0,void 0===Z[ot.bucketInstanceId]&&(Z[ot.bucketInstanceId]=[]),Z[ot.bucketInstanceId].push(ot.featureIndex))}}return Z},Fn.prototype.insertCollisionBox=function(n,a,o,l,d){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:l,collisionGroupID:d},n[0],n[1],n[2],n[3])},Fn.prototype.insertCollisionCircles=function(n,a,o,l,d){for(var _=a?this.ignoredGrid:this.grid,g={bucketInstanceId:o,featureIndex:l,collisionGroupID:d},w=0;w<n.length;w+=4)_.insertCircle(g,n[w],n[w+1],n[w+2])},Fn.prototype.projectAndGetPerspectiveRatio=function(n,a,o){var l=[a,o,0,1];return Cn(l,l,n),{point:new c.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},Fn.prototype.isOffscreen=function(n,a,o,l){return o<100||n>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},Fn.prototype.isInsideGrid=function(n,a,o,l){return o>=0&&n<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},Fn.prototype.getViewportMatrix=function(){var n=c.identity([]);return c.translate(n,n,[-100,-100,0]),n};var ro=function(n,a,o,l){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):l&&o?1:0,this.placed=o};ro.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var wr=function(n,a,o,l,d){this.text=new ro(n?n.text:null,a,o,d),this.icon=new ro(n?n.icon:null,a,l,d)};wr.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Pa=function(n,a,o){this.text=n,this.icon=a,this.skipFade=o},rr=function(){this.invProjMatrix=c.create(),this.viewportMatrix=c.create(),this.circles=[]},Ga=function(n,a,o,l,d){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=o,this.bucketIndex=l,this.tileID=d},Ln=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Un(n,a,o,l,d){var _=c.getAnchorAlignment(n),g=-(_.horizontalAlign-.5)*a,w=-(_.verticalAlign-.5)*o,I=c.evaluateVariableOffset(n,l);return new c.Point(g+I[0]*d,w+I[1]*d)}function Jr(n,a,o,l,d,_){var g=n.x1,w=n.x2,I=n.y1,M=n.y2,N=n.anchorPointX,Z=n.anchorPointY,q=new c.Point(a,o);return l&&q._rotate(d?_:-_),{x1:g+q.x,y1:I+q.y,x2:w+q.x,y2:M+q.y,anchorPointX:N,anchorPointY:Z}}Ln.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:function(o){return o.collisionGroupID===a}}}return this.collisionGroups[n]};var pr=function(n,a,o,l){this.transform=n.clone(),this.collisionIndex=new Fn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new Ln(o),this.collisionCircleArrays={},this.prevPlacement=l,l&&(l.prevPlacement=void 0),this.placedOrientations={}};function oa(n,a,o,l,d){n.emplaceBack(a?1:0,o?1:0,l||0,d||0),n.emplaceBack(a?1:0,o?1:0,l||0,d||0),n.emplaceBack(a?1:0,o?1:0,l||0,d||0),n.emplaceBack(a?1:0,o?1:0,l||0,d||0)}pr.prototype.getBucketParts=function(n,a,o,l){var d=o.getBucket(a),_=o.latestFeatureIndex;if(d&&_&&a.id===d.layerIds[0]){var g=o.collisionBoxArray,w=d.layers[0].layout,I=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),M=o.tileSize/c.EXTENT,N=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),Z="map"===w.get("text-pitch-alignment"),q="map"===w.get("text-rotation-alignment"),Q=Gi(o,1,this.transform.zoom),$=rn(N,Z,q,this.transform,Q),ot=null;if(Z){var K=vi(N,Z,q,this.transform,Q);ot=c.multiply([],this.transform.labelPlaneMatrix,K)}this.retainedQueryData[d.bucketInstanceId]=new Ga(d.bucketInstanceId,_,d.sourceLayerIndex,d.index,o.tileID);var rt={bucket:d,layout:w,posMatrix:N,textLabelPlaneMatrix:$,labelToScreenMatrix:ot,scale:I,textPixelRatio:M,holdingForFade:o.holdingForFade(),collisionBoxArray:g,partiallyEvaluatedTextSize:c.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(l)for(var lt=0,yt=d.sortKeyRanges;lt<yt.length;lt+=1){var Et=yt[lt];n.push({sortKey:Et.sortKey,symbolInstanceStart:Et.symbolInstanceStart,symbolInstanceEnd:Et.symbolInstanceEnd,parameters:rt})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:rt})}},pr.prototype.attemptAnchorPlacement=function(n,a,o,l,d,_,g,w,I,M,N,Z,q,Q,$){var ot,K=[Z.textOffset0,Z.textOffset1],rt=Un(n,o,l,K,d),lt=this.collisionIndex.placeCollisionBox(Jr(a,rt.x,rt.y,_,g,this.transform.angle),N,w,I,M.predicate);if(!$||0!==this.collisionIndex.placeCollisionBox(Jr($,rt.x,rt.y,_,g,this.transform.angle),N,w,I,M.predicate).box.length)return lt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(ot=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),this.variableOffsets[Z.crossTileID]={textOffset:K,width:o,height:l,anchor:n,textBoxScale:d,prevAnchor:ot},this.markUsedJustification(q,n,Z,Q),q.allowVerticalPlacement&&(this.markUsedOrientation(q,Q,Z),this.placedOrientations[Z.crossTileID]=Q),{shift:rt,placedGlyphBoxes:lt}):void 0},pr.prototype.placeLayerBucketPart=function(n,a,o){var l=this,d=n.parameters,_=d.bucket,g=d.layout,w=d.posMatrix,I=d.textLabelPlaneMatrix,M=d.labelToScreenMatrix,N=d.textPixelRatio,Z=d.holdingForFade,q=d.collisionBoxArray,Q=d.partiallyEvaluatedTextSize,$=d.collisionGroup,ot=g.get("text-optional"),K=g.get("icon-optional"),rt=g.get("text-allow-overlap"),lt=g.get("icon-allow-overlap"),yt="map"===g.get("text-rotation-alignment"),Et="map"===g.get("text-pitch-alignment"),Tt="none"!==g.get("icon-text-fit"),It="viewport-y"===g.get("symbol-z-order"),Ot=rt&&(lt||!_.hasIconData()||K),Xt=lt&&(rt||!_.hasTextData()||ot);!_.collisionArrays&&q&&_.deserializeCollisionBoxes(q);var Wt=function(he,Fe){if(!a[he.crossTileID])if(Z)l.placements[he.crossTileID]=new Pa(!1,!1,!1);else{var $e,De=!1,ke=!1,Xe=!0,Le=null,Pe={box:null,offscreen:null},Pr={box:null,offscreen:null},Zn=null,po=null,Nr=0,zn=0,Yn=0;Fe.textFeatureIndex?Nr=Fe.textFeatureIndex:he.useRuntimeCollisionCircles&&(Nr=he.featureIndex),Fe.verticalTextFeatureIndex&&(zn=Fe.verticalTextFeatureIndex);var Vo=Fe.textBox;if(Vo){var vo=function(Oi){var na=c.WritingMode.horizontal;if(_.allowVerticalPlacement&&!Oi&&l.prevPlacement){var zo=l.prevPlacement.placedOrientations[he.crossTileID];zo&&(l.placedOrientations[he.crossTileID]=zo,l.markUsedOrientation(_,na=zo,he))}return na},ys=function(Oi,na){if(_.allowVerticalPlacement&&he.numVerticalGlyphVertices>0&&Fe.verticalTextBox)for(var zo=0,Ms=_.writingModes;zo<Ms.length&&(Ms[zo]===c.WritingMode.vertical?(Pe=na(),Pr=Pe):Pe=Oi(),!(Pe&&Pe.box&&Pe.box.length));zo+=1);else Pe=Oi()};if(g.get("text-variable-anchor")){var Lo=g.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[he.crossTileID]){var Sa=l.prevPlacement.variableOffsets[he.crossTileID];Lo.indexOf(Sa.anchor)>0&&(Lo=Lo.filter(function(Oi){return Oi!==Sa.anchor})).unshift(Sa.anchor)}var pa=function(Oi,na,zo){for(var Ms=Oi.x2-Oi.x1,sh=Oi.y2-Oi.y1,Tl=he.textBoxScale,lh=Tt&&!lt?na:null,ll={box:[],offscreen:!1},Iu=rt?2*Lo.length:Lo.length,Xs=0;Xs<Iu;++Xs){var Sl=l.attemptAnchorPlacement(Lo[Xs%Lo.length],Oi,Ms,sh,Tl,yt,Et,N,w,$,Xs>=Lo.length,he,_,zo,lh);if(Sl&&(ll=Sl.placedGlyphBoxes)&&ll.box&&ll.box.length){De=!0,Le=Sl.shift;break}}return ll};ys(function(){return pa(Vo,Fe.iconBox,c.WritingMode.horizontal)},function(){var Oi=Fe.verticalTextBox;return _.allowVerticalPlacement&&!(Pe&&Pe.box&&Pe.box.length)&&he.numVerticalGlyphVertices>0&&Oi?pa(Oi,Fe.verticalIconBox,c.WritingMode.vertical):{box:null,offscreen:null}}),Pe&&(De=Pe.box,Xe=Pe.offscreen);var ol=vo(Pe&&Pe.box);if(!De&&l.prevPlacement){var Ws=l.prevPlacement.variableOffsets[he.crossTileID];Ws&&(l.variableOffsets[he.crossTileID]=Ws,l.markUsedJustification(_,Ws.anchor,he,ol))}}else{var gs=function(Oi,na){var zo=l.collisionIndex.placeCollisionBox(Oi,rt,N,w,$.predicate);return zo&&zo.box&&zo.box.length&&(l.markUsedOrientation(_,na,he),l.placedOrientations[he.crossTileID]=na),zo};ys(function(){return gs(Vo,c.WritingMode.horizontal)},function(){var Oi=Fe.verticalTextBox;return _.allowVerticalPlacement&&he.numVerticalGlyphVertices>0&&Oi?gs(Oi,c.WritingMode.vertical):{box:null,offscreen:null}}),vo(Pe&&Pe.box&&Pe.box.length)}}if(De=($e=Pe)&&$e.box&&$e.box.length>0,Xe=$e&&$e.offscreen,he.useRuntimeCollisionCircles){var Hs=_.text.placedSymbolArray.get(he.centerJustifiedTextSymbolIndex),al=c.evaluateSizeForFeature(_.textSizeData,Q,Hs),Za=g.get("text-padding");Zn=l.collisionIndex.placeCollisionCircles(rt,Hs,_.lineVertexArray,_.glyphOffsetArray,al,w,I,M,o,Et,$.predicate,he.collisionCircleDiameter,Za),De=rt||Zn.circles.length>0&&!Zn.collisionDetected,Xe=Xe&&Zn.offscreen}if(Fe.iconFeatureIndex&&(Yn=Fe.iconFeatureIndex),Fe.iconBox){var sl=function(Oi){var na=Tt&&Le?Jr(Oi,Le.x,Le.y,yt,Et,l.transform.angle):Oi;return l.collisionIndex.placeCollisionBox(na,lt,N,w,$.predicate)};ke=Pr&&Pr.box&&Pr.box.length&&Fe.verticalIconBox?(po=sl(Fe.verticalIconBox)).box.length>0:(po=sl(Fe.iconBox)).box.length>0,Xe=Xe&&po.offscreen}var Va=ot||0===he.numHorizontalGlyphVertices&&0===he.numVerticalGlyphVertices,Ar=K||0===he.numIconVertices;if(Va||Ar?Ar?Va||(ke=ke&&De):De=ke&&De:ke=De=ke&&De,De&&$e&&$e.box&&l.collisionIndex.insertCollisionBox($e.box,g.get("text-ignore-placement"),_.bucketInstanceId,Pr&&Pr.box&&zn?zn:Nr,$.ID),ke&&po&&l.collisionIndex.insertCollisionBox(po.box,g.get("icon-ignore-placement"),_.bucketInstanceId,Yn,$.ID),Zn&&(De&&l.collisionIndex.insertCollisionCircles(Zn.circles,g.get("text-ignore-placement"),_.bucketInstanceId,Nr,$.ID),o)){var is=_.bucketInstanceId,vs=l.collisionCircleArrays[is];void 0===vs&&(vs=l.collisionCircleArrays[is]=new rr);for(var ks=0;ks<Zn.circles.length;ks+=4)vs.circles.push(Zn.circles[ks+0]),vs.circles.push(Zn.circles[ks+1]),vs.circles.push(Zn.circles[ks+2]),vs.circles.push(Zn.collisionDetected?1:0)}l.placements[he.crossTileID]=new Pa(De||Ot,ke||Xt,Xe||_.justReloaded),a[he.crossTileID]=!0}};if(It)for(var se=_.getSortedSymbolIndexes(this.transform.angle),ge=se.length-1;ge>=0;--ge){var we=se[ge];Wt(_.symbolInstances.get(we),_.collisionArrays[we])}else for(var be=n.symbolInstanceStart;be<n.symbolInstanceEnd;be++)Wt(_.symbolInstances.get(be),_.collisionArrays[be]);if(o&&_.bucketInstanceId in this.collisionCircleArrays){var xi=this.collisionCircleArrays[_.bucketInstanceId];c.invert(xi.invProjMatrix,w),xi.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1},pr.prototype.markUsedJustification=function(n,a,o,l){var d;d=l===c.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[c.getAnchorJustification(a)];for(var _=0,g=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];_<g.length;_+=1){var w=g[_];w>=0&&(n.text.placedSymbolArray.get(w).crossTileID=d>=0&&w!==d?0:o.crossTileID)}},pr.prototype.markUsedOrientation=function(n,a,o){for(var l=a===c.WritingMode.horizontal||a===c.WritingMode.horizontalOnly?a:0,d=a===c.WritingMode.vertical?a:0,_=0,g=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];_<g.length;_+=1)n.text.placedSymbolArray.get(g[_]).placedOrientation=l;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=d)},pr.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,o=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(n):1,d=a?a.opacities:{},_=a?a.variableOffsets:{},g=a?a.placedOrientations:{};for(var w in this.placements){var I=this.placements[w],M=d[w];M?(this.opacities[w]=new wr(M,l,I.text,I.icon),o=o||I.text!==M.text.placed||I.icon!==M.icon.placed):(this.opacities[w]=new wr(null,l,I.text,I.icon,I.skipFade),o=o||I.text||I.icon)}for(var N in d){var Z=d[N];if(!this.opacities[N]){var q=new wr(Z,l,!1,!1);q.isHidden()||(this.opacities[N]=q,o=o||Z.text.placed||Z.icon.placed)}}for(var Q in _)this.variableOffsets[Q]||!this.opacities[Q]||this.opacities[Q].isHidden()||(this.variableOffsets[Q]=_[Q]);for(var $ in g)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=g[$]);o?this.lastPlacementChangeTime=n:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)},pr.prototype.updateLayerOpacities=function(n,a){for(var o={},l=0,d=a;l<d.length;l+=1){var _=d[l],g=_.getBucket(n);g&&_.latestFeatureIndex&&n.id===g.layerIds[0]&&this.updateBucketOpacities(g,o,_.collisionBoxArray)}},pr.prototype.updateBucketOpacities=function(n,a,o){var l=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var d=n.layers[0].layout,_=new wr(null,0,!1,!1,!0),g=d.get("text-allow-overlap"),w=d.get("icon-allow-overlap"),I=d.get("text-variable-anchor"),M="map"===d.get("text-rotation-alignment"),N="map"===d.get("text-pitch-alignment"),Z="none"!==d.get("icon-text-fit"),q=new wr(null,0,g&&(w||!n.hasIconData()||d.get("icon-optional")),w&&(g||!n.hasTextData()||d.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var Q=function(rt,lt,yt){for(var Et=0;Et<lt/4;Et++)rt.opacityVertexArray.emplaceBack(yt)},$=function(rt){var lt=n.symbolInstances.get(rt),yt=lt.numHorizontalGlyphVertices,Et=lt.numVerticalGlyphVertices,Tt=lt.crossTileID,It=l.opacities[Tt];a[Tt]?It=_:It||(l.opacities[Tt]=It=q),a[Tt]=!0;var Ot=lt.numIconVertices>0,Xt=l.placedOrientations[lt.crossTileID],Wt=Xt===c.WritingMode.vertical,se=Xt===c.WritingMode.horizontal||Xt===c.WritingMode.horizontalOnly;if(yt>0||Et>0){var ge=Xn(It.text);Q(n.text,yt,Wt?dr:ge),Q(n.text,Et,se?dr:ge);var we=It.text.isHidden();[lt.rightJustifiedTextSymbolIndex,lt.centerJustifiedTextSymbolIndex,lt.leftJustifiedTextSymbolIndex].forEach(function(Pe){Pe>=0&&(n.text.placedSymbolArray.get(Pe).hidden=we||Wt?1:0)}),lt.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(lt.verticalPlacedTextSymbolIndex).hidden=we||se?1:0);var be=l.variableOffsets[lt.crossTileID];be&&l.markUsedJustification(n,be.anchor,lt,Xt);var xi=l.placedOrientations[lt.crossTileID];xi&&(l.markUsedJustification(n,"left",lt,xi),l.markUsedOrientation(n,xi,lt))}if(Ot){var he=Xn(It.icon),Fe=!(Z&&lt.verticalPlacedIconSymbolIndex&&Wt);lt.placedIconSymbolIndex>=0&&(Q(n.icon,lt.numIconVertices,Fe?he:dr),n.icon.placedSymbolArray.get(lt.placedIconSymbolIndex).hidden=It.icon.isHidden()),lt.verticalPlacedIconSymbolIndex>=0&&(Q(n.icon,lt.numVerticalIconVertices,Fe?dr:he),n.icon.placedSymbolArray.get(lt.verticalPlacedIconSymbolIndex).hidden=It.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var $e=n.collisionArrays[rt];if($e){var De=new c.Point(0,0);if($e.textBox||$e.verticalTextBox){var ke=!0;if(I){var Xe=l.variableOffsets[Tt];Xe?(De=Un(Xe.anchor,Xe.width,Xe.height,Xe.textOffset,Xe.textBoxScale),M&&De._rotate(N?l.transform.angle:-l.transform.angle)):ke=!1}$e.textBox&&oa(n.textCollisionBox.collisionVertexArray,It.text.placed,!ke||Wt,De.x,De.y),$e.verticalTextBox&&oa(n.textCollisionBox.collisionVertexArray,It.text.placed,!ke||se,De.x,De.y)}var Le=Boolean(!se&&$e.verticalIconBox);$e.iconBox&&oa(n.iconCollisionBox.collisionVertexArray,It.icon.placed,Le,Z?De.x:0,Z?De.y:0),$e.verticalIconBox&&oa(n.iconCollisionBox.collisionVertexArray,It.icon.placed,!Le,Z?De.x:0,Z?De.y:0)}}},ot=0;ot<n.symbolInstances.length;ot++)$(ot);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var K=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=K.invProjMatrix,n.placementViewportMatrix=K.viewportMatrix,n.collisionCircleArray=K.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},pr.prototype.symbolFadeChange=function(n){return 0===this.fadeDuration?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},pr.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},pr.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},pr.prototype.stillRecent=function(n,a){var o=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*o>n},pr.prototype.setStale=function(){this.stale=!0};var Aa=Math.pow(2,25),aa=Math.pow(2,24),Oo=Math.pow(2,17),as=Math.pow(2,16),Wa=Math.pow(2,9),Ps=Math.pow(2,8),Ia=Math.pow(2,1);function Xn(n){if(0===n.opacity&&!n.placed)return 0;if(1===n.opacity&&n.placed)return 4294967295;var a=n.placed?1:0,o=Math.floor(127*n.opacity);return o*Aa+a*aa+o*Oo+a*as+o*Wa+a*Ps+o*Ia+a}var dr=0,So=function(n){this._sortAcrossTiles="viewport-y"!==n.layout.get("symbol-z-order")&&void 0!==n.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};So.prototype.continuePlacement=function(n,a,o,l,d){for(var _=this._bucketParts;this._currentTileIndex<n.length;)if(a.getBucketParts(_,l,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort(function(g,w){return g.sortKey-w.sortKey}));this._currentPartIndex<_.length;)if(a.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,d())return!0;return!1};var oo=function(n,a,o,l,d,_,g){this.placement=new pr(n,d,_,g),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=l,this._done=!1};oo.prototype.isDone=function(){return this._done},oo.prototype.continuePlacement=function(n,a,o){for(var l=this,d=c.browser.now(),_=function(){var I=c.browser.now()-d;return!l._forceFullPlacement&&I>2};this._currentPlacementIndex>=0;){var g=a[n[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if("symbol"===g.type&&(!g.minzoom||g.minzoom<=w)&&(!g.maxzoom||g.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new So(g)),this._inProgressLayer.continuePlacement(o[g.source],this.placement,this._showCollisionBoxes,g,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},oo.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Ca=512/c.EXTENT/2,Ha=function(n,a,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var l=0;l<a.length;l++){var d=a.get(l),_=d.key;this.indexedSymbolInstances[_]||(this.indexedSymbolInstances[_]=[]),this.indexedSymbolInstances[_].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,n)})}};Ha.prototype.getScaledCoordinates=function(n,a){var o=Ca/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*c.EXTENT+n.anchorX)*o),y:Math.floor((a.canonical.y*c.EXTENT+n.anchorY)*o)}},Ha.prototype.findMatches=function(n,a,o){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),d=0;d<n.length;d++){var _=n.get(d);if(!_.crossTileID){var g=this.indexedSymbolInstances[_.key];if(g)for(var w=this.getScaledCoordinates(_,a),I=0,M=g;I<M.length;I+=1){var N=M[I];if(Math.abs(N.coord.x-w.x)<=l&&Math.abs(N.coord.y-w.y)<=l&&!o[N.crossTileID]){o[N.crossTileID]=!0,_.crossTileID=N.crossTileID;break}}}}};var Dr=function(){this.maxCrossTileID=0};Dr.prototype.generate=function(){return++this.maxCrossTileID};var Or=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Or.prototype.handleWrapJump=function(n){var a=Math.round((n-this.lng)/360);if(0!==a)for(var o in this.indexes){var l=this.indexes[o],d={};for(var _ in l){var g=l[_];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),d[g.tileID.key]=g}this.indexes[o]=d}this.lng=n},Or.prototype.addBucket=function(n,a,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var d=this.usedCrossTileIDs[n.overscaledZ];for(var _ in this.indexes){var g=this.indexes[_];if(Number(_)>n.overscaledZ)for(var w in g){var I=g[w];I.tileID.isChildOf(n)&&I.findMatches(a.symbolInstances,n,d)}else{var M=g[n.scaledTo(Number(_)).key];M&&M.findMatches(a.symbolInstances,n,d)}}for(var N=0;N<a.symbolInstances.length;N++){var Z=a.symbolInstances.get(N);Z.crossTileID||(Z.crossTileID=o.generate(),d[Z.crossTileID]=!0)}return void 0===this.indexes[n.overscaledZ]&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Ha(n,a.symbolInstances,a.bucketInstanceId),!0},Or.prototype.removeBucketCrossTileIDs=function(n,a){for(var o in a.indexedSymbolInstances)for(var l=0,d=a.indexedSymbolInstances[o];l<d.length;l+=1)delete this.usedCrossTileIDs[n][d[l].crossTileID]},Or.prototype.removeStaleBuckets=function(n){var a=!1;for(var o in this.indexes){var l=this.indexes[o];for(var d in l)n[l[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,l[d]),delete l[d],a=!0)}return a};var Eo=function(){this.layerIndexes={},this.crossTileIDs=new Dr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Eo.prototype.addLayer=function(n,a,o){var l=this.layerIndexes[n.id];void 0===l&&(l=this.layerIndexes[n.id]=new Or);var d=!1,_={};l.handleWrapJump(o);for(var g=0,w=a;g<w.length;g+=1){var I=w[g],M=I.getBucket(n);M&&n.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(I.tileID,M,this.crossTileIDs)&&(d=!0),_[M.bucketInstanceId]=!0)}return l.removeStaleBuckets(_)&&(d=!0),d},Eo.prototype.pruneUnusedLayers=function(n){var a={};for(var o in n.forEach(function(l){a[l]=!0}),this.layerIndexes)a[o]||delete this.layerIndexes[o]};var Ho=function(n,a){return c.emitValidationErrors(n,a&&a.filter(function(o){return"source.canvas"!==o.identifier}))},Tr=c.pick(Yt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ao=c.pick(Yt,["setCenter","setZoom","setBearing","setPitch"]),Sn=function(){var n={},a=c.styleSpec.$version;for(var o in c.styleSpec.$root){var l,d=c.styleSpec.$root[o];d.required&&null!=(l="version"===o?a:"array"===d.type?[]:{})&&(n[o]=l)}return n}(),or=function(n){function a(o,l){var d=this;void 0===l&&(l={}),n.call(this),this.map=o,this.dispatcher=new un(Pt(),this),this.imageManager=new Ct,this.imageManager.setEventedParent(this),this.glyphManager=new ki(o._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Ri(256,512),this.crossTileSymbolIndex=new Eo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.getReferrer());var _=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(g){_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},function(w,I){if(c.triggerPluginCompletionEvent(w),I&&I.every(function(N){return N}))for(var M in _.sourceCaches)_.sourceCaches[M].reload()})}),this.on("data",function(g){if("source"===g.dataType&&"metadata"===g.sourceDataType){var w=d.sourceCaches[g.sourceId];if(w){var I=w.getSource();if(I&&I.vectorLayerIds)for(var M in d._layers){var N=d._layers[M];N.source===I.id&&d._validateLayer(N)}}}})}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.loadURL=function(o,l){var d=this;void 0===l&&(l={}),this.fire(new c.Event("dataloading",{dataType:"style"}));var _="boolean"==typeof l.validate?l.validate:!c.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,l.accessToken);var g=this.map._requestManager.transformRequest(o,c.ResourceType.Style);this._request=c.getJSON(g,function(w,I){d._request=null,w?d.fire(new c.ErrorEvent(w)):I&&d._load(I,_)})},a.prototype.loadJSON=function(o,l){var d=this;void 0===l&&(l={}),this.fire(new c.Event("dataloading",{dataType:"style"})),this._request=c.browser.frame(function(){d._request=null,d._load(o,!1!==l.validate)})},a.prototype.loadEmpty=function(){this.fire(new c.Event("dataloading",{dataType:"style"})),this._load(Sn,!1)},a.prototype._load=function(o,l){if(!l||!Ho(this,c.validateStyle(o))){for(var d in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(d,o.sources[d],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var _=Kt(this.stylesheet.layers);this._order=_.map(function(M){return M.id}),this._layers={},this._serializedLayers={};for(var g=0,w=_;g<w.length;g+=1){var I=w[g];(I=c.createStyleLayer(I)).setEventedParent(this,{layer:{id:I.id}}),this._layers[I.id]=I,this._serializedLayers[I.id]=I.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Wn(this.stylesheet.light),this.fire(new c.Event("data",{dataType:"style"})),this.fire(new c.Event("style.load"))}},a.prototype._loadSprite=function(o){var l=this;this._spriteRequest=function(d,_,g){var w,I,M,N=c.browser.devicePixelRatio>1?"@2x":"",Z=c.getJSON(_.transformRequest(_.normalizeSpriteURL(d,N,".json"),c.ResourceType.SpriteJSON),function($,ot){Z=null,M||(M=$,w=ot,Q())}),q=c.getImage(_.transformRequest(_.normalizeSpriteURL(d,N,".png"),c.ResourceType.SpriteImage),function($,ot){q=null,M||(M=$,I=ot,Q())});function Q(){if(M)g(M);else if(w&&I){var $=c.browser.getImageData(I),ot={};for(var K in w){var rt=w[K],lt=rt.width,yt=rt.height,Et=rt.x,Tt=rt.y,It=rt.sdf,Ot=rt.pixelRatio,Xt=rt.stretchX,Wt=rt.stretchY,se=rt.content,ge=new c.RGBAImage({width:lt,height:yt});c.RGBAImage.copy($,ge,{x:Et,y:Tt},{x:0,y:0},{width:lt,height:yt}),ot[K]={data:ge,pixelRatio:Ot,sdf:It,stretchX:Xt,stretchY:Wt,content:se}}g(null,ot)}}return{cancel:function(){Z&&(Z.cancel(),Z=null),q&&(q.cancel(),q=null)}}}(o,this.map._requestManager,function(d,_){if(l._spriteRequest=null,d)l.fire(new c.ErrorEvent(d));else if(_)for(var g in _)l.imageManager.addImage(g,_[g]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new c.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(o){var l=this.sourceCaches[o.source];if(l){var d=o.sourceLayer;if(d){var _=l.getSource();("geojson"===_.type||_.vectorLayerIds&&-1===_.vectorLayerIds.indexOf(d))&&this.fire(new c.ErrorEvent(new Error('Source layer "'+d+'" does not exist on source "'+_.id+'" as specified by style layer "'+o.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(o){for(var l=[],d=0,_=o;d<_.length;d+=1){var g=this._layers[_[d]];"custom"!==g.type&&l.push(g.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(o){if(this._loaded){var l=this._changed;if(this._changed){var d=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);for(var g in(d.length||_.length)&&this._updateWorkerLayers(d,_),this._updatedSources){var w=this._updatedSources[g];"reload"===w?this._reloadSource(g):"clear"===w&&this._clearSource(g)}for(var I in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[I].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var M={};for(var N in this.sourceCaches){var Z=this.sourceCaches[N];M[N]=Z.used,Z.used=!1}for(var q=0,Q=this._order;q<Q.length;q+=1){var $=this._layers[Q[q]];$.recalculate(o,this._availableImages),!$.isHidden(o.zoom)&&$.source&&(this.sourceCaches[$.source].used=!0)}for(var ot in M){var K=this.sourceCaches[ot];M[ot]!==K.used&&K.fire(new c.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ot}))}this.light.recalculate(o),this.z=o.zoom,l&&this.fire(new c.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},a.prototype._updateWorkerLayers=function(o,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(o){var l=this;if(this._checkLoaded(),Ho(this,c.validateStyle(o)))return!1;(o=c.clone$1(o)).layers=Kt(o.layers);var d=function(g,w){if(!g)return[{command:Yt.setStyle,args:[w]}];var I=[];try{if(!c.deepEqual(g.version,w.version))return[{command:Yt.setStyle,args:[w]}];c.deepEqual(g.center,w.center)||I.push({command:Yt.setCenter,args:[w.center]}),c.deepEqual(g.zoom,w.zoom)||I.push({command:Yt.setZoom,args:[w.zoom]}),c.deepEqual(g.bearing,w.bearing)||I.push({command:Yt.setBearing,args:[w.bearing]}),c.deepEqual(g.pitch,w.pitch)||I.push({command:Yt.setPitch,args:[w.pitch]}),c.deepEqual(g.sprite,w.sprite)||I.push({command:Yt.setSprite,args:[w.sprite]}),c.deepEqual(g.glyphs,w.glyphs)||I.push({command:Yt.setGlyphs,args:[w.glyphs]}),c.deepEqual(g.transition,w.transition)||I.push({command:Yt.setTransition,args:[w.transition]}),c.deepEqual(g.light,w.light)||I.push({command:Yt.setLight,args:[w.light]});var M={},N=[];!function(q,Q,$,ot){var K;for(K in Q=Q||{},q=q||{})q.hasOwnProperty(K)&&(Q.hasOwnProperty(K)||$t(K,$,ot));for(K in Q)Q.hasOwnProperty(K)&&(q.hasOwnProperty(K)?c.deepEqual(q[K],Q[K])||("geojson"===q[K].type&&"geojson"===Q[K].type&&Ze(q,Q,K)?$.push({command:Yt.setGeoJSONSourceData,args:[K,Q[K].data]}):Je(K,Q,$,ot)):ze(K,Q,$))}(g.sources,w.sources,N,M);var Z=[];g.layers&&g.layers.forEach(function(q){M[q.source]?I.push({command:Yt.removeLayer,args:[q.id]}):Z.push(q)}),I=I.concat(N),function(q,Q,$){Q=Q||[];var ot,K,rt,lt,yt,Et,Tt,It=(q=q||[]).map(si),Ot=Q.map(si),Xt=q.reduce(ti,{}),Wt=Q.reduce(ti,{}),se=It.slice(),ge=Object.create(null);for(ot=0,K=0;ot<It.length;ot++)Wt.hasOwnProperty(rt=It[ot])?K++:($.push({command:Yt.removeLayer,args:[rt]}),se.splice(se.indexOf(rt,K),1));for(ot=0,K=0;ot<Ot.length;ot++)se[se.length-1-ot]!==(rt=Ot[Ot.length-1-ot])&&(Xt.hasOwnProperty(rt)?($.push({command:Yt.removeLayer,args:[rt]}),se.splice(se.lastIndexOf(rt,se.length-K),1)):K++,$.push({command:Yt.addLayer,args:[Wt[rt],Et=se[se.length-ot]]}),se.splice(se.length-ot,0,rt),ge[rt]=!0);for(ot=0;ot<Ot.length;ot++)if(lt=Xt[rt=Ot[ot]],yt=Wt[rt],!ge[rt]&&!c.deepEqual(lt,yt))if(c.deepEqual(lt.source,yt.source)&&c.deepEqual(lt["source-layer"],yt["source-layer"])&&c.deepEqual(lt.type,yt.type)){for(Tt in Be(lt.layout,yt.layout,$,rt,null,Yt.setLayoutProperty),Be(lt.paint,yt.paint,$,rt,null,Yt.setPaintProperty),c.deepEqual(lt.filter,yt.filter)||$.push({command:Yt.setFilter,args:[rt,yt.filter]}),c.deepEqual(lt.minzoom,yt.minzoom)&&c.deepEqual(lt.maxzoom,yt.maxzoom)||$.push({command:Yt.setLayerZoomRange,args:[rt,yt.minzoom,yt.maxzoom]}),lt)lt.hasOwnProperty(Tt)&&"layout"!==Tt&&"paint"!==Tt&&"filter"!==Tt&&"metadata"!==Tt&&"minzoom"!==Tt&&"maxzoom"!==Tt&&(0===Tt.indexOf("paint.")?Be(lt[Tt],yt[Tt],$,rt,Tt.slice(6),Yt.setPaintProperty):c.deepEqual(lt[Tt],yt[Tt])||$.push({command:Yt.setLayerProperty,args:[rt,Tt,yt[Tt]]}));for(Tt in yt)yt.hasOwnProperty(Tt)&&!lt.hasOwnProperty(Tt)&&"layout"!==Tt&&"paint"!==Tt&&"filter"!==Tt&&"metadata"!==Tt&&"minzoom"!==Tt&&"maxzoom"!==Tt&&(0===Tt.indexOf("paint.")?Be(lt[Tt],yt[Tt],$,rt,Tt.slice(6),Yt.setPaintProperty):c.deepEqual(lt[Tt],yt[Tt])||$.push({command:Yt.setLayerProperty,args:[rt,Tt,yt[Tt]]}))}else $.push({command:Yt.removeLayer,args:[rt]}),Et=se[se.lastIndexOf(rt)+1],$.push({command:Yt.addLayer,args:[yt,Et]})}(Z,w.layers,I)}catch(q){console.warn("Unable to compute style diff:",q),I=[{command:Yt.setStyle,args:[w]}]}return I}(this.serialize(),o).filter(function(g){return!(g.command in ao)});if(0===d.length)return!1;var _=d.filter(function(g){return!(g.command in Tr)});if(_.length>0)throw new Error("Unimplemented: "+_.map(function(g){return g.command}).join(", ")+".");return d.forEach(function(g){"setTransition"!==g.command&&l[g.command].apply(l,g.args)}),this.stylesheet=o,!0},a.prototype.addImage=function(o,l){if(this.getImage(o))return this.fire(new c.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,l),this._afterImageUpdated(o)},a.prototype.updateImage=function(o,l){this.imageManager.updateImage(o,l)},a.prototype.getImage=function(o){return this.imageManager.getImage(o)},a.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new c.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},a.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(o,l,d){var _=this;if(void 0===d&&(d={}),this._checkLoaded(),void 0!==this.sourceCaches[o])throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(c.validateStyle.source,"sources."+o,l,null,d))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var g=this.sourceCaches[o]=new et(o,l,this.dispatcher);g.style=this,g.setEventedParent(this,function(){return{isSourceLoaded:_.loaded(),source:g.serialize(),sourceId:o}}),g.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(o){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===o)return this.fire(new c.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+l+'" is using it.')));var d=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],d.fire(new c.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.clearTiles(),d.onRemove&&d.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(o,l){this._checkLoaded(),this.sourceCaches[o].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},a.prototype.addLayer=function(o,l,d){void 0===d&&(d={}),this._checkLoaded();var _=o.id;if(this.getLayer(_))this.fire(new c.ErrorEvent(new Error('Layer with id "'+_+'" already exists on this map')));else{var g;if("custom"===o.type){if(Ho(this,c.validateCustomStyleLayer(o)))return;g=c.createStyleLayer(o)}else{if("object"==typeof o.source&&(this.addSource(_,o.source),o=c.clone$1(o),o=c.extend(o,{source:_})),this._validate(c.validateStyle.layer,"layers."+_,o,{arrayIndex:-1},d))return;g=c.createStyleLayer(o),this._validateLayer(g),g.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[g.id]=g.serialize()}var w=l?this._order.indexOf(l):this._order.length;if(l&&-1===w)this.fire(new c.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(w,0,_),this._layerOrderChanged=!0,this._layers[_]=g,this._removedLayers[_]&&g.source&&"custom"!==g.type){var I=this._removedLayers[_];delete this._removedLayers[_],I.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}},a.prototype.moveLayer=function(o,l){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==l){var d=this._order.indexOf(o);this._order.splice(d,1);var _=l?this._order.indexOf(l):this._order.length;l&&-1===_?this.fire(new c.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(_,0,o),this._layerOrderChanged=!0)}}else this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(o){this._checkLoaded();var l=this._layers[o];if(l){l.setEventedParent(null);var d=this._order.indexOf(o);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=l,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],l.onRemove&&l.onRemove(this.map)}else this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(o){return this._layers[o]},a.prototype.hasLayer=function(o){return o in this._layers},a.prototype.setLayerZoomRange=function(o,l,d){this._checkLoaded();var _=this.getLayer(o);_?_.minzoom===l&&_.maxzoom===d||(null!=l&&(_.minzoom=l),null!=d&&(_.maxzoom=d),this._updateLayer(_)):this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(o,l,d){void 0===d&&(d={}),this._checkLoaded();var _=this.getLayer(o);if(_){if(!c.deepEqual(_.filter,l))return null==l?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(c.validateStyle.filter,"layers."+_.id+".filter",l,null,d)||(_.filter=c.clone$1(l),this._updateLayer(_)))}else this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(o){return c.clone$1(this.getLayer(o).filter)},a.prototype.setLayoutProperty=function(o,l,d,_){void 0===_&&(_={}),this._checkLoaded();var g=this.getLayer(o);g?c.deepEqual(g.getLayoutProperty(l),d)||(g.setLayoutProperty(l,d,_),this._updateLayer(g)):this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(o,l){var d=this.getLayer(o);if(d)return d.getLayoutProperty(l);this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(o,l,d,_){void 0===_&&(_={}),this._checkLoaded();var g=this.getLayer(o);g?c.deepEqual(g.getPaintProperty(l),d)||(g.setPaintProperty(l,d,_)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(o,l){return this.getLayer(o).getPaintProperty(l)},a.prototype.setFeatureState=function(o,l){this._checkLoaded();var d=o.source,_=o.sourceLayer,g=this.sourceCaches[d];if(void 0!==g){var w=g.getSource().type;"geojson"===w&&_?this.fire(new c.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==w||_?(void 0===o.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),g.setFeatureState(_,o.id,l)):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(o,l){this._checkLoaded();var d=o.source,_=this.sourceCaches[d];if(void 0!==_){var g=_.getSource().type,w="vector"===g?o.sourceLayer:void 0;"vector"!==g||w?l&&"string"!=typeof o.id&&"number"!=typeof o.id?this.fire(new c.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(w,o.id,l):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(o){this._checkLoaded();var l=o.source,d=o.sourceLayer,_=this.sourceCaches[l];if(void 0!==_){if("vector"!==_.getSource().type||d)return void 0===o.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(d,o.id);this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return c.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return c.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:c.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return void 0!==o})},a.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&"raster"!==this.sourceCaches[o.source].getSource().type&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(o){for(var l=this,d=function(Xt){return"fill-extrusion"===l._layers[Xt].type},_={},g=[],w=this._order.length-1;w>=0;w--){var I=this._order[w];if(d(I)){_[I]=w;for(var M=0,N=o;M<N.length;M+=1){var Z=N[M][I];if(Z)for(var q=0,Q=Z;q<Q.length;q+=1)g.push(Q[q])}}}g.sort(function(Xt,Wt){return Wt.intersectionZ-Xt.intersectionZ});for(var $=[],ot=this._order.length-1;ot>=0;ot--){var K=this._order[ot];if(d(K))for(var rt=g.length-1;rt>=0;rt--){var lt=g[rt].feature;if(_[lt.layer.id]<ot)break;$.push(lt),g.pop()}else for(var yt=0,Et=o;yt<Et.length;yt+=1){var Tt=Et[yt][K];if(Tt)for(var It=0,Ot=Tt;It<Ot.length;It+=1)$.push(Ot[It].feature)}}return $},a.prototype.queryRenderedFeatures=function(o,l,d){l&&l.filter&&this._validate(c.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var _={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new c.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var g=0,w=l.layers;g<w.length;g+=1){var I=w[g],M=this._layers[I];if(!M)return this.fire(new c.ErrorEvent(new Error("The layer '"+I+"' does not exist in the map's style and cannot be queried for features."))),[];_[M.source]=!0}}var N=[];for(var Z in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!_[Z]||N.push(Hn(this.sourceCaches[Z],this._layers,this._serializedLayers,o,l,d));return this.placement&&N.push(function(q,Q,$,ot,K,rt,lt){for(var yt={},Et=rt.queryRenderedSymbols(ot),Tt=[],It=0,Ot=Object.keys(Et).map(Number);It<Ot.length;It+=1)Tt.push(lt[Ot[It]]);Tt.sort(Xr);for(var Xt=function(){var be=se[Wt],xi=be.featureIndex.lookupSymbolFeatures(Et[be.bucketInstanceId],Q,be.bucketIndex,be.sourceLayerIndex,K.filter,K.layers,K.availableImages,q);for(var he in xi){var Fe=yt[he]=yt[he]||[],$e=xi[he];$e.sort(function(Xe,Le){var Pe=be.featureSortOrder;if(Pe){var Pr=Pe.indexOf(Xe.featureIndex);return Pe.indexOf(Le.featureIndex)-Pr}return Le.featureIndex-Xe.featureIndex});for(var De=0,ke=$e;De<ke.length;De+=1)Fe.push(ke[De])}},Wt=0,se=Tt;Wt<se.length;Wt+=1)Xt();var ge=function(be){yt[be].forEach(function(xi){var he=xi.feature,Fe=$[q[be].source].getFeatureState(he.layer["source-layer"],he.id);he.source=he.layer.source,he.layer["source-layer"]&&(he.sourceLayer=he.layer["source-layer"]),he.state=Fe})};for(var we in yt)ge(we);return yt}(this._layers,this._serializedLayers,this.sourceCaches,o,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(N)},a.prototype.querySourceFeatures=function(o,l){l&&l.filter&&this._validate(c.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var d=this.sourceCaches[o];return d?function(_,g){for(var w=_.getRenderableIds().map(function(Q){return _.getTileByID(Q)}),I=[],M={},N=0;N<w.length;N++){var Z=w[N],q=Z.tileID.canonical.key;M[q]||(M[q]=!0,Z.querySourceFeatures(I,g))}return I}(d,l):[]},a.prototype.addSourceType=function(o,l,d){return a.getSourceType(o)?d(new Error('A source type called "'+o+'" already exists.')):(a.setSourceType(o,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:l.workerSourceURL},d):d(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(o,l){void 0===l&&(l={}),this._checkLoaded();var d=this.light.getLight(),_=!1;for(var g in o)if(!c.deepEqual(o[g],d[g])){_=!0;break}if(_){var w={now:c.browser.now(),transition:c.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,l),this.light.updateTransitions(w)}},a.prototype._validate=function(o,l,d,_,g){return void 0===g&&(g={}),(!g||!1!==g.validate)&&Ho(this,o.call(c.validateStyle,c.extend({key:l,style:this.serialize(),value:d,styleSpec:c.styleSpec},_)))},a.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),c.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},a.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},a.prototype._updateSources=function(o){for(var l in this.sourceCaches)this.sourceCaches[l].update(o)},a.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},a.prototype._updatePlacement=function(o,l,d,_,g){void 0===g&&(g=!1);for(var w=!1,I=!1,M={},N=0,Z=this._order;N<Z.length;N+=1){var q=this._layers[Z[N]];if("symbol"===q.type){if(!M[q.source]){var Q=this.sourceCaches[q.source];M[q.source]=Q.getRenderableIds(!0).map(function(lt){return Q.getTileByID(lt)}).sort(function(lt,yt){return yt.tileID.overscaledZ-lt.tileID.overscaledZ||(lt.tileID.isLessThan(yt.tileID)?-1:1)})}var $=this.crossTileSymbolIndex.addLayer(q,M[q.source],o.center.lng);w=w||$}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||0===d)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.browser.now(),o.zoom))&&(this.pauseablePlacement=new oo(o,this._order,g,l,d,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.browser.now()),I=!0),w&&this.pauseablePlacement.placement.setStale()),I||w)for(var ot=0,K=this._order;ot<K.length;ot+=1){var rt=this._layers[K[ot]];"symbol"===rt.type&&this.placement.updateLayerOpacities(rt,M[rt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},a.prototype.getImages=function(o,l,d){this.imageManager.getImages(l.icons,d),this._updateTilesForChangedImages();var _=this.sourceCaches[l.source];_&&_.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(o,l,d){this.glyphManager.getGlyphs(l.stacks,d)},a.prototype.getResource=function(o,l,d){return c.makeRequest(l,d)},a}(c.Evented);or.getSourceType=function(n){return Hr[n]},or.setSourceType=function(n,a){Hr[n]=a},or.registerForPluginStateChange=c.registerForPluginStateChange;var cn=c.createLayout([{name:"a_pos",type:"Int16",components:2}]),Po=Ii("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),La=Ii("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Xa=Ii("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ka=Ii("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Xo=Ii("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),za=Ii("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),ss=Ii("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),va=Ii("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ka=Ii("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),ls=Ii("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ns=Ii("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Yr=Ii("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ko=Ii("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ma=Ii("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Nn=Ii("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),sa=Ii("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),$r=Ii("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ao=Ii("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),la=Ii("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Br=Ii("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Rr=Ii("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Jo=Ii("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),yo=Ii("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),so=Ii("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Da=Ii("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),xa=Ii("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Ii(n,a){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),d=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=_?_.concat(d):d,w={};return{fragmentSource:n=n.replace(o,function(I,M,N,Z,q){return w[q]=!0,"define"===M?"\n#ifndef HAS_UNIFORM_u_"+q+"\nvarying "+N+" "+Z+" "+q+";\n#else\nuniform "+N+" "+Z+" u_"+q+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+q+"\n    "+N+" "+Z+" "+q+" = u_"+q+";\n#endif\n"}),vertexSource:a=a.replace(o,function(I,M,N,Z,q){var Q="float"===Z?"vec2":"vec4",$=q.match(/color/)?"color":Q;return w[q]?"define"===M?"\n#ifndef HAS_UNIFORM_u_"+q+"\nuniform lowp float u_"+q+"_t;\nattribute "+N+" "+Q+" a_"+q+";\nvarying "+N+" "+Z+" "+q+";\n#else\nuniform "+N+" "+Z+" u_"+q+";\n#endif\n":"vec4"===$?"\n#ifndef HAS_UNIFORM_u_"+q+"\n    "+q+" = a_"+q+";\n#else\n    "+N+" "+Z+" "+q+" = u_"+q+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+q+"\n    "+q+" = unpack_mix_"+$+"(a_"+q+", u_"+q+"_t);\n#else\n    "+N+" "+Z+" "+q+" = u_"+q+";\n#endif\n":"define"===M?"\n#ifndef HAS_UNIFORM_u_"+q+"\nuniform lowp float u_"+q+"_t;\nattribute "+N+" "+Q+" a_"+q+";\n#else\nuniform "+N+" "+Z+" u_"+q+";\n#endif\n":"vec4"===$?"\n#ifndef HAS_UNIFORM_u_"+q+"\n    "+N+" "+Z+" "+q+" = a_"+q+";\n#else\n    "+N+" "+Z+" "+q+" = u_"+q+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+q+"\n    "+N+" "+Z+" "+q+" = unpack_mix_"+$+"(a_"+q+", u_"+q+"_t);\n#else\n    "+N+" "+Z+" "+q+" = u_"+q+";\n#endif\n"}),staticAttributes:l,staticUniforms:g}}var js=Object.freeze({__proto__:null,prelude:Po,background:La,backgroundPattern:Xa,circle:Ka,clippingMask:Xo,heatmap:za,heatmapTexture:ss,collisionBox:va,collisionCircle:ka,debug:ls,fill:Ns,fillOutline:Yr,fillOutlinePattern:Ko,fillPattern:Ma,fillExtrusion:Nn,fillExtrusionPattern:sa,hillshadePrepare:$r,hillshade:Ao,line:la,lineGradient:Br,linePattern:Rr,lineSDF:Jo,raster:yo,symbolIcon:so,symbolSDF:Da,symbolTextAndIcon:xa}),go=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function lo(n){for(var a=[],o=0;o<n.length;o++)if(null!==n[o]){var l=n[o].split(" ");a.push(l.pop())}return a}go.prototype.bind=function(n,a,o,l,d,_,g,w){this.context=n;for(var I=this.boundPaintVertexBuffers.length!==l.length,M=0;!I&&M<l.length;M++)this.boundPaintVertexBuffers[M]!==l[M]&&(I=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===o&&!I&&this.boundIndexBuffer===d&&this.boundVertexOffset===_&&this.boundDynamicVertexBuffer===g&&this.boundDynamicVertexBuffer2===w?(n.bindVertexArrayOES.set(this.vao),g&&g.bind(),d&&d.dynamicDraw&&d.bind(),w&&w.bind()):this.freshBind(a,o,l,d,_,g,w)},go.prototype.freshBind=function(n,a,o,l,d,_,g){var w,I=n.numAttributes,M=this.context,N=M.gl;if(M.extVertexArrayObject)this.vao&&this.destroy(),this.vao=M.extVertexArrayObject.createVertexArrayOES(),M.bindVertexArrayOES.set(this.vao),w=0,this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=l,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=g;else{w=M.currentNumAttributes||0;for(var Z=I;Z<w;Z++)N.disableVertexAttribArray(Z)}a.enableAttributes(N,n);for(var q=0,Q=o;q<Q.length;q+=1)Q[q].enableAttributes(N,n);_&&_.enableAttributes(N,n),g&&g.enableAttributes(N,n),a.bind(),a.setVertexAttribPointers(N,n,d);for(var $=0,ot=o;$<ot.length;$+=1){var K=ot[$];K.bind(),K.setVertexAttribPointers(N,n,d)}_&&(_.bind(),_.setVertexAttribPointers(N,n,d)),l&&l.bind(),g&&(g.bind(),g.setVertexAttribPointers(N,n,d)),M.currentNumAttributes=I},go.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Yo=function(n,a,o,l,d,_){var g=n.gl;this.program=g.createProgram();for(var w=lo(o.staticAttributes),I=l?l.getBinderAttributes():[],M=w.concat(I),N=o.staticUniforms?lo(o.staticUniforms):[],Z=l?l.getBinderUniforms():[],q=[],Q=0,$=N.concat(Z);Q<$.length;Q+=1){var ot=$[Q];q.indexOf(ot)<0&&q.push(ot)}var K=l?l.defines():[];_&&K.push("#define OVERDRAW_INSPECTOR;");var rt=K.concat(Po.fragmentSource,o.fragmentSource).join("\n"),lt=K.concat(Po.vertexSource,o.vertexSource).join("\n"),yt=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(yt,rt),g.compileShader(yt),g.attachShader(this.program,yt);var Et=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(Et,lt),g.compileShader(Et),g.attachShader(this.program,Et),this.attributes={};var Tt={};this.numAttributes=M.length;for(var It=0;It<this.numAttributes;It++)M[It]&&(g.bindAttribLocation(this.program,It,M[It]),this.attributes[M[It]]=It);g.linkProgram(this.program),g.deleteShader(Et),g.deleteShader(yt);for(var Ot=0;Ot<q.length;Ot++){var Xt=q[Ot];if(Xt&&!Tt[Xt]){var Wt=g.getUniformLocation(this.program,Xt);Wt&&(Tt[Xt]=Wt)}}this.fixedUniforms=d(n,Tt),this.binderUniforms=l?l.getUniforms(n,Tt):[]}}};function Ja(n,a,o){var l=1/Gi(o,1,a.transform.tileZoom),d=Math.pow(2,o.tileID.overscaledZ),_=o.tileSize*Math.pow(2,a.transform.tileZoom)/d,g=_*(o.tileID.canonical.x+o.tileID.wrap*d),w=_*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[l,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[g>>16,w>>16],u_pixel_coord_lower:[65535&g,65535&w]}}Yo.prototype.draw=function(n,a,o,l,d,_,g,w,I,M,N,Z,q,Q,$,ot){var K,rt=n.gl;if(!this.failedToCreate){for(var lt in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(l),n.setColorMode(d),n.setCullFace(_),this.fixedUniforms)this.fixedUniforms[lt].set(g[lt]);Q&&Q.setUniforms(n,this.binderUniforms,Z,{zoom:q});for(var yt=(K={},K[rt.LINES]=2,K[rt.TRIANGLES]=3,K[rt.LINE_STRIP]=1,K)[a],Et=0,Tt=N.get();Et<Tt.length;Et+=1){var It=Tt[Et],Ot=It.vaos||(It.vaos={});(Ot[w]||(Ot[w]=new go)).bind(n,this,I,Q?Q.getPaintVertexBuffers():[],M,It.vertexOffset,$,ot),rt.drawElements(a,It.primitiveLength*yt,rt.UNSIGNED_SHORT,It.primitiveOffset*yt*2)}}};var Ya=function(n,a,o,l){var d=a.style.light,_=d.properties.get("position"),g=[_.x,_.y,_.z],w=c.create$1();"viewport"===d.properties.get("anchor")&&c.fromRotation(w,-a.transform.angle),c.transformMat3(g,g,w);var I=d.properties.get("color");return{u_matrix:n,u_lightpos:g,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+o,u_opacity:l}},Io=function(n,a,o,l,d,_,g){return c.extend(Ya(n,a,o,l),Ja(_,a,g),{u_height_factor:-Math.pow(2,d.overscaledZ)/g.tileSize/8})},uo=function(n){return{u_matrix:n}},ba=function(n,a,o,l){return c.extend(uo(n),Ja(o,a,l))},r=function(n,a){return{u_matrix:n,u_world:a}},u=function(n,a,o,l,d){return c.extend(ba(n,a,o,l),{u_world:d})},m=function(n,a,o,l){var d,_,g=n.transform;if("map"===l.paint.get("circle-pitch-alignment")){var w=Gi(o,1,g.zoom);d=!0,_=[w,w]}else d=!1,_=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+("map"===l.paint.get("circle-pitch-scale")),u_matrix:n.translatePosMatrix(a.posMatrix,o,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:c.browser.devicePixelRatio,u_extrude_scale:_}},b=function(n,a,o){var l=Gi(o,1,a.zoom),d=Math.pow(2,a.zoom-o.tileID.overscaledZ),_=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:l,u_extrude_scale:[a.pixelsToGLUnits[0]/(l*d),a.pixelsToGLUnits[1]/(l*d)],u_overscale_factor:_}},A=function(n,a,o){return{u_matrix:n,u_inv_matrix:a,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},V=function(n,a,o){return void 0===o&&(o=1),{u_matrix:n,u_color:a,u_overlay:0,u_overlay_scale:o}},ct=function(n){return{u_matrix:n}},ut=function(n,a,o,l){return{u_matrix:n,u_extrude_scale:Gi(a,1,o),u_intensity:l}},Dt=function(n,a,o){var l=n.transform;return{u_matrix:_n(n,a,o),u_ratio:1/Gi(a,1,l.zoom),u_device_pixel_ratio:c.browser.devicePixelRatio,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]]}},jt=function(n,a,o,l){return c.extend(Dt(n,a,o),{u_image:0,u_image_height:l})},ye=function(n,a,o,l){var d=n.transform,_=Ui(a,d);return{u_matrix:_n(n,a,o),u_texsize:a.imageAtlasTexture.size,u_ratio:1/Gi(a,1,d.zoom),u_device_pixel_ratio:c.browser.devicePixelRatio,u_image:0,u_scale:[_,l.fromScale,l.toScale],u_fade:l.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},li=function(n,a,o,l,d){var _=n.lineAtlas,g=Ui(a,n.transform),w="round"===o.layout.get("line-cap"),I=_.getDash(l.from,w),M=_.getDash(l.to,w),N=I.width*d.fromScale,Z=M.width*d.toScale;return c.extend(Dt(n,a,o),{u_patternscale_a:[g/N,-I.height/2],u_patternscale_b:[g/Z,-M.height/2],u_sdfgamma:_.width/(256*Math.min(N,Z)*c.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:I.y,u_tex_y_b:M.y,u_mix:d.t})};function Ui(n,a){return 1/Gi(n,1,a.tileZoom)}function _n(n,a,o){return n.translatePosMatrix(a.tileID.posMatrix,a,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Bo=function(n,a,o,l,d){return{u_matrix:n,u_tl_parent:a,u_scale_parent:o,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(g=d.paint.get("raster-saturation"),g>0?1-1/(1.001-g):-g),u_contrast_factor:(_=d.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Sr(d.paint.get("raster-hue-rotate"))};var _,g};function Sr(n){n*=Math.PI/180;var a=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*a-o+1)/3,(Math.sqrt(3)*a-o+1)/3]}var Kn,wa=function(n,a,o,l,d,_,g,w,I,M){var N=d.transform;return{u_is_size_zoom_constant:+("constant"===n||"source"===n),u_is_size_feature_constant:+("constant"===n||"camera"===n),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:N.cameraToCenterDistance,u_pitch:N.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:N.width/N.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:g,u_coord_matrix:w,u_is_text:+I,u_pitch_with_map:+l,u_texsize:M,u_texture:0}},Ro=function(n,a,o,l,d,_,g,w,I,M,N){var Z=d.transform;return c.extend(wa(n,a,o,l,d,_,g,w,I,M),{u_gamma_scale:l?Math.cos(Z._pitch)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:c.browser.devicePixelRatio,u_is_halo:+N})},$a=function(n,a,o,l,d,_,g,w,I,M){return c.extend(Ro(n,a,o,l,d,_,g,w,!0,I,!0),{u_texsize_icon:M,u_texture_icon:1})},on=function(n,a,o){return{u_matrix:n,u_opacity:a,u_color:o}},$o=function(n,a,o,l,d,_){return c.extend((w=_,M=d,N=(I=o).imageManager.getPattern((g=l).from.toString()),Z=I.imageManager.getPattern(g.to.toString()),Q=(q=I.imageManager.getPixelSize()).width,$=q.height,ot=Math.pow(2,M.tileID.overscaledZ),rt=(K=M.tileSize*Math.pow(2,I.transform.tileZoom)/ot)*(M.tileID.canonical.x+M.tileID.wrap*ot),lt=K*M.tileID.canonical.y,{u_image:0,u_pattern_tl_a:N.tl,u_pattern_br_a:N.br,u_pattern_tl_b:Z.tl,u_pattern_br_b:Z.br,u_texsize:[Q,$],u_mix:w.t,u_pattern_size_a:N.displaySize,u_pattern_size_b:Z.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/Gi(M,1,I.transform.tileZoom),u_pixel_coord_upper:[rt>>16,lt>>16],u_pixel_coord_lower:[65535&rt,65535&lt]}),{u_matrix:n,u_opacity:a});var g,w,I,M,N,Z,q,Q,$,ot,K,rt,lt},Ta={fillExtrusion:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_lightpos:new c.Uniform3f(n,a.u_lightpos),u_lightintensity:new c.Uniform1f(n,a.u_lightintensity),u_lightcolor:new c.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new c.Uniform1f(n,a.u_vertical_gradient),u_opacity:new c.Uniform1f(n,a.u_opacity)}},fillExtrusionPattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_lightpos:new c.Uniform3f(n,a.u_lightpos),u_lightintensity:new c.Uniform1f(n,a.u_lightintensity),u_lightcolor:new c.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new c.Uniform1f(n,a.u_vertical_gradient),u_height_factor:new c.Uniform1f(n,a.u_height_factor),u_image:new c.Uniform1i(n,a.u_image),u_texsize:new c.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new c.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new c.Uniform3f(n,a.u_scale),u_fade:new c.Uniform1f(n,a.u_fade),u_opacity:new c.Uniform1f(n,a.u_opacity)}},fill:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix)}},fillPattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_image:new c.Uniform1i(n,a.u_image),u_texsize:new c.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new c.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new c.Uniform3f(n,a.u_scale),u_fade:new c.Uniform1f(n,a.u_fade)}},fillOutline:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_world:new c.Uniform2f(n,a.u_world)}},fillOutlinePattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_world:new c.Uniform2f(n,a.u_world),u_image:new c.Uniform1i(n,a.u_image),u_texsize:new c.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new c.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new c.Uniform3f(n,a.u_scale),u_fade:new c.Uniform1f(n,a.u_fade)}},circle:function(n,a){return{u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_scale_with_map:new c.Uniform1i(n,a.u_scale_with_map),u_pitch_with_map:new c.Uniform1i(n,a.u_pitch_with_map),u_extrude_scale:new c.Uniform2f(n,a.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(n,a.u_matrix)}},collisionBox:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_pixels_to_tile_units:new c.Uniform1f(n,a.u_pixels_to_tile_units),u_extrude_scale:new c.Uniform2f(n,a.u_extrude_scale),u_overscale_factor:new c.Uniform1f(n,a.u_overscale_factor)}},collisionCircle:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_inv_matrix:new c.UniformMatrix4f(n,a.u_inv_matrix),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_viewport_size:new c.Uniform2f(n,a.u_viewport_size)}},debug:function(n,a){return{u_color:new c.UniformColor(n,a.u_color),u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_overlay:new c.Uniform1i(n,a.u_overlay),u_overlay_scale:new c.Uniform1f(n,a.u_overlay_scale)}},clippingMask:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix)}},heatmap:function(n,a){return{u_extrude_scale:new c.Uniform1f(n,a.u_extrude_scale),u_intensity:new c.Uniform1f(n,a.u_intensity),u_matrix:new c.UniformMatrix4f(n,a.u_matrix)}},heatmapTexture:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_world:new c.Uniform2f(n,a.u_world),u_image:new c.Uniform1i(n,a.u_image),u_color_ramp:new c.Uniform1i(n,a.u_color_ramp),u_opacity:new c.Uniform1f(n,a.u_opacity)}},hillshade:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_image:new c.Uniform1i(n,a.u_image),u_latrange:new c.Uniform2f(n,a.u_latrange),u_light:new c.Uniform2f(n,a.u_light),u_shadow:new c.UniformColor(n,a.u_shadow),u_highlight:new c.UniformColor(n,a.u_highlight),u_accent:new c.UniformColor(n,a.u_accent)}},hillshadePrepare:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_image:new c.Uniform1i(n,a.u_image),u_dimension:new c.Uniform2f(n,a.u_dimension),u_zoom:new c.Uniform1f(n,a.u_zoom),u_unpack:new c.Uniform4f(n,a.u_unpack)}},line:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_ratio:new c.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(n,a.u_units_to_pixels)}},lineGradient:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_ratio:new c.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(n,a.u_units_to_pixels),u_image:new c.Uniform1i(n,a.u_image),u_image_height:new c.Uniform1f(n,a.u_image_height)}},linePattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_texsize:new c.Uniform2f(n,a.u_texsize),u_ratio:new c.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_image:new c.Uniform1i(n,a.u_image),u_units_to_pixels:new c.Uniform2f(n,a.u_units_to_pixels),u_scale:new c.Uniform3f(n,a.u_scale),u_fade:new c.Uniform1f(n,a.u_fade)}},lineSDF:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_ratio:new c.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(n,a.u_units_to_pixels),u_patternscale_a:new c.Uniform2f(n,a.u_patternscale_a),u_patternscale_b:new c.Uniform2f(n,a.u_patternscale_b),u_sdfgamma:new c.Uniform1f(n,a.u_sdfgamma),u_image:new c.Uniform1i(n,a.u_image),u_tex_y_a:new c.Uniform1f(n,a.u_tex_y_a),u_tex_y_b:new c.Uniform1f(n,a.u_tex_y_b),u_mix:new c.Uniform1f(n,a.u_mix)}},raster:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_tl_parent:new c.Uniform2f(n,a.u_tl_parent),u_scale_parent:new c.Uniform1f(n,a.u_scale_parent),u_buffer_scale:new c.Uniform1f(n,a.u_buffer_scale),u_fade_t:new c.Uniform1f(n,a.u_fade_t),u_opacity:new c.Uniform1f(n,a.u_opacity),u_image0:new c.Uniform1i(n,a.u_image0),u_image1:new c.Uniform1i(n,a.u_image1),u_brightness_low:new c.Uniform1f(n,a.u_brightness_low),u_brightness_high:new c.Uniform1f(n,a.u_brightness_high),u_saturation_factor:new c.Uniform1f(n,a.u_saturation_factor),u_contrast_factor:new c.Uniform1f(n,a.u_contrast_factor),u_spin_weights:new c.Uniform3f(n,a.u_spin_weights)}},symbolIcon:function(n,a){return{u_is_size_zoom_constant:new c.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new c.Uniform1f(n,a.u_size_t),u_size:new c.Uniform1f(n,a.u_size),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new c.Uniform1f(n,a.u_pitch),u_rotate_symbol:new c.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new c.Uniform1f(n,a.u_fade_change),u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new c.Uniform1i(n,a.u_is_text),u_pitch_with_map:new c.Uniform1i(n,a.u_pitch_with_map),u_texsize:new c.Uniform2f(n,a.u_texsize),u_texture:new c.Uniform1i(n,a.u_texture)}},symbolSDF:function(n,a){return{u_is_size_zoom_constant:new c.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new c.Uniform1f(n,a.u_size_t),u_size:new c.Uniform1f(n,a.u_size),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new c.Uniform1f(n,a.u_pitch),u_rotate_symbol:new c.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new c.Uniform1f(n,a.u_fade_change),u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new c.Uniform1i(n,a.u_is_text),u_pitch_with_map:new c.Uniform1i(n,a.u_pitch_with_map),u_texsize:new c.Uniform2f(n,a.u_texsize),u_texture:new c.Uniform1i(n,a.u_texture),u_gamma_scale:new c.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(n,a.u_is_halo)}},symbolTextAndIcon:function(n,a){return{u_is_size_zoom_constant:new c.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new c.Uniform1f(n,a.u_size_t),u_size:new c.Uniform1f(n,a.u_size),u_camera_to_center_distance:new c.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new c.Uniform1f(n,a.u_pitch),u_rotate_symbol:new c.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new c.Uniform1f(n,a.u_fade_change),u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new c.Uniform1i(n,a.u_is_text),u_pitch_with_map:new c.Uniform1i(n,a.u_pitch_with_map),u_texsize:new c.Uniform2f(n,a.u_texsize),u_texsize_icon:new c.Uniform2f(n,a.u_texsize_icon),u_texture:new c.Uniform1i(n,a.u_texture),u_texture_icon:new c.Uniform1i(n,a.u_texture_icon),u_gamma_scale:new c.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(n,a.u_is_halo)}},background:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_opacity:new c.Uniform1f(n,a.u_opacity),u_color:new c.UniformColor(n,a.u_color)}},backgroundPattern:function(n,a){return{u_matrix:new c.UniformMatrix4f(n,a.u_matrix),u_opacity:new c.Uniform1f(n,a.u_opacity),u_image:new c.Uniform1i(n,a.u_image),u_pattern_tl_a:new c.Uniform2f(n,a.u_pattern_tl_a),u_pattern_br_a:new c.Uniform2f(n,a.u_pattern_br_a),u_pattern_tl_b:new c.Uniform2f(n,a.u_pattern_tl_b),u_pattern_br_b:new c.Uniform2f(n,a.u_pattern_br_b),u_texsize:new c.Uniform2f(n,a.u_texsize),u_mix:new c.Uniform1f(n,a.u_mix),u_pattern_size_a:new c.Uniform2f(n,a.u_pattern_size_a),u_pattern_size_b:new c.Uniform2f(n,a.u_pattern_size_b),u_scale_a:new c.Uniform1f(n,a.u_scale_a),u_scale_b:new c.Uniform1f(n,a.u_scale_b),u_pixel_coord_upper:new c.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(n,a.u_pixel_coord_lower),u_tile_units_to_pixels:new c.Uniform1f(n,a.u_tile_units_to_pixels)}}};function us(n,a,o,l,d,_,g){for(var w=n.context,I=w.gl,M=n.useProgram("collisionBox"),N=[],Z=0,q=0,Q=0;Q<l.length;Q++){var $=l[Q],ot=a.getTile($),K=ot.getBucket(o);if(K){var rt=$.posMatrix;0===d[0]&&0===d[1]||(rt=n.translatePosMatrix($.posMatrix,ot,d,_));var lt=g?K.textCollisionBox:K.iconCollisionBox,yt=K.collisionCircleArray;if(yt.length>0){var Et=c.create(),Tt=rt;c.mul(Et,K.placementInvProjMatrix,n.transform.glCoordMatrix),c.mul(Et,Et,K.placementViewportMatrix),N.push({circleArray:yt,circleOffset:q,transform:Tt,invTransform:Et}),q=Z+=yt.length/4}lt&&M.draw(w,I.LINES,G.disabled,X.disabled,n.colorModeForRenderPass(),st.disabled,b(rt,n.transform,ot),o.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,null,n.transform.zoom,null,null,lt.collisionVertexBuffer)}}if(g&&N.length){var It=n.useProgram("collisionCircle"),Ot=new c.StructArrayLayout2f1f2i16;Ot.resize(4*Z),Ot._trim();for(var Xt=0,Wt=0,se=N;Wt<se.length;Wt+=1)for(var ge=se[Wt],we=0;we<ge.circleArray.length/4;we++){var be=4*we,xi=ge.circleArray[be+0],he=ge.circleArray[be+1],Fe=ge.circleArray[be+2],$e=ge.circleArray[be+3];Ot.emplace(Xt++,xi,he,Fe,$e,0),Ot.emplace(Xt++,xi,he,Fe,$e,1),Ot.emplace(Xt++,xi,he,Fe,$e,2),Ot.emplace(Xt++,xi,he,Fe,$e,3)}(!Kn||Kn.length<2*Z)&&(Kn=function(Zn){var po=2*Zn,Nr=new c.StructArrayLayout3ui6;Nr.resize(po),Nr._trim();for(var zn=0;zn<po;zn++){var Yn=6*zn;Nr.uint16[Yn+0]=4*zn+0,Nr.uint16[Yn+1]=4*zn+1,Nr.uint16[Yn+2]=4*zn+2,Nr.uint16[Yn+3]=4*zn+2,Nr.uint16[Yn+4]=4*zn+3,Nr.uint16[Yn+5]=4*zn+0}return Nr}(Z));for(var De=w.createIndexBuffer(Kn,!0),ke=w.createVertexBuffer(Ot,c.collisionCircleLayout.members,!0),Xe=0,Le=N;Xe<Le.length;Xe+=1){var Pe=Le[Xe],Pr=A(Pe.transform,Pe.invTransform,n.transform);It.draw(w,I.TRIANGLES,G.disabled,X.disabled,n.colorModeForRenderPass(),st.disabled,Pr,o.id,ke,De,c.SegmentVector.simpleSegment(0,2*Pe.circleOffset,Pe.circleArray.length,Pe.circleArray.length/2),null,n.transform.zoom,null,null,null)}ke.destroy(),De.destroy()}}var Fo=c.identity(new Float32Array(16));function _l(n,a,o,l,d,_){var g=c.getAnchorAlignment(n),w=-(g.horizontalAlign-.5)*a,I=-(g.verticalAlign-.5)*o,M=c.evaluateVariableOffset(n,l);return new c.Point((w/d+M[0])*_,(I/d+M[1])*_)}function Qs(n,a,o,l,d,_,g,w,I,M,N){var Z=n.text.placedSymbolArray,q=n.text.dynamicLayoutVertexArray,Q=n.icon.dynamicLayoutVertexArray,$={};q.clear();for(var ot=0;ot<Z.length;ot++){var K=Z.get(ot),rt=K.hidden||!K.crossTileID||n.allowVerticalPlacement&&!K.placedOrientation?null:l[K.crossTileID];if(rt){var lt=new c.Point(K.anchorX,K.anchorY),yt=Ye(lt,o?w:g),Et=fe(_.cameraToCenterDistance,yt.signedDistanceFromCamera),Tt=d.evaluateSizeForFeature(n.textSizeData,M,K)*Et/c.ONE_EM;o&&(Tt*=n.tilePixelRatio/I);for(var It=_l(rt.anchor,rt.width,rt.height,rt.textOffset,rt.textBoxScale,Tt),Ot=o?Ye(lt.add(It),g).point:yt.point.add(a?It.rotate(-_.angle):It),Xt=n.allowVerticalPlacement&&K.placedOrientation===c.WritingMode.vertical?Math.PI/2:0,Wt=0;Wt<K.numGlyphs;Wt++)c.addDynamicAttributes(q,Ot,Xt);N&&K.associatedIconIndex>=0&&($[K.associatedIconIndex]={shiftedAnchor:Ot,angle:Xt})}else In(K.numGlyphs,q)}if(N){Q.clear();for(var se=n.icon.placedSymbolArray,ge=0;ge<se.length;ge++){var we=se.get(ge);if(we.hidden)In(we.numGlyphs,Q);else{var be=$[ge];if(be)for(var xi=0;xi<we.numGlyphs;xi++)c.addDynamicAttributes(Q,be.shiftedAnchor,be.angle);else In(we.numGlyphs,Q)}}n.icon.dynamicLayoutVertexBuffer.updateData(Q)}n.text.dynamicLayoutVertexBuffer.updateData(q)}function As(n,a,o){return o.iconsInText&&a?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function Oa(n,a,o,l,d,_,g,w,I,M,N,Z){for(var q=n.context,Q=q.gl,$=n.transform,ot="map"===w,K="map"===I,rt=ot&&"point"!==o.layout.get("symbol-placement"),lt=ot&&!K&&!rt,yt=void 0!==o.layout.get("symbol-sort-key").constantOr(1),Et=!1,Tt=n.depthModeForSublayer(0,G.ReadOnly),It=o.layout.get("text-variable-anchor"),Ot=[],Xt=0,Wt=l;Xt<Wt.length;Xt+=1){var se=Wt[Xt],ge=a.getTile(se),we=ge.getBucket(o);if(we){var be=d?we.text:we.icon;if(be&&be.segments.get().length){var xi=be.programConfigurations.get(o.id),he=d||we.sdfIcons,Fe=d?we.textSizeData:we.iconSizeData,$e=K||0!==$.pitch,De=n.useProgram(As(he,d,we),xi),ke=c.evaluateSizeForZoom(Fe,$.zoom),Xe=void 0,Le=[0,0],Pe=void 0,Pr=void 0,Zn=null,po=void 0;if(d)Pe=ge.glyphAtlasTexture,Pr=Q.LINEAR,Xe=ge.glyphAtlasTexture.size,we.iconsInText&&(Le=ge.imageAtlasTexture.size,Zn=ge.imageAtlasTexture,po=$e||n.options.rotating||n.options.zooming||"composite"===Fe.kind||"camera"===Fe.kind?Q.LINEAR:Q.NEAREST);else{var Nr=1!==o.layout.get("icon-size").constantOr(0)||we.iconsNeedLinear;Pe=ge.imageAtlasTexture,Pr=he||n.options.rotating||n.options.zooming||Nr||$e?Q.LINEAR:Q.NEAREST,Xe=ge.imageAtlasTexture.size}var zn=Gi(ge,1,n.transform.zoom),Yn=rn(se.posMatrix,K,ot,n.transform,zn),Vo=vi(se.posMatrix,K,ot,n.transform,zn),vo=It&&we.hasTextData(),ys="none"!==o.layout.get("icon-text-fit")&&vo&&we.hasIconData();rt&&ya(we,se.posMatrix,n,d,Yn,Vo,K,M);var Lo=n.translatePosMatrix(se.posMatrix,ge,_,g),Sa=rt||d&&It||ys?Fo:Yn,pa=n.translatePosMatrix(Vo,ge,_,g,!0),ol=he&&0!==o.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1),Ws={program:De,buffers:be,uniformValues:he?we.iconsInText?$a(Fe.kind,ke,lt,K,n,Lo,Sa,pa,Xe,Le):Ro(Fe.kind,ke,lt,K,n,Lo,Sa,pa,d,Xe,!0):wa(Fe.kind,ke,lt,K,n,Lo,Sa,pa,d,Xe),atlasTexture:Pe,atlasTextureIcon:Zn,atlasInterpolation:Pr,atlasInterpolationIcon:po,isSDF:he,hasHalo:ol};if(yt&&we.canOverlap){Et=!0;for(var gs=0,Hs=be.segments.get();gs<Hs.length;gs+=1){var al=Hs[gs];Ot.push({segments:new c.SegmentVector([al]),sortKey:al.sortKey,state:Ws})}}else Ot.push({segments:be.segments,sortKey:0,state:Ws})}}}Et&&Ot.sort(function(vs,ks){return vs.sortKey-ks.sortKey});for(var Za=0,sl=Ot;Za<sl.length;Za+=1){var Va=sl[Za],Ar=Va.state;if(q.activeTexture.set(Q.TEXTURE0),Ar.atlasTexture.bind(Ar.atlasInterpolation,Q.CLAMP_TO_EDGE),Ar.atlasTextureIcon&&(q.activeTexture.set(Q.TEXTURE1),Ar.atlasTextureIcon&&Ar.atlasTextureIcon.bind(Ar.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),Ar.isSDF){var is=Ar.uniformValues;Ar.hasHalo&&(is.u_is_halo=1,Qa(Ar.buffers,Va.segments,o,n,Ar.program,Tt,N,Z,is)),is.u_is_halo=0}Qa(Ar.buffers,Va.segments,o,n,Ar.program,Tt,N,Z,Ar.uniformValues)}}function Qa(n,a,o,l,d,_,g,w,I){var M=l.context;d.draw(M,M.gl.TRIANGLES,_,g,w,st.disabled,I,o.id,n.layoutVertexBuffer,n.indexBuffer,a,o.paint,l.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Is(n,a,o,l,d,_,g){var w,I,M,N,Z,q=n.context.gl,Q=o.paint.get("fill-pattern"),$=Q&&Q.constantOr(1),ot=o.getCrossfadeParameters();g?(I=$&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=q.LINES):(I=$?"fillPattern":"fill",w=q.TRIANGLES);for(var K=0,rt=l;K<rt.length;K+=1){var lt=rt[K],yt=a.getTile(lt);if(!$||yt.patternsLoaded()){var Et=yt.getBucket(o);if(Et){var Tt=Et.programConfigurations.get(o.id),It=n.useProgram(I,Tt);$&&(n.context.activeTexture.set(q.TEXTURE0),yt.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),Tt.updatePaintBuffers(ot));var Ot=Q.constantOr(null);if(Ot&&yt.imageAtlas){var Xt=yt.imageAtlas,Wt=Xt.patternPositions[Ot.to.toString()],se=Xt.patternPositions[Ot.from.toString()];Wt&&se&&Tt.setConstantPatternPositions(Wt,se)}var ge=n.translatePosMatrix(lt.posMatrix,yt,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(g){N=Et.indexBuffer2,Z=Et.segments2;var we=[q.drawingBufferWidth,q.drawingBufferHeight];M="fillOutlinePattern"===I&&$?u(ge,n,ot,yt,we):r(ge,we)}else N=Et.indexBuffer,Z=Et.segments,M=$?ba(ge,n,ot,yt):uo(ge);It.draw(n.context,w,d,n.stencilModeForClipping(lt),_,st.disabled,M,o.id,Et.layoutVertexBuffer,N,Z,o.paint,n.transform.zoom,Tt)}}}}function Cs(n,a,o,l,d,_,g){for(var w=n.context,I=w.gl,M=o.paint.get("fill-extrusion-pattern"),N=M.constantOr(1),Z=o.getCrossfadeParameters(),q=o.paint.get("fill-extrusion-opacity"),Q=0,$=l;Q<$.length;Q+=1){var ot=$[Q],K=a.getTile(ot),rt=K.getBucket(o);if(rt){var lt=rt.programConfigurations.get(o.id),yt=n.useProgram(N?"fillExtrusionPattern":"fillExtrusion",lt);N&&(n.context.activeTexture.set(I.TEXTURE0),K.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),lt.updatePaintBuffers(Z));var Et=M.constantOr(null);if(Et&&K.imageAtlas){var Tt=K.imageAtlas,It=Tt.patternPositions[Et.to.toString()],Ot=Tt.patternPositions[Et.from.toString()];It&&Ot&&lt.setConstantPatternPositions(It,Ot)}var Xt=n.translatePosMatrix(ot.posMatrix,K,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Wt=o.paint.get("fill-extrusion-vertical-gradient"),se=N?Io(Xt,n,Wt,q,ot,Z,K):Ya(Xt,n,Wt,q);yt.draw(w,w.gl.TRIANGLES,d,_,g,st.backCCW,se,o.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,o.paint,n.transform.zoom,lt)}}}function ua(n,a,o,l,d,_){var g=n.context,w=g.gl,I=a.fbo;if(I){var M=n.useProgram("hillshade");g.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,I.colorAttachment.get());var N=function(Z,q,Q){var $=Q.paint.get("hillshade-shadow-color"),ot=Q.paint.get("hillshade-highlight-color"),K=Q.paint.get("hillshade-accent-color"),rt=Q.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Q.paint.get("hillshade-illumination-anchor")&&(rt-=Z.transform.angle);var lt,yt,Et,Tt=!Z.options.moving;return{u_matrix:Z.transform.calculatePosMatrix(q.tileID.toUnwrapped(),Tt),u_image:0,u_latrange:(lt=q.tileID,yt=Math.pow(2,lt.canonical.z),Et=lt.canonical.y,[new c.MercatorCoordinate(0,Et/yt).toLngLat().lat,new c.MercatorCoordinate(0,(Et+1)/yt).toLngLat().lat]),u_light:[Q.paint.get("hillshade-exaggeration"),rt],u_shadow:$,u_highlight:ot,u_accent:K}}(n,a,o);M.draw(g,w.TRIANGLES,l,d,_,st.disabled,N,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function yl(n,a,o,l,d,_){var ot,K,rt,lt,g=n.context,w=g.gl,I=a.dem;if(I&&I.data){var M=I.dim,N=I.stride,Z=I.getPixels();if(g.activeTexture.set(w.TEXTURE1),g.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||n.getTileTexture(N),a.demTexture){var q=a.demTexture;q.update(Z,{premultiply:!1}),q.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else a.demTexture=new c.Texture(g,Z,w.RGBA,{premultiply:!1}),a.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);g.activeTexture.set(w.TEXTURE0);var Q=a.fbo;if(!Q){var $=new c.Texture(g,{width:M,height:M,data:null},w.RGBA);$.bind(w.LINEAR,w.CLAMP_TO_EDGE),(Q=a.fbo=g.createFramebuffer(M,M,!0)).colorAttachment.set($.texture)}g.bindFramebuffer.set(Q.framebuffer),g.viewport.set([0,0,M,M]),n.useProgram("hillshadePrepare").draw(g,w.TRIANGLES,l,d,_,st.disabled,(ot=a.tileID,rt=(K=I).stride,lt=c.create(),c.ortho(lt,0,c.EXTENT,-c.EXTENT,0,0,1),c.translate(lt,lt,[0,-c.EXTENT,0]),{u_matrix:lt,u_image:1,u_dimension:[rt,rt],u_zoom:ot.overscaledZ,u_unpack:K.getUnpackVector()}),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function ts(n,a,o,l,d){var _=l.paint.get("raster-fade-duration");if(_>0){var g=c.browser.now(),w=(g-n.timeAdded)/_,I=a?(g-a.timeAdded)/_:-1,M=o.getSource(),N=d.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),Z=!a||Math.abs(a.tileID.overscaledZ-N)>Math.abs(n.tileID.overscaledZ-N),q=Z&&n.refreshedUponExpiration?1:c.clamp(Z?w:1-I,0,1);return n.refreshedUponExpiration&&w>=1&&(n.refreshedUponExpiration=!1),a?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}var hs=new c.Color(1,0,0,1),gl=new c.Color(0,1,0,1),vl=new c.Color(0,0,1,1),Ba=new c.Color(1,0,1,1),R=new c.Color(0,1,1,1);function y(n,a,o,l){H(n,0,a+o/2,n.transform.width,o,l)}function P(n,a,o,l){H(n,a-o/2,0,o,n.transform.height,l)}function H(n,a,o,l,d,_){var g=n.context,w=g.gl;w.enable(w.SCISSOR_TEST),w.scissor(a*c.browser.devicePixelRatio,o*c.browser.devicePixelRatio,l*c.browser.devicePixelRatio,d*c.browser.devicePixelRatio),g.clear({color:_}),w.disable(w.SCISSOR_TEST)}function mt(n,a,o){var l=n.context,d=l.gl,_=o.posMatrix,g=n.useProgram("debug"),w=G.disabled,I=X.disabled,M=n.colorModeForRenderPass();l.activeTexture.set(d.TEXTURE0),n.emptyTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),g.draw(l,d.LINE_STRIP,w,I,M,st.disabled,V(_,c.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var N=a.getTileByID(o.key).latestRawTileData,Z=Math.floor((N&&N.byteLength||0)/1024),q=a.getTile(o).tileSize,Q=512/Math.min(q,512)*(o.overscaledZ/n.transform.zoom)*.5,$=o.canonical.toString();o.overscaledZ!==o.canonical.z&&($+=" => "+o.overscaledZ),function(ot,K){ot.initDebugOverlayCanvas();var rt=ot.debugOverlayCanvas,lt=ot.context.gl,yt=ot.debugOverlayCanvas.getContext("2d");yt.clearRect(0,0,rt.width,rt.height),yt.shadowColor="white",yt.shadowBlur=2,yt.lineWidth=1.5,yt.strokeStyle="white",yt.textBaseline="top",yt.font="bold 36px Open Sans, sans-serif",yt.fillText(K,5,5),yt.strokeText(K,5,5),ot.debugOverlayTexture.update(rt),ot.debugOverlayTexture.bind(lt.LINEAR,lt.CLAMP_TO_EDGE)}(n,$+" "+Z+"kb"),g.draw(l,d.TRIANGLES,w,I,nt.alphaBlended,st.disabled,V(_,c.Color.transparent,Q),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var _t={symbol:function(n,a,o,l,d){if("translucent"===n.renderPass){var _=X.disabled,g=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(w,I,M,N,Z,q,Q){for(var $=I.transform,ot="map"===Z,K="map"===q,rt=0,lt=w;rt<lt.length;rt+=1){var yt=lt[rt],Et=N.getTile(yt),Tt=Et.getBucket(M);if(Tt&&Tt.text&&Tt.text.segments.get().length){var It=c.evaluateSizeForZoom(Tt.textSizeData,$.zoom),Ot=Gi(Et,1,I.transform.zoom),Xt=rn(yt.posMatrix,K,ot,I.transform,Ot),Wt="none"!==M.layout.get("icon-text-fit")&&Tt.hasIconData();if(It){var se=Math.pow(2,$.zoom-Et.tileID.overscaledZ);Qs(Tt,ot,K,Q,c.symbolSize,$,Xt,yt.posMatrix,se,It,Wt)}}}}(l,n,o,a,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),d),0!==o.paint.get("icon-opacity").constantOr(1)&&Oa(n,a,o,l,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),_,g),0!==o.paint.get("text-opacity").constantOr(1)&&Oa(n,a,o,l,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),_,g),a.map.showCollisionBoxes&&(us(n,a,o,l,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),us(n,a,o,l,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,a,o,l){if("translucent"===n.renderPass){var d=o.paint.get("circle-opacity"),_=o.paint.get("circle-stroke-width"),g=o.paint.get("circle-stroke-opacity"),w=void 0!==o.layout.get("circle-sort-key").constantOr(1);if(0!==d.constantOr(1)||0!==_.constantOr(1)&&0!==g.constantOr(1)){for(var I=n.context,M=I.gl,N=n.depthModeForSublayer(0,G.ReadOnly),Z=X.disabled,q=n.colorModeForRenderPass(),Q=[],$=0;$<l.length;$++){var ot=l[$],K=a.getTile(ot),rt=K.getBucket(o);if(rt){var lt=rt.programConfigurations.get(o.id),yt={programConfiguration:lt,program:n.useProgram("circle",lt),layoutVertexBuffer:rt.layoutVertexBuffer,indexBuffer:rt.indexBuffer,uniformValues:m(n,ot,K,o)};if(w)for(var Et=0,Tt=rt.segments.get();Et<Tt.length;Et+=1){var It=Tt[Et];Q.push({segments:new c.SegmentVector([It]),sortKey:It.sortKey,state:yt})}else Q.push({segments:rt.segments,sortKey:0,state:yt})}}w&&Q.sort(function(ge,we){return ge.sortKey-we.sortKey});for(var Ot=0,Xt=Q;Ot<Xt.length;Ot+=1){var Wt=Xt[Ot],se=Wt.state;se.program.draw(I,M.TRIANGLES,N,Z,q,st.disabled,se.uniformValues,o.id,se.layoutVertexBuffer,se.indexBuffer,Wt.segments,o.paint,n.transform.zoom,se.programConfiguration)}}}},heatmap:function(n,a,o,l){if(0!==o.paint.get("heatmap-opacity"))if("offscreen"===n.renderPass){var d=n.context,_=d.gl,g=X.disabled,w=new nt([_.ONE,_.ONE],c.Color.transparent,[!0,!0,!0,!0]);(function(Q,$,ot){var K=Q.gl;Q.activeTexture.set(K.TEXTURE1),Q.viewport.set([0,0,$.width/4,$.height/4]);var yt,Et,Tt,It,Ot,rt=ot.heatmapFbo;if(rt)K.bindTexture(K.TEXTURE_2D,rt.colorAttachment.get()),Q.bindFramebuffer.set(rt.framebuffer);else{var lt=K.createTexture();K.bindTexture(K.TEXTURE_2D,lt),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR),Tt=lt,It=rt=ot.heatmapFbo=Q.createFramebuffer($.width/4,$.height/4,!1),(Ot=(yt=Q).gl).texImage2D(Ot.TEXTURE_2D,0,Ot.RGBA,(Et=$).width/4,Et.height/4,0,Ot.RGBA,yt.extRenderToTextureHalfFloat?yt.extTextureHalfFloat.HALF_FLOAT_OES:Ot.UNSIGNED_BYTE,null),It.colorAttachment.set(Tt)}})(d,n,o),d.clear({color:c.Color.transparent});for(var I=0;I<l.length;I++){var M=l[I];if(!a.hasRenderableParent(M)){var N=a.getTile(M),Z=N.getBucket(o);if(Z){var q=Z.programConfigurations.get(o.id);n.useProgram("heatmap",q).draw(d,_.TRIANGLES,G.disabled,g,w,st.disabled,ut(M.posMatrix,N,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,o.paint,n.transform.zoom,q)}}}d.viewport.set([0,0,n.width,n.height])}else"translucent"===n.renderPass&&(n.context.setColorMode(n.colorModeForRenderPass()),function(Q,$){var ot=Q.context,K=ot.gl,rt=$.heatmapFbo;if(rt){ot.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,rt.colorAttachment.get()),ot.activeTexture.set(K.TEXTURE1);var lt=$.colorRampTexture;lt||(lt=$.colorRampTexture=new c.Texture(ot,$.colorRamp,K.RGBA)),lt.bind(K.LINEAR,K.CLAMP_TO_EDGE),Q.useProgram("heatmapTexture").draw(ot,K.TRIANGLES,G.disabled,X.disabled,Q.colorModeForRenderPass(),st.disabled,function(yt,Et,Tt,It){var Ot=c.create();c.ortho(Ot,0,yt.width,yt.height,0,0,1);var Xt=yt.context.gl;return{u_matrix:Ot,u_world:[Xt.drawingBufferWidth,Xt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Et.paint.get("heatmap-opacity")}}(Q,$),$.id,Q.viewportBuffer,Q.quadTriangleIndexBuffer,Q.viewportSegments,$.paint,Q.transform.zoom)}}(n,o))},line:function(n,a,o,l){if("translucent"===n.renderPass){var d=o.paint.get("line-opacity"),_=o.paint.get("line-width");if(0!==d.constantOr(1)&&0!==_.constantOr(1))for(var g=n.depthModeForSublayer(0,G.ReadOnly),w=n.colorModeForRenderPass(),I=o.paint.get("line-dasharray"),M=o.paint.get("line-pattern"),N=M.constantOr(1),Z=o.paint.get("line-gradient"),q=o.getCrossfadeParameters(),Q=N?"linePattern":I?"lineSDF":Z?"lineGradient":"line",$=n.context,ot=$.gl,K=!0,rt=0,lt=l;rt<lt.length;rt+=1){var yt=lt[rt],Et=a.getTile(yt);if(!N||Et.patternsLoaded()){var Tt=Et.getBucket(o);if(Tt){var It=Tt.programConfigurations.get(o.id),Ot=n.context.program.get(),Xt=n.useProgram(Q,It),Wt=K||Xt.program!==Ot,se=M.constantOr(null);if(se&&Et.imageAtlas){var ge=Et.imageAtlas,we=ge.patternPositions[se.to.toString()],be=ge.patternPositions[se.from.toString()];we&&be&&It.setConstantPatternPositions(we,be)}var xi=N?ye(n,Et,o,q):I?li(n,Et,o,I,q):Z?jt(n,Et,o,Tt.lineClipsArray.length):Dt(n,Et,o);if(N)$.activeTexture.set(ot.TEXTURE0),Et.imageAtlasTexture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE),It.updatePaintBuffers(q);else if(I&&(Wt||n.lineAtlas.dirty))$.activeTexture.set(ot.TEXTURE0),n.lineAtlas.bind($);else if(Z){var he=Tt.gradients[o.id],Fe=he.texture;if(o.gradientVersion!==he.version){var $e=256;if(o.stepInterpolant){var De=a.getSource().maxzoom,ke=yt.canonical.z===De?Math.ceil(1<<n.transform.maxZoom-yt.canonical.z):1;$e=c.clamp(c.nextPowerOfTwo(Tt.maxLineLength/c.EXTENT*1024*ke),256,$.maxTextureSize)}he.gradient=c.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:$e,image:he.gradient||void 0,clips:Tt.lineClipsArray}),he.texture?he.texture.update(he.gradient):he.texture=new c.Texture($,he.gradient,ot.RGBA),he.version=o.gradientVersion,Fe=he.texture}$.activeTexture.set(ot.TEXTURE0),Fe.bind(o.stepInterpolant?ot.NEAREST:ot.LINEAR,ot.CLAMP_TO_EDGE)}Xt.draw($,ot.TRIANGLES,g,n.stencilModeForClipping(yt),w,st.disabled,xi,o.id,Tt.layoutVertexBuffer,Tt.indexBuffer,Tt.segments,o.paint,n.transform.zoom,It,Tt.layoutVertexBuffer2),K=!1}}}}},fill:function(n,a,o,l){var d=o.paint.get("fill-color"),_=o.paint.get("fill-opacity");if(0!==_.constantOr(1)){var g=n.colorModeForRenderPass(),w=o.paint.get("fill-pattern"),I=n.opaquePassEnabledForLayer()&&!w.constantOr(1)&&1===d.constantOr(c.Color.transparent).a&&1===_.constantOr(0)?"opaque":"translucent";if(n.renderPass===I){var M=n.depthModeForSublayer(1,"opaque"===n.renderPass?G.ReadWrite:G.ReadOnly);Is(n,a,o,l,M,g,!1)}if("translucent"===n.renderPass&&o.paint.get("fill-antialias")){var N=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,G.ReadOnly);Is(n,a,o,l,N,g,!0)}}},"fill-extrusion":function(n,a,o,l){var d=o.paint.get("fill-extrusion-opacity");if(0!==d&&"translucent"===n.renderPass){var _=new G(n.context.gl.LEQUAL,G.ReadWrite,n.depthRangeFor3D);if(1!==d||o.paint.get("fill-extrusion-pattern").constantOr(1))Cs(n,a,o,l,_,X.disabled,nt.disabled),Cs(n,a,o,l,_,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var g=n.colorModeForRenderPass();Cs(n,a,o,l,_,X.disabled,g)}}},hillshade:function(n,a,o,l){if("offscreen"===n.renderPass||"translucent"===n.renderPass){for(var d=n.context,_=n.depthModeForSublayer(0,G.ReadOnly),g=n.colorModeForRenderPass(),w="translucent"===n.renderPass?n.stencilConfigForOverlap(l):[{},l],I=w[0],M=0,N=w[1];M<N.length;M+=1){var Z=N[M],q=a.getTile(Z);q.needsHillshadePrepare&&"offscreen"===n.renderPass?yl(n,q,o,_,X.disabled,g):"translucent"===n.renderPass&&ua(n,q,o,_,I[Z.overscaledZ],g)}d.viewport.set([0,0,n.width,n.height])}},raster:function(n,a,o,l){if("translucent"===n.renderPass&&0!==o.paint.get("raster-opacity")&&l.length)for(var d=n.context,_=d.gl,g=a.getSource(),w=n.useProgram("raster"),I=n.colorModeForRenderPass(),M=g instanceof xr?[{},l]:n.stencilConfigForOverlap(l),N=M[0],Z=M[1],q=Z[Z.length-1].overscaledZ,Q=!n.options.moving,$=0,ot=Z;$<ot.length;$+=1){var K=ot[$],rt=n.depthModeForSublayer(K.overscaledZ-q,1===o.paint.get("raster-opacity")?G.ReadWrite:G.ReadOnly,_.LESS),lt=a.getTile(K),yt=n.transform.calculatePosMatrix(K.toUnwrapped(),Q);lt.registerFadeDuration(o.paint.get("raster-fade-duration"));var Et=a.findLoadedParent(K,0),Tt=ts(lt,Et,a,o,n.transform),It=void 0,Ot=void 0,Xt="nearest"===o.paint.get("raster-resampling")?_.NEAREST:_.LINEAR;d.activeTexture.set(_.TEXTURE0),lt.texture.bind(Xt,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),d.activeTexture.set(_.TEXTURE1),Et?(Et.texture.bind(Xt,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),It=Math.pow(2,Et.tileID.overscaledZ-lt.tileID.overscaledZ),Ot=[lt.tileID.canonical.x*It%1,lt.tileID.canonical.y*It%1]):lt.texture.bind(Xt,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST);var Wt=Bo(yt,Ot||[0,0],It||1,Tt,o);g instanceof xr?w.draw(d,_.TRIANGLES,rt,X.disabled,I,st.disabled,Wt,o.id,g.boundsBuffer,n.quadTriangleIndexBuffer,g.boundsSegments):w.draw(d,_.TRIANGLES,rt,N[K.overscaledZ],I,st.disabled,Wt,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,a,o){var l=o.paint.get("background-color"),d=o.paint.get("background-opacity");if(0!==d){var _=n.context,g=_.gl,w=n.transform,I=w.tileSize,M=o.paint.get("background-pattern");if(!n.isPatternMissing(M)){var N=!M&&1===l.a&&1===d&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===N){var Z=X.disabled,q=n.depthModeForSublayer(0,"opaque"===N?G.ReadWrite:G.ReadOnly),Q=n.colorModeForRenderPass(),$=n.useProgram(M?"backgroundPattern":"background"),ot=w.coveringTiles({tileSize:I});M&&(_.activeTexture.set(g.TEXTURE0),n.imageManager.bind(n.context));for(var K=o.getCrossfadeParameters(),rt=0,lt=ot;rt<lt.length;rt+=1){var yt=lt[rt],Et=n.transform.calculatePosMatrix(yt.toUnwrapped()),Tt=M?$o(Et,d,n,M,{tileID:yt,tileSize:I},K):on(Et,d,l);$.draw(_,g.TRIANGLES,q,Z,Q,st.disabled,Tt,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,a,o){for(var l=0;l<o.length;l++)mt(n,a,o[l])},custom:function(n,a,o){var l=n.context,d=o.implementation;if("offscreen"===n.renderPass){var _=d.prerender;_&&(n.setCustomLayerDefaults(),l.setColorMode(n.colorModeForRenderPass()),_.call(d,l.gl,n.transform.customLayerMatrix()),l.setDirty(),n.setBaseState())}else if("translucent"===n.renderPass){n.setCustomLayerDefaults(),l.setColorMode(n.colorModeForRenderPass()),l.setStencilMode(X.disabled);var g="3d"===d.renderingMode?new G(n.context.gl.LEQUAL,G.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,G.ReadOnly);l.setDepthMode(g),d.render(l.gl,n.transform.customLayerMatrix()),l.setDirty(),n.setBaseState(),l.bindFramebuffer.set(null)}}},wt=function(n,a){this.context=new j(n),this.transform=a,this._tileTextures={},this.setup(),this.numSublayers=et.maxUnderzooming+et.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Eo,this.gpuTimers={}};wt.prototype.resize=function(n,a){if(this.width=n*c.browser.devicePixelRatio,this.height=a*c.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,l=this.style._order;o<l.length;o+=1)this.style._layers[l[o]].resize()},wt.prototype.setup=function(){var n=this.context,a=new c.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(c.EXTENT,0),a.emplaceBack(0,c.EXTENT),a.emplaceBack(c.EXTENT,c.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(a,cn.members),this.tileExtentSegments=c.SegmentVector.simpleSegment(0,0,4,2);var o=new c.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(c.EXTENT,0),o.emplaceBack(0,c.EXTENT),o.emplaceBack(c.EXTENT,c.EXTENT),this.debugBuffer=n.createVertexBuffer(o,cn.members),this.debugSegments=c.SegmentVector.simpleSegment(0,0,4,5);var l=new c.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(c.EXTENT,0,c.EXTENT,0),l.emplaceBack(0,c.EXTENT,0,c.EXTENT),l.emplaceBack(c.EXTENT,c.EXTENT,c.EXTENT,c.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(l,On.members),this.rasterBoundsSegments=c.SegmentVector.simpleSegment(0,0,4,2);var d=new c.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(d,cn.members),this.viewportSegments=c.SegmentVector.simpleSegment(0,0,4,2);var _=new c.StructArrayLayout1ui2;_.emplaceBack(0),_.emplaceBack(1),_.emplaceBack(3),_.emplaceBack(2),_.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(_);var g=new c.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(g),this.emptyTexture=new c.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var w=this.context.gl;this.stencilClearMode=new X({func:w.ALWAYS,mask:0},0,255,w.ZERO,w.ZERO,w.ZERO)},wt.prototype.clearStencil=function(){var n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=c.create();c.ortho(o,0,this.width,this.height,0,0,1),c.scale(o,o,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,a.TRIANGLES,G.disabled,this.stencilClearMode,nt.disabled,st.disabled,ct(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},wt.prototype._renderTileClippingMasks=function(n,a){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&a&&a.length){this.currentStencilSource=n.source;var o=this.context,l=o.gl;this.nextStencilID+a.length>256&&this.clearStencil(),o.setColorMode(nt.disabled),o.setDepthMode(G.disabled);var d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var _=0,g=a;_<g.length;_+=1){var w=g[_],I=this._tileClippingMaskIDs[w.key]=this.nextStencilID++;d.draw(o,l.TRIANGLES,G.disabled,new X({func:l.ALWAYS,mask:0},I,255,l.KEEP,l.KEEP,l.REPLACE),nt.disabled,st.disabled,ct(w.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},wt.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,a=this.context.gl;return new X({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)},wt.prototype.stencilModeForClipping=function(n){var a=this.context.gl;return new X({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)},wt.prototype.stencilConfigForOverlap=function(n){var a,o=this.context.gl,l=n.sort(function(I,M){return M.overscaledZ-I.overscaledZ}),d=l[l.length-1].overscaledZ,_=l[0].overscaledZ-d+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();for(var g={},w=0;w<_;w++)g[w+d]=new X({func:o.GEQUAL,mask:255},w+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=_,[g,l]}return[(a={},a[d]=X.disabled,a),l]},wt.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new nt([n.CONSTANT_COLOR,n.ONE],new c.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?nt.unblended:nt.alphaBlended},wt.prototype.depthModeForSublayer=function(n,a,o){if(!this.opaquePassEnabledForLayer())return G.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new G(o||this.context.gl.LEQUAL,a,[l,l])},wt.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},wt.prototype.render=function(n,a){var o=this;this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(c.browser.now()),this.imageManager.beginFrame();var l=this.style._order,d=this.style.sourceCaches;for(var _ in d){var g=d[_];g.used&&g.prepare(this.context)}var w,I,M={},N={},Z={};for(var q in d){var Q=d[q];M[q]=Q.getVisibleCoordinates(),N[q]=M[q].slice().reverse(),Z[q]=Q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var $=0;$<l.length;$++)if(this.style._layers[l[$]].is3D()){this.opaquePassCutoff=$;break}this.renderPass="offscreen";for(var ot=0,K=l;ot<K.length;ot+=1){var rt=this.style._layers[K[ot]];if(rt.hasOffscreenPass()&&!rt.isHidden(this.transform.zoom)){var lt=N[rt.source];("custom"===rt.type||lt.length)&&this.renderLayer(this,d[rt.source],rt,lt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.Color.black:c.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var yt=this.style._layers[l[this.currentLayer]],Et=d[yt.source],Tt=M[yt.source];this._renderTileClippingMasks(yt,Tt),this.renderLayer(this,Et,yt,Tt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var It=this.style._layers[l[this.currentLayer]],Ot=d[It.source],Xt=("symbol"===It.type?Z:N)[It.source];this._renderTileClippingMasks(It,M[It.source]),this.renderLayer(this,Ot,It,Xt)}this.options.showTileBoundaries&&(c.values(this.style._layers).forEach(function(Wt){Wt.source&&!Wt.isHidden(o.transform.zoom)&&(Wt.source!==(I&&I.id)&&(I=o.style.sourceCaches[Wt.source]),(!w||w.getSource().maxzoom<I.getSource().maxzoom)&&(w=I))}),w&&_t.debug(this,w,w.getVisibleCoordinates())),this.options.showPadding&&function(Wt){var se=Wt.transform.padding;y(Wt,Wt.transform.height-(se.top||0),3,hs),y(Wt,se.bottom||0,3,gl),P(Wt,se.left||0,3,vl),P(Wt,Wt.transform.width-(se.right||0),3,Ba);var we,be,xi,he,ge=Wt.transform.centerPoint;H(we=Wt,(be=ge.x)-1,(xi=Wt.transform.height-ge.y)-10,2,20,he=R),H(we,be-10,xi-1,20,2,he)}(this),this.context.setDefault()},wt.prototype.renderLayer=function(n,a,o,l){o.isHidden(this.transform.zoom)||("background"===o.type||"custom"===o.type||l.length)&&(this.id=o.id,this.gpuTimingStart(o),_t[o.type](n,a,o,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},wt.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var a=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),o.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,o.query)}},wt.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},wt.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},wt.prototype.queryGpuTimers=function(n){var a={};for(var o in n){var l=n[o],d=this.context.extTimerQuery,_=d.getQueryObjectEXT(l.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(l.query),a[o]=_}return a},wt.prototype.translatePosMatrix=function(n,a,o,l,d){if(!o[0]&&!o[1])return n;var _=d?"map"===l?this.transform.angle:0:"viewport"===l?-this.transform.angle:0;if(_){var g=Math.sin(_),w=Math.cos(_);o=[o[0]*w-o[1]*g,o[0]*g+o[1]*w]}var I=[d?o[0]:Gi(a,o[0],this.transform.zoom),d?o[1]:Gi(a,o[1],this.transform.zoom),0],M=new Float32Array(16);return c.translate(M,n,I),M},wt.prototype.saveTileTexture=function(n){var a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]},wt.prototype.getTileTexture=function(n){var a=this._tileTextures[n];return a&&a.length>0?a.pop():null},wt.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var a=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!a||!o},wt.prototype.useProgram=function(n,a){this.cache=this.cache||{};var o=""+n+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new Yo(this.context,n,js[n],a,Ta[n],this._showOverdrawInspector)),this.cache[o]},wt.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},wt.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},wt.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=c.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},wt.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ut=function(n,a){this.points=n,this.planes=a};Ut.fromInvProjectionMatrix=function(n,a,o){var l=Math.pow(2,o),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(g){return c.transformMat4([],g,n)}).map(function(g){return c.scale$1([],g,1/g[3]/a*l)}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(g){var w=c.sub([],d[g[0]],d[g[1]]),I=c.sub([],d[g[2]],d[g[1]]),M=c.normalize([],c.cross([],w,I)),N=-c.dot(M,d[g[1]]);return M.concat(N)});return new Ut(d,_)};var ie=function(n,a){this.min=n,this.max=a,this.center=c.scale$2([],c.add([],this.min,this.max),.5)};ie.prototype.quadrant=function(n){for(var a=[n%2==0,n<2],o=c.clone$2(this.min),l=c.clone$2(this.max),d=0;d<a.length;d++)o[d]=a[d]?this.min[d]:this.center[d],l[d]=a[d]?this.center[d]:this.max[d];return l[2]=this.max[2],new ie(o,l)},ie.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},ie.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},ie.prototype.intersects=function(n){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,l=0;l<n.planes.length;l++){for(var d=n.planes[l],_=0,g=0;g<a.length;g++)_+=c.dot$1(d,a[g])>=0;if(0===_)return 0;_!==a.length&&(o=!1)}if(o)return 2;for(var w=0;w<3;w++){for(var I=Number.MAX_VALUE,M=-Number.MAX_VALUE,N=0;N<n.points.length;N++){var Z=n.points[N][w]-this.min[w];I=Math.min(I,Z),M=Math.max(M,Z)}if(M<0||I>this.max[w]-this.min[w])return 0}return 1};var de=function(n,a,o,l){if(void 0===n&&(n=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===l&&(l=0),isNaN(n)||n<0||isNaN(a)||a<0||isNaN(o)||o<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=o,this.right=l};de.prototype.interpolate=function(n,a,o){return null!=a.top&&null!=n.top&&(this.top=c.number(n.top,a.top,o)),null!=a.bottom&&null!=n.bottom&&(this.bottom=c.number(n.bottom,a.bottom,o)),null!=a.left&&null!=n.left&&(this.left=c.number(n.left,a.left,o)),null!=a.right&&null!=n.right&&(this.right=c.number(n.right,a.right,o)),this},de.prototype.getCenter=function(n,a){var o=c.clamp((this.left+n-this.right)/2,0,n),l=c.clamp((this.top+a-this.bottom)/2,0,a);return new c.Point(o,l)},de.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},de.prototype.clone=function(){return new de(this.top,this.bottom,this.left,this.right)},de.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Gt=function(n,a,o,l,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===d||d,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=o??0,this._maxPitch=l??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new de,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ht={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Gt.prototype.clone=function(){var n=new Gt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Ht.minZoom.get=function(){return this._minZoom},Ht.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Ht.maxZoom.get=function(){return this._maxZoom},Ht.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Ht.minPitch.get=function(){return this._minPitch},Ht.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Ht.maxPitch.get=function(){return this._maxPitch},Ht.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Ht.renderWorldCopies.get=function(){return this._renderWorldCopies},Ht.renderWorldCopies.set=function(n){void 0===n?n=!0:null===n&&(n=!1),this._renderWorldCopies=n},Ht.worldSize.get=function(){return this.tileSize*this.scale},Ht.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ht.size.get=function(){return new c.Point(this.width,this.height)},Ht.bearing.get=function(){return-this.angle/Math.PI*180},Ht.bearing.set=function(n){var a=-c.wrap(n,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=c.create$2(),c.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ht.pitch.get=function(){return this._pitch/Math.PI*180},Ht.pitch.set=function(n){var a=c.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},Ht.fov.get=function(){return this._fov/Math.PI*180},Ht.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Ht.zoom.get=function(){return this._zoom},Ht.zoom.set=function(n){var a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},Ht.center.get=function(){return this._center},Ht.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Ht.padding.get=function(){return this._edgeInsets.toJSON()},Ht.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Ht.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Gt.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},Gt.prototype.interpolatePadding=function(n,a,o){this._unmodified=!1,this._edgeInsets.interpolate(n,a,o),this._constrain(),this._calcMatrices()},Gt.prototype.coveringZoomLevel=function(n){var a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)},Gt.prototype.getVisibleUnwrappedCoordinates=function(n){var a=[new c.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new c.Point(0,0)),l=this.pointCoordinate(new c.Point(this.width,0)),d=this.pointCoordinate(new c.Point(this.width,this.height)),_=this.pointCoordinate(new c.Point(0,this.height)),g=Math.floor(Math.min(o.x,l.x,d.x,_.x)),w=Math.floor(Math.max(o.x,l.x,d.x,_.x)),I=g-1;I<=w+1;I++)0!==I&&a.push(new c.UnwrappedTileID(I,n));return a},Gt.prototype.coveringTiles=function(n){var a=this.coveringZoomLevel(n),o=a;if(void 0!==n.minzoom&&a<n.minzoom)return[];void 0!==n.maxzoom&&a>n.maxzoom&&(a=n.maxzoom);var l=c.MercatorCoordinate.fromLngLat(this.center),d=Math.pow(2,a),_=[d*l.x,d*l.y,0],g=Ut.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),w=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(w=a);var I=function(Wt){return{aabb:new ie([Wt*d,0,0],[(Wt+1)*d,d,0]),zoom:0,x:0,y:0,wrap:Wt,fullyVisible:!1}},M=[],N=[],Z=a,q=n.reparseOverscaled?o:a;if(this._renderWorldCopies)for(var Q=1;Q<=3;Q++)M.push(I(-Q)),M.push(I(Q));for(M.push(I(0));M.length>0;){var $=M.pop(),ot=$.x,K=$.y,rt=$.fullyVisible;if(!rt){var lt=$.aabb.intersects(g);if(0===lt)continue;rt=2===lt}var yt=$.aabb.distanceX(_),Et=$.aabb.distanceY(_),Tt=Math.max(Math.abs(yt),Math.abs(Et));if($.zoom===Z||Tt>3+(1<<Z-$.zoom)-2&&$.zoom>=w)N.push({tileID:new c.OverscaledTileID($.zoom===Z?q:$.zoom,$.wrap,$.zoom,ot,K),distanceSq:c.sqrLen([_[0]-.5-ot,_[1]-.5-K])});else for(var It=0;It<4;It++){var Ot=(ot<<1)+It%2,Xt=(K<<1)+(It>>1);M.push({aabb:$.aabb.quadrant(It),zoom:$.zoom+1,x:Ot,y:Xt,wrap:$.wrap,fullyVisible:rt})}}return N.sort(function(Wt,se){return Wt.distanceSq-se.distanceSq}).map(function(Wt){return Wt.tileID})},Gt.prototype.resize=function(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()},Ht.unmodified.get=function(){return this._unmodified},Gt.prototype.zoomScale=function(n){return Math.pow(2,n)},Gt.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},Gt.prototype.project=function(n){var a=c.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new c.Point(c.mercatorXfromLng(n.lng)*this.worldSize,c.mercatorYfromLat(a)*this.worldSize)},Gt.prototype.unproject=function(n){return new c.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Ht.point.get=function(){return this.project(this.center)},Gt.prototype.setLocationAtPoint=function(n,a){var o=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(n),_=new c.MercatorCoordinate(d.x-(o.x-l.x),d.y-(o.y-l.y));this.center=this.coordinateLocation(_),this._renderWorldCopies&&(this.center=this.center.wrap())},Gt.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},Gt.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},Gt.prototype.locationCoordinate=function(n){return c.MercatorCoordinate.fromLngLat(n)},Gt.prototype.coordinateLocation=function(n){return n.toLngLat()},Gt.prototype.pointCoordinate=function(n){var a=[n.x,n.y,0,1],o=[n.x,n.y,1,1];c.transformMat4(a,a,this.pixelMatrixInverse),c.transformMat4(o,o,this.pixelMatrixInverse);var l=a[3],d=o[3],_=a[1]/l,g=o[1]/d,w=a[2]/l,I=o[2]/d,M=w===I?0:(0-w)/(I-w);return new c.MercatorCoordinate(c.number(a[0]/l,o[0]/d,M)/this.worldSize,c.number(_,g,M)/this.worldSize)},Gt.prototype.coordinatePoint=function(n){var a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.transformMat4(a,a,this.pixelMatrix),new c.Point(a[0]/a[3],a[1]/a[3])},Gt.prototype.getBounds=function(){return(new c.LngLatBounds).extend(this.pointLocation(new c.Point(0,0))).extend(this.pointLocation(new c.Point(this.width,0))).extend(this.pointLocation(new c.Point(this.width,this.height))).extend(this.pointLocation(new c.Point(0,this.height)))},Gt.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new c.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Gt.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Gt.prototype.calculatePosMatrix=function(n,a){void 0===a&&(a=!1);var o=n.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[o])return l[o];var d=n.canonical,_=this.worldSize/this.zoomScale(d.z),g=d.x+Math.pow(2,d.z)*n.wrap,w=c.identity(new Float64Array(16));return c.translate(w,w,[g*_,d.y*_,0]),c.scale(w,w,[_/c.EXTENT,_/c.EXTENT,1]),c.multiply(w,a?this.alignedProjMatrix:this.projMatrix,w),l[o]=new Float32Array(w),l[o]},Gt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Gt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,a,o,l,d=-90,_=90,g=-180,w=180,I=this.size,M=this._unmodified;if(this.latRange){var N=this.latRange;d=c.mercatorYfromLat(N[1])*this.worldSize,n=(_=c.mercatorYfromLat(N[0])*this.worldSize)-d<I.y?I.y/(_-d):0}if(this.lngRange){var Z=this.lngRange;g=c.mercatorXfromLng(Z[0])*this.worldSize,a=(w=c.mercatorXfromLng(Z[1])*this.worldSize)-g<I.x?I.x/(w-g):0}var q=this.point,Q=Math.max(a||0,n||0);if(Q)return this.center=this.unproject(new c.Point(a?(w+g)/2:q.x,n?(_+d)/2:q.y)),this.zoom+=this.scaleZoom(Q),this._unmodified=M,void(this._constraining=!1);if(this.latRange){var $=q.y,ot=I.y/2;$-ot<d&&(l=d+ot),$+ot>_&&(l=_-ot)}if(this.lngRange){var K=q.x,rt=I.x/2;K-rt<g&&(o=g+rt),K+rt>w&&(o=w-rt)}void 0===o&&void 0===l||(this.center=this.unproject(new c.Point(void 0!==o?o:q.x,void 0!==l?l:q.y))),this._unmodified=M,this._constraining=!1}},Gt.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),l=Math.sin(o)*this.cameraToCenterDistance/Math.sin(c.clamp(Math.PI-a-o,.01,Math.PI-.01)),d=this.point,_=d.x,g=d.y,w=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),I=this.height/50,M=new Float64Array(16);c.perspective(M,this._fov,this.width/this.height,I,w),M[8]=2*-n.x/this.width,M[9]=2*n.y/this.height,c.scale(M,M,[1,-1,1]),c.translate(M,M,[0,0,-this.cameraToCenterDistance]),c.rotateX(M,M,this._pitch),c.rotateZ(M,M,this.angle),c.translate(M,M,[-_,-g,0]),this.mercatorMatrix=c.scale([],M,[this.worldSize,this.worldSize,this.worldSize]),c.scale(M,M,[1,1,c.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=M,this.invProjMatrix=c.invert([],this.projMatrix);var N=this.width%2/2,Z=this.height%2/2,q=Math.cos(this.angle),Q=Math.sin(this.angle),$=_-Math.round(_)+q*N+Q*Z,ot=g-Math.round(g)+q*Z+Q*N,K=new Float64Array(M);if(c.translate(K,K,[$>.5?$-1:$,ot>.5?ot-1:ot,0]),this.alignedProjMatrix=K,M=c.create(),c.scale(M,M,[this.width/2,-this.height/2,1]),c.translate(M,M,[1,-1,0]),this.labelPlaneMatrix=M,M=c.create(),c.scale(M,M,[1,-1,1]),c.translate(M,M,[-1,-1,0]),c.scale(M,M,[2/this.width,2/this.height,1]),this.glCoordMatrix=M,this.pixelMatrix=c.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(M=c.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=M,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Gt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new c.Point(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},Gt.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.Point(0,n))},Gt.prototype.getCameraQueryGeometry=function(n){var a=this.getCameraPoint();if(1===n.length)return[n[0],a];for(var o=a.x,l=a.y,d=a.x,_=a.y,g=0,w=n;g<w.length;g+=1){var I=w[g];o=Math.min(o,I.x),l=Math.min(l,I.y),d=Math.max(d,I.x),_=Math.max(_,I.y)}return[new c.Point(o,l),new c.Point(d,l),new c.Point(d,_),new c.Point(o,_),new c.Point(o,l)]},Object.defineProperties(Gt.prototype,Ht);var Ne=function(n){var a,o,l,d;this._hashName=n&&encodeURIComponent(n),c.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(a=this._updateHashUnthrottled.bind(this),o=!1,l=null,d=function(){l=null,o&&(a(),l=setTimeout(d,300),o=!1)},function(){return o=!0,l||d(),l})};Ne.prototype.addTo=function(n){return this._map=n,c.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ne.prototype.remove=function(){return c.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ne.prototype.getHashString=function(n){var a=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,l=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,l),_=Math.round(a.lng*d)/d,g=Math.round(a.lat*d)/d,w=this._map.getBearing(),I=this._map.getPitch(),M="";if(M+=n?"/"+_+"/"+g+"/"+o:o+"/"+g+"/"+_,(w||I)&&(M+="/"+Math.round(10*w)/10),I&&(M+="/"+Math.round(I)),this._hashName){var N=this._hashName,Z=!1,q=c.window.location.hash.slice(1).split("&").map(function(Q){var $=Q.split("=")[0];return $===N?(Z=!0,$+"="+M):Q}).filter(function(Q){return Q});return Z||q.push(N+"="+M),"#"+q.join("&")}return"#"+M},Ne.prototype._getCurrentHash=function(){var n,a=this,o=c.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(n=l)}),(n&&n[1]||"").split("/")):o.split("/")},Ne.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:a,pitch:+(n[4]||0)}),!0}return!1},Ne.prototype._updateHashUnthrottled=function(){var n=c.window.location.href.replace(/(#.+)?$/,this.getHashString());try{c.window.history.replaceState(c.window.history.state,null,n)}catch{}};var Re={linearity:.3,easing:c.bezier(0,0,.3,1)},Ge=c.extend({deceleration:2500,maxSpeed:1400},Re),Ve=c.extend({deceleration:20,maxSpeed:1400},Re),ii=c.extend({deceleration:1e3,maxSpeed:360},Re),tn=c.extend({deceleration:1e3,maxSpeed:90},Re),Xi=function(n){this._map=n,this.clear()};function ui(n,a){(!n.duration||n.duration<a.duration)&&(n.duration=a.duration,n.easing=a.easing)}function mi(n,a,o){var l=o.maxSpeed,d=o.linearity,_=o.deceleration,g=c.clamp(n*d/(a/1e3),-l,l),w=Math.abs(g)/(_*d);return{easing:o.easing,duration:1e3*w,amount:g*(w/2)}}Xi.prototype.clear=function(){this._inertiaBuffer=[]},Xi.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.browser.now(),settings:n})},Xi.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,a=c.browser.now();n.length>0&&a-n[0].time>160;)n.shift()},Xi.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new c.Point(0,0),pinchAround:void 0,around:void 0},o=0,l=this._inertiaBuffer;o<l.length;o+=1){var d=l[o].settings;a.zoom+=d.zoomDelta||0,a.bearing+=d.bearingDelta||0,a.pitch+=d.pitchDelta||0,d.panDelta&&a.pan._add(d.panDelta),d.around&&(a.around=d.around),d.pinchAround&&(a.pinchAround=d.pinchAround)}var _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(a.pan.mag()){var w=mi(a.pan.mag(),_,c.extend({},Ge,n||{}));g.offset=a.pan.mult(w.amount/a.pan.mag()),g.center=this._map.transform.center,ui(g,w)}if(a.zoom){var I=mi(a.zoom,_,Ve);g.zoom=this._map.transform.zoom+I.amount,ui(g,I)}if(a.bearing){var M=mi(a.bearing,_,ii);g.bearing=this._map.transform.bearing+c.clamp(M.amount,-179,179),ui(g,M)}if(a.pitch){var N=mi(a.pitch,_,tn);g.pitch=this._map.transform.pitch+N.amount,ui(g,N)}if(g.zoom||g.bearing){var Z=void 0===a.pinchAround?a.around:a.pinchAround;g.around=Z?this._map.unproject(Z):this._map.getCenter()}return this.clear(),c.extend(g,{noMoveStart:!0})}};var Ee=function(n){function a(l,d,_,g){void 0===g&&(g={});var w=Mt.mousePos(d.getCanvasContainer(),_),I=d.unproject(w);n.call(this,l,c.extend({point:w,lngLat:I,originalEvent:_},g)),this._defaultPrevented=!1,this.target=d}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(c.Event),_i=function(n){function a(l,d,_){var g="touchend"===l?_.changedTouches:_.touches,w=Mt.touchPos(d.getCanvasContainer(),g),I=w.map(function(Z){return d.unproject(Z)}),M=w.reduce(function(Z,q,Q,$){return Z.add(q.div($.length))},new c.Point(0,0)),N=d.unproject(M);n.call(this,l,{points:w,point:M,lngLats:I,lngLat:N,originalEvent:_}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(c.Event),Ki=function(n){function a(l,d,_){n.call(this,l,{originalEvent:_}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(c.Event),We=function(n,a){this._map=n,this._clickTolerance=a.clickTolerance};We.prototype.reset=function(){delete this._mousedownPos},We.prototype.wheel=function(n){return this._firePreventable(new Ki(n.type,this._map,n))},We.prototype.mousedown=function(n,a){return this._mousedownPos=a,this._firePreventable(new Ee(n.type,this._map,n))},We.prototype.mouseup=function(n){this._map.fire(new Ee(n.type,this._map,n))},We.prototype.click=function(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Ee(n.type,this._map,n))},We.prototype.dblclick=function(n){return this._firePreventable(new Ee(n.type,this._map,n))},We.prototype.mouseover=function(n){this._map.fire(new Ee(n.type,this._map,n))},We.prototype.mouseout=function(n){this._map.fire(new Ee(n.type,this._map,n))},We.prototype.touchstart=function(n){return this._firePreventable(new _i(n.type,this._map,n))},We.prototype.touchmove=function(n){this._map.fire(new _i(n.type,this._map,n))},We.prototype.touchend=function(n){this._map.fire(new _i(n.type,this._map,n))},We.prototype.touchcancel=function(n){this._map.fire(new _i(n.type,this._map,n))},We.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},We.prototype.isEnabled=function(){return!0},We.prototype.isActive=function(){return!1},We.prototype.enable=function(){},We.prototype.disable=function(){};var Zt=function(n){this._map=n};Zt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Zt.prototype.mousemove=function(n){this._map.fire(new Ee(n.type,this._map,n))},Zt.prototype.mousedown=function(){this._delayContextMenu=!0},Zt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ee("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Zt.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ee(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},Zt.prototype.isEnabled=function(){return!0},Zt.prototype.isActive=function(){return!1},Zt.prototype.enable=function(){},Zt.prototype.disable=function(){};var Ni=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1};function Qr(n,a){for(var o={},l=0;l<n.length;l++)o[n[l].identifier]=a[l];return o}Ni.prototype.isEnabled=function(){return!!this._enabled},Ni.prototype.isActive=function(){return!!this._active},Ni.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ni.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ni.prototype.mousedown=function(n,a){this.isEnabled()&&n.shiftKey&&0===n.button&&(Mt.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},Ni.prototype.mousemoveWindow=function(n,a){if(this._active){var o=a;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=o,this._box||(this._box=Mt.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var d=Math.min(l.x,o.x),_=Math.max(l.x,o.x),g=Math.min(l.y,o.y),w=Math.max(l.y,o.y);Mt.setTransform(this._box,"translate("+d+"px,"+g+"px)"),this._box.style.width=_-d+"px",this._box.style.height=w-g+"px"}}},Ni.prototype.mouseupWindow=function(n,a){var o=this;if(this._active&&0===n.button){var l=this._startPos,d=a;if(this.reset(),Mt.suppressClick(),l.x!==d.x||l.y!==d.y)return this._map.fire(new c.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(_){return _.fitScreenCoordinates(l,d,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Ni.prototype.keydown=function(n){this._active&&27===n.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Ni.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(Mt.remove(this._box),this._box=null),Mt.enableDrag(),delete this._startPos,delete this._lastPos},Ni.prototype._fireEvent=function(n,a){return this._map.fire(new c.Event(n,{originalEvent:a}))};var to=function(n){this.reset(),this.numTouches=n.numTouches};to.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},to.prototype.touchstart=function(n,a,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(l){for(var d=new c.Point(0,0),_=0,g=l;_<g.length;_+=1)d._add(g[_]);return d.div(l.length)}(a),this.touches=Qr(o,a)))},to.prototype.touchmove=function(n,a,o){if(!this.aborted&&this.centroid){var l=Qr(o,a);for(var d in this.touches){var _=l[d];(!_||_.dist(this.touches[d])>30)&&(this.aborted=!0)}}},to.prototype.touchend=function(n,a,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),0===o.length){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var yn=function(n){this.singleTap=new to(n),this.numTaps=n.numTaps,this.reset()};yn.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},yn.prototype.touchstart=function(n,a,o){this.singleTap.touchstart(n,a,o)},yn.prototype.touchmove=function(n,a,o){this.singleTap.touchmove(n,a,o)},yn.prototype.touchend=function(n,a,o){var l=this.singleTap.touchend(n,a,o);if(l){var d=n.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(l)<30;if(d&&_||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var gn=function(){this._zoomIn=new yn({numTouches:1,numTaps:2}),this._zoomOut=new yn({numTouches:2,numTaps:1}),this.reset()};gn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},gn.prototype.touchstart=function(n,a,o){this._zoomIn.touchstart(n,a,o),this._zoomOut.touchstart(n,a,o)},gn.prototype.touchmove=function(n,a,o){this._zoomIn.touchmove(n,a,o),this._zoomOut.touchmove(n,a,o)},gn.prototype.touchend=function(n,a,o){var l=this,d=this._zoomIn.touchend(n,a,o),_=this._zoomOut.touchend(n,a,o);return d?(this._active=!0,n.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(g){return g.easeTo({duration:300,zoom:g.getZoom()+1,around:g.unproject(d)},{originalEvent:n})}}):_?(this._active=!0,n.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(g){return g.easeTo({duration:300,zoom:g.getZoom()-1,around:g.unproject(_)},{originalEvent:n})}}):void 0},gn.prototype.touchcancel=function(){this.reset()},gn.prototype.enable=function(){this._enabled=!0},gn.prototype.disable=function(){this._enabled=!1,this.reset()},gn.prototype.isEnabled=function(){return this._enabled},gn.prototype.isActive=function(){return this._active};var Fr={0:1,2:2},Vt=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};Vt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Vt.prototype._correctButton=function(n,a){return!1},Vt.prototype._move=function(n,a){return{}},Vt.prototype.mousedown=function(n,a){if(!this._lastPoint){var o=Mt.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=a,this._eventButton=o)}},Vt.prototype.mousemoveWindow=function(n,a){var l,_,o=this._lastPoint;if(o)if(n.preventDefault(),_=Fr[this._eventButton],void 0===(l=n).buttons||(l.buttons&_)!==_)this.reset();else if(this._moved||!(a.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(o,a)},Vt.prototype.mouseupWindow=function(n){this._lastPoint&&Mt.mouseButton(n)===this._eventButton&&(this._moved&&Mt.suppressClick(),this.reset())},Vt.prototype.enable=function(){this._enabled=!0},Vt.prototype.disable=function(){this._enabled=!1,this.reset()},Vt.prototype.isEnabled=function(){return this._enabled},Vt.prototype.isActive=function(){return this._active};var Uo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.mousedown=function(o,l){n.prototype.mousedown.call(this,o,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(o,l){return 0===l&&!o.ctrlKey},a.prototype._move=function(o,l){return{around:l,panDelta:l.sub(o)}},a}(Vt),Co=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,l){return 0===l&&o.ctrlKey||2===l},a.prototype._move=function(o,l){var d=.8*(l.x-o.x);if(d)return this._active=!0,{bearingDelta:d}},a.prototype.contextmenu=function(o){o.preventDefault()},a}(Vt),Ra=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,l){return 0===l&&o.ctrlKey||2===l},a.prototype._move=function(o,l){var d=-.5*(l.y-o.y);if(d)return this._active=!0,{pitchDelta:d}},a.prototype.contextmenu=function(o){o.preventDefault()},a}(Vt),Yi=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};Yi.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new c.Point(0,0)},Yi.prototype.touchstart=function(n,a,o){return this._calculateTransform(n,a,o)},Yi.prototype.touchmove=function(n,a,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,a,o)},Yi.prototype.touchend=function(n,a,o){this._calculateTransform(n,a,o),this._active&&o.length<this._minTouches&&this.reset()},Yi.prototype.touchcancel=function(){this.reset()},Yi.prototype._calculateTransform=function(n,a,o){o.length>0&&(this._active=!0);var l=Qr(o,a),d=new c.Point(0,0),_=new c.Point(0,0),g=0;for(var w in l){var I=l[w],M=this._touches[w];M&&(d._add(I),_._add(I.sub(M)),g++,l[w]=I)}if(this._touches=l,!(g<this._minTouches)&&_.mag()){var N=_.div(g);if(this._sum._add(N),!(this._sum.mag()<this._clickTolerance))return{around:d.div(g),panDelta:N}}},Yi.prototype.enable=function(){this._enabled=!0},Yi.prototype.disable=function(){this._enabled=!1,this.reset()},Yi.prototype.isEnabled=function(){return this._enabled},Yi.prototype.isActive=function(){return this._active};var fi=function(){this.reset()};function Er(n,a,o){for(var l=0;l<n.length;l++)if(n[l].identifier===o)return a[l]}function ho(n,a){return Math.log(n/a)/Math.LN2}fi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},fi.prototype._start=function(n){},fi.prototype._move=function(n,a,o){return{}},fi.prototype.touchstart=function(n,a,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([a[0],a[1]]))},fi.prototype.touchmove=function(n,a,o){if(this._firstTwoTouches){n.preventDefault();var l=this._firstTwoTouches,d=l[1],_=Er(o,a,l[0]),g=Er(o,a,d);if(_&&g){var w=this._aroundCenter?null:_.add(g).div(2);return this._move([_,g],w,n)}}},fi.prototype.touchend=function(n,a,o){if(this._firstTwoTouches){var l=this._firstTwoTouches,d=l[1],_=Er(o,a,l[0]),g=Er(o,a,d);_&&g||(this._active&&Mt.suppressClick(),this.reset())}},fi.prototype.touchcancel=function(){this.reset()},fi.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&"center"===n.around},fi.prototype.disable=function(){this._enabled=!1,this.reset()},fi.prototype.isEnabled=function(){return this._enabled},fi.prototype.isActive=function(){return this._active};var Jn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},a.prototype._move=function(o,l){var d=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(ho(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ho(this._distance,d),pinchAround:l}},a}(fi);function No(n,a){return 180*n.angleWith(a)/Math.PI}var tl=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},a.prototype._move=function(o,l){var d=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:No(this._vector,d),pinchAround:l}},a.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var l=25/(Math.PI*this._minDiameter)*360,d=No(o,this._startVector);return Math.abs(d)<l},a}(fi);function cs(n){return Math.abs(n.y)>Math.abs(n.x)}var ps=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(o){this._lastPoints=o,cs(o[0].sub(o[1]))&&(this._valid=!1)},a.prototype._move=function(o,l,d){var _=o[0].sub(this._lastPoints[0]),g=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(_,g,d.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(_.y+g.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(o,l,d){if(void 0!==this._valid)return this._valid;var _=o.mag()>=2,g=l.mag()>=2;if(_||g){if(!_||!g)return void 0===this._firstMove&&(this._firstMove=d),d-this._firstMove<100&&void 0;var w=o.y>0==l.y>0;return cs(o)&&cs(l)&&w}},a}(fi),el={panStep:100,bearingStep:15,pitchStep:10},ha=function(){var n=el;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function co(n){return n*(2-n)}ha.prototype.reset=function(){this._active=!1},ha.prototype.keydown=function(n){var a=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,l=0,d=0,_=0,g=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?l=-1:(n.preventDefault(),_=-1);break;case 39:n.shiftKey?l=1:(n.preventDefault(),_=1);break;case 38:n.shiftKey?d=1:(n.preventDefault(),g=-1);break;case 40:n.shiftKey?d=-1:(n.preventDefault(),g=1);break;default:return}return this._rotationDisabled&&(l=0,d=0),{cameraAnimation:function(w){var I=w.getZoom();w.easeTo({duration:300,easeId:"keyboardHandler",easing:co,zoom:o?Math.round(I)+o*(n.shiftKey?2:1):I,bearing:w.getBearing()+l*a._bearingStep,pitch:w.getPitch()+d*a._pitchStep,offset:[-_*a._panStep,-g*a._panStep],center:w.getCenter()},{originalEvent:n})}}}},ha.prototype.enable=function(){this._enabled=!0},ha.prototype.disable=function(){this._enabled=!1,this.reset()},ha.prototype.isEnabled=function(){return this._enabled},ha.prototype.isActive=function(){return this._active},ha.prototype.disableRotation=function(){this._rotationDisabled=!0},ha.prototype.enableRotation=function(){this._rotationDisabled=!1};var oi=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,c.bindAll(["_onTimeout"],this)};oi.prototype.setZoomRate=function(n){this._defaultZoomRate=n},oi.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},oi.prototype.isEnabled=function(){return!!this._enabled},oi.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},oi.prototype.isZooming=function(){return!!this._zooming},oi.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&"center"===n.around)},oi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},oi.prototype.wheel=function(n){if(this.isEnabled()){var a=n.deltaMode===c.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=c.browser.now(),l=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,0!==a&&a%4.000244140625==0?this._type="wheel":0!==a&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}},oi.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},oi.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=Mt.mousePos(this._el,n);this._around=c.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},oi.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(0!==this._delta){var o="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&0!==l&&(l=1/l);var d="number"==typeof this._targetZoom?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(d*l))),"wheel"===this._type&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var _,g="number"==typeof this._targetZoom?this._targetZoom:a.zoom,w=this._startZoom,I=this._easing,M=!1;if("wheel"===this._type&&w&&I){var N=Math.min((c.browser.now()-this._lastWheelEventTime)/200,1),Z=I(N);_=c.number(w,g,Z),N<1?this._frameId||(this._frameId=!0):M=!0}else _=g,M=!0;return this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!M,zoomDelta:_-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},oi.prototype._smoothOutEasing=function(n){var a=c.ease;if(this._prevEase){var o=this._prevEase,l=(c.browser.now()-o.start)/o.duration,d=o.easing(l+.01)-o.easing(l),_=.27/Math.sqrt(d*d+1e-4)*.01,g=Math.sqrt(.0729-_*_);a=c.bezier(_,g,.25,1)}return this._prevEase={start:c.browser.now(),duration:n,easing:a},a},oi.prototype.reset=function(){this._active=!1};var Qo=function(n,a){this._clickZoom=n,this._tapZoom=a};Qo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Qo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Qo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Qo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ta=function(){this.reset()};ta.prototype.reset=function(){this._active=!1},ta.prototype.dblclick=function(n,a){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(a)},{originalEvent:n})}}},ta.prototype.enable=function(){this._enabled=!0},ta.prototype.disable=function(){this._enabled=!1,this.reset()},ta.prototype.isEnabled=function(){return this._enabled},ta.prototype.isActive=function(){return this._active};var fr=function(){this._tap=new yn({numTouches:1,numTaps:1}),this.reset()};fr.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},fr.prototype.touchstart=function(n,a,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=a[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,a,o))},fr.prototype.touchmove=function(n,a,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var l=a[0],d=l.y-this._swipePoint.y;return this._swipePoint=l,n.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(n,a,o)},fr.prototype.touchend=function(n,a,o){this._tapTime?this._swipePoint&&0===o.length&&this.reset():this._tap.touchend(n,a,o)&&(this._tapTime=n.timeStamp)},fr.prototype.touchcancel=function(){this.reset()},fr.prototype.enable=function(){this._enabled=!0},fr.prototype.disable=function(){this._enabled=!1,this.reset()},fr.prototype.isEnabled=function(){return this._enabled},fr.prototype.isActive=function(){return this._active};var Fa=function(n,a,o){this._el=n,this._mousePan=a,this._touchPan=o};Fa.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Fa.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Fa.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Fa.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ua=function(n,a,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=o};Ua.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ua.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ua.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ua.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ea=function(n,a,o,l){this._el=n,this._touchZoom=a,this._touchRotate=o,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0};ea.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ea.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ea.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ea.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ea.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ea.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var jn=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Na=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a}(c.Event);function me(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var ce=function(n,a){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xi(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),c.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[c.window.document,"mousemove",{capture:!0}],[c.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[c.window,"blur",void 0]];for(var l=0,d=this._listeners;l<d.length;l+=1){var _=d[l],g=_[0];Mt.addEventListener(g,_[1],g===c.window.document?this.handleWindowEvent:this.handleEvent,_[2])}};ce.prototype.destroy=function(){for(var n=0,a=this._listeners;n<a.length;n+=1){var o=a[n],l=o[0];Mt.removeEventListener(l,o[1],l===c.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},ce.prototype._addDefaultHandlers=function(n){var a=this._map,o=a.getCanvasContainer();this._add("mapEvent",new We(a,n));var l=a.boxZoom=new Ni(a,n);this._add("boxZoom",l);var d=new gn,_=new ta;a.doubleClickZoom=new Qo(_,d),this._add("tapZoom",d),this._add("clickZoom",_);var g=new fr;this._add("tapDragZoom",g);var w=a.touchPitch=new ps;this._add("touchPitch",w);var I=new Co(n),M=new Ra(n);a.dragRotate=new Ua(n,I,M),this._add("mouseRotate",I,["mousePitch"]),this._add("mousePitch",M,["mouseRotate"]);var N=new Uo(n),Z=new Yi(n);a.dragPan=new Fa(o,N,Z),this._add("mousePan",N),this._add("touchPan",Z,["touchZoom","touchRotate"]);var q=new tl,Q=new Jn;a.touchZoomRotate=new ea(o,Q,q,g),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",Q,["touchPan","touchRotate"]);var $=a.scrollZoom=new oi(a,this);this._add("scrollZoom",$,["mousePan"]);var ot=a.keyboard=new ha;this._add("keyboard",ot),this._add("blockableMapEvent",new Zt(a));for(var K=0,rt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];K<rt.length;K+=1){var lt=rt[K];n.interactive&&n[lt]&&a[lt].enable(n[lt])}},ce.prototype._add=function(n,a,o){this._handlers.push({handlerName:n,handler:a,allowed:o}),this._handlersById[n]=a},ce.prototype.stop=function(n){if(!this._updatingCamera){for(var a=0,o=this._handlers;a<o.length;a+=1)o[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},ce.prototype.isActive=function(){for(var n=0,a=this._handlers;n<a.length;n+=1)if(a[n].handler.isActive())return!0;return!1},ce.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},ce.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},ce.prototype.isMoving=function(){return Boolean(jn(this._eventsInProgress))||this.isZooming()},ce.prototype._blockedByActive=function(n,a,o){for(var l in n)if(l!==o&&(!a||a.indexOf(l)<0))return!0;return!1},ce.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},ce.prototype._getMapTouches=function(n){for(var a=[],o=0,l=n;o<l.length;o+=1){var d=l[o];this._el.contains(d.target)&&a.push(d)}return a},ce.prototype.handleEvent=function(n,a){if("blur"!==n.type){this._updatingCamera=!0;for(var o="renderFrame"===n.type?void 0:n,l={needsRenderFrame:!1},d={},_={},g=n.touches?this._getMapTouches(n.touches):void 0,w=g?Mt.touchPos(this._el,g):Mt.mousePos(this._el,n),I=0,M=this._handlers;I<M.length;I+=1){var N=M[I],Z=N.handlerName,q=N.handler,Q=N.allowed;if(q.isEnabled()){var $=void 0;this._blockedByActive(_,Q,Z)?q.reset():q[a||n.type]&&($=q[a||n.type](n,w,g),this.mergeHandlerResult(l,d,$,Z,o),$&&$.needsRenderFrame&&this._triggerRenderFrame()),($||q.isActive())&&(_[Z]=q)}}var ot={};for(var K in this._previousActiveHandlers)_[K]||(ot[K]=o);this._previousActiveHandlers=_,(Object.keys(ot).length||me(l))&&(this._changes.push([l,d,ot]),this._triggerRenderFrame()),(Object.keys(_).length||me(l))&&this._map._stop(!0),this._updatingCamera=!1;var rt=l.cameraAnimation;rt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],rt(this._map))}else this.stop(!0)},ce.prototype.mergeHandlerResult=function(n,a,o,l,d){if(o){c.extend(n,o);var _={handlerName:l,originalEvent:o.originalEvent||d};void 0!==o.zoomDelta&&(a.zoom=_),void 0!==o.panDelta&&(a.drag=_),void 0!==o.pitchDelta&&(a.pitch=_),void 0!==o.bearingDelta&&(a.rotate=_)}},ce.prototype._applyChanges=function(){for(var n={},a={},o={},l=0,d=this._changes;l<d.length;l+=1){var _=d[l],g=_[0],w=_[1],I=_[2];g.panDelta&&(n.panDelta=(n.panDelta||new c.Point(0,0))._add(g.panDelta)),g.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+g.pitchDelta),void 0!==g.around&&(n.around=g.around),void 0!==g.pinchAround&&(n.pinchAround=g.pinchAround),g.noInertia&&(n.noInertia=g.noInertia),c.extend(a,w),c.extend(o,I)}this._updateMapTransform(n,a,o),this._changes=[]},ce.prototype._updateMapTransform=function(n,a,o){var l=this._map,d=l.transform;if(!me(n))return this._fireEvents(a,o,!0);var _=n.panDelta,g=n.zoomDelta,w=n.bearingDelta,I=n.pitchDelta,M=n.around,N=n.pinchAround;void 0!==N&&(M=N),l._stop(!0),M=M||l.transform.centerPoint;var Z=d.pointLocation(_?M.sub(_):M);w&&(d.bearing+=w),I&&(d.pitch+=I),g&&(d.zoom+=g),d.setLocationAtPoint(Z,M),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,o,!0)},ce.prototype._fireEvents=function(n,a,o){var l=this,d=jn(this._eventsInProgress),_=jn(n),g={};for(var w in n)this._eventsInProgress[w]||(g[w+"start"]=n[w].originalEvent),this._eventsInProgress[w]=n[w];for(var I in!d&&_&&this._fireEvent("movestart",_.originalEvent),g)this._fireEvent(I,g[I]);for(var M in _&&this._fireEvent("move",_.originalEvent),n)this._fireEvent(M,n[M].originalEvent);var N,Z={};for(var q in this._eventsInProgress){var Q=this._eventsInProgress[q],$=Q.handlerName,ot=Q.originalEvent;this._handlersById[$].isActive()||(delete this._eventsInProgress[q],Z[q+"end"]=N=a[$]||ot)}for(var K in Z)this._fireEvent(K,Z[K]);var rt=jn(this._eventsInProgress);if(o&&(d||_)&&!rt){this._updatingCamera=!0;var lt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),yt=function(Et){return 0!==Et&&-l._bearingSnap<Et&&Et<l._bearingSnap};lt?(yt(lt.bearing||this._map.getBearing())&&(lt.bearing=0),this._map.easeTo(lt,{originalEvent:N})):(this._map.fire(new c.Event("moveend",{originalEvent:N})),yt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},ce.prototype._fireEvent=function(n,a){this._map.fire(new c.Event(n,a?{originalEvent:a}:{}))},ce.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete n._frameId,n.handleEvent(new Na("renderFrame",{timeStamp:a})),n._applyChanges()})},ce.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var ds=function(n){function a(o,l){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=l.bearingSnap,c.bindAll(["_renderFrameCallback"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getCenter=function(){return new c.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(o,l){return this.jumpTo({center:o},l)},a.prototype.panBy=function(o,l,d){return o=c.Point.convert(o).mult(-1),this.panTo(this.transform.center,c.extend({offset:o},l),d)},a.prototype.panTo=function(o,l,d){return this.easeTo(c.extend({center:o},l),d)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(o,l){return this.jumpTo({zoom:o},l),this},a.prototype.zoomTo=function(o,l,d){return this.easeTo(c.extend({zoom:o},l),d)},a.prototype.zoomIn=function(o,l){return this.zoomTo(this.getZoom()+1,o,l),this},a.prototype.zoomOut=function(o,l){return this.zoomTo(this.getZoom()-1,o,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(o,l){return this.jumpTo({bearing:o},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(o,l){return this.jumpTo({padding:o},l),this},a.prototype.rotateTo=function(o,l,d){return this.easeTo(c.extend({bearing:o},l),d)},a.prototype.resetNorth=function(o,l){return this.rotateTo(0,c.extend({duration:1e3},o),l),this},a.prototype.resetNorthPitch=function(o,l){return this.easeTo(c.extend({bearing:0,pitch:0,duration:1e3},o),l),this},a.prototype.snapToNorth=function(o,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(o,l){return this.jumpTo({pitch:o},l),this},a.prototype.cameraForBounds=function(o,l){o=c.LngLatBounds.convert(o);var d=l&&l.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),d,l)},a.prototype._cameraForBoxAndBearing=function(o,l,d,_){var g={top:0,bottom:0,right:0,left:0};if("number"==typeof(_=c.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding){var w=_.padding;_.padding={top:w,bottom:w,right:w,left:w}}_.padding=c.extend(g,_.padding);var I=this.transform,M=I.padding,N=I.project(c.LngLat.convert(o)),Z=I.project(c.LngLat.convert(l)),q=N.rotate(-d*Math.PI/180),Q=Z.rotate(-d*Math.PI/180),$=new c.Point(Math.max(q.x,Q.x),Math.max(q.y,Q.y)),ot=new c.Point(Math.min(q.x,Q.x),Math.min(q.y,Q.y)),K=$.sub(ot),rt=(I.width-(M.left+M.right+_.padding.left+_.padding.right))/K.x,lt=(I.height-(M.top+M.bottom+_.padding.top+_.padding.bottom))/K.y;if(!(lt<0||rt<0)){var yt=Math.min(I.scaleZoom(I.scale*Math.min(rt,lt)),_.maxZoom),Et="number"==typeof _.offset.x?new c.Point(_.offset.x,_.offset.y):c.Point.convert(_.offset),Tt=new c.Point((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(d*Math.PI/180),It=Et.add(Tt).mult(I.scale/I.zoomScale(yt));return{center:I.unproject(N.add(Z).div(2).sub(It)),zoom:yt,bearing:d}}c.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(o,l,d){return this._fitInternal(this.cameraForBounds(o,l),l,d)},a.prototype.fitScreenCoordinates=function(o,l,d,_,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.Point.convert(o)),this.transform.pointLocation(c.Point.convert(l)),d,_),_,g)},a.prototype._fitInternal=function(o,l,d){return o?(delete(l=c.extend(o,l)).padding,l.linear?this.easeTo(l,d):this.flyTo(l,d)):this},a.prototype.jumpTo=function(o,l){this.stop();var d=this.transform,_=!1,g=!1,w=!1;return"zoom"in o&&d.zoom!==+o.zoom&&(_=!0,d.zoom=+o.zoom),void 0!==o.center&&(d.center=c.LngLat.convert(o.center)),"bearing"in o&&d.bearing!==+o.bearing&&(g=!0,d.bearing=+o.bearing),"pitch"in o&&d.pitch!==+o.pitch&&(w=!0,d.pitch=+o.pitch),null==o.padding||d.isPaddingEqual(o.padding)||(d.padding=o.padding),this.fire(new c.Event("movestart",l)).fire(new c.Event("move",l)),_&&this.fire(new c.Event("zoomstart",l)).fire(new c.Event("zoom",l)).fire(new c.Event("zoomend",l)),g&&this.fire(new c.Event("rotatestart",l)).fire(new c.Event("rotate",l)).fire(new c.Event("rotateend",l)),w&&this.fire(new c.Event("pitchstart",l)).fire(new c.Event("pitch",l)).fire(new c.Event("pitchend",l)),this.fire(new c.Event("moveend",l))},a.prototype.easeTo=function(o,l){var d=this;this._stop(!1,o.easeId),(!1===(o=c.extend({offset:[0,0],duration:500,easing:c.ease},o)).animate||!o.essential&&c.browser.prefersReducedMotion)&&(o.duration=0);var _=this.transform,g=this.getZoom(),w=this.getBearing(),I=this.getPitch(),M=this.getPadding(),N="zoom"in o?+o.zoom:g,Z="bearing"in o?this._normalizeBearing(o.bearing,w):w,q="pitch"in o?+o.pitch:I,Q="padding"in o?o.padding:_.padding,$=c.Point.convert(o.offset),ot=_.centerPoint.add($),K=_.pointLocation(ot),rt=c.LngLat.convert(o.center||K);this._normalizeCenter(rt);var lt,yt,Et=_.project(K),Tt=_.project(rt).sub(Et),It=_.zoomScale(N-g);o.around&&(lt=c.LngLat.convert(o.around),yt=_.locationPoint(lt));var Ot={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||N!==g,this._rotating=this._rotating||w!==Z,this._pitching=this._pitching||q!==I,this._padding=!_.isPaddingEqual(Q),this._easeId=o.easeId,this._prepareEase(l,o.noMoveStart,Ot),this._ease(function(Xt){if(d._zooming&&(_.zoom=c.number(g,N,Xt)),d._rotating&&(_.bearing=c.number(w,Z,Xt)),d._pitching&&(_.pitch=c.number(I,q,Xt)),d._padding&&(_.interpolatePadding(M,Q,Xt),ot=_.centerPoint.add($)),lt)_.setLocationAtPoint(lt,yt);else{var Wt=_.zoomScale(_.zoom-g),se=N>g?Math.min(2,It):Math.max(.5,It),ge=Math.pow(se,1-Xt),we=_.unproject(Et.add(Tt.mult(Xt*ge)).mult(Wt));_.setLocationAtPoint(_.renderWorldCopies?we.wrap():we,ot)}d._fireMoveEvents(l)},function(Xt){d._afterEase(l,Xt)},o),this},a.prototype._prepareEase=function(o,l,d){void 0===d&&(d={}),this._moving=!0,l||d.moving||this.fire(new c.Event("movestart",o)),this._zooming&&!d.zooming&&this.fire(new c.Event("zoomstart",o)),this._rotating&&!d.rotating&&this.fire(new c.Event("rotatestart",o)),this._pitching&&!d.pitching&&this.fire(new c.Event("pitchstart",o))},a.prototype._fireMoveEvents=function(o){this.fire(new c.Event("move",o)),this._zooming&&this.fire(new c.Event("zoom",o)),this._rotating&&this.fire(new c.Event("rotate",o)),this._pitching&&this.fire(new c.Event("pitch",o))},a.prototype._afterEase=function(o,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var d=this._zooming,_=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new c.Event("zoomend",o)),_&&this.fire(new c.Event("rotateend",o)),g&&this.fire(new c.Event("pitchend",o)),this.fire(new c.Event("moveend",o))}},a.prototype.flyTo=function(o,l){var d=this;if(!o.essential&&c.browser.prefersReducedMotion){var _=c.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_,l)}this.stop(),o=c.extend({offset:[0,0],speed:1.2,curve:1.42,easing:c.ease},o);var g=this.transform,w=this.getZoom(),I=this.getBearing(),M=this.getPitch(),N=this.getPadding(),Z="zoom"in o?c.clamp(+o.zoom,g.minZoom,g.maxZoom):w,q="bearing"in o?this._normalizeBearing(o.bearing,I):I,Q="pitch"in o?+o.pitch:M,$="padding"in o?o.padding:g.padding,ot=g.zoomScale(Z-w),K=c.Point.convert(o.offset),rt=g.centerPoint.add(K),lt=g.pointLocation(rt),yt=c.LngLat.convert(o.center||lt);this._normalizeCenter(yt);var Et=g.project(lt),Tt=g.project(yt).sub(Et),It=o.curve,Ot=Math.max(g.width,g.height),Xt=Ot/ot,Wt=Tt.mag();if("minZoom"in o){var se=c.clamp(Math.min(o.minZoom,w,Z),g.minZoom,g.maxZoom),ge=Ot/g.zoomScale(se-w);It=Math.sqrt(ge/Wt*2)}var we=It*It;function be(Le){var Pe=(Xt*Xt-Ot*Ot+(Le?-1:1)*we*we*Wt*Wt)/(2*(Le?Xt:Ot)*we*Wt);return Math.log(Math.sqrt(Pe*Pe+1)-Pe)}function xi(Le){return(Math.exp(Le)-Math.exp(-Le))/2}function he(Le){return(Math.exp(Le)+Math.exp(-Le))/2}var Fe=be(0),$e=function(Le){return he(Fe)/he(Fe+It*Le)},De=function(Le){return Ot*((he(Fe)*(xi(Pe=Fe+It*Le)/he(Pe))-xi(Fe))/we)/Wt;var Pe},ke=(be(1)-Fe)/It;if(Math.abs(Wt)<1e-6||!isFinite(ke)){if(Math.abs(Ot-Xt)<1e-6)return this.easeTo(o,l);var Xe=Xt<Ot?-1:1;ke=Math.abs(Math.log(Xt/Ot))/It,De=function(){return 0},$e=function(Le){return Math.exp(Xe*It*Le)}}return o.duration="duration"in o?+o.duration:1e3*ke/("screenSpeed"in o?+o.screenSpeed/It:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=I!==q,this._pitching=Q!==M,this._padding=!g.isPaddingEqual($),this._prepareEase(l,!1),this._ease(function(Le){var Pe=Le*ke,Pr=1/$e(Pe);g.zoom=1===Le?Z:w+g.scaleZoom(Pr),d._rotating&&(g.bearing=c.number(I,q,Le)),d._pitching&&(g.pitch=c.number(M,Q,Le)),d._padding&&(g.interpolatePadding(N,$,Le),rt=g.centerPoint.add(K));var Zn=1===Le?yt:g.unproject(Et.add(Tt.mult(De(Pe))).mult(Pr));g.setLocationAtPoint(g.renderWorldCopies?Zn.wrap():Zn,rt),d._fireMoveEvents(l)},function(){return d._afterEase(l)},o),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(o,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,l)}if(!o){var _=this.handlers;_&&_.stop(!1)}return this},a.prototype._ease=function(o,l,d){!1===d.animate||0===d.duration?(o(1),l()):(this._easeStart=c.browser.now(),this._easeOptions=d,this._onEaseFrame=o,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var o=Math.min((c.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(o,l){o=c.wrap(o,-180,180);var d=Math.abs(o-l);return Math.abs(o-360-l)<d&&(o-=360),Math.abs(o+360-l)<d&&(o+=360),o},a.prototype._normalizeCenter=function(o){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var d=o.lng-l.center.lng;o.lng+=d>180?-360:d<-180?360:0}},a}(c.Evented),Ur=function(n){void 0===n&&(n={}),this.options=n,c.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Ur.prototype.getDefaultPosition=function(){return"bottom-right"},Ur.prototype.onAdd=function(n){var a=this.options&&this.options.compact;return this._map=n,this._container=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Mt.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Mt.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===a&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ur.prototype.onRemove=function(){Mt.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ur.prototype._setElementTitle=function(n,a){var o=this._map._getUIString("AttributionControl."+a);n.title=o,n.setAttribute("aria-label",o)},Ur.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Ur.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||c.config.ACCESS_TOKEN}];if(n){var o=a.reduce(function(l,d,_){return d.value&&(l+=d.key+"="+d.value+(_<a.length-1?"&":"")),l},"?");n.href=c.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},Ur.prototype._updateData=function(n){!n||"metadata"!==n.sourceDataType&&"visibility"!==n.sourceDataType&&"style"!==n.dataType||(this._updateAttributions(),this._updateEditLink())},Ur.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(w){return"string"!=typeof w?"":w})):"string"==typeof this.options.customAttribution&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var o=this._map.style.sourceCaches;for(var l in o){var d=o[l];if(d.used){var _=d.getSource();_.attribution&&n.indexOf(_.attribution)<0&&n.push(_.attribution)}}n.sort(function(w,I){return w.length-I.length});var g=(n=n.filter(function(w,I){for(var M=I+1;M<n.length;M++)if(n[M].indexOf(w)>=0)return!1;return!0})).join(" | ");g!==this._attribHTML&&(this._attribHTML=g,n.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ur.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var jo=function(){c.bindAll(["_updateLogo"],this),c.bindAll(["_updateCompact"],this)};jo.prototype.onAdd=function(n){this._map=n,this._container=Mt.create("div","mapboxgl-ctrl");var a=Mt.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},jo.prototype.onRemove=function(){Mt.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},jo.prototype.getDefaultPosition=function(){return"bottom-left"},jo.prototype._updateLogo=function(n){n&&"metadata"!==n.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},jo.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var a in n)if(n[a].getSource().mapbox_logo)return!0;return!1}},jo.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var a=n[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var mr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};mr.prototype.add=function(n){var a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a},mr.prototype.remove=function(n){for(var a=this._currentlyRunning,o=0,l=a?this._queue.concat(a):this._queue;o<l.length;o+=1){var d=l[o];if(d.id===n)return void(d.cancelled=!0)}},mr.prototype.run=function(n){void 0===n&&(n=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,l=a;o<l.length;o+=1){var d=l[o];if(!d.cancelled&&(d.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},mr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ia={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},il=c.window.HTMLImageElement,Zs=c.window.HTMLElement,Si=c.window.ImageBitmap,ar={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Au=function(n){function a(l){var d=this;if(null!=(l=c.extend({},ar,l)).minZoom&&null!=l.maxZoom&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=l.minPitch&&null!=l.maxPitch&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=l.minPitch&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=l.maxPitch&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var _=new Gt(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(n.call(this,_,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new mr,this._controls=[],this._mapId=c.uniqueId(),this._locale=c.extend({},ia,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new c.RequestManager(l.transformRequest,l.accessToken),"string"==typeof l.container){if(this._container=c.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof Zs))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),c.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return d._update(!1)}),this.on("moveend",function(){return d._update(!1)}),this.on("zoom",function(){return d._update(!0)}),void 0!==c.window&&(c.window.addEventListener("online",this._onWindowOnline,!1),c.window.addEventListener("resize",this._onWindowResize,!1),c.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ce(this,l),this._hash=l.hash&&new Ne("string"==typeof l.hash&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Ur({customAttribution:l.customAttribution})),this.addControl(new jo,l.logoPosition),this.on("style.load",function(){d.transform.unmodified&&d.jumpTo(d.style.stylesheet)}),this.on("data",function(g){d._update("style"===g.dataType),d.fire(new c.Event(g.dataType+"data",g))}),this.on("dataloading",function(g){d.fire(new c.Event(g.dataType+"dataloading",g))})}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,d){if(void 0===d&&(d=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var _=l.onAdd(this);this._controls.push(l);var g=this._controlPositions[d];return-1!==d.indexOf("bottom")?g.insertBefore(_,g.firstChild):g.appendChild(_),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var d=this._controls.indexOf(l);return d>-1&&this._controls.splice(d,1),l.onRemove(this),this},a.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},a.prototype.resize=function(l){var d=this._containerDimensions(),_=d[0],g=d[1];this._resizeCanvas(_,g),this.transform.resize(_,g),this.painter.resize(_,g);var w=!this._moving;return w&&(this.stop(),this.fire(new c.Event("movestart",l)).fire(new c.Event("move",l))),this.fire(new c.Event("resize",l)),w&&this.fire(new c.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(c.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l??-2)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l??22)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(c.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(c.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,d,_){var g,w=this;if("mouseenter"===l||"mouseover"===l){var I=!1;return{layer:d,listener:_,delegates:{mousemove:function(N){var Z=w.getLayer(d)?w.queryRenderedFeatures(N.point,{layers:[d]}):[];Z.length?I||(I=!0,_.call(w,new Ee(l,w,N.originalEvent,{features:Z}))):I=!1},mouseout:function(){I=!1}}}}if("mouseleave"===l||"mouseout"===l){var M=!1;return{layer:d,listener:_,delegates:{mousemove:function(N){(w.getLayer(d)?w.queryRenderedFeatures(N.point,{layers:[d]}):[]).length?M=!0:M&&(M=!1,_.call(w,new Ee(l,w,N.originalEvent)))},mouseout:function(N){M&&(M=!1,_.call(w,new Ee(l,w,N.originalEvent)))}}}}return{layer:d,listener:_,delegates:(g={},g[l]=function(N){var Z=w.getLayer(d)?w.queryRenderedFeatures(N.point,{layers:[d]}):[];Z.length&&(N.features=Z,_.call(w,N),delete N.features)},g)}},a.prototype.on=function(l,d,_){if(void 0===_)return n.prototype.on.call(this,l,d);var g=this._createDelegatedListener(l,d,_);for(var w in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(g),g.delegates)this.on(w,g.delegates[w]);return this},a.prototype.once=function(l,d,_){if(void 0===_)return n.prototype.once.call(this,l,d);var g=this._createDelegatedListener(l,d,_);for(var w in g.delegates)this.once(w,g.delegates[w]);return this},a.prototype.off=function(l,d,_){var g=this;return void 0===_?n.prototype.off.call(this,l,d):(this._delegatedListeners&&this._delegatedListeners[l]&&function(w){for(var I=w[l],M=0;M<I.length;M++){var N=I[M];if(N.layer===d&&N.listener===_){for(var Z in N.delegates)g.off(Z,N.delegates[Z]);return I.splice(M,1),g}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,d){if(!this.style)return[];var _;if(void 0!==d||void 0===l||l instanceof c.Point||Array.isArray(l)||(d=l,l=void 0),d=d||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof c.Point||"number"==typeof l[0])_=[c.Point.convert(l)];else{var g=c.Point.convert(l[0]),w=c.Point.convert(l[1]);_=[g,new c.Point(w.x,g.y),w,new c.Point(g.x,w.y),g]}return this.style.queryRenderedFeatures(_,d,this.transform)},a.prototype.querySourceFeatures=function(l,d){return this.style.querySourceFeatures(l,d)},a.prototype.setStyle=function(l,d){return!1!==(d=c.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},d)).diff&&d.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._updateStyle(l,d))},a.prototype._getUIString=function(l){var d=this._locale[l];if(null==d)throw new Error("Missing UI string '"+l+"'");return d},a.prototype._updateStyle=function(l,d){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new or(this,d||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof l?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new or(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,d){var _=this;if("string"==typeof l){var g=this._requestManager.normalizeStyleURL(l),w=this._requestManager.transformRequest(g,c.ResourceType.Style);c.getJSON(w,function(I,M){I?_.fire(new c.ErrorEvent(I)):M&&_._updateDiff(M,d)})}else"object"==typeof l&&this._updateDiff(l,d)},a.prototype._updateDiff=function(l,d){try{this.style.setState(l)&&this._update(!0)}catch(_){c.warnOnce("Unable to perform style diff: "+(_.message||_.error||_)+".  Rebuilding the style from scratch."),this._updateStyle(l,d)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():c.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,d){return this._lazyInitEmptyStyle(),this.style.addSource(l,d),this._update(!0)},a.prototype.isSourceLoaded=function(l){var d=this.style&&this.style.sourceCaches[l];if(void 0!==d)return d.loaded();this.fire(new c.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var d in l){var _=l[d]._tiles;for(var g in _){var w=_[g];if("loaded"!==w.state&&"errored"!==w.state)return!1}}return!0},a.prototype.addSourceType=function(l,d,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,d,_)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,d,_){void 0===_&&(_={});var g=_.pixelRatio;void 0===g&&(g=1);var w=_.sdf;void 0===w&&(w=!1);var I=_.stretchX,M=_.stretchY,N=_.content;if(this._lazyInitEmptyStyle(),d instanceof il||Si&&d instanceof Si){var Z=c.browser.getImageData(d);this.style.addImage(l,{data:new c.RGBAImage({width:Z.width,height:Z.height},Z.data),pixelRatio:g,stretchX:I,stretchY:M,content:N,sdf:w,version:0})}else{if(void 0===d.width||void 0===d.height)return this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var q=d;this.style.addImage(l,{data:new c.RGBAImage({width:d.width,height:d.height},new Uint8Array(d.data)),pixelRatio:g,stretchX:I,stretchY:M,content:N,sdf:w,version:0,userImage:q}),q.onAdd&&q.onAdd(this,l)}},a.prototype.updateImage=function(l,d){var _=this.style.getImage(l);if(!_)return this.fire(new c.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var g=d instanceof il||Si&&d instanceof Si?c.browser.getImageData(d):d,w=g.width,I=g.height,M=g.data;return void 0===w||void 0===I?this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):w!==_.data.width||I!==_.data.height?this.fire(new c.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(_.data.replace(M,!(d instanceof il||Si&&d instanceof Si)),void this.style.updateImage(l,_))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new c.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,d){c.getImage(this._requestManager.transformRequest(l,c.ResourceType.Image),d)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,d){return this._lazyInitEmptyStyle(),this.style.addLayer(l,d),this._update(!0)},a.prototype.moveLayer=function(l,d){return this.style.moveLayer(l,d),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,d,_){return this.style.setLayerZoomRange(l,d,_),this._update(!0)},a.prototype.setFilter=function(l,d,_){return void 0===_&&(_={}),this.style.setFilter(l,d,_),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,d,_,g){return void 0===g&&(g={}),this.style.setPaintProperty(l,d,_,g),this._update(!0)},a.prototype.getPaintProperty=function(l,d){return this.style.getPaintProperty(l,d)},a.prototype.setLayoutProperty=function(l,d,_,g){return void 0===g&&(g={}),this.style.setLayoutProperty(l,d,_,g),this._update(!0)},a.prototype.getLayoutProperty=function(l,d){return this.style.getLayoutProperty(l,d)},a.prototype.setLight=function(l,d){return void 0===d&&(d={}),this._lazyInitEmptyStyle(),this.style.setLight(l,d),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,d){return this.style.setFeatureState(l,d),this._update()},a.prototype.removeFeatureState=function(l,d){return this.style.removeFeatureState(l,d),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,d=0;return this._container&&(l=this._container.clientWidth||400,d=this._container.clientHeight||300),[l,d]},a.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==c.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&c.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=Mt.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var d=this._canvasContainer=Mt.create("div","mapboxgl-canvas-container",l);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=Mt.create("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var _=this._containerDimensions();this._resizeCanvas(_[0],_[1]);var g=this._controlContainer=Mt.create("div","mapboxgl-control-container",l),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(I){w[I]=Mt.create("div","mapboxgl-ctrl-"+I,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(l,d){var _=c.browser.devicePixelRatio||1;this._canvas.width=_*l,this._canvas.height=_*d,this._canvas.style.width=l+"px",this._canvas.style.height=d+"px"},a.prototype._setupPainter=function(){var l=c.extend({},gi.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);d?(this.painter=new wt(d,this.transform),c.webpSupported.testSupport(d)):this.fire(new c.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new c.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new c.Event("webglcontextrestored",{originalEvent:l}))},a.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var d,_=this,g=0,w=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(d=w.createQueryEXT(),w.beginQueryEXT(w.TIME_ELAPSED_EXT,d),g=c.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var I=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var M=this.transform.zoom,N=c.browser.now();this.style.zoomHistory.update(M,N);var Z=new c.EvaluationParameters(M,{now:N,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),q=Z.crossFadingFactor();1===q&&q===this._crossFadingFactor||(I=!0,this._crossFadingFactor=q),this.style.update(Z)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new c.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new c.Event("load"))),this.style&&(this.style.hasTransitions()||I)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Q=c.browser.now()-g;w.endQueryEXT(w.TIME_ELAPSED_EXT,d),setTimeout(function(){var K=w.getQueryObjectEXT(d,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(d),_.fire(new c.Event("gpu-timing-frame",{cpuTime:Q,gpuTime:K}))},50)}if(this.listens("gpu-timing-layer")){var $=this.painter.collectGpuTimers();setTimeout(function(){var K=_.painter.queryGpuTimers($);_.fire(new c.Event("gpu-timing-layer",{layerTimes:K}))},50)}var ot=this._sourcesDirty||this._styleDirty||this._placementDirty;return ot||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.Event("idle")),!this._loaded||this._fullyLoaded||ot||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,d=this._controls;l<d.length;l+=1)d[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==c.window&&(c.window.removeEventListener("resize",this._onWindowResize,!1),c.window.removeEventListener("orientationchange",this._onWindowResize,!1),c.window.removeEventListener("online",this._onWindowOnline,!1));var _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),Ls(this._canvasContainer),Ls(this._controlContainer),Ls(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new c.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=c.browser.frame(function(d){l._frame=null,l._render(d)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,d){c.setCacheLimits(l,d)},o.version.get=function(){return c.version},Object.defineProperties(a.prototype,o),a}(ds);function Ls(n){n.parentNode&&n.parentNode.removeChild(n)}var Yl={showCompass:!0,showZoom:!0,visualizePitch:!1},es=function(n){var a=this;this.options=c.extend({},Yl,n),this._container=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(c.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return a._map.zoomIn({},{originalEvent:o})}),Mt.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return a._map.zoomOut({},{originalEvent:o})}),Mt.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(c.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){a.options.visualizePitch?a._map.resetNorthPitch({},{originalEvent:o}):a._map.resetNorth({},{originalEvent:o})}),this._compassIcon=Mt.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};es.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),a=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},es.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},es.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Zo(this._map,this._compass,this.options.visualizePitch)),this._container},es.prototype.onRemove=function(){Mt.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},es.prototype._createButton=function(n,a){var o=Mt.create("button",n,this._container);return o.type="button",o.addEventListener("click",a),o},es.prototype._setButtonTitle=function(n,a){var o=this._map._getUIString("NavigationControl."+a);n.title=o,n.setAttribute("aria-label",o)};var Zo=function(n,a,o){void 0===o&&(o=!1),this._clickTolerance=10,this.element=a,this.mouseRotate=new Co({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new Ra({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),c.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Mt.addEventListener(a,"mousedown",this.mousedown),Mt.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),Mt.addEventListener(a,"touchmove",this.touchmove),Mt.addEventListener(a,"touchend",this.touchend),Mt.addEventListener(a,"touchcancel",this.reset)};function Vs(n,a,o){if(n=new c.LngLat(n.lng,n.lat),a){var l=new c.LngLat(n.lng-360,n.lat),d=new c.LngLat(n.lng+360,n.lat),_=o.locationPoint(n).distSqr(a);o.locationPoint(l).distSqr(a)<_?n=l:o.locationPoint(d).distSqr(a)<_&&(n=d)}for(;Math.abs(n.lng-o.center.lng)>180;){var g=o.locationPoint(n);if(g.x>=0&&g.y>=0&&g.x<=o.width&&g.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}Zo.prototype.down=function(n,a){this.mouseRotate.mousedown(n,a),this.mousePitch&&this.mousePitch.mousedown(n,a),Mt.disableDrag()},Zo.prototype.move=function(n,a){var o=this.map,l=this.mouseRotate.mousemoveWindow(n,a);if(l&&l.bearingDelta&&o.setBearing(o.getBearing()+l.bearingDelta),this.mousePitch){var d=this.mousePitch.mousemoveWindow(n,a);d&&d.pitchDelta&&o.setPitch(o.getPitch()+d.pitchDelta)}},Zo.prototype.off=function(){var n=this.element;Mt.removeEventListener(n,"mousedown",this.mousedown),Mt.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),Mt.removeEventListener(n,"touchmove",this.touchmove),Mt.removeEventListener(n,"touchend",this.touchend),Mt.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Zo.prototype.offTemp=function(){Mt.enableDrag(),Mt.removeEventListener(c.window,"mousemove",this.mousemove),Mt.removeEventListener(c.window,"mouseup",this.mouseup)},Zo.prototype.mousedown=function(n){this.down(c.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),Mt.mousePos(this.element,n)),Mt.addEventListener(c.window,"mousemove",this.mousemove),Mt.addEventListener(c.window,"mouseup",this.mouseup)},Zo.prototype.mousemove=function(n){this.move(n,Mt.mousePos(this.element,n))},Zo.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Zo.prototype.touchstart=function(n){1!==n.targetTouches.length?this.reset():(this._startPos=this._lastPos=Mt.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Zo.prototype.touchmove=function(n){1!==n.targetTouches.length?this.reset():(this._lastPos=Mt.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Zo.prototype.touchend=function(n){0===n.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Zo.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ja={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xl(n,a,o){var l=n.classList;for(var d in ja)l.remove("mapboxgl-"+o+"-anchor-"+d);l.add("mapboxgl-"+o+"-anchor-"+a)}var qs,nl=function(n){function a(o,l){if(n.call(this),(o instanceof c.window.HTMLElement||l)&&(o=c.extend({element:o},l)),c.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=c.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=Mt.create("div"),this._element.setAttribute("aria-label","Map marker");var d=Mt.createNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height","41px"),d.setAttributeNS(null,"width","27px"),d.setAttributeNS(null,"viewBox","0 0 27 41");var _=Mt.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");var g=Mt.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"fill-rule","nonzero");var w=Mt.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");for(var I=0,M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];I<M.length;I+=1){var N=M[I],Z=Mt.createNS("http://www.w3.org/2000/svg","ellipse");Z.setAttributeNS(null,"opacity","0.04"),Z.setAttributeNS(null,"cx","10.5"),Z.setAttributeNS(null,"cy","5.80029008"),Z.setAttributeNS(null,"rx",N.rx),Z.setAttributeNS(null,"ry",N.ry),w.appendChild(Z)}var q=Mt.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"fill",this._color);var Q=Mt.createNS("http://www.w3.org/2000/svg","path");Q.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),q.appendChild(Q);var $=Mt.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");var ot=Mt.createNS("http://www.w3.org/2000/svg","path");ot.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(ot);var K=Mt.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(6.0, 7.0)"),K.setAttributeNS(null,"fill","#FFFFFF");var rt=Mt.createNS("http://www.w3.org/2000/svg","g");rt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var lt=Mt.createNS("http://www.w3.org/2000/svg","circle");lt.setAttributeNS(null,"fill","#000000"),lt.setAttributeNS(null,"opacity","0.25"),lt.setAttributeNS(null,"cx","5.5"),lt.setAttributeNS(null,"cy","5.5"),lt.setAttributeNS(null,"r","5.4999962");var yt=Mt.createNS("http://www.w3.org/2000/svg","circle");yt.setAttributeNS(null,"fill","#FFFFFF"),yt.setAttributeNS(null,"cx","5.5"),yt.setAttributeNS(null,"cy","5.5"),yt.setAttributeNS(null,"r","5.4999962"),rt.appendChild(lt),rt.appendChild(yt),g.appendChild(w),g.appendChild(q),g.appendChild($),g.appendChild(K),g.appendChild(rt),d.appendChild(g),d.setAttributeNS(null,"height",41*this._scale+"px"),d.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(d),this._offset=c.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Et){Et.preventDefault()}),this._element.addEventListener("mousedown",function(Et){Et.preventDefault()}),xl(this._element,this._anchor,"marker"),this._popup=null}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Mt.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=c.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(o){var l=o.code,d=o.charCode||o.keyCode;"Space"!==l&&"Enter"!==l&&32!==d&&13!==d||this.togglePopup()},a.prototype._onMapClick=function(o){var l=o.originalEvent.target,d=this._element;this._popup&&(l===d||d.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},a.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Vs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?l="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var d="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?d="rotateX(0deg)":"map"===this._pitchAlignment&&(d="rotateX("+this._map.getPitch()+"deg)"),o&&"moveend"!==o.type||(this._pos=this._pos.round()),Mt.setTransform(this._element,ja[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+d+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(o){return this._offset=c.Point.convert(o),this._update(),this},a.prototype._onMove=function(o){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new c.Event("dragstart"))),this.fire(new c.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new c.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(c.Evented),$l={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Gs=0,zs=!1,Ql=function(n){function a(o){n.call(this),this.options=c.extend({},$l,o),c.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){var l;return this._map=o,this._container=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,void 0!==qs?l(qs):void 0!==c.window.navigator.permissions?c.window.navigator.permissions.query({name:"geolocation"}).then(function(d){l(qs="denied"!==d.state)}):l(qs=!!c.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(c.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Mt.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Gs=0,zs=!1},a.prototype._isOutOfMapMaxBounds=function(o){var l=this._map.getMaxBounds(),d=o.coords;return l&&(d.longitude<l.getWest()||d.longitude>l.getEast()||d.latitude<l.getSouth()||d.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new c.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("geolocate",o)),this._finish()}},a.prototype._updateCamera=function(o){var l=new c.LngLat(o.coords.longitude,o.coords.latitude),d=o.coords.accuracy,_=this._map.getBearing(),g=c.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(d),g,{geolocateSource:!0})},a.prototype._updateMarker=function(o){if(o){var l=new c.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,l=this._map.unproject([0,o]),d=this._map.unproject([1,o]),_=l.distanceTo(d),g=Math.ceil(2*this._accuracy/_);this._circleElement.style.width=g+"px",this._circleElement.style.height=g+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&zs)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("error",o)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(o){var l=this;if(this._container.addEventListener("contextmenu",function(g){return g.preventDefault()}),this._geolocateButton=Mt.create("button","mapboxgl-ctrl-geolocate",this._container),Mt.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===o){c.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{var _=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Mt.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new nl(this._dotElement),this._circleElement=Mt.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new nl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(g){g.geolocateSource||"ACTIVE_LOCK"!==l._watchState||g.originalEvent&&"resize"===g.originalEvent.type||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new c.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return c.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Gs--,zs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new c.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Gs>1?(o={maximumAge:6e5,timeout:0},zs=!0):(o=this.options.positionOptions,zs=!1),this._geolocationWatchID=c.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else c.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){c.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(c.Evented),fs={maxWidth:100,unit:"metric"},ms=function(n){this.options=c.extend({},fs,n),c.bindAll(["_onMove","setUnit"],this)};function bl(n,a,o){var l=o&&o.maxWidth||100,d=n._container.clientHeight/2,_=n.unproject([0,d]),g=n.unproject([l,d]),w=_.distanceTo(g);if(o&&"imperial"===o.unit){var I=3.2808*w;I>5280?_s(a,l,I/5280,n._getUIString("ScaleControl.Miles")):_s(a,l,I,n._getUIString("ScaleControl.Feet"))}else o&&"nautical"===o.unit?_s(a,l,w/1852,n._getUIString("ScaleControl.NauticalMiles")):w>=1e3?_s(a,l,w/1e3,n._getUIString("ScaleControl.Kilometers")):_s(a,l,w,n._getUIString("ScaleControl.Meters"))}function _s(n,a,o,l){var d,_,g,I,M,w=(d=o,(_=Math.pow(10,(""+Math.floor(d)).length-1))*(g=(g=d/_)>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:(I=g,M=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10)),Math.round(I*M)/M)));n.style.width=a*(w/o)+"px",n.innerHTML=w+"&nbsp;"+l}ms.prototype.getDefaultPosition=function(){return"bottom-left"},ms.prototype._onMove=function(){bl(this._map,this._container,this.options)},ms.prototype.onAdd=function(n){return this._map=n,this._container=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ms.prototype.onRemove=function(){Mt.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ms.prototype.setUnit=function(n){this.options.unit=n,bl(this._map,this._container,this.options)};var ca=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof c.window.HTMLElement?this._container=n.container:c.warnOnce("Full screen control 'container' must be a DOM element.")),c.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in c.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in c.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in c.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in c.window.document&&(this._fullscreenchange="MSFullscreenChange")};ca.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=Mt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",c.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ca.prototype.onRemove=function(){Mt.remove(this._controlContainer),this._map=null,c.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ca.prototype._checkFullscreenSupport=function(){return!!(c.window.document.fullscreenEnabled||c.window.document.mozFullScreenEnabled||c.window.document.msFullscreenEnabled||c.window.document.webkitFullscreenEnabled)},ca.prototype._setupUI=function(){var n=this._fullscreenButton=Mt.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Mt.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),c.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ca.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},ca.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ca.prototype._isFullscreen=function(){return this._fullscreen},ca.prototype._changeIcon=function(){(c.window.document.fullscreenElement||c.window.document.mozFullScreenElement||c.window.document.webkitFullscreenElement||c.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ca.prototype._onClickFullscreen=function(){this._isFullscreen()?c.window.document.exitFullscreen?c.window.document.exitFullscreen():c.window.document.mozCancelFullScreen?c.window.document.mozCancelFullScreen():c.window.document.msExitFullscreen?c.window.document.msExitFullscreen():c.window.document.webkitCancelFullScreen&&c.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var tu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),eu=function(n){function a(o){n.call(this),this.options=c.extend(Object.create(tu),o),c.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new c.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&Mt.remove(this._content),this._container&&(Mt.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new c.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=c.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(o){return this.setDOMContent(c.window.document.createTextNode(o))},a.prototype.setHTML=function(o){var l,d=c.window.document.createDocumentFragment(),_=c.window.document.createElement("body");for(_.innerHTML=o;l=_.firstChild;)d.appendChild(l);return this.setDOMContent(d)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},a.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Mt.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},a.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},a.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},a.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=Mt.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(o){this._update(o.point)},a.prototype._onMouseMove=function(o){this._update(o.point)},a.prototype._onDrag=function(o){this._update(o.point)},a.prototype._update=function(o){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=Mt.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=Mt.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Z){return l._container.classList.add(Z)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Vs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var d=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),_=this.options.anchor,g=function Z(q){if(q){if("number"==typeof q){var Q=Math.round(Math.sqrt(.5*Math.pow(q,2)));return{center:new c.Point(0,0),top:new c.Point(0,q),"top-left":new c.Point(Q,Q),"top-right":new c.Point(-Q,Q),bottom:new c.Point(0,-q),"bottom-left":new c.Point(Q,-Q),"bottom-right":new c.Point(-Q,-Q),left:new c.Point(q,0),right:new c.Point(-q,0)}}if(q instanceof c.Point||Array.isArray(q)){var $=c.Point.convert(q);return{center:$,top:$,"top-left":$,"top-right":$,bottom:$,"bottom-left":$,"bottom-right":$,left:$,right:$}}return{center:c.Point.convert(q.center||[0,0]),top:c.Point.convert(q.top||[0,0]),"top-left":c.Point.convert(q["top-left"]||[0,0]),"top-right":c.Point.convert(q["top-right"]||[0,0]),bottom:c.Point.convert(q.bottom||[0,0]),"bottom-left":c.Point.convert(q["bottom-left"]||[0,0]),"bottom-right":c.Point.convert(q["bottom-right"]||[0,0]),left:c.Point.convert(q.left||[0,0]),right:c.Point.convert(q.right||[0,0])}}return Z(new c.Point(0,0))}(this.options.offset);if(!_){var w,I=this._container.offsetWidth,M=this._container.offsetHeight;w=d.y+g.bottom.y<M?["top"]:d.y>this._map.transform.height-M?["bottom"]:[],d.x<I/2?w.push("left"):d.x>this._map.transform.width-I/2&&w.push("right"),_=0===w.length?"bottom":w.join("-")}var N=d.add(g[_]).round();Mt.setTransform(this._container,ja[_]+" translate("+N.x+"px,"+N.y+"px)"),xl(this._container,_,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(rl);o&&o.focus()}},a.prototype._onClose=function(){this.remove()},a}(c.Evented),wl={version:c.version,supported:gi,setRTLTextPlugin:c.setRTLTextPlugin,getRTLTextPluginStatus:c.getRTLTextPluginStatus,Map:Au,NavigationControl:es,GeolocateControl:Ql,AttributionControl:Ur,ScaleControl:ms,FullscreenControl:ca,Popup:eu,Marker:nl,Style:or,LngLat:c.LngLat,LngLatBounds:c.LngLatBounds,Point:c.Point,MercatorCoordinate:c.MercatorCoordinate,Evented:c.Evented,config:c.config,prewarm:function(){Pt().acquire(bt)},clearPrewarmedResources:function(){var n=ne;n&&(n.isPreloaded()&&1===n.numActive()?(n.release(bt),ne=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return c.config.ACCESS_TOKEN},set accessToken(n){c.config.ACCESS_TOKEN=n},get baseApiUrl(){return c.config.API_URL},set baseApiUrl(n){c.config.API_URL=n},get workerCount(){return vt.workerCount},set workerCount(n){vt.workerCount=n},get maxParallelImageRequests(){return c.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){c.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){c.clearTileCache(n)},workerUrl:""};return wl}),zi}();var Wo=zr.exports,Do=dt.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,opacity:1},initialize:function(Bt){dt.setOptions(this,Bt),this._throttledUpdate=dt.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(Bt){this._container||this._initContainer(),this.getPane().appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),Bt.options.zoomAnimation&&dt.DomEvent.on(Bt._proxy,dt.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(Bt){this._map._proxy&&this._map.options.zoomAnimation&&dt.DomEvent.off(this._map._proxy,dt.DomUtil.TRANSITION_END,this._transitionEnd,this),this.getPane().removeChild(this._container),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd}},getMapboxMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+2*this.options.padding)},getOpacity:function(){return this.options.opacity},setOpacity:function(Bt){this.options.opacity=Bt,this._container.style.opacity=Bt},getBounds:function(){var Bt=this.getSize().multiplyBy(.5),ee=this._map.latLngToContainerPoint(this._map.getCenter());return dt.latLngBounds(this._map.containerPointToLatLng(ee.subtract(Bt)),this._map.containerPointToLatLng(ee.add(Bt)))},getContainer:function(){return this._container},_initContainer:function(){var Bt=this._container=dt.DomUtil.create("div","leaflet-gl-layer"),ee=this.getSize(),Me=this._map.getSize().multiplyBy(this.options.padding);Bt.style.width=ee.x+"px",Bt.style.height=ee.y+"px",Bt.style.position="absolute",Bt.style.opacity=this.options.opacity;var Te=this._map.containerPointToLayerPoint([0,0]).subtract(Me);dt.DomUtil.setPosition(Bt,Te)},_initGL:function(){var Bt=this._map.getCenter(),ee=dt.extend({},this.options,{container:this._container,center:[Bt.lng,Bt.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new Wo.Map(ee),this._glMap.once("styledata",function(Te){this.fire("styleLoaded")}.bind(this)),this._glMap.transform.latRange=null,this._glMap.transform.maxValidLatitude=1/0,this._transformGL(this._glMap),this._glMap._actualCanvas=this._glMap._canvas.canvas?this._glMap._canvas.canvas:this._glMap._canvas;var Me=this._glMap._actualCanvas;dt.DomUtil.addClass(Me,"leaflet-image-layer"),dt.DomUtil.addClass(Me,"leaflet-zoom-animated"),this.options.interactive&&dt.DomUtil.addClass(Me,"leaflet-interactive"),this.options.className&&dt.DomUtil.addClass(Me,this.options.className)},_update:function(Bt){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var ee=this.getSize(),Me=this._container,Te=this._glMap,zi=this._map.getSize().multiplyBy(this.options.padding),wn=this._map.containerPointToLayerPoint([0,0]).subtract(zi);dt.DomUtil.setPosition(Me,wn),this._transformGL(Te),Te.transform.width!==ee.x||Te.transform.height!==ee.y?(Me.style.width=ee.x+"px",Me.style.height=ee.y+"px",null!=Te._resize?Te._resize():Te.resize()):null!=Te._update?Te._update():Te.update()}},_transformGL:function(Bt){var ee=this._map.getCenter(),Me=Bt.transform;Me.center=Wo.LngLat.convert([ee.lng,ee.lat]),Me.zoom=this._map.getZoom()-1},_pinchZoom:function(Bt){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(Bt){var ee=this._map.getZoomScale(Bt.zoom),Me=this._map.getSize().multiplyBy(this.options.padding*ee),Te=this.getSize()._divideBy(2),zi=this._map.project(Bt.center,Bt.zoom)._subtract(Te)._add(this._map._getMapPanePos().add(Me))._round(),wn=this._map.project(this._map.getBounds().getNorthWest(),Bt.zoom)._subtract(zi);dt.DomUtil.setTransform(this._glMap._actualCanvas,wn.subtract(this._offset),ee)},_zoomStart:function(Bt){this._zooming=!0},_zoomEnd:function(){var Bt=this._map.getZoomScale(this._map.getZoom());dt.DomUtil.setTransform(this._glMap._actualCanvas,null,Bt),this._zooming=!1,this._update()},_transitionEnd:function(Bt){dt.Util.requestAnimFrame(function(){var ee=this._map.getZoom(),Me=this._map.getCenter(),Te=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());dt.DomUtil.setTransform(this._glMap._actualCanvas,Te,1),this._glMap.once("moveend",dt.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:Me,zoom:ee-1})},this)}});function Vi(Bt){return new Do(Bt)}var ur=dt.Layer.extend({options:{key:"ArcGIS:Streets"},initialize:function(Bt,ee){if(ee&&dt.setOptions(this,ee),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.token&&(this.options.apikey=this.options.token),!this.options.apikey&&!this.options.token)throw new Error("API Key or token is required for vectorBasemapLayer.");Bt&&(this.options.key=Bt),this._createLayer()},_createLayer:function(){var ee,Me,Te=(Me="https://basemaps-api.arcgis.com/arcgis/rest/services/styles/"+this.options.key+"?type=style",(ee=this.options.apikey)&&(Me=Me+"&apiKey="+ee),Me);this._mapboxGL=Vi({style:Te,pane:this.options.pane,opacity:this.options.opacity}),this._ready=!0,this.fire("ready",{},!0),this._mapboxGL.on("styleLoaded",function(zi){this._setupAttribution()}.bind(this))},_setupAttribution:function(){var Bt=this._map;if(qr.Util.setEsriAttribution(Bt),32===this.options.key.length){var ee=this._mapboxGL.getMapboxMap().style.stylesheet.sources,Me=[];Object.keys(ee).forEach(function(Te){Me.push(ee[Te].attribution),ee[Te].copyrightText&&ee[Te].copyrightText&&""!==ee[Te].copyrightText&&ee[Te].attribution!==ee[Te].copyrightText&&Me.push(ee[Te].copyrightText)}),Bt.attributionControl.addAttribution('<span class="">'+Me.join(", ")+"</span>")}else if(this.options.attributionUrls||(this.options.attributionUrls=this._getAttributionUrls(this.options.key)),this._map&&this.options.attributionUrls){if(this._map.attributionControl){for(let Te=0;Te<this.options.attributionUrls.length;Te++)Lr(this.options.attributionUrls[Te],Bt);Bt.attributionControl.addAttribution('<span class="esri-dynamic-attribution"></span>')}qr.Util._updateMapAttribution({target:this._map})}},_getAttributionUrls:function(Bt){return 0===Bt.indexOf("OSM:")?["https://static.arcgis.com/attribution/Vector/OpenStreetMap_v2"]:0===Bt.indexOf("ArcGIS:Imagery")?["https://static.arcgis.com/attribution/World_Imagery","https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]:["https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]},onAdd:function(Bt){this._map=Bt,this._initPane(),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},_initPane:function(){if(this.options.pane||(this.options.pane=this.options.key.indexOf(":Labels")>-1?"esri-labels":"tilePane"),!this._map.getPane(this.options.pane)){var Bt=this._map.createPane(this.options.pane);Bt.style.pointerEvents="none",Bt.style.zIndex="esri-labels"===this.options.pane?550:500}},onRemove:function(Bt){if(Bt.off("moveend",qr.Util._updateMapAttribution),Bt.removeLayer(this._mapboxGL),Bt.attributionControl){var ee=document.getElementsByClassName("esri-dynamic-attribution");ee&&ee.length>0&&Bt.attributionControl.removeAttribution(ee[0].outerHTML)}},_asyncAdd:function(){var Bt=this._map;Bt.on("moveend",qr.Util._updateMapAttribution),this._mapboxGL.addTo(Bt,this)}}),Mn=dt.Layer.extend({options:{pane:"overlayPane",portalUrl:"https://www.arcgis.com"},initialize:function(Bt,ee){if(ee&&dt.setOptions(this,ee),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.apikey&&(this.options.token=this.options.apikey),!Bt)throw new Error("An ITEM ID or SERVICE URL is required for vectorTileLayer.");Bt&&(this.options.key=Bt),this._createLayer()},_createLayer:function(){!function eo(Bt,ee,Me){var Te,zi,wn,c;/^https?:\/\//.test(Bt)&&/\/VectorTileServer\/?$/.test(Bt)?ni(Bt,ee,Me):(wn=Me,Go(c=(zi=ee).portalUrl+"/sharing/rest/content/items/"+(Te=Bt)+"/resources/styles/root.json",zi,function(gi,Mt){!function lr(Bt,ee,Me){qr.request(ee.portalUrl+"/sharing/rest/content/items/"+Bt,ee.token?{token:ee.token}:{},Me)}(Te,zi,gi?function(Ue,le){Ue&&console.error(Ue),ni(le.url,zi,wn)}:function(Ue,le){Ue&&console.error(Ue),Ei(le.url,zi,function(en,Nt){wn(en,Mt,c,Nt,le.url)})})}))}(this.options.key,this.options,function(Bt,ee,Me,Te){if(Bt)throw new Error(Bt);if(sn.indexOf(Te.tileInfo.spatialReference.wkid)>=0||console.warn('This layer is not guaranteed to display properly because its service does not use the Web Mercator projection. The "tileInfo.spatialReference" property is:',Te.tileInfo.spatialReference,"\nMore information is available at https://docs.mapbox.com/help/glossary/projection/ and https://github.com/Esri/esri-leaflet-vector/issues/94."),ee=function(c,gi,Mt,Ue){for(var le=Object.keys(c.sources),en=0;en<le.length;en++){var Nt=c.sources[le[en]];-1===Nt.url.indexOf("http")&&(Nt.url=gi.replace("/resources/styles/root.json","")),"/"===Nt.url.charAt(Nt.url.length-1)&&(Nt.url=Nt.url.slice(0,Nt.url.length-1)),Nt.tiles||(Mt.tiles&&"/"!==Mt.tiles[0].charAt(0)&&(Mt.tiles[0]="/"+Mt.tiles[0]),Nt.tiles=[Nt.url+Mt.tiles[0]]),Nt.url+="?f=json",Nt.url+=Ue?"&token="+Ue:"",Nt.tiles[0]+=Ue?"?token="+Ue:"",Nt.minzoom=Mt.tileInfo.lods[0].level,Nt.maxzoom=Mt.tileInfo.lods[Mt.tileInfo.lods.length-1].level}var dn=c.sources[le[le.length-1]];dn.attribution=Mt.copyrightText||"",dn.copyrightText=Mt.copyrightText||"";for(var nn=0;nn<c.layers.length;nn++){var Se=c.layers[nn];Se.layout&&Se.layout["text-font"]&&Se.layout["text-font"].length>1&&(Se.layout["text-font"]=[Se.layout["text-font"][0]])}return c.sprite&&-1===c.sprite.indexOf("http")&&(c.sprite=gi.replace("styles/root.json",c.sprite.replace("../","")),c.sprite+=Ue?"?token="+Ue:""),c.glyphs&&-1===c.glyphs.indexOf("http")&&(c.glyphs=gi.replace("styles/root.json",c.glyphs.replace("../","")),c.glyphs+=Ue?"?token="+Ue:""),c}(ee,Me,Te,this.options.token),!this.getAttribution()){var wn=Object.keys(ee.sources);this.options.attribution=ee.sources[wn[wn.length-1]].attribution,this._map&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution())}this.options.style&&"function"==typeof this.options.style&&(ee=this.options.style(ee)),this._mapboxGL=Vi({style:ee,pane:this.options.pane,opacity:this.options.opacity}),this._ready=!0,this.fire("ready",{},!0)}.bind(this))},onAdd:function(Bt){this._map=Bt,this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(Bt){Bt.removeLayer(this._mapboxGL)},_asyncAdd:function(){this._mapboxGL.addTo(this._map,this)}});At.VERSION="3.1.5",At.VectorBasemapLayer=ur,At.VectorTileLayer=Mn,At.vectorBasemapLayer=function(Bt,ee){return new ur(Bt,ee)},At.vectorTileLayer=function(Bt,ee){return new Mn(Bt,ee)},Object.defineProperty(At,"__esModule",{value:!0})});